;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="633bb36e-b183-acd1-ee54-642a251ca43d")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2102048,e=>{"use strict";var t=e.i(2144405),l=e.i(4205214),a=e.i(1397323),i=e.i(5677444),s=e.i(8660982),r=e.i(57106),n=e.i(7429602),o=e.i(7420728),c=e.i(9367781),u=e.i(9106354),d=e.i(4004502),m=e.i(6143247),h=e.i(9317241),f=e.i(5255926);function x(e){let{width:t}=e;return(0,l.jsx)(f.Skeleton,{className:"w-full @lg-page:h-[388px]",height:200,width:t??300})}var g=e.i(5579912),p=e.i(3992079),j=e.i(5149014);function v(e){let{size:t=16,fill:a="currentColor",className:i=""}=e;return(0,l.jsx)("svg",{className:i,fill:a,height:t,viewBox:"0 0 56 56",width:t,xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M40.25 24.5C48.949 24.5 56 31.552 56 40.25 56 48.949 48.949 56 40.25 56c-8.698 0-15.75-7.051-15.75-15.75 0-8.698 7.052-15.75 15.75-15.75ZM37.696 42c.138 3.376.675 6.74 1.612 10.02l-1.091.31a12.33 12.33 0 0 0 4.065 0l-1.09-.31A42.838 42.838 0 0 0 42.804 42h-5.108ZM23 0c0 1.785.56 3.083 1.453 4.122.933 1.085 2.307 1.976 4.045 2.74 1.733.76 3.698 1.34 5.718 1.881 1.958.524 4.053 1.03 5.792 1.61l1.367.456v6.066h-4v-3.148c-1.26-.361-2.662-.71-4.193-1.12-2.05-.548-4.263-1.192-6.292-2.084-2.025-.889-3.997-2.079-5.471-3.794-.146-.17-.284-.346-.419-.525-.135.179-.273.355-.419.525-1.474 1.715-3.446 2.905-5.47 3.794-2.03.892-4.244 1.536-6.293 2.084-1.531.41-2.933.759-4.193 1.12v19.618c0 5.114 2.84 9.807 7.37 12.18l4.683 2.453 1.771.928-1.855 3.543-1.772-.927-4.683-2.454A17.75 17.75 0 0 1 .625 33.345V10.809l1.367-.457c1.739-.579 3.834-1.085 5.792-1.609 2.02-.54 3.985-1.12 5.718-1.882 1.738-.763 3.112-1.654 4.045-2.739C18.44 3.083 19 1.785 19 0h4Zm23.307 42a46.327 46.327 0 0 1-1.372 9.57c3.924-1.627 6.82-5.23 7.44-9.57h-6.068Zm-18.182 0c.62 4.34 3.515 7.943 7.438 9.57a46.332 46.332 0 0 1-1.37-9.57h-6.068Zm7.438-13.07c-3.923 1.626-6.817 5.23-7.438 9.57h6.068a46.328 46.328 0 0 1 1.37-9.57Zm9.372 0a46.33 46.33 0 0 1 1.372 9.57h6.068c-.62-4.34-3.516-7.945-7.44-9.57ZM40.25 28c-.693 0-1.372.058-2.033.169l1.09.311a42.838 42.838 0 0 0-1.61 10.02h5.107a42.838 42.838 0 0 0-1.612-10.02l1.09-.311c-.66-.11-1.34-.169-2.032-.169Z"})})}function w(e){let{size:t=16,fill:a="currentColor",className:i=""}=e;return(0,l.jsx)("svg",{className:i,fill:a,height:t,viewBox:"0 0 42 55",width:t,xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M23 0c0 1.785.56 3.083 1.453 4.122.933 1.085 2.307 1.976 4.045 2.74 1.733.76 3.698 1.34 5.718 1.881 1.958.524 4.053 1.03 5.792 1.61l1.367.456v22.536a17.75 17.75 0 0 1-9.514 15.723l-9.933 5.204-.928.486-.928-.486-9.933-5.204A17.75 17.75 0 0 1 .625 33.345V10.809l1.367-.457c1.739-.579 3.834-1.085 5.792-1.609 2.02-.54 3.985-1.12 5.718-1.882 1.738-.763 3.112-1.654 4.045-2.739C18.44 3.083 19 1.785 19 0h4Zm-2 6.204c-.135.179-.273.355-.419.525-1.474 1.715-3.446 2.905-5.47 3.794-2.03.892-4.244 1.536-6.293 2.084-1.531.41-2.933.759-4.193 1.12v19.618c0 5.114 2.84 9.807 7.37 12.18L21 50.242l9.005-4.717a13.751 13.751 0 0 0 7.37-12.18V13.728c-1.26-.362-2.662-.71-4.193-1.12-2.05-.549-4.263-1.193-6.292-2.085-2.025-.889-3.997-2.079-5.471-3.794-.146-.17-.284-.346-.419-.525ZM30.828 24.5 18.914 36.414a2 2 0 0 1-2.828 0L11.172 31.5 14 28.672l3.5 3.5 10.5-10.5 2.828 2.828Z"})})}function b(e){let{size:t=16,fill:a="currentColor",className:i=""}=e;return(0,l.jsx)("svg",{className:i,fill:a,height:t,viewBox:"0 0 55 54",width:t,xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M11.625 33.345c0 5.114 2.84 9.807 7.37 12.18L28 50.242l3.135-1.641 1.771-.93 1.856 3.545-1.772.928-4.062 2.128-.928.486-.928-.486-9.933-5.204a17.75 17.75 0 0 1-9.514-15.723v-9.97h4v9.97ZM30 0c0 1.785.56 3.083 1.453 4.122.933 1.085 2.307 1.976 4.045 2.74 1.733.76 3.699 1.34 5.718 1.881 1.958.524 4.053 1.03 5.792 1.61l1.367.456v22.536c0 3.414-.983 6.681-2.737 9.465l8.815 8.815-2.828 2.828L1.547 4.375l2.828-2.828 7.864 7.864.44-.115c3.388-.888 6.79-1.734 9.39-3.217C24.541 4.67 26 2.861 26 0h4Zm-2 6.204c-1.05 1.39-2.432 2.484-3.95 3.35-2.583 1.473-5.73 2.388-8.536 3.131L42.717 39.89a13.736 13.736 0 0 0 1.658-6.544V13.728c-1.26-.362-2.662-.71-4.193-1.12-2.05-.549-4.263-1.193-6.292-2.085-2.025-.889-3.997-2.079-5.471-3.794-.146-.17-.284-.346-.419-.525Z"})})}function y(e){let{hasAnomaly:t,isLoading:a}=(0,j.useActiveAnomaly)(e),i=(0,g.useProxyModal)(),[r,n,o]=(0,j.useReverseProxyBadge)({...e,onProxyClick:i.open}),[c,u,d,f]=(0,j.useACMBadge)(e),[y,M,C]=(0,j.useGlobalBypass)(e),N=(0,s.useCallback)(()=>r||c||y?null:(0,l.jsx)("span",{className:"text-label-12 text-gray-alpha-900",children:"All systems normal"}),[c,r,y]),k=(0,s.useCallback)(()=>y?(0,l.jsx)(b,{fill:"var(--ds-red-800)",size:56}):t?(0,l.jsx)(v,{fill:"var(--ds-amber-800)",size:56,className:"ml-2"}):(0,l.jsx)(w,{fill:"var(--ds-blue-700)",size:56}),[y,t]),S=(0,s.useMemo)(()=>y?"System Mitigations Paused":t?"DDoS attacks are being mitigated":"Firewall is active",[t,y]),L=a||o||f||C,A=(0,s.useRef)(!1);return((0,s.useEffect)(()=>{L||A.current||(A.current=!0)},[L]),L&&!A.current)?(0,l.jsx)(x,{width:278}):(0,l.jsxs)(h.GradientPostureCard,{hasAnomaly:t,hasChallengeMode:c,hasGlobalBypass:y,children:[(0,l.jsxs)("figure",{className:"flex flex-col items-center gap-3 @lg-page:gap-5 grow justify-center",children:[(0,l.jsx)(k,{}),(0,l.jsxs)("figcaption",{className:(0,m.cn)("flex flex-col items-center",{"gap-1":c||r}),children:[(0,l.jsx)("p",{children:(0,l.jsx)("strong",{className:"text-label-14 font-medium",children:S})}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 items-center",children:[(0,l.jsx)(M,{}),(0,l.jsx)(u,{}),(0,l.jsx)(n,{}),(0,l.jsx)(N,{})]})]})]}),(0,l.jsxs)("div",{className:"group flex flex-col gap-1",children:[(0,l.jsx)(h.BotProtectionRow,{hasReverseProxy:r,...e}),(0,l.jsx)(h.CustomRulesRow,{...e}),(0,l.jsx)(h.AttackChallengeRow,{challengeData:d,isAlerting:c})]}),i.isOpen&&(0,l.jsx)(p.ProxyImpactModal,{onClose:i.close,...e})]})}var M=e.i(8708663),C=e.i(5963711),N=e.i(5182595),k=e.i(8690335);function S(){return(0,l.jsxs)("div",{className:"flex w-full flex-col h-full justify-between",children:[(0,l.jsxs)("div",{className:"flex max-h-36 flex-row items-center gap-5",children:[(0,l.jsx)(f.Skeleton,{height:16,width:28}),(0,l.jsx)("hr",{className:"w-full"})]}),(0,l.jsxs)("div",{className:"flex max-h-36 flex-row items-center gap-5",children:[(0,l.jsx)(f.Skeleton,{height:16,width:28}),(0,l.jsx)("hr",{className:"w-full"})]}),(0,l.jsxs)("div",{className:"flex max-h-36 flex-row items-center gap-5",children:[(0,l.jsx)(f.Skeleton,{height:16,width:28}),(0,l.jsx)("hr",{className:"w-full"})]}),(0,l.jsxs)("div",{className:"flex max-h-36 flex-row items-center gap-5",children:[(0,l.jsx)(f.Skeleton,{height:16,width:28}),(0,l.jsx)("hr",{className:"w-full"})]}),(0,l.jsxs)("div",{className:"flex max-h-36 flex-row items-center gap-5",children:[(0,l.jsx)(f.Skeleton,{height:16,width:28}),(0,l.jsx)("hr",{className:"w-full"})]}),(0,l.jsxs)("div",{className:"flex max-h-36 flex-row items-center gap-5",children:[(0,l.jsx)(f.Skeleton,{height:16,width:28}),(0,l.jsx)("hr",{className:"w-full"})]}),(0,l.jsxs)("div",{className:"flex flex-row justify-around",children:[(0,l.jsx)(f.Skeleton,{height:16,width:48}),(0,l.jsx)(f.Skeleton,{height:16,width:48}),(0,l.jsx)(f.Skeleton,{className:"xs:block hidden",height:16,width:48}),(0,l.jsx)(f.Skeleton,{className:"hidden @sm-page:block",height:16,width:48}),(0,l.jsx)(f.Skeleton,{className:"hidden @md-page:block",height:16,width:48}),(0,l.jsx)(f.Skeleton,{className:"hidden @lg-page:block",height:16,width:48})]})]})}var L=e.i(3538015);function A(e){let{data:t,query:a,error:i,isLoading:r,onZoomIn:n}=e,o=!!r,{allData:c,allKeys:u,seriesColor:d,formatter:m,hoveredAction:h}=(0,M.useVisualizationContext)(),f=(0,s.useMemo)(()=>{var e,t;let l;return e=c.filter(e=>!(0,C.isOthersAggregate)(e.key)),t=u,l=new Map(e.map(e=>{let{date:l}=e;return[l.toISOString(),{time:l.toISOString(),name:l.toISOString(),date:l,...Object.fromEntries(t.map(e=>[e,0]))}]})),e.forEach(e=>{let{date:t,key:a,value:i}=e,s=l.get(t.toISOString());s&&(s[a]=i)}),[...l.values()].sort((e,t)=>e.date.getTime()-t.date.getTime())},[c,u]),x=(0,s.useMemo)(()=>{let e=new Map;return u.forEach(t=>{e.set(t,function(e){if(e.includes("$$")){let[t,l]=e.split("$$"),a=L.ruleToMappings[t]?.label||t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),i=(0,C.formatFirewallActionForDisplay)(l);return`${a} (${i})`}return L.ruleToMappings[e]?L.ruleToMappings[e].label:e}(t))}),e},[u]),g=(0,s.useMemo)(()=>f.map(e=>{let t={name:e.name,time:e.time};return Object.entries(e).forEach(e=>{let[l,a]=e;"name"!==l&&"time"!==l&&"date"!==l&&(t[x.get(l)||l]=a)}),t}),[f,x]),p=(0,s.useMemo)(()=>u.map(e=>x.get(e)||e),[u,x]),j=(0,s.useMemo)(()=>e=>{let t=Array.from(x.entries()).find(t=>{let[l,a]=t;return a===e})?.[0];return t?d[t]:d[e]},[d,x]),v=(0,s.useMemo)(()=>{if(h)return e=>{let t=Array.from(x.entries()).find(t=>{let[l,a]=t;return a===e})?.[0];return!!t&&t.split("$$")[1]!==h}},[h,x]);return!i&&!o&&t&&t.size>0?(0,l.jsx)(N.LineChart,{agentWorkflow:"firewall-investigation",builderQuery:(0,k.fromSonarQuery)(a),categories:p,data:g,disableLegend:!0,formatValue:e=>m(e),formatXAxisValue:B,getColor:j,hideZeroValuesInTooltip:!0,isLoading:o,onZoomIn:n,shouldFadeKey:v,syncId:"firewall",tooltipStyle:"value-list",xTickCount:5,yTickCount:5}):(0,l.jsx)(R,{error:i,isLoading:o,data:t})}function R(e){let{error:t,isLoading:a,data:i}=e;return t?(0,l.jsxs)("div",{"data-testid":(0,d.tid)("firewall","graph","error"),className:"border-border flex flex-col items-center justify-center gap-2 rounded-md border border-gray-400 bg-[var(--accents-1)] h-full",children:[(0,l.jsx)("p",{className:"text-[14px] leading-[20px] font-medium capitalize",children:t.code}),(0,l.jsx)("p",{className:"text-copy-14 max-w-[400px] text-gray-800",children:t.message})]}):a||i?.size!==0?(0,l.jsx)(S,{}):(0,l.jsxs)("div",{"data-testid":(0,d.tid)("firewall","graph","empty"),className:"border-border flex flex-col items-center justify-center gap-2 rounded-md border border-gray-400 bg-[var(--accents-1)] h-full",children:[(0,l.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"No Data"}),(0,l.jsx)("p",{className:"text-copy-14 max-w-[400px] text-gray-800",children:"There's no data available for your selection."})]})}let T={hour:"numeric",minute:"2-digit",second:"numeric"};function B(e){return e.toLocaleTimeString(void 0,T)}var E=e.i(9475671),I=e.i(7807066),$=e.i(7506654);function P(e){let{children:t}=e,a=(0,s.useRef)(null),[i,r]=(0,s.useState)(!1),[n,o]=(0,s.useState)(!1),c=(0,$.useReducedMotion)();(0,s.useEffect)(()=>{let e=a.current;if(!e)return;let{first:t,last:l}=(()=>{let t=Array.from(e.children);if(0===t.length)return{first:null,last:null};let l=t.at(1),a=t.at(-2);return l&&a?.isSameNode(l)?{first:null,last:null}:{first:l,last:a}})();if(!t||!l)return;let i=new IntersectionObserver(e=>{e.forEach(e=>{e.target===t&&r(1!==e.intersectionRatio),e.target===l&&o(1!==e.intersectionRatio)})},{root:e,threshold:1});return i.observe(t),i.observe(l),()=>i.disconnect()},[]);let u=(0,s.useCallback)(e=>{let t=a.current;if(!t)return;let l="left"===e?0:t.scrollWidth-t.clientWidth;t.scrollTo({left:l,behavior:c?"instant":"smooth"})},[c]);return(0,l.jsx)("div",{className:"group isolate relative flex items-center overflow-hidden border-b border-gray-alpha-400",children:(0,l.jsxs)("div",{ref:a,className:"flex flex-1 items-center gap-3 overflow-x-auto px-4 py-3 [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",children:[(0,l.jsx)("button",{type:"button",disabled:!i,onClick:()=>u("left"),className:(0,m.cn)("absolute left-2 top-1/2 -translate-y-1/2 z-20 bg-background-100 border border-gray-alpha-400 rounded-md p-2 shadow-md opacity-0  transition-opacity hover:bg-background-200 pointer-events-none",{"group-hover:opacity-100 pointer-events-auto":i}),"aria-label":"Scroll left",children:(0,l.jsx)(E.ChevronLeft,{})}),t,(0,l.jsx)("button",{type:"button",disabled:!n,onClick:()=>u("right"),className:(0,m.cn)("absolute right-2 top-1/2 -translate-y-1/2 z-20 bg-background-100 border border-gray-alpha-400 rounded-md p-2 shadow-md opacity-0 transition-opacity hover:bg-background-200 pointer-events-none",{"group-hover:opacity-100 pointer-events-auto":n}),"aria-label":"Scroll right",children:(0,l.jsx)(I.ChevronRight,{})})]})})}let O=(0,s.forwardRef)(function(e,t){let{active:a,children:i,actionName:r,label:n,onClick:o,onMouseEnter:c,onMouseLeave:u}=e,[d,h]=(0,s.useState)(!1),f=a||d;return(0,l.jsxs)("button",{type:"button",ref:t,onClick:o,onMouseEnter:()=>{h(!0),c?.()},onMouseLeave:()=>{h(!1),u?.()},onFocus:()=>{h(!0)},onBlur:()=>{h(!1)},className:(0,m.cn)("flex shrink-0 cursor-pointer items-center gap-1.5 whitespace-nowrap rounded-full px-2 py-1 text-sm transition-colors","opacity-100"),style:{backgroundColor:f?`hsl(${C.ACTION_COLORS[r].active}, 0.66)`:"transparent"},children:[(0,l.jsx)("span",{className:(0,m.cn)("size-2 shrink-0 rounded-full bg-current",C.ACTION_COLORS[r].base)}),(0,l.jsx)("span",{className:"font-medium text-gray-1000",children:n}),(0,l.jsx)("span",{className:(0,m.cn)("tabular-nums transition-colors",f?"text-gray-1000":"text-gray-900"),children:void 0===i||0===i?"-":(0,C.formatShortPrecision)(i)})]})});function _(e){let{totalRequests:t}=e;return(0,l.jsx)(P,{children:(0,l.jsx)(O,{active:!1,actionName:"all",label:"BotID Checks",children:t})})}var z=e.i(1717203),D=e.i(7557283),F=e.i(5481907);function U(e){let{onActionClick:t,query:a,state:i}=e,{can:r}=(0,z.default)(),{setHoveredAction:n}=(0,M.useVisualizationContext)(),o=(0,C.wafRuleId)(i.filter),c=(0,s.useRef)(null),{currentData:u}=(0,F.useSonarLiveQuery)({...a,filter:"all_rules"===i.filter?void 0:`wafRuleId eq '${o}'`,groupBy:["wafAction"],summaryOnly:!0},"live"===i.range&&(r(D.Action.Read,D.Resource.SeawallConfig)||r(D.Action.List,D.Resource.SeawallConfig))),d=(u?.summary??[]).reduce((e,t)=>{let l="allow"===t.wafAction?"allow":(0,C.normalizeFirewallAction)(t.wafAction);return l in e&&(e[l]+=t.value??0),e.all+=t.value??0,e},{all:0,allow:0,challenge:0,deny:0,log:0,rate_limit:0});return(0,l.jsxs)(P,{children:[(0,l.jsx)(O,{active:"allow"===i.action,actionName:"allow",label:"Allowed",onClick:()=>t("allow"===i.action?"all":"allow"),onMouseEnter:()=>n("allow"),onMouseLeave:()=>n(null),ref:"allow"===i.action?c:void 0,children:d.allow}),(0,l.jsx)(O,{active:"deny"===i.action,actionName:"deny",label:"Denied",onClick:()=>t("deny"===i.action?"all":"deny"),onMouseEnter:()=>n("deny"),onMouseLeave:()=>n(null),ref:"deny"===i.action?c:void 0,children:d.deny}),(0,l.jsx)(O,{active:"challenge"===i.action,actionName:"challenge",label:"Challenged",onClick:()=>t("challenge"===i.action?"all":"challenge"),onMouseEnter:()=>n("challenge"),onMouseLeave:()=>n(null),ref:"challenge"===i.action?c:void 0,children:d.challenge}),(0,l.jsx)(O,{active:"log"===i.action,actionName:"log",label:"Logged",onClick:()=>t("log"===i.action?"all":"log"),onMouseEnter:()=>n("log"),onMouseLeave:()=>n(null),ref:"log"===i.action?c:void 0,children:d.log}),(0,l.jsx)(O,{active:"rate_limit"===i.action,actionName:"rate_limit",label:"Rate Limited",onClick:()=>t("rate_limit"===i.action?"all":"rate_limit"),onMouseEnter:()=>n("rate_limit"),onMouseLeave:()=>n(null),ref:"rate_limit"===i.action?c:void 0,children:d.rate_limit})]})}function Z(e){let{query:t}=e,{currentData:a}=(0,F.useSonarLiveQuery)({...t,event:"incomingRequest",reason:"firewall_tab",rollups:{value:{measure:"count",aggregation:"sum"}},groupBy:[],filter:"matchesPattern(botName, '\\S')",summaryOnly:!0}),i=a?.summary[0]?.value??void 0;return(0,l.jsx)(P,{children:(0,l.jsx)(O,{active:!1,actionName:"all",label:"Known Bot Traffic",children:i})})}function V(e){let{toolbarState:t,setToolbarState:a,query:r,lineSeries:n,error:o,isGraphDataLoading:c,isFirewallStatusLoading:u,totalBotRequests:m}=e,h=(0,i.useParams)(),f=(0,s.useMemo)(()=>e=>{a({type:"range",value:e})},[a]),g=(0,s.useMemo)(()=>e=>{a({type:"action",value:e})},[a]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-full  @lg-page:w-[278px]",children:!h||u?(0,l.jsx)(x,{width:278}):(0,l.jsx)(y,{projectId:h.project,teamId:h.teamSlug})}),(0,l.jsxs)("div",{className:"flex flex-1 flex-col rounded-md border border-gray-alpha-400 bg-background-100",children:["BotID"===t.filter?(0,l.jsx)(_,{totalRequests:m}):"bot-management"===t.filter?(0,l.jsx)(Z,{query:r}):(0,l.jsx)(U,{onActionClick:g,query:r,state:t}),(0,l.jsx)("div",{"data-testid":(0,d.tid)("firewall","graph","container"),className:"flex-1 px-4 pb-4 pt-8",style:{position:"relative"},children:(0,l.jsx)(A,{data:n,error:o,isLoading:c,query:r,onZoomIn:f})})]})]})}var q=e.i(5467025),H=e.i(4597921);let X=["alert","eventIp","eventHost","eventAction","eventStart","eventEnd"];e.s(["FirewallProjectLayout",0,function(e){let{children:d,headerActions:h,showTabs:f=!0}=e,x=(0,u.useFirewallState)(),{timeRangeSelector:g}=x,p=(0,H.useServerFlag)("show-security-plus",!1),j=[{label:"Overview",route:"/[teamSlug]/[project]/firewall",computeSearch:e=>{let{filtered:t}=e;return t.delete("filter"),t.delete("action"),t}},"/[teamSlug]/[project]/firewall/traffic","/[teamSlug]/[project]/firewall/rules","/[teamSlug]/[project]/firewall/audit-log"];p&&j.push({label:"Bot Management",route:"/[teamSlug]/[project]/firewall/bot-management",meta:{suffix:(0,l.jsx)(n.default,{size:"sm"})}});let v=p?"w-[260px]":"w-[209px]",w=(0,i.usePathname)(),b=(0,s.useMemo)(()=>h?"bot-management"===w?.split("/").at(-1)?h["bot-management"]:h.default:null,[w,h]),{title:y}=(0,s.useMemo)(()=>{let e=Object.entries(o.Routes).find(e=>{let[t]=e,l=t.replace(/^.*(?=firewall)/,"");return w?.endsWith(l)});if(e&&w){let[,t]=e;if("Firewall"===t.group)return{title:t.label}}return{title:"Overview"}},[w]);return(0,l.jsxs)("div",{className:"flex flex-1 flex-col relative",children:[(0,l.jsx)("div",{className:`w-full md:py-6 ${!f?"border-b":""}`,children:(0,l.jsxs)("div",{className:"container flex px-0 items-center @md-page:min-h-14 @md-page:py-0",children:["true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH?null:(0,l.jsxs)("div",{className:(0,m.cn)("flex flex-col justify-center self-start -mt-2.5",{[v]:f}),children:[(0,l.jsx)(r.Link,{href:w?.replace(/\/[^/]+$/,""),className:"text-sm text-gray-900 inline-block h-4 hover:underline",children:"Firewall"}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-1.5",children:[(0,l.jsx)("h1",{className:"font-medium text-heading-32 text-3xl",children:y}),(0,l.jsx)(c.MicrofrontendsHelpBadge,{childHelp:"Firewall rules for the default app also run for every request to this microfrontend.",parentHelp:"Firewall rules defined here will run for all microfrontends in this group."})]})]}),g||b?(0,l.jsxs)("div",{className:"flex justify-between items-center grow",children:[g&&(0,l.jsx)("div",{className:(0,m.cn)("flex gap-2",{"ml-6":f}),children:g}),b&&(0,l.jsx)("div",{className:"flex gap-2 items-center ml-auto",children:b})]}):null]})}),(0,l.jsx)("div",{className:"relative flex-1",children:(0,l.jsxs)("div",{className:"container flex flex-col gap-6 pb-10 px-0 @md-page:flex-row @md-page:py-6",children:[f&&("true"===t.default.env.NEXT_PUBLIC_TESTMODE||"true"===t.default.env.NEXT_PUBLIC_TESTSERVER||"1"!==t.default.env.NEXT_PUBLIC_DASH)?(0,l.jsx)("div",{className:`flex shrink-0 ${v} flex-col gap-2 -mx-2.5 md:mr-0`,children:(0,l.jsx)(a.TabList,{excludeParams:X,routes:j})}):null,(0,l.jsxs)("div",{className:"flex flex-col w-full min-w-0",children:[x.shouldRenderPostureGraph&&(0,l.jsx)("div",{className:"flex flex-col gap-3 mb-4 @lg-page:flex-row @lg-page:h-[388px]",children:(0,l.jsx)(q.ObservabilityChartContextProvider,{children:(0,l.jsx)(M.VisualizationContextProvider,{formatter:C.formatShortPrecision,series:x.lineSeries??new Map,children:(0,l.jsx)(V,{toolbarState:x.toolbarState,setToolbarState:x.setToolbarState,query:x.query,lineSeries:x.lineSeries,error:x.error,isGraphDataLoading:x.isGraphDataLoading,isFirewallStatusLoading:x.isFirewallStatusLoading,totalBotRequests:x.totalBotRequests})})})}),d]})]})})]})}],2102048)},5190666,e=>{"use strict";var t=e.i(4205214);e.i(6483798);var l=e.i(8287059),a=e.i(8459493),i=e.i(5677444),s=e.i(8660982);e.s(["UpgradableMenuItem",0,function(e){let{href:r,isHobby:n,teamId:o,source:c,...u}=e,d=(0,i.useRouter)(),m=(0,l.useOpenUpgradeModal)(),h=(0,s.useCallback)(()=>{r&&m({teamHint:o,source:`firewall-configure-menu-${c}`,onConversionSuccess:()=>{d.push(r)}})},[r,m,d.push,c,o]);return n?(0,t.jsx)(a.MenuItem,{...u,isLink:!1,onClick:h}):(0,t.jsx)(a.MenuItem,{isLink:!0,href:"https://vercel.com/contact/sales",...u})}])},2139548,e=>{"use strict";var t=e.i(850302);e.s(["useConfirmAttackModeModal",0,function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{data:l,mutate:a}=(0,t.default)("showConfirmAttackModeModal",null,{fallbackData:e});return{showConfirmAttackModeModal:l,setShowConfirmAttackModeModal:a}}])},4185682,e=>{"use strict";var t=e.i(4205214),l=e.i(2139548),a=e.i(8459493);e.s(["ConfirmAttackModeModalTrigger",0,function(e){let{setShowConfirmAttackModeModal:i}=(0,l.useConfirmAttackModeModal)();return(0,t.jsx)(a.MenuItem,{onClick:()=>i(!0),...e})}])},6234625,e=>{"use strict";var t=e.i(850302);e.s(["useMitigationsBypassModal",0,function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{data:l,mutate:a}=(0,t.default)("showMitigationsBypassModal",null,{fallbackData:e});return{showMitigationsBypassModal:l,setShowMitigationsBypassModal:a}}])},1669084,e=>{"use strict";var t=e.i(4205214),l=e.i(6234625),a=e.i(8459493);e.s(["MitigationsBypassModalTrigger",0,function(e){let{setShowMitigationsBypassModal:i}=(0,l.useMitigationsBypassModal)();return(0,t.jsx)(a.MenuItem,{onClick:()=>i(!0),...e})}])},7449504,e=>{"use strict";var t=e.i(4205214),l=e.i(2139548),a=e.i(6234625),i=e.i(3538015),s=e.i(9943777),r=e.i(2504781),n=e.i(8674454),o=e.i(6694387),c=e.i(4991687),u=e.i(5232300),d=e.i(4161083),m=e.i(8876434),h=e.i(2375916),f=e.i(3814652),x=e.i(6198010),g=e.i(7749365),p=e.i(4905330),j=e.i(5677444),v=e.i(8660982);function w(e){let{disabled:l,onClick:a,prefix:i,suffix:s,type:n,children:o}=e,{actions:c}=(0,u.useMenu)();return(0,t.jsx)(r.Button,{disabled:l,onClick:()=>{c.setOpen(!1),a()},prefix:i,suffix:s,type:n,width:"100%",children:o})}e.s(["MobileMenu",0,function(e){let{teamSlug:r,project:u,canWriteConfig:b,attackModeEnabled:y,isBypassEnabled:M,showBypassOption:C,showRefreshedFirewall:N}=e,k=(0,j.useRouter)(),S=(0,v.useRef)(null),L=M?h.Shield:f.ShieldOff,{setShowMitigationsBypassModal:A}=(0,a.useMitigationsBypassModal)(),{setShowConfirmAttackModeModal:R}=(0,l.useConfirmAttackModeModal)(),T=(0,v.useMemo)(()=>M?"Resume":"Pause",[M]),B=N?`/${r}/${u}/firewall/rules`:`/${r}/${u}/firewall/configure`,E=N?`/${r}/${u}/firewall/audit-log`:`/${r}/${u}/firewall/activity-log`;return(0,t.jsxs)(c.MenuContainer,{closeOnSelect:!0,position:"bottom-end",children:[(0,t.jsx)(o.MenuButton,{"aria-label":"Menu",className:"@lg-page:hidden",shape:"square",size:"small",svgOnly:!0,type:"secondary",children:(0,t.jsx)(m.MoreHorizontal,{})}),(0,t.jsx)(n.Menu,{className:"@lg-page:hidden",containerRef:S,mobileContainerClassName:"z-[5001]",portalClassName:"tailwind-preflight @lg-page:hidden",width:"14rem",children:(0,t.jsxs)("div",{className:"flex h-full flex-col gap-y-3 p-2",children:[(0,t.jsx)(w,{onClick:()=>{k.push(`/${r}/${u}/firewall/configure/rule/new`)},type:"secondary",prefix:(0,t.jsx)(x.Plus,{size:16}),children:"Add Rule"}),(0,t.jsx)(w,{onClick:()=>{let e=(0,s.getRuleTemplateSignature)(i.rateLimitTemplate);k.push(`/${r}/${u}/firewall/configure/rule/new?template=${encodeURIComponent(i.rateLimitTemplate)}&sig=${encodeURIComponent(e)}`)},type:"secondary",prefix:(0,t.jsx)(g.Clock,{size:16}),children:"Add Rate Limit"}),(0,t.jsx)(w,{onClick:()=>k.push(B),type:"secondary",prefix:(0,t.jsx)(p.Scroll,{size:16}),children:"Configure Rules"}),(0,t.jsx)(w,{onClick:()=>k.push(E),type:"secondary",prefix:(0,t.jsx)(d.BookOpen,{size:16}),children:"View Audit Log"}),(0,t.jsx)(w,{onClick:()=>k.push(`${B}${N?"":"#bot-management"}`),prefix:(0,t.jsx)(h.Shield,{size:16}),children:"Bot Management"}),C?(0,t.jsxs)(w,{disabled:!b,onClick:()=>A(!0),prefix:(0,t.jsx)(L,{size:16}),type:"Pause"===T?"error":"secondary",children:[T," System Mitigations"]}):null,(0,t.jsxs)(w,{disabled:!b,onClick:()=>R(!0),type:"error",children:[y?"Disable":"Enable"," Attack Mode"]})]})})]})}])},7328883,e=>{"use strict";var t=e.i(4205214),l=e.i(2139548),a=e.i(6234625),i=e.i(8114130),s=e.i(6482765),r=e.i(8362250),n=e.i(7917902),o=e.i(9465698),c=e.i(5793260),u=e.i(6060673),d=e.i(5677444),m=e.i(8660982),h=e.i(3657238);e.s(["FirewallModals",0,function(){let e=(0,d.useParams)(),f=(0,d.useRouter)(),{team:x,user:g}=(0,n.useAccount)(),{showMitigationsBypassModal:p,setShowMitigationsBypassModal:j}=(0,a.useMitigationsBypassModal)(),{showConfirmAttackModeModal:v,setShowConfirmAttackModeModal:w}=(0,l.useConfirmAttackModeModal)(),{data:b,isLoading:y,mutate:M}=(0,u.useProject)(e?.project,{apiVersion:"v9"}),{updateMitigationsBypassAll:C,isLoading:N}=(0,o.useFirewallBypass)({projectId:b?.id}),{trigger:k}=(0,c.useUpdateAttackMode)(),S=(b?.security?.attackModeEnabled&&(!b?.security?.attackModeActiveUntil||b.security.attackModeActiveUntil>Date.now()))??!1,{enabled:L}=(0,i.globalBypassStatus)(b),A=(0,m.useCallback)(e=>"string"==typeof e&&e.includes(`projects/${b?.name}`)&&e.includes(`teamId=${x?.slug}`),[b?.name,x?.slug]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.MitigationsBypassModal,{confirmText:`${x?x.slug:g?.username}/${b?.name}`,isEnabled:L,isLoading:N||y,onClose:()=>j(!1),onSubmit:()=>{C(!L).then(async()=>{j(!1),await Promise.all([M(),(0,h.mutate)(A)]),f.refresh()}).catch(()=>{})},open:p}),(0,t.jsx)(r.ConfirmationAttackMode,{isEnabled:S||!1,onClose:()=>{w(!1)},onSubmit:e=>{b&&!y&&k({projectId:b.id,attackModeEnabled:!S,attackModeActiveUntil:e?Date.now()+e:void 0}).then(async()=>{w(!1),await Promise.all([M(),(0,h.mutate)(A)]),f.refresh()}).catch(e=>{console.error("Failed to update attack mode:",e)})},open:v})]})}])}]);

//# debugId=633bb36e-b183-acd1-ee54-642a251ca43d
//# sourceMappingURL=db856cb34bddcf69.js.map