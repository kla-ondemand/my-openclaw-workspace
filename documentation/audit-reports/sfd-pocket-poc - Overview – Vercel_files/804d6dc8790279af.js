;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="1c266ec2-cb4c-2463-f53e-6492fc82b58e")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2383382,e=>{"use strict";var t=e.i(850302),n=e.i(7222834),a=e.i(8660982),r=e.i(8042625),i=e.i(277234),s=e.i(4244280),l=e.i(1717203),o=e.i(7557283);function d(e){let{teamId:t,projectId:n,ids:a}=e;return`${s.API_SHARED_ENV_VARIABLES}/all${(0,r.encode)({teamId:t,projectId:n,ids:a})}`}e.s(["getUseSharedEnvsSWRKey",0,d,"useSharedEnvVarsInfinite",0,function(e){let{teamId:l,projectId:o,ids:d,excludeIds:c,excludeProjectId:u}=e,{limit:m=8,search:v,revalidateFirstPage:p=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},x=arguments.length>3&&void 0!==arguments[3]&&arguments[3],f=arguments.length>4&&void 0!==arguments[4]&&arguments[4],y=(0,n.default)((e,t)=>{if(!e)return`${s.API_SHARED_ENV_VARIABLES}${(0,r.encode)({limit:m,search:v,teamId:l,projectId:o,ids:d,exclude:{ids:c??null,projectId:u??null}})}`;if(t&&t.length>=m){let e=t[t.length-1];return`${s.API_SHARED_ENV_VARIABLES}${(0,r.encode)({until:e.updatedAt||e.createdAt-1,limit:m,search:v,teamId:l,projectId:o,ids:d,exclude:{ids:c??null,projectId:u??null}})}`}return null},async e=>(await (0,i.fetchAPI)(e,{throwOnHTTPError:!0})).data,{...h,keepPreviousData:f,revalidateFirstPage:p,persistSize:!0}),g=!!y.data,j=g&&y.data[y.data.length-1]?.length<m,b=(0,a.useMemo)(()=>y.data?y.data.flat():[],[y.data]),E=g&&0===b.length,_=g&&y.size>y.data.length;return(0,t.default)(()=>{if(!x||!y.data||j)return null;let e=y.data[y.data.length-1];return`${s.API_SHARED_ENV_VARIABLES}${(0,r.encode)({until:(e[e.length-1].updatedAt??e[e.length-1].createdAt)-1,limit:m,search:v,teamId:l,projectId:o,ids:d,exclude:{ids:c??null,projectId:u??null}})}`},e=>(0,i.fetchAPI)(e,{throwOnHTTPError:!0})),[y,{envVars:b,initialDataLoaded:g,isEmpty:E,loadMore:()=>y.setSize(e=>e+1),isLoadingMore:_,isReachingEnd:j,isValidating:y.isValidating}]},"useTeamSharedEnvs",0,function(e,n,a,r){let{can:s,isLoading:c}=(0,l.default)(n?{projectIdOrName:n}:void 0),u=s(o.Action.List,o.Resource.ProjectEnvVars),m=e&&!c&&u;return(0,t.default)(()=>m?d({teamId:e,ids:a,projectId:n}):"",async e=>{let{data:t}=await (0,i.fetchAPI)(e,{throwOnHTTPError:!0});return{envs:t}},r)}])},6116602,e=>{e.v({optionBranch:"env-variables-filter-module__XqclKW__optionBranch"})},1411137,e=>{"use strict";var t=e.i(4205214),n=e.i(5323212),a=e.i(6881349),r=e.i(5255926),i=e.i(4004502),s=e.i(5927860),l=e.i(7713873),o=e.i(8835183),d=e.i(4345845),c=e.i(8249095),u=e.i(7957424),m=e.i(6116602);e.s(["EnvVariablesFilter",0,function(e){let{envs:v,search:p,setSearch:h,envOrBranchFilter:x,setEnvOrBranchFilter:f,sortTarget:y,setSortTarget:g,disabled:j,disableEnvironmentSelector:b,isLoading:E,project:_}=e,C=Array.from(new Set((v||[]).map(e=>e.gitBranch??null).filter(Boolean))).sort((e,t)=>e.localeCompare(t)),{isLoading:S,data:{environments:k}}=(0,u.useAllEnvironments)(_);return(0,t.jsxs)("div",{className:"flex flex-col @md-page:flex-row items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-[50%]",children:(0,t.jsx)(o.SearchInput,{"data-testid":(0,i.tid)("env-variables-filter","search-input"),disabled:j,maxLength:256,onChange:e=>h(e.target.value),placeholder:"Search…",value:p,width:"100%"})}),f?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-[25%]",children:(0,t.jsxs)(a.Combobox,{clearable:!1,"data-testid":(0,i.tid)("env-variables-filter","select"),disabled:j||b,noInputPrefix:!0,onChange:e=>f(e||l.allEnvironmentsFilter),value:x,children:[(0,t.jsx)(r.Skeleton,{show:!!(S||E),children:(0,t.jsx)(a.Combobox.Input,{})}),(0,t.jsx)(a.Combobox.List,{maxWidth:450,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Combobox.Option,{value:l.allEnvironmentsFilter,children:"All Environments"}),void 0===_&&(0,t.jsx)(a.Combobox.Option,{value:l.allCustomEnvironmentsFilter,children:"All Custom Environments"}),(0,t.jsx)(a.Combobox.Option,{value:(0,l.mapToEnvFilter)(s.EnvTarget.Production),children:"Production"}),(0,t.jsx)(a.Combobox.Option,{value:(0,l.mapToEnvFilter)(s.EnvTarget.Development),children:"Development"}),(0,t.jsx)(a.Combobox.Option,{value:(0,l.mapToEnvFilter)(s.EnvTarget.Preview),children:"Preview"}),k.filter(e=>(0,l.isCustomEnvId)(e.id)).sort((e,t)=>e.slug.localeCompare(t.slug)).map(e=>(0,t.jsx)(a.Combobox.Option,{className:m.default.optionBranch,value:e.id,children:e.slug},e.id)),C.map(e=>(0,t.jsx)(a.Combobox.Option,{prefix:(0,t.jsx)(d.GitBranch,{}),value:e,children:(0,t.jsx)("span",{className:`text-copy-14-mono ${m.default.optionBranch}`,children:e})},e))]})})]})}):null,(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start max-w-[184px] flex-[25%]",children:(0,t.jsxs)(n.Select,{disabled:j,onChange:e=>g(e.target.value),placeholder:"Sort by…",prefix:(0,t.jsx)(c.SortDescending,{}),value:y,children:[(0,t.jsx)("option",{value:"createdAt",children:"Last Updated"}),(0,t.jsx)("option",{value:"key",children:"Name"}),(0,t.jsx)("option",{value:"type",children:"Type"})]})})]})}])},1558786,e=>{e.v({iconContainer:"env-variables-icon-module__0YD5da__iconContainer"})},2183562,e=>{e.v({amber:"index-module__G9ddHW__amber",hidden:"index-module__G9ddHW__hidden",muted:"index-module__G9ddHW__muted",overlay:"index-module__G9ddHW__overlay",symbol:"index-module__G9ddHW__symbol",tooltipContainer:"index-module__G9ddHW__tooltipContainer",tooltipContainerContainer:"index-module__G9ddHW__tooltipContainerContainer",tooltipContent:"index-module__G9ddHW__tooltipContent"})},6024244,e=>{e.v({container:"tev-key-input-module__L-kdSa__container",inputSpacer:"tev-key-input-module__L-kdSa__inputSpacer",monoInput:"tev-key-input-module__L-kdSa__monoInput",overlay:"tev-key-input-module__L-kdSa__overlay",tooltipContainer:"tev-key-input-module__L-kdSa__tooltipContainer",tooltipContainerContainer:"tev-key-input-module__L-kdSa__tooltipContainerContainer",tooltipContent:"tev-key-input-module__L-kdSa__tooltipContent",warn:"tev-key-input-module__L-kdSa__warn"})},1839393,e=>{e.v({envVarValueSensitive:"env-variables-edit-form-module__FkdT-q__envVarValueSensitive",envVarValueSensitiveText:"env-variables-edit-form-module__FkdT-q__envVarValueSensitiveText",mono:"env-variables-edit-form-module__FkdT-q__mono",overlay:"env-variables-edit-form-module__FkdT-q__overlay",textarea:"env-variables-edit-form-module__FkdT-q__textarea"})},1642786,e=>{e.v({bold:"tev-environments-selector-module__yCytCa__bold",selectGitBranch:"tev-environments-selector-module__yCytCa__selectGitBranch",truncate:"tev-environments-selector-module__yCytCa__truncate"})},1728195,e=>{e.v({container:"input-module__1EzHua__container",error:"input-module__1EzHua__error",input:"input-module__1EzHua__input",keyboardFocus:"input-module__1EzHua__keyboardFocus",large:"input-module__1EzHua__large",mediumSmall:"input-module__1EzHua__mediumSmall",noPrefixStyle:"input-module__1EzHua__noPrefixStyle",noSuffixStyle:"input-module__1EzHua__noSuffixStyle",prefix:"input-module__1EzHua__prefix",small:"input-module__1EzHua__small",suffix:"input-module__1EzHua__suffix",xSmall:"input-module__1EzHua__xSmall"})},538090,e=>{e.v({bold:"tev-add-form-module__PZYaGG__bold",button:"tev-add-form-module__PZYaGG__button",commentField:"tev-add-form-module__PZYaGG__commentField",container:"tev-add-form-module__PZYaGG__container "+e.i(1728195).container,dragEffectBackground:"tev-add-form-module__PZYaGG__dragEffectBackground",envVarsForm:"tev-add-form-module__PZYaGG__envVarsForm",error:"tev-add-form-module__PZYaGG__error "+e.i(1728195).error,keyboardFocus:"tev-add-form-module__PZYaGG__keyboardFocus",label:"tev-add-form-module__PZYaGG__label",large:"tev-add-form-module__PZYaGG__large",projectList:"tev-add-form-module__PZYaGG__projectList",projectName:"tev-add-form-module__PZYaGG__projectName",selectedProjectEntity:"tev-add-form-module__PZYaGG__selectedProjectEntity",small:"tev-add-form-module__PZYaGG__small",textAreaHeight:"tev-add-form-module__PZYaGG__textAreaHeight",textarea:"tev-add-form-module__PZYaGG__textarea "+e.i(1728195).input,textareaInput:"tev-add-form-module__PZYaGG__textareaInput",textareaStack:"tev-add-form-module__PZYaGG__textareaStack",textareaWrapper:"tev-add-form-module__PZYaGG__textareaWrapper",viewValueButton:"tev-add-form-module__PZYaGG__viewValueButton"})},7332807,e=>{e.v({popoverBottom:"styled-combobox-module__rI3xva__popoverBottom",popoverShadow:"styled-combobox-module__rI3xva__popoverShadow",projectOptionList:"styled-combobox-module__rI3xva__projectOptionList",themeBorder:"styled-combobox-module__rI3xva__themeBorder"})},4251055,e=>{e.v({bullets:"env-variables-table-module__L-jLVG__bullets",commentWrapper:"env-variables-table-module__L-jLVG__commentWrapper",dataStoreIconWrapperStyles:"env-variables-table-module__L-jLVG__dataStoreIconWrapperStyles",editing:"env-variables-table-module__L-jLVG__editing",empty:"env-variables-table-module__L-jLVG__empty",entity:"env-variables-table-module__L-jLVG__entity",iconsContainer:"env-variables-table-module__L-jLVG__iconsContainer",key:"env-variables-table-module__L-jLVG__key",overriddenEnvVar:"env-variables-table-module__L-jLVG__overriddenEnvVar",plaintextEnvValue:"env-variables-table-module__L-jLVG__plaintextEnvValue",resultRow:"env-variables-table-module__L-jLVG__resultRow",reveal:"env-variables-table-module__L-jLVG__reveal",section:"env-variables-table-module__L-jLVG__section",suggestionHighlight:"env-variables-table-module__L-jLVG__suggestionHighlight",time:"env-variables-table-module__L-jLVG__time",timeAgoText:"env-variables-table-module__L-jLVG__timeAgoText",varName:"env-variables-table-module__L-jLVG__varName",varNameContainer:"env-variables-table-module__L-jLVG__varNameContainer",virtuosoRowOverflowAnchor:"env-variables-table-module__L-jLVG__virtuosoRowOverflowAnchor"})},6899807,42012,7855500,1961840,5601055,3245331,4171299,8916169,3845686,2215529,e=>{"use strict";var t,n=e.i(4205214),a=e.i(8660982),r=e.i(9307292),i=e.i(9722978),s=e.i(8248823),l=e.i(57106),o=e.i(4585051),d=e.i(3306538),c=e.i(2504781),u=e.i(8161149),m=e.i(4030453),v=e.i(8459493),p=e.i(7448864),h=e.i(6891161),x=e.i(6850581),f=e.i(5255926),y=e.i(9318197),g=e.i(5468328),j=e.i(455575),b=e.i(5433449),E=e.i(3973638),_=e.i(1933683),C=e.i(762945),S=e.i(1000031),k=e.i(4345845),w=e.i(2065543),T=e.i(4004502),N=e.i(5927860),P=e.i(7713873),I=e.i(5338940),A=e.i(3322724),L=e.i(2789453),V=e.i(7218483),B=e.i(5166685),R=e.i(5819220),F=e.i(4712634),D=e.i(979715),O=e.i(7808943),G=e.i(3627160),$=e.i(5756088),M=e.i(4450569),H=e.i(5328446),z=e.i(7743427),W=e.i(6417808);let U=()=>(0,n.jsxs)("svg",{fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M2.66675 4.66675V2.66675H13.3334V4.66675",stroke:"#666666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,n.jsx)("path",{d:"M6 13.3333H10",stroke:"#666666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,n.jsx)("path",{d:"M8 2.66675V13.3334",stroke:"#666666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]});var Y=e.i(1558786);function q(e){let{env:t}=e,{data:a}=(0,H.default)(t?.configurationId),{data:r}=(0,z.useIntegration)(a?.integrationId);if(!t.configurationId)if("plain"===t.type)return(0,n.jsx)(M.default,{center:!0,className:(0,i.clsx)(Y.default.iconContainer,"plaintextIconContainer"),children:(0,n.jsx)(U,{})});else if("system"===t.type)return(0,n.jsx)(M.default,{center:!0,className:(0,i.clsx)(Y.default.iconContainer,"systemIconContainer"),children:(0,n.jsx)(W.default,{color:"var(--accents-5)",width:16})});else if("encrypted"===t.type)return(0,n.jsx)(M.default,{center:!0,className:(0,i.clsx)(Y.default.iconContainer,"encryptedIconContainer"),children:(0,n.jsx)(G.Code,{color:"gray-700"})});else if("sensitive"===t.type)return(0,n.jsx)(M.default,{center:!0,className:(0,i.clsx)(Y.default.iconContainer,"sensitiveIconContainer"),children:(0,n.jsx)($.LockClosed,{color:"gray-700"})});else return(0,n.jsx)(M.default,{center:!0,className:(0,i.clsx)(Y.default.iconContainer,"secretIconContainer"),children:(0,n.jsx)($.LockClosed,{color:"gray-700"})});return(0,n.jsx)(o.Avatar,{className:"integrationIcon",hash:r?.icon,placeholder:!a||!r,size:30})}e.s(["default",0,q],42012);var Z=e.i(3869281),K=e.i(6881349),X=e.i(3500331),J=e.i(3671642),Q=e.i(8522580),ee=e.i(1848296),et=e.i(9334091),en=e.i(8042625),ea=e.i(277234),er=e.i(4244280),ei=e.i(5140444),es=e.i(5677444),el=e.i(8432052),eo=e.i(5858269),ed=e.i(2455417),ec=e.i(850302),eu=e.i(1717203),em=e.i(7557283);function ev(){let{config:e,id:t,noRequest:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isReady:a,team:r}=(0,I.useTeam)(),{can:i,isLoading:s}=(0,eu.default)(),l=i(em.Action.Read,em.Resource.Secrets),o=a&&!s&&!n&&l;return(0,ec.default)(()=>o?`${er.API_SECRETS}${(0,en.encode)({teamId:r?.id,id:t})}`:null,e=>(0,ea.fetchAPI)(e,{throwOnHTTPError:!0}),e)}e.s(["useSecrets",0,ev],7855500);var ep=e.i(1138941),eh=e.i(6060673);let ex=e=>e.startsWith("-----BEGIN PRIVATE KEY-----\\n")&&e.endsWith("\\n-----END PRIVATE KEY-----\\n")?e.replace(/\\n/g,"\n"):e,ef=e=>{let{active:t,initialSecretName:r,onCancel:i,onAdd:s}=e,[o,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[v,p]=(0,a.useState)(void 0),[x,f]=(0,a.useState)(!1),{team:g}=(0,I.useTeam)(),b=(0,j.useToasts)(),{data:E}=ev(),{data:_}=(0,eh.useProject)((0,ep.useProjectIdOrName)());(0,a.useEffect)(()=>{t&&d(e=>{if(e)return e;let t=(0,eo.default)(r||_?.name||"");return E?.secrets.find(e=>e.name.toLowerCase()===t.toLowerCase())?`${t}-${Math.random().toString(36).substring(9)}`:t})},[r,t,_,E]);let C=async()=>{f(!0);let e=await (0,ea.fetchAPI)(`${er.API_SECRETS}${(0,en.encode)({teamId:g?.id})}`,{method:"POST",body:JSON.stringify({name:o,value:c}),throwOnHTTPError:!1});f(!1),e.error?p(e.error):(s(e.uid),b.success("Created Secret successfully."))},S=(0,a.useCallback)(()=>{p(void 0),u(""),d("")},[]);return(0,n.jsxs)(h.Modal.Modal,{active:t,onAnimationDone:S,onClickOutside:i,width:"420px",children:[(0,n.jsxs)(h.Modal.Body,{children:[(0,n.jsxs)(M.default,{center:!0,children:[(0,n.jsx)("h4",{className:"text-copy-16",style:{fontWeight:500,margin:0},children:"Add Secret"}),(0,n.jsx)("p",{className:"text-copy-14 text-center",style:{color:"var(--accents-5)"},children:"Secrets contain sensitive information, are encrypted and also available across all projects."})]}),(0,n.jsx)("main",{children:(0,n.jsxs)("form",{className:"form",onSubmit:async e=>{e?.preventDefault(),await C()},children:[(0,n.jsx)(M.default,{children:(0,n.jsx)(J.Label,{value:"Value",children:(0,n.jsx)(et.Textarea,{"aria-label":"Value",autoFocus:!0,disabled:x,name:"add-secret-value",onChange:e=>{u(ex(e.target.value))},placeholder:"i9ju23nf39nunu3asn",rows:2,value:c,width:"100%"})})}),(0,n.jsx)(y.Spacer,{y:1}),(0,n.jsx)(M.default,{children:(0,n.jsx)(J.Label,{id:"add-secret-name",value:"Name",withInput:!0,children:(0,n.jsx)(X.Input,{disabled:x,id:"add-secret-name",name:"add-secret-name",onChange:e=>{d(e.target.value)},placeholder:"secret-name",prefix:"@",style:{height:40},value:o,width:"100%"})})}),(0,n.jsx)(y.Spacer,{}),(0,n.jsxs)("span",{children:[(0,n.jsxs)("span",{style:{color:"var(--accents-5)"},children:["You will be able to reuse this Secret in multiple Projects using this name."," "]}),(0,n.jsx)(l.Link,{external:!0,href:"/docs/environment-variables#secrets",type:"highlight",children:"Learn More"})]}),v?(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(y.Spacer,{y:.5})," ",(0,n.jsx)(m.Error,{error:v})," "]}):null]})})]}),(0,n.jsxs)(h.Modal.Actions,{children:[(0,n.jsx)(h.Modal.Action,{onClick:i,type:"secondary",children:"Cancel"}),(0,n.jsxs)(h.Modal.Action,{disabled:x,onClick:C,children:[x?(0,n.jsx)(ed.LoadingDots,{}):null,!x&&"Create Secret"]})]})]})};var ey=e.i(187815),eg=e.i(7482607);function ej(e,t){let{isReady:n,team:a}=(0,I.useTeam)();return(0,ec.default)(()=>e&&n?`${(0,er.API_PROJECTS_VERSION)("v7")}/${encodeURIComponent(e)}/system-env-values${(0,en.encode)({teamId:a?.id})}`:"",e=>(0,ea.fetchAPI)(e,{throwOnHTTPError:!0}),t)}e.s(["default",0,ej],1961840);var eb=e.i(4469437),eE=e.i(1265647),e_=e.i(4854149),eC=e.i(2183562);function eS(e){let{value:t,width:r,id:s,className:l}=e,[o,d]=(0,a.useState)(!1),c=0===t.length,u=c?" ":t.replace(/\n$/,"\n "),m=c?[]:u.split(""),v=!c&&/^\s+/gm.exec(u),p=!c&&/\s+$/gm.exec(u),h=u.includes("\r")||u.includes("\n"),x=u.includes("\0"),f=[];return v&&p?f.push("starts and ends with whitespace"):v?f.push("starts with whitespace"):p&&f.push("ends with whitespace"),h&&f.push("has return characters"),x&&f.push("contains null characters"),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("pre",{"aria-hidden":"true",className:(0,i.clsx)(eC.default.overlay,l),style:{width:r??"100%"},children:ek(m).map((e,t)=>e.class?(0,n.jsx)("span",{className:(0,i.clsx)(eC.default.symbol,e.class),children:e.symbol},t):(0,n.jsx)("span",{className:eC.default.hidden,children:e.symbol},t))}),(0,n.jsx)(eb.AnimatePresence,{children:f.length>0&&!o?(0,n.jsx)(eE.motion.div,{animate:{opacity:1},"aria-label":`This value ${f.join(" and ")}.`,className:eC.default.tooltipContainerContainer,exit:{opacity:0},id:s,initial:{opacity:0},transition:{duration:0},children:(0,n.jsx)(eE.motion.div,{animate:{opacity:1},className:eC.default.tooltipContainer,exit:{opacity:0,transition:{duration:0}},initial:{opacity:0},children:!o&&(0,n.jsx)(g.Tooltip,{"aria-label":"Hide warning",as:"button",delay:!1,htmlType:"button",onClick:()=>{d(!0)},sticky:!0,text:(0,n.jsx)("div",{onClick:e=>{e.stopPropagation()},className:(0,i.clsx)("flex flex-row items-center justify-between gap-2 flex-initial",eC.default.tooltipContent),children:(0,n.jsxs)(e_.Balancer,{children:["This value ",f.join(" and "),"."]})}),children:(0,n.jsx)(C.Warning,{size:14})})})},"tooltip"):null})]})}let ek=e=>{let t=ew(e),n=ew([...e].reverse()),a=e.slice(0,t),r=e.slice(t,e.length-n),i=e.slice(e.length-n,e.length);return[...a.map(e=>({symbol:eT[e].symbol||eT[" "].symbol,class:eC.default.amber})),...r.map(e=>{let t=eT[e];return t?{symbol:t.symbol,class:t.class||eC.default.muted}:{symbol:e}}),...i.map((e,t)=>t===i.length-1&&"\n"===i[t-1]&&" "===i[t]?{symbol:e}:{symbol:eT[e].symbol||eT[" "].symbol,class:eC.default.amber})]};function ew(e){let t=/^\s+$/;for(let n=0;n<e.length;n++)if(!t.test(e[n]))return n;return -1}let eT={"\n":{symbol:"↵\n",class:eC.default.amber},"\r":{symbol:"↵\n",class:eC.default.amber},"	":{symbol:"⇥",class:eC.default.amber},"\v":{symbol:"␋",class:eC.default.amber}," ":{symbol:"␣"},"\f":{symbol:"␌",class:eC.default.amber}," ":{symbol:"␣"}," ":{symbol:"␣"},"​":{symbol:"␣"},"‌":{symbol:"␣"},"‍":{symbol:"␣"},"\u2028":{symbol:"␣"},"\u2029":{symbol:"␣"}," ":{symbol:"␣"}," ":{symbol:"␣"},"　":{symbol:"␣"},"\uFEFF":{symbol:"␣"}};var eN=e.i(361349),eP=e.i(4551858),eI=e.i(6024244);function eA(e){let{inputRef:t,isErrorState:a,disabled:r,testId:s,onChange:l,id:o,placeholder:d,value:c,onPaste:u}=e,m=eB(c);return(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:[(0,n.jsxs)("div",{className:(0,i.clsx)("flex flex-col items-stretch justify-start flex-initial",eI.default.container),children:[(0,n.jsx)(X.Input,{"aria-label":"environment variable key",className:eI.default.monoInput,"data-testid":s,disabled:r,id:o,label:t?"key":null,maxLength:256,onChange:l,onPaste:u,placeholder:d,ref:t,style:{paddingRight:m?"36px":"12px"},type:a?"error":"default",value:c}),(0,n.jsx)(eR,{inputRef:t,keyValue:c})]}),(0,n.jsx)("div",{className:eI.default.inputSpacer})]})}let eL=["NEXT_PUBLIC_","VUE_APP_","REACT_APP_","GATSBY_","GRIDSOME_","NUXT_PUBLIC_","STORYBOOK_","VITE_","PUBLIC_"],eV=["password","key","private","access_token","access","auth","secret","jwt","signature"],eB=e=>{let t=eF();return(t?[...eL,t]:eL).find(t=>e.toLowerCase().startsWith(t.toLowerCase()))};function eR(e){let t,{keyValue:r,inputRef:s}=e,[l,o]=(0,a.useState)(r),[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),v=eB(r),p=`${v||""} exposes this value to the browser. Verify it is safe to share publicly`,h=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"font-mono text-[12px] leading-[16px] font-medium",children:v})," ","exposes this value to the browser. Verify it is safe to share publicly."]}),x=!!v,f=(t=RegExp(eV.join("|"),"i").exec(r))?t[0]:null;return null!==f&&(p=`This key, which is prefixed with ${v||""} and includes the term ${f}, might expose sensitive information to the browser. Verify it is safe to share publicly.`,h=(0,n.jsxs)(n.Fragment,{children:["This key, which is prefixed with"," ",(0,n.jsx)("span",{className:"font-mono text-[12px] leading-[16px] font-medium",children:v})," ","and includes the term"," ",(0,n.jsx)("span",{className:"font-mono text-[12px] leading-[16px] font-medium",children:f}),", might expose sensitive information to the browser. Verify it is safe to share publicly."]})),(0,a.useEffect)(()=>{d&&r!==l&&c(!1)},[d,r,l]),(0,eN.useInterval)(()=>{s?.current&&m(s.current.scrollWidth>s.current.clientWidth+4&&0===s.current.scrollLeft)},50),(0,n.jsx)(eb.AnimatePresence,{children:x&&v&&!d?(0,n.jsxs)(eE.motion.div,{animate:{opacity:1},"aria-label":p,className:eI.default.tooltipContainerContainer,exit:{opacity:0},initial:{opacity:0},transition:{duration:0},children:[(0,n.jsx)(eE.motion.div,{animate:{opacity:+!!u},className:eI.default.overlay,style:{pointerEvents:"none"},transition:{duration:0}}),(0,n.jsx)(eE.motion.div,{animate:{opacity:1},className:(0,i.clsx)(eI.default.tooltipContainer,{[eI.default.warn]:f}),exit:{opacity:0,transition:{duration:0}},initial:{opacity:0},children:(0,n.jsx)(g.Tooltip,{"aria-label":"Hide warning",as:"button",delay:!1,htmlType:"button",onClick:()=>{c(!0),o(r)},sticky:!0,text:(0,n.jsx)("div",{onClick:e=>{e.stopPropagation()},className:(0,i.clsx)("flex flex-row items-center justify-between gap-2 flex-initial",eI.default.tooltipContent),children:(0,n.jsx)("span",{children:h})}),children:(0,n.jsx)(C.Warning,{size:14})})})]},"tooltip"):null})}let eF=()=>{var e;let t,{data:n}=(0,eh.useProject)((0,ep.useProjectIdOrName)()),{data:a}=(0,eh.useProject)(n?.id),r=(0,es.useParams)()?.teamSlug,i=a?.framework,s=!1;(void 0===i||"sveltekit-1"!==i&&"sveltekit-2"!==i)&&(s=!0);let l=a?.targets?.production?.id;void 0===l&&(s=!0);let o=new URL(`/api/v7/deployments/${l||""}/files/get`,"https://vercel.com");o.searchParams.append("path","svelte.config.js");let{data:d}=(0,eP.useFileContent)(s?null:{type:"file",name:"svelte.config.js",link:o.toString(),mime:"application/javascript"},r);return void 0!==d&&"string"==typeof d?(e=d,(t=/publicPrefix:\s*'(?<value>[^']*)'/.exec(e))?t[1]:null):null};var eD=e.i(1991452),eO=e.i(6159310),eG=e.i(2928617),e$=e.i(1473216),eM=e.i(8735244),eH=e.i(3753138),ez=e.i(4482823),eW=e.i(2560270),eU=e.i(2634426),eY=e.i(6107899),eq=e.i(3394346),eZ=e.i(7957424),eK=e.i(1516738);let eX=(0,P.brandCustomEnvId)("applyToAllCustomEnvironments");function eJ(e){let{canCreateProductionEnvVars:t,disabled:a=!1,onChange:r,selectedEnvironmentIds:i=new Set([P.PreviewEnvironment.id,P.DevelopmentEnvironment.id]),isPreviewEnvironment:s,disableDevelopmentEnvironment:l}=e,o=(0,ep.useProjectIdOrName)(),d=""===o,{isLoading:u,isAllPreProductionEnvironmentsIndeterminate:m,isAllPreProductionEnvironmentsSelected:v,preProductionEnvironmentIds:p,hasCustomEnvironments:h,customEnvironments:x,label:f,icon:y}=e2({selectedEnvironmentIds:i,isPreviewEnvironment:s}),{data:g}=(0,eh.useProject)(s?o:void 0),{data:j=[]}=(0,eG.useProjectBranches)(s?g?.id:void 0),b=e=>t=>{if(s)r([e]);else{let n=new Set(i);return t?n.add(e):n.delete(e),r(Array.from(n)),n}};return(0,n.jsxs)(e$.Root,{children:[(0,n.jsx)(e$.Trigger,{asChild:!0,children:(0,n.jsx)(c.Button,{className:"group !justify-between !pl-0 !font-normal",disabled:a,name:"add-form-environments-picker",suffix:(0,n.jsx)(eW.ChevronDown,{className:"!text-gray-900 group-hover:!text-gray-1000"}),type:"secondary",typeName:"button",width:"100%",children:(0,n.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial -ml-1.5 h-10",children:[(0,n.jsx)("span",{className:"-my-4 grid size-10 shrink-0 place-items-center rounded-l border-r bg-background-200 group-disabled:bg-gray-100",children:u?(0,n.jsx)(eM.Spinner,{}):y}),(0,n.jsx)("span",{className:"block w-full gap-2 overflow-hidden text-ellipsis text-gray-1000 ",children:f})]})})}),(0,n.jsx)(e$.Portal,{children:(0,n.jsx)("div",{className:"tailwind-preflight",children:(0,n.jsxs)(e$.Content,{className:"flex max-h-[calc(var(--radix-popover-content-available-height)-32px)] w-[var(--radix-popover-trigger-width)] flex-col gap-px overflow-auto rounded-lg bg-background-100 p-2 shadow-md",sideOffset:5,children:[!s&&(0,n.jsx)(eQ,{enabled:i.has(P.ProductionEnvironment.id),env:P.ProductionEnvironment,disabled:t?void 0:"missingPermission",name:"add-form-production",onChange:e=>{b(P.ProductionEnvironment.id)(e)},testId:"production-checkbox"}),(h||d)&&!s?(0,n.jsxs)("label",{className:"group flex h-9 shrink-0 select-none items-center justify-between rounded bg-background-100 px-2 py-[6px] text-gray-1000 transition-colors hover:cursor-pointer hover:bg-gray-alpha-300 focus-visible:bg-gray-alpha-300",children:[(0,n.jsx)("span",{className:"text-[12px] leading-[16px] font-medium text-gray-900 transition-colors group-hover:!text-gray-1000",children:"Pre-Production Environments"}),(0,n.jsx)(Z.Checkbox,{checked:m?v:void 0,indeterminate:!m||void 0,onChange:e=>{let t=new Set(i);p.forEach(n=>{e.target.checked?t.add(n):t.delete(n)}),r(Array.from(t))}})]}):null,(0,n.jsx)(eQ,{customLabel:"Preview",enabled:i.has(P.PreviewEnvironment.id),env:P.PreviewEnvironment,hideCheckbox:s,name:"add-form-preview",onChange:e=>{b(P.PreviewEnvironment.id)(e)},testId:"preview-checkbox"}),d||s?null:(0,n.jsx)(n.Fragment,{children:x.sort((e,t)=>e.slug.localeCompare(t.slug)).map(e=>(0,n.jsx)(eQ,{enabled:i.has(e.id),env:e,name:`add-form-custom-environment-${e.slug}`,onChange:t=>{b(e.id)(t)},testId:e.slug},e.id))}),s?(0,n.jsx)(n.Fragment,{children:j.sort((e,t)=>e.ref.localeCompare(t.ref)).filter(e=>e.ref!==g?.link?.productionBranch).map(e=>(0,n.jsx)(e0,{branch:e,enabled:i.has((0,P.brandCustomEnvId)(e.ref)),onChange:t=>{b((0,P.brandCustomEnvId)(e.ref))(t)}},e.ref))}):null,!s&&(0,n.jsx)(eQ,{enabled:i.has(P.DevelopmentEnvironment.id),env:P.DevelopmentEnvironment,disabled:l?"sensitive":void 0,name:"add-form-development",onChange:e=>{b(P.DevelopmentEnvironment.id)(e)},testId:"development-checkbox"}),d?(0,n.jsxs)("label",{className:"flex h-9 shrink-0 select-none items-center justify-between rounded bg-background-100 px-2 py-[6px] text-gray-1000 transition-colors hover:cursor-pointer hover:bg-gray-alpha-300 focus-visible:bg-gray-alpha-300",children:[(0,n.jsxs)("span",{className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)("span",{className:"text-gray-900",children:(0,n.jsx)(ez.Asterisk,{})}),(0,n.jsx)("span",{className:"flex gap-1",children:(0,n.jsx)("span",{children:"Include all custom environments"})})]}),(0,n.jsx)(Z.Checkbox,{checked:i.has(eX),onChange:e=>{b(eX)(e.target.checked)}})]}):null]})})})]})}function eQ(e){let{env:t,onChange:a,enabled:r,hideCheckbox:s,customLabel:l,name:o,testId:d,disabled:c}=e,u=(0,P.isCustomEnvironment)(t),m="missingPermission"===c?`Additional permissions are required to create ${(0,P.envName)(t)} environment variables.`:"Sensitive environment variables cannot be created in the Development environment";return(0,n.jsx)(g.Tooltip,{className:"block",disableTriggers:!c,text:m,children:(0,n.jsxs)("label",{className:`flex h-9 shrink-0 select-none items-center justify-between rounded bg-background-100 px-2 py-[6px] text-gray-1000 transition-colors hover:bg-gray-alpha-300 focus-visible:bg-gray-alpha-300 ${c?"hover:cursor-not-allowed":"hover:cursor-pointer"}`,"data-testid":(0,T.tid)("env-variables","label",l||(0,P.envName)(t)),children:[(0,n.jsxs)("span",{className:"flex w-[calc(100%-16px)] items-center gap-2 text-sm",children:[(0,n.jsx)("span",{className:"text-gray-900",children:(0,n.jsx)(eK.EnvironmentIcon,{id:t.id})}),(0,n.jsxs)("span",{className:"flex w-[calc(100%-36px)] gap-1",children:[(0,n.jsx)("span",{className:"overflow-hidden text-ellipsis text-nowrap",children:l||(0,P.envName)(t)}),t.slug&&u?(0,n.jsx)("span",{className:"hidden max-w-[38ch] cursor-pointer truncate rounded-sm bg-gray-100 px-[6px] font-mono text-[13px] leading-5 text-gray-900 outline-0 transition-colors focus-visible:shadow-focus-ring active:bg-gray-300 @md-page:inline",children:t.slug}):null]})]}),c?(0,n.jsx)($.LockClosed,{}):(0,n.jsx)(Z.Checkbox,{checked:r,className:(0,i.clsx)(s&&"opacity-0"),"data-testid":(0,T.tid)("env-variables",d),name:o,onChange:e=>{a(e.target.checked)}}),s?(0,n.jsx)(e1,{enabled:r}):null]})})}function e0(e){let{branch:t,onChange:a,enabled:r}=e;return(0,n.jsxs)("label",{className:(0,i.clsx)("flex h-9 shrink-0 select-none items-center justify-between rounded bg-background-100 px-2 py-[6px] text-gray-1000 transition-colors hover:cursor-pointer hover:bg-gray-alpha-300 focus-visible:bg-gray-alpha-300"),children:[(0,n.jsxs)("span",{className:"flex w-[calc(100%-16px)] items-center gap-2 text-sm",children:[(0,n.jsx)("span",{className:"text-gray-900",children:(0,n.jsx)(k.GitBranch,{})}),(0,n.jsx)("span",{className:"flex w-[calc(100%-36px)] gap-1",children:(0,n.jsx)("span",{className:"overflow-hidden text-ellipsis text-nowrap",children:t.ref})})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(Z.Checkbox,{checked:r,className:"pointer-events-none absolute inset-0 opacity-0",onChange:e=>{a(e.target.checked)}}),(0,n.jsx)(e1,{enabled:r})]})]})}function e1(e){let{enabled:t}=e;return(0,n.jsx)(eb.AnimatePresence,{initial:!1,children:t?(0,n.jsx)(eE.motion.span,{children:(0,n.jsx)(eE.motion.svg,{fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)(eE.motion.path,{animate:{strokeDashoffset:0,opacity:1,transition:{duration:.15,ease:"easeIn"}},d:"M1.5 10L4.29289 12.7929C4.68342 13.1834 5.31658 13.1834 5.70711 12.7929L14.5 4",exit:{strokeDashoffset:0,opacity:0,transition:{duration:.2}},initial:{strokeDashoffset:1},pathLength:"1",stroke:"currentColor",strokeLinecap:"butt",strokeLinejoin:"round",strokeWidth:"1.5px",style:{strokeDasharray:"1"}})})}):null})}function e2(e){let{selectedEnvironmentIds:t,isPreviewEnvironment:n=!1}=e,r=(0,ep.useProjectIdOrName)(),{data:{environments:i},isLoading:s}=(0,eZ.useAllEnvironments)(r),l=""===r,o=i.filter(P.isCustomEnvironment),d=(0,a.useMemo)(()=>l?[P.PreviewEnvironment.id,P.DevelopmentEnvironment.id,eX]:[P.PreviewEnvironment.id,P.DevelopmentEnvironment.id,...o.map(e=>e.id)],[o,l]),c=(0,a.useMemo)(()=>d.every(e=>t.has(e)),[d,t]),u=(0,a.useMemo)(()=>d.some(e=>t.has(e))?d.every(e=>t.has(e)):d.every(e=>!t.has(e)),[d,t]),m=o.length>0,{label:v,icon:p,environmentNamesList:h}=(0,a.useMemo)(()=>e5({selectedEnvironmentIds:t,environments:i,isAllPreProductionEnvironmentsSelected:c,isPreviewEnvironment:n}),[t,i,n,c]);return{isLoading:s,isAllPreProductionEnvironmentsSelected:c,isAllPreProductionEnvironmentsIndeterminate:u,hasCustomEnvironments:m,preProductionEnvironmentIds:d,customEnvironments:o,label:v,environmentNamesList:h,icon:p}}let e5=e=>{var t;let a,{selectedEnvironmentIds:r,environments:i,isPreviewEnvironment:s,isAllPreProductionEnvironmentsSelected:l}=e;if(s&&1===r.size){let e=Array.from(r),t=i.find(t=>t.id===e[0]);return t&&t.id===(0,P.brandCustomEnvId)(N.EnvTarget.Preview)?{environmentNamesList:["Preview"],label:"Preview",icon:(0,n.jsx)(eY.PreviewEye,{color:"gray-900"})}:{environmentNamesList:[e[0]],label:e[0],icon:(0,n.jsx)(k.GitBranch,{color:"gray-900"})}}if(0===r.size)return{environmentNamesList:[],label:"No Environments",icon:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(eU.Layers,{color:"gray-900"}),(0,n.jsx)("div",{className:"absolute left-px top-0 box-content h-[1.5px] w-[131%] origin-top-left rotate-[44deg] bg-gray-900",style:{borderBottom:"1.5px solid var(--ds-background-200)"}})]})};if(r.has(P.ProductionEnvironment.id)&&l)return{environmentNamesList:["Production","Preview","Development","All Custom Environments"],label:"All Environments",icon:(0,n.jsx)(eU.Layers,{color:"gray-900"})};if(l)return{environmentNamesList:["All Pre-Production Environments"],label:"All Pre-Production Environments",icon:(0,n.jsx)(eU.Layers,{color:"gray-900"})};if(1===r.size){if(r.has(eX))return{environmentNamesList:["All Custom Environments"],label:"All Custom Environments",icon:(0,n.jsx)(eU.Layers,{color:"gray-900"})};let e=i.find(e=>e.id===Array.from(r)[0]);if(void 0===e)return{environmentNamesList:["All Custom Environments"],label:"All Custom Environments",icon:(0,n.jsx)(eU.Layers,{color:"gray-900"})};if(e.id===(0,P.brandCustomEnvId)(N.EnvTarget.Production))return{environmentNamesList:["Production"],label:"Production",icon:(0,n.jsx)(eH.ArrowCircleUp,{color:"gray-900"})};if(e.id===(0,P.brandCustomEnvId)(N.EnvTarget.Preview))return{environmentNamesList:["Preview"],label:"Preview",icon:(0,n.jsx)(eY.PreviewEye,{color:"gray-900"})};if(e.id===(0,P.brandCustomEnvId)(N.EnvTarget.Development))return{environmentNamesList:["Development"],label:"Development",icon:(0,n.jsx)(eq.Wrench,{color:"gray-900"})}}let o=(t=Array.from(r).flatMap(e=>{let t=i.find(t=>t.id===e);return t?[(0,P.envName)(t)]:[]}),a={Production:1,Preview:2,Development:4,"All Custom Environments":5},t.sort((e,t)=>{let n=a[e]||3,r=a[t]||3;return n!==r?n-r:3===n&&3===r?e.localeCompare(t):0}));if(r.has(eX)&&o.push("All Custom Environments"),o.length>3){let e=o.slice(0,3),t=o.slice(3),a=[...e,`${t.length} more`];return{environmentNamesList:o,label:`${(0,B.toListSentence)(a)}`,icon:(0,n.jsx)(eU.Layers,{color:"gray-900"})}}return{environmentNamesList:o,label:`${(0,B.toListSentence)(o)}`,icon:(0,n.jsx)(eU.Layers,{color:"gray-900"})}};e.s(["CustomEnvironmentEnvVarPicker",0,eJ,"INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID",0,eX,"useCustomEnvironmentsPrettyLabel",0,e2],5601055);var e6=e.i(7401972);function e3(e){let{selectedGitBranch:t,checkedProduction:r,checkedPreview:i,checkedDevelopment:s,setCheckedProduction:l,setCheckedPreview:o,setCheckedDevelopment:d,setSelectedGitBranch:u,onChangeSelectedCustomEnvironmentIds:m,selectedCustomEnvironmentIds:v,disableEnvironmentPicker:p,disableDevelopmentEnvironment:h,hideGitBranchSelector:x}=e,[f,g]=(0,a.useState)(""),[j,b]=(0,a.useState)(!!t),{project:E}=(0,eD.useRouter)().query,{data:_}=(0,eh.useProject)(E),{can:C}=(0,eu.default)(),S=_?.id,{data:k}=(0,eG.useProjectBranches)(S),[,{branches:w}]=(0,e6.useProjectDeployedBranches)({project:_,query:f}),T=(0,a.useMemo)(()=>Array.from(new Set([...w||[],...(k||[]).filter(Boolean).map(e=>e.ref)])),[k,w]),P=C(em.Action.Create,em.Resource.ProjectEnvVarsProduction),I=[...v];return r&&I.push(N.EnvTarget.Production),i&&I.push(N.EnvTarget.Preview),s&&I.push(N.EnvTarget.Development),(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,n.jsx)(J.Label,{value:"Environments"}),(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,n.jsx)(eJ,{canCreateProductionEnvVars:P,disabled:p,disableDevelopmentEnvironment:h,onChange:e=>{let t=[],n=[];e.forEach(e=>{(0,N.isSystemEnvTarget)(e)?t.push(e):n.push(e)}),l(t.includes(N.EnvTarget.Production)),o(t.includes(N.EnvTarget.Preview)),d(t.includes(N.EnvTarget.Development)),b(!!(1===t.length&&t.includes(N.EnvTarget.Preview))),m(n)},selectedEnvironmentIds:new Set(I)}),x?null:(0,n.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-3 flex-1",children:[(0,n.jsx)(c.Button,{onClick:()=>{l(!1),o(!0),m([]),d(!1),b(e=>!e),j&&u(null)},size:"small",type:"secondary",typeName:"button",variant:"invert",children:j?"Cancel":"Select a Custom Preview Branch"}),j?_?.link?(0,n.jsxs)(K.Combobox,{onChange:e=>u(e||""),placeholder:"All Preview Branches",size:"small",value:t||null,children:[(0,n.jsx)(K.Combobox.Input,{onChange:e=>g(e.target.value.trim()),trimValue:!0}),(0,n.jsxs)(K.Combobox.List,{emptyMessage:"No preview branches",children:[(0,n.jsx)(n.Fragment,{children:f&&!T.find(e=>e===f)?(0,n.jsx)(K.Combobox.Option,{displayValue:!0,value:f||"",children:`Use "${f}"`}):null}),(0,n.jsx)(n.Fragment,{children:T.map(e=>{let t=String(_.link?.productionBranch)===e;return t?null:(0,n.jsx)(K.Combobox.Option,{disabled:t,value:e,children:e},e)})})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Spacer,{y:.5}),(0,n.jsx)(eO.DashboardButtonLink,{route:"/[teamSlug]/[project]/settings/git",type:"secondary",children:"Connect Git Repository"})]}):null]})]})]})}var e4=e.i(1839393);function e8(e){let{envVariable:t,onDiscard:r,onSave:i,onSecretAdd:l,disableEnvironmentPicker:o,disableNameInput:d,disableComment:u,disableEnvironmentInput:v,customSave:p,editTextareaValueProps:h}=e,[x,g]=(0,a.useState)(t.type),[j,b]=(0,a.useState)({value:t.key,edited:!1}),[E,_]=(0,a.useState)({value:t.comment,edited:!1}),[C,S]=(0,a.useState)(()=>x===N.EnvType.Plain?t.value:""),[k,w]=(0,a.useState)(()=>x===N.EnvType.Encrypted&&t.decrypted?t.value:""),[P,A]=(0,a.useState)(!1),L=(0,a.useId)(),V=Array.isArray(t.target)?t.target:[t.target],B=t.type===N.EnvType.Secret&&V.includes(N.EnvTarget.Development),[R,F]=(0,a.useState)(V.includes(N.EnvTarget.Production)),[D,O]=(0,a.useState)(V.includes(N.EnvTarget.Preview)),[G,$]=(0,a.useState)(V.includes(N.EnvTarget.Development)),[H,z]=(0,a.useState)(t.customEnvironmentIds||[]),{data:W}=ev(),{team:U}=(0,I.useTeam)(),{user:Y}=(0,ei.useUser)(),{project:q,envIdOrSlug:eo}=(0,es.useParams)()||{},{data:ed}=(0,eh.useProject)(q),[ec,eu]=(0,a.useState)(void 0),em=U?.id;(0,a.useEffect)(()=>{t.decrypted&&w(t.value)},[t.decrypted,t.value]);let ep=(0,a.useMemo)(()=>W?.secrets.map(e=>({label:`@${e.name}`,value:e.uid}))??[],[W]),[eb,eE]=(0,a.useState)(t.gitBranch),{data:e_}=ej(q),[eC,ek]=(0,a.useState)(!1),[ew,eT]=(0,a.useState)(""),[eN,eP]=(0,a.useState)(()=>x===N.EnvType.Secret?t.value:null),[eI,eL]=(0,a.useState)(()=>x===N.EnvType.System?t.value:null),eV=(0,a.useCallback)(e=>{"create-new-secret"===e?ek(!0):(null===e&&eT(""),eP(e))},[ek,eP,eT]),eB=(0,a.useCallback)(e=>{if((eL(e),null!==e)&&(!j.value||!j.edited))switch(ed?.framework){case"nextjs":b({edited:!1,value:`NEXT_PUBLIC_${e}`});break;case"create-react-app":b({edited:!1,value:`REACT_APP_${e}`})}},[j,ed]),{open:eR}=(0,eg.useSaveAndRedeploy)(),eF=(0,a.useCallback)(async()=>{A(!0);let e="";switch(x){case N.EnvType.Plain:e=C;break;case N.EnvType.Secret:e=eN;break;case N.EnvType.System:e=eI;break;case N.EnvType.Encrypted:case N.EnvType.Sensitive:e=k}let n=[];R&&n.push(N.EnvTarget.Production),D&&n.push(N.EnvTarget.Preview),G&&n.push(N.EnvTarget.Development);try{let a=eb||null,r=x===N.EnvType.Sensitive?{value:e||void 0,target:n,gitBranch:a,comment:E.value}:{key:j.value,value:e,target:n,type:x,gitBranch:a,comment:E.value};if(r.customEnvironmentIds=H,p)await p(r);else{let e=await (0,ea.fetchAPI)(`${(0,er.API_PROJECTS_VERSION)("v7")}/${q}/env/${t.id}${(0,en.encode)({teamId:em})}`,{method:"PATCH",body:JSON.stringify(r),throwOnHTTPError:!0});i(e),eR("Updated Environment Variable successfully.")}}catch(e){eu((0,s.normalizeError)(e))}A(!1)},[i,p,j,E,C,eN,eI,k,q,em,G,D,R,t,x,eb,H,eR]);(0,a.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&13===e.keyCode&&"TEXTAREA"===e.target.tagName&&eF()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[eF]);let eD=(0,a.useMemo)(()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(J.Label,{value:"Type"}),(0,n.jsx)(ee.RadioGroup,{label:"Environment Variable Type",onChange:e=>{g(e),B||e!==N.EnvType.Secret||$(!1)},value:x,children:(0,n.jsxs)(M.default,{direction:["column","row","row"],gap:0,style:{fontSize:"14px"},children:[(0,n.jsx)(ee.RadioGroup.Item,{value:N.EnvType.Plain,children:"Plaintext"}),(0,n.jsx)(y.Spacer,{x:1,y:.5}),(0,n.jsx)(ee.RadioGroup.Item,{value:N.EnvType.Secret,children:"Secret"}),(0,n.jsx)(y.Spacer,{x:1,y:.5}),(0,n.jsx)(ee.RadioGroup.Item,{value:N.EnvType.System,children:"Provided by System"})]})})]}),[x,$,B]),eO=(0,a.useMemo)(()=>(0,n.jsx)(M.default,{flex:.5,children:(0,n.jsx)(J.Label,{value:"Value",children:(0,n.jsxs)(K.Combobox,{disabled:B,onChange:eV,placeholder:"Select Secret…",value:eN,children:[(0,n.jsx)(K.Combobox.Input,{className:"edit-var-select-secret",onChange:e=>eT(e.target.value)}),(0,n.jsxs)(K.Combobox.List,{children:[(0,n.jsx)(K.Combobox.Option,{value:"create-new-secret",children:ew?`Create new Secret "${ew}" for ${U?.name??Y?.name??Y?.username}`:`Create a new Secret for ${U?.name??Y?.name??Y?.username}`}),(0,n.jsx)(n.Fragment,{children:ep.map(e=>(0,n.jsx)(K.Combobox.Option,{value:e.value,children:e.label},e.value))})]})]})})}),[eT,eV,ep,B,ew,eN,U,Y]),eG=(0,a.useMemo)(()=>(0,n.jsx)(M.default,{flex:.5,children:(0,n.jsx)(J.Label,{value:"Value",children:(0,n.jsxs)(K.Combobox,{onChange:eB,placeholder:"Select System Environment Variable…",value:eI,children:[(0,n.jsx)(K.Combobox.Input,{}),(0,n.jsx)(K.Combobox.List,{children:e_?.systemEnvValues.map(e=>(0,n.jsx)(K.Combobox.Option,{value:e,children:e},e))})]})})}),[e_,eB,eI]),e$=(0,a.useMemo)(()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Spacer,{y:.5}),(0,n.jsx)(J.Label,{value:"Value",children:(0,n.jsx)(et.Textarea,{onChange:e=>S(ex(e.target.value)),placeholder:"i9ju23nf39nunu3asn",rows:3,value:C,width:"100%"})})]}),[C,S]),eM=!t.decrypted;return(0,n.jsxs)(el.EntityForm,{footerNote:(()=>{if(!o)return!1;let e=V.length>1,t=H.length>1;return e||t||V.length>0&&H.length>0})()?(0,n.jsx)(Q.Note,{type:"warning",children:"Editing this environment variable will affect multiple environments."}):null,primaryAction:(0,n.jsx)(c.Button,{"data-testid":(0,T.tid)("env-variables-edit-form","save-button"),loading:P,onClick:eF,size:"small",children:"Save"}),secondaryAction:(0,n.jsx)(c.Button,{onClick:r,size:"small",type:"secondary",children:"Cancel"}),children:[(0,n.jsxs)(M.default,{direction:"column",children:[(0,n.jsxs)(M.default,{flex:3,gap:0,children:[B?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Note,{size:"small",children:["Secrets can no longer be used in the Development Environment. ",'Please switch this Environment Variable to the "Plaintext" type in order to edit its value.']}),(0,n.jsx)(y.Spacer,{y:.5})]}):null,![N.EnvType.Encrypted,N.EnvType.Sensitive].includes(x)&&(0,n.jsxs)(n.Fragment,{children:[eD,(0,n.jsx)(y.Spacer,{y:.5})]}),(0,n.jsx)(M.default,{children:(0,n.jsxs)(M.default,{direction:["column","row","row"],gap:.5,children:[(0,n.jsx)(M.default,{flex:[N.EnvType.Plain,N.EnvType.Encrypted,N.EnvType.Sensitive].includes(x)?1:.5,children:(0,n.jsx)(J.Label,{value:"Name",children:(0,n.jsx)(eA,{disabled:x===N.EnvType.Sensitive||d,id:"edit-env-name",onChange:e=>b({edited:!0,value:e.target.value}),onPaste:e=>{if(C||k)return;let t=Object.entries((0,ey.parseEnv)(e.clipboardData.getData("text")));if(0===t.length||t.length>1)return;e.preventDefault();let n=t[0],a=n[0],r=n[1];b({edited:!0,value:a}),x===N.EnvType.Plain?S(ex(r)):[N.EnvType.Encrypted,N.EnvType.Sensitive].includes(x)&&w(ex(r))},placeholder:"EXAMPLE_NAME",value:j.value})})}),x===N.EnvType.Secret?eO:null,x===N.EnvType.System?eG:null]})}),x===N.EnvType.Plain?e$:null,[N.EnvType.Encrypted,N.EnvType.Sensitive].includes(x)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Spacer,{y:.5}),(0,n.jsx)(J.Label,{value:"Value",children:(0,n.jsxs)(f.Skeleton,{show:x===N.EnvType.Encrypted&&eM,style:{position:"relative"},children:[(0,n.jsx)(et.Textarea,{"aria-describedby":L,onChange:e=>w(ex(e.target.value)),placeholder:"YOUR_SECRET_VALUE_GOES_HERE",rows:6,value:k,width:"100%",wrapperClassName:e4.default.textarea,...h}),(0,n.jsx)(eS,{className:e4.default.overlay,id:L,value:k,width:"100%",...h})]})})]}),[N.EnvType.Encrypted,N.EnvType.Sensitive].includes(x)?null:(0,n.jsx)(()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Spacer,{y:.5}),(0,n.jsx)("span",{className:"text-copy-16",style:{textTransform:"uppercase",fontSize:"0.75rem",fontWeight:500,color:"var(--geist-secondary)"},children:"Environments"}),(0,n.jsx)(y.Spacer,{y:.5}),(0,n.jsxs)(M.default,{direction:["column","row","row"],gap:0,children:[(0,n.jsx)(Z.Checkbox,{checked:R,name:"edit-form-production",onChange:()=>F(!R),children:"Production"}),(0,n.jsx)(y.Spacer,{x:1,y:.5}),(0,n.jsx)(Z.Checkbox,{checked:D,name:"edit-form-preview",onChange:()=>O(!D),children:"Preview"}),(0,n.jsx)(y.Spacer,{x:1,y:.5}),(0,n.jsx)(Z.Checkbox,{checked:G,disabled:x===N.EnvType.Secret&&!B||x===N.EnvType.Sensitive,name:"edit-form-development",onChange:()=>$(!G),children:"Development"})]})]}),{}),(0,n.jsx)(y.Spacer,{y:.5}),(0,n.jsxs)(M.default,{direction:["column","row","row"],gap:.5,children:[u?null:(0,n.jsx)(M.default,{flex:[N.EnvType.Plain,N.EnvType.Encrypted,N.EnvType.Sensitive].includes(x)?1:.5,children:(0,n.jsx)(J.Label,{value:"Comment",children:(0,n.jsx)(X.Input,{id:"edit-env-comment",maxLength:N.ENV_VAR_COMMENT_MAX_LENGTH,onChange:e=>_({edited:!0,value:e.target.value}),placeholder:"e.g., Database key from Supabase…",value:E.value,width:"100%"})})}),x===N.EnvType.Secret?eO:null,x===N.EnvType.System?eG:null]})]}),[N.EnvType.Encrypted,N.EnvType.Sensitive].includes(x)&&!v?(0,n.jsx)(M.default,{flex:2,children:(0,n.jsx)(e3,{checkedDevelopment:G,checkedPreview:D,checkedProduction:R,disableEnvironmentPicker:o,disableDevelopmentEnvironment:x===N.EnvType.Sensitive,hideGitBranchSelector:!!(o&&eo!==N.EnvTarget.Preview),onChangeSelectedCustomEnvironmentIds:z,selectedCustomEnvironmentIds:H,selectedGitBranch:eb,setCheckedDevelopment:$,setCheckedPreview:O,setCheckedProduction:F,setSelectedGitBranch:eE})}):null]}),ec?(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(y.Spacer,{y:1})," ",(0,n.jsx)(m.Error,{error:ec})," "]}):null,(0,n.jsx)(ef,{active:eC,initialSecretName:ew||j.value,onAdd:e=>{ek(!1),eT(""),eP(e),l()},onCancel:()=>{ek(!1),eT("")}})]})}var e9=e.i(2729296);e.i(6887680);var e7=e.i(6810699),te=e.i(3850869),tt=e.i(7188996),tn=e.i(3756284),ta=e.i(545405),tr=e.i(3703009),ti=e.i(8525850),ts=e.i(3357231),tl=e.i(134877),to=e.i(972022);let td=function(e){return(0,n.jsx)("form",{...e,onKeyDown:e=>{if("Enter"===e.key&&e.metaKey){let t=e.target;t.form&&t.form.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))}},onSubmit:t=>{t.preventDefault(),e.onSubmit?.(t)}})};async function tc(e){let{projectId:t,kvs:n,target:a,type:r=N.EnvType.Encrypted,teamId:i,applyToAllCustomEnvironments:s}=e;return(0,ea.fetchAPI)(`${er.API_SHARED_ENV_VARIABLES}${(0,en.encode)({teamId:i})}`,{method:"POST",body:JSON.stringify({evs:n,projectId:t,target:a,type:r,applyToAllCustomEnvironments:s}),throwOnHTTPError:!0})}e.s(["default",0,td],3245331);var tu=e.i(1080700);async function tm(e){let{envVar:t,teamId:n,payload:a,applyToAllCustomEnvironments:r}=e,i={};return t.key!==a.key&&(i.key=a.key),t.value!==a.value&&(i.value=a.value),(0,tu.arraysEqual)(t.target.sort(),a.target.sort())||(i.target=[...a.target]),a.projectIdUpdates&&(i.projectIdUpdates=a.projectIdUpdates),void 0!==a.comment&&(i.comment=a.comment),void 0!==r&&(i.applyToAllCustomEnvironments=r),(0,ea.fetchAPI)(`${er.API_SHARED_ENV_VARIABLES}${(0,en.encode)({teamId:n})}`,{method:"PATCH",body:JSON.stringify({updates:{[t.id]:i}}),throwOnHTTPError:!0})}async function tv(e){let{envVar:t,projectId:n,teamId:a}=e,r=`${er.API_SHARED_ENV_VARIABLES}/${t.id}/unlink/${n}${(0,en.encode)({teamId:a})}`;await (0,ea.fetchAPI)(r,{method:"PATCH",throwOnHTTPError:!0,body:{}})}async function tp(e){let{envVars:t,projectId:n,teamId:a}=e,r={};t.forEach(e=>{if(e.projectId.includes(n))throw Error("Project already added to env var");r[e.id]={projectIdUpdates:{link:[n],unlink:[]}},e.applyToAllCustomEnvironments&&(r[e.id].applyToAllCustomEnvironments=e.applyToAllCustomEnvironments)}),await (0,ea.fetchAPI)(`${er.API_SHARED_ENV_VARIABLES}${(0,en.encode)({teamId:a})}`,{method:"PATCH",body:JSON.stringify({updates:r}),throwOnHTTPError:!0})}e.s(["addProjectToSharedEnvVars",0,tp,"removeProjectFromSharedEnvVar",0,tv,"updateSharedEnvVar",0,tm],4171299);var th=e.i(9512272),tx=e.i(6949145),tf=e.i(3243396),ty=e.i(8128646),tg=e.i(1642786),tj=e.i(2988836);function tb(e){let{dispatch:t,state:r,mustBeSensitive:s,teamId:l,variant:o,gitBranch:d,restrictToEnvironmentIds:u,disableEnvironmentPicker:m,disableDevelopmentEnvironment:v}=e,{can:p,isLoading:h}=(0,eu.default)({teamId:l}),x=(0,A.useIsTablet)()||"project"===o,f=r.target,y=f.production||f.preview,g=p(em.Action.Create,"project"===o?em.Resource.ProjectEnvVarsProduction:em.Resource.SharedEnvVarsProduction);(0,a.useEffect)(()=>{!h&&(g||t({type:"update_target",payload:{target:{production:!1}}}),(r.sensitive||s)&&y&&t({type:"update_target",payload:{target:{development:!1}}}))},[g,h,s,r.sensitive,y,f.production,t]);let j=!!u?.length,b=u?.length===1&&u[0]===P.PreviewEnvironment.id;(0,a.useEffect)(()=>{if(u?.length)if(b)t({type:"update_custom_environment_target",payload:{target:{customEnvironmentIds:[],development:!1,preview:!0,production:!1}}});else{let e=[],n=[];u.forEach(t=>{["production","development","preview"].includes(t)?e.push(t):n.push(t)}),t({type:"update_custom_environment_target",payload:{target:{customEnvironmentIds:n,applyToAllCustomEnvironments:n.includes(eX),development:e.includes("development"),preview:e.includes("preview"),production:e.includes("production")}}})}},[t,b,u]);let E=j?b&&!m:!m;return(0,n.jsxs)("div",{className:(0,i.default)("flex flex-col items-stretch justify-start flex-initial",x?"gap-1":""),children:[(0,n.jsx)(J.Label,{value:"Environments"}),(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,n.jsx)(eJ,{canCreateProductionEnvVars:g,disabled:j||m,disableDevelopmentEnvironment:v,isPreviewEnvironment:b,onChange:e=>{if(u?.length&&!b)return;if(b&&1===e.length){let n="preview"===e[0]?void 0:e[0];n&&t({type:"set_git_branch_name",payload:{branchName:n}}),t({type:"update_custom_environment_target",payload:{target:{customEnvironmentIds:[],development:!1,preview:!0,production:!1,gitBranch:!!n}}});return}let n=[],a=[];e.forEach(e=>{["production","development","preview"].includes(e)?n.push(e):a.push(e)}),t({type:"update_custom_environment_target",payload:{target:{customEnvironmentIds:a,development:n.includes("development"),preview:n.includes("preview"),production:n.includes("production"),gitBranch:!1,applyToAllCustomEnvironments:a.includes(eX)}}})},selectedEnvironmentIds:new Set(u?.length?u:[...r.target.customEnvironmentIds,r.target.production&&"production",r.target.development&&"development",r.target.preview&&"preview",r.target.applyToAllCustomEnvironments&&eX].filter(Boolean))}),"project"===o&&E?(0,n.jsxs)("div",{children:[(0,n.jsx)(J.Label,{value:"Branch"}),(0,n.jsxs)("div",{className:"flex flex-row items-stretch w-full justify-start gap-3 flex-1",children:[(0,n.jsx)(c.Button,{onClick:()=>{t({type:"update_target",payload:{target:{customEnvironmentIds:[],production:!1,development:!1,preview:!0,gitBranch:!f.gitBranch}}})},size:"small",type:"secondary",typeName:"button",variant:"invert",children:f.gitBranch?"Cancel":"Select a Custom Preview Branch"}),f.gitBranch?(0,n.jsx)(tC,{checkedState:f,dispatch:t,gitBranch:d}):null]})]}):null]})]})}function tE(e){let t=[];return e.development&&t.push(N.EnvTarget.Development),e.preview&&t.push(N.EnvTarget.Preview),e.production&&t.push(N.EnvTarget.Production),t}function t_(e){return{production:e.target.includes(N.EnvTarget.Production),preview:e.target.includes(N.EnvTarget.Preview),development:e.target.includes(N.EnvTarget.Development),gitBranch:!!e.gitBranch,customEnvironmentIds:e.applyToAllCustomEnvironments?[eX]:[],applyToAllCustomEnvironments:e.applyToAllCustomEnvironments}}function tC(e){let{gitBranch:t,checkedState:r,dispatch:i}=e,s=(0,es.useParams)()?.project,{data:l}=(0,eh.useProject)(s),o=l?.id,{data:d}=(0,eG.useProjectBranches)(o),[,{branches:c}]=(0,e6.useProjectDeployedBranches)({project:l,query:t}),u=(0,a.useMemo)(()=>Array.from(new Set([...c||[],...(d||[]).filter(Boolean).map(e=>e.ref)])),[d,c]);return r.gitBranch?l?.link?(0,n.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-4 flex-initial",children:[(0,n.jsxs)(K.Combobox,{className:tg.default.selectGitBranch,onChange:e=>i({type:"set_git_branch_name",payload:{branchName:e||void 0}}),placeholder:"All Preview Branches",size:"small",value:t||null,children:[(0,n.jsx)(K.Combobox.Input,{onChange:e=>{i({type:"set_git_branch_name",payload:{branchName:e.target.value.trim()||void 0}})},trimValue:!0}),(0,n.jsxs)(K.Combobox.List,{emptyMessage:"No preview branches",maxWidth:450,children:[(0,n.jsx)(n.Fragment,{children:t&&!u.find(e=>e===t)?(0,n.jsx)(K.Combobox.Option,{displayValue:!0,value:t||"",children:`Use "${t}"`}):null}),(0,n.jsx)(n.Fragment,{children:u.map(e=>{let t=String(l.link?.productionBranch)===e;return t?null:(0,n.jsx)(K.Combobox.Option,{disabled:t,value:e,children:e},e)})})]})]}),(0,n.jsx)(g.Tooltip,{text:(0,n.jsx)("span",{children:"If a branch is selected, these variables apply only to the Preview Deployments from that branch."}),children:(0,n.jsx)(tj.InformationFillSmall,{})})]}):(0,n.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-4 flex-initial",children:(0,n.jsx)(eO.DashboardButtonLink,{route:"/[teamSlug]/[project]/settings/git",size:"small",type:"secondary",children:"Connect Git Repository"})}):null}let tS={kvs:[{key:"",value:"",tempId:(0,tf.uniqueId)("env_"),comment:""}],projects:[],target:{development:!0,production:!0,preview:!0,gitBranch:!1,customEnvironmentIds:[]},error:void 0,isProcessing:!1,gitBranch:""},tk=(e,t)=>(0,ty.produce)(e,e=>{switch(t.type){case"add_new_kv":return e.kvs=[...e.kvs,{key:"",value:"",tempId:(0,tf.uniqueId)("env_")}],e;case"remove_kv":return e.kvs=e.kvs.filter(e=>e.tempId!==t.payload.id),0===e.kvs.length&&(e.kvs=[{key:"",value:"",tempId:(0,tf.uniqueId)("env_")}]),e;case"update_kv":return e.kvs[t.payload.index]={...e.kvs[t.payload.index],...t.payload.update},e.error&&(e.error.envVarIds=e.error.envVarIds.filter(n=>n!==e.kvs[t.payload.index].tempId)),e;case"prefill_form":{let{envVar:n}=t.payload;return e.kvs=[{key:n.key,value:n.value,tempId:n.id}],e.target=t_(n),e.gitBranch=n.gitBranch||"",e.projects=n.projects??[],e.sensitive=n.type===N.EnvType.Sensitive,e}case"update_target":return e.target={...e.target,...t.payload.target},e.target.preview||(e.gitBranch=void 0,e.target.gitBranch=!1),e;case"update_custom_environment_target":return e.target={...e.target,...t.payload.target},e;case"add_project":{let{project:n}=t.payload;return e.projects.find(e=>e.id===n.id)||(e.projects=[...e.projects,n]),e}case"remove_project":{let{id:n}=t.payload;return e.projects=e.projects.filter(e=>e.id!==n),e}case"error":return e.error={errorObject:t.payload.error,envVarIds:e.kvs.map(e=>e.tempId)},e;case"processing":return e.isProcessing=t.payload.isProcessing,e;case"sensitive":return e.sensitive=t.payload.sensitive,e;case"reset":return e.kvs=tS.kvs,e.projects=tS.projects,e.error=tS.error,e.sensitive=tS.sensitive,e;case"import_file":{let{fileData:n,insertAtIndex:a}=t.payload,r=Object.entries((0,ey.parseEnv)(n));if(0===r.length)return e;return e.kvs=[...e.kvs.slice(0,a),...r.map(e=>{let[t,n]=e;return{key:t,value:n,tempId:(0,tf.uniqueId)("env_")}}),...e.kvs.slice(a+1)],e}case"set_git_branch_name":{let{branchName:n}=t.payload;return e.gitBranch=n,e}case"form_submitted":{let{response:n}=t.payload;if(0===n.failed.length)return e.kvs=tS.kvs,e.projects=tS.projects,e.error=tS.error,e;let a=e.kvs.filter(e=>!n.created.find(t=>t.key===e.key));return e.kvs=a,e.error={errorObject:n.failed[0].error,envVarIds:a.map(e=>e.tempId)},e}default:return e}});var tw=e.i(7917902),tT=e.i(7957251),tN=e.i(2107254),tP=e.i(6352514),tI=e.i(1853611),tA=e.i(9544652);let tL=e=>{let t=(0,tA.useDisabled)(e.disabled),a=e.loading??e.swr?.isLoadingMore,r="Load More";return!e.swr?.initialDataLoaded||e.swr?.isReachingEnd?null:(0,n.jsx)(c.Button,{type:"secondary",width:"100%",...e,disabled:t,loading:a,onClick:t=>{let n=e.onClick??e.swr?.loadMore;n?.(t),tI.analytics.track(tP.AnalyticsEvent.CLICK_EVENT,{click_name:"dashboard_cta",click_value:r})},children:r})};e.s(["default",0,tL],8916169);var tV=e.i(7710663),tB=e.i(6319736),tR=e.i(6509836),tF=e.i(538090),tD=e.i(7332807);function tO(e){let{items:t,selectedItems:r,hideSelectedItems:s,placeholderText:l,OptionComponent:o,search:d,setSearch:c,onChange:u,ListFooterComponent:m,disabled:v,size:p,classNames:h}=e,[x,f]=(0,a.useState)(!1),y=(0,a.useMemo)(()=>s?t.filter(e=>!r.find(t=>e.id===t.id)):t,[s,t,r]);return(0,n.jsxs)(K.Combobox,{className:(0,i.clsx)(tD.default.portal,h?.combobox),disabled:v,onChange:u,onChangeOpen:f,placeholder:l,size:p,value:d,children:[(0,n.jsx)(K.Combobox.Input,{className:(0,i.clsx)(tD.default.themeBorder,tD.default.inputBox,{[tD.default.popoverShadow]:x},h?.input),onChange:e=>{c(e.target.value)}}),(0,n.jsx)(K.Combobox.List,{ListFooterComponent:m,avoidCollisions:!1,className:(0,i.clsx)(tD.default.projectOptionList,tD.default.themeBorder,tD.default.popoverBottom,tD.default.popoverShadow,h?.list),children:y.map(e=>(0,n.jsx)(o,{item:e},e.id))})]})}function tG(e){let{dispatch:t,selectedProjects:a,SWRDataToWaitFor:r}=e,{data:i}=(0,tV.useFrameworks)(),{account:s}=(0,tw.useAccount)();return(0,n.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,n.jsx)(J.Label,{value:"Link to Projects (optional)",bypassCasing:!0,children:(0,n.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-1",children:(0,n.jsxs)(tB.EnsureSWRData,{data:[s,i,...r],fallback:(0,n.jsx)(f.Skeleton,{height:40,width:"100%"}),children:[(0,n.jsx)(tM,{selectProject:e=>{t({type:"add_project",payload:{project:e}})},selectedProjects:a}),!!a.length&&(0,n.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:a.map(e=>(0,n.jsx)(t$,{project:e,removeProject:()=>{t({type:"remove_project",payload:{id:e.id}})}},e.id))})]})})})})}function t$(e){let{project:t,removeProject:a}=e,r=(0,ep.useFramework)(t);return(0,n.jsxs)(R.Entity,{actions:(0,n.jsx)(c.Button,{"aria-label":"remove row",className:tF.default.button,onClick:()=>{a(t)},style:{"--themed-bg":"var(--ds-gray-1000)"},svgOnly:!0,type:"tertiary",children:(0,n.jsx)(tT.MinusCircle,{})}),className:tF.default.selectedProjectEntity,thumbnail:(0,n.jsx)(F.EntityThumbnail,{size:20,wrap:!0,children:r?(0,n.jsx)(tR.FrameworkIcon,{framework:r,size:20}):null}),children:[(0,n.jsx)(D.EntityField,{className:tF.default.bold,title:t.name}),t.targets?.production?.alias?.[0]?(0,n.jsx)(D.EntityField,{description:t.targets.production.alias[0]}):null]},t.id)}function tM(e){let{selectedProjects:t,selectProject:r}=e,[i,s]=(0,a.useState)(""),[l,o]=(0,tN.useProjectListInfinite)({limit:20,latestDeployments:0,search:i},{},!1,!0);if(void 0===l.data)return(0,n.jsx)(f.Skeleton,{height:40,width:"100%"});let{projects:d}=o;return(0,n.jsx)(tO,{ListFooterComponent:(0,n.jsx)(tL,{swr:o}),OptionComponent:tH,classNames:{list:tF.default.projectList},hideSelectedItems:!0,items:d,onChange:e=>{let t=d.find(t=>t.name===e)??null;t&&r(t)},placeholderText:"Search projects…",search:i,selectedItems:t,setSearch:s})}function tH(e){let{item:t}=e,a=(0,ep.useFramework)(t);return(0,n.jsx)(K.Combobox.Option,{prefix:a?(0,n.jsx)(tR.FrameworkIcon,{framework:a,size:24}):void 0,suffix:t.targets?.production?.alias?.[0]??void 0,truncateSuffix:!0,value:t.name,children:(0,n.jsx)("span",{className:tF.default.projectName,children:t.name})})}e.s(["StyledCombobox",0,tO],3845686);var tz=e.i(6420219),tW=e.i(6198010),tU=e.i(923772),tY=e.i(692265),tq=e.i(2446691);let tZ=(0,a.forwardRef)((e,t)=>{let{disabled:a,label:r,resize:s,width:l,error:o,type:d,size:c,className:u,wrapperClassName:v,spellCheck:p=!1,autoCapitalize:h="off",autoComplete:x="off",autoCorrect:f="off",isEditing:g=!1,isSensitive:j=!1,inputType:b,...E}=e,_=(0,tY.useId)("aria"),C=r?J.Label:"label",S={...r?{value:r,withInput:!0,className:(0,i.clsx)(v,tF.default.label)}:{className:v}},k=(0,tA.useDisabled)()||a,w=(0,tY.useId)("textarea-"),N=(0,tq.useType)(o?"error":d);return(0,n.jsxs)(C,{"data-version":"v1",...S,children:[(0,n.jsx)("div",{className:`flex flex-row items-stretch justify-start flex-initial ${(0,i.clsx)(tF.default.textareaStack,j?tF.default.textAreaHeight:"")}`,children:(0,n.jsx)("div",{className:(0,i.clsx)(tF.default.container,N,tF.default.textareaWrapper),children:j?(0,n.jsx)(X.Input,{...E,autoCapitalize:h,autoComplete:x,autoCorrect:f,className:(0,i.clsx)(tF.default.textarea,N,{[tF.default.large]:"large"===c,[tF.default.small]:"small"===c},u,tF.default.textareaInput),"data-testid":(0,T.tid)("env-variables","add-form","value-input"),disabled:k,innerWrapperClassName:"!shadow-none",prefix:j&&g?(0,n.jsx)($.LockClosed,{size:16}):null,prefixStyling:!1,ref:t,spellCheck:p,typeName:b,width:l??"100%"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("textarea",{"aria-describedby":_,...E,autoCapitalize:h,autoComplete:x,autoCorrect:f,className:(0,i.clsx)(tF.default.textarea,N,{[tF.default.large]:"large"===c,[tF.default.small]:"small"===c},u,tF.default.textareaInput),"data-testid":(0,T.tid)("env-variables","add-form","value-input"),disabled:k,ref:t,spellCheck:p,style:{resize:s,width:l}}),(0,n.jsx)(eS,{id:_,value:E.value,width:l})]})})}),o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Spacer,{y:.5}),(0,n.jsx)(m.Error,{"data-testid":E["data-testid"]?(0,T.tid)(E["data-testid"],"error"):void 0,error:o,id:`${w}-error`,size:tK[c||"small"],style:{width:l}})]}):null]})}),tK={xSmall:"small",small:"small",mediumSmall:"small",large:"large"};function tX(e){let{kvs:t,dispatch:r,enableBulk:i=!1,isEditing:s=!1,firstInputRef:l,error:o,isSensitive:d}=e,[u,m]=(0,tz.useQueryState)("new",tz.parseAsString),v=(0,a.useRef)(null);return(0,a.useEffect)(()=>{u&&u&&t.length>0&&""===t[0].key&&(r({type:"update_kv",payload:{index:0,update:{key:u}}}),v.current&&v.current.focus(),m(null))},[u,t,r,m]),(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,n.jsx)("div",{className:"space-y-8",children:t.map((e,a,c)=>(0,n.jsx)(tJ,{dispatch:r,enableBulk:i,index:a,inputRef:0===a?l:void 0,valueInputRef:0===a?v:void 0,isEditing:s,isErrorState:o?.envVarIds.includes(e.tempId),isSensitive:d,kv:e,showDelete:i&&t.length>1},e.tempId))}),i?(0,n.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-3 flex-1",children:(0,n.jsx)(c.Button,{onClick:()=>r({type:"add_new_kv"}),prefix:(0,n.jsx)(tW.Plus,{}),size:"small",type:"secondary",typeName:"button",children:"Add Another"})}):null]})}function tJ(e){let{inputRef:t,valueInputRef:r,dispatch:s,index:l,kv:o,enableBulk:d=!1,isEditing:u=!1,isErrorState:m,isSensitive:v,showDelete:p=!1}=e,[h,x]=(0,a.useState)(!!o.comment),f=(0,a.useRef)(null);return(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-evenly gap-3 flex-1 group",children:[(0,n.jsxs)("div",{className:"flex flex-row items-stretch justify-evenly gap-3 flex-1",children:[(0,n.jsx)(eA,{disabled:!!v&&u,inputRef:t,isErrorState:m,onChange:e=>{s({type:"update_kv",payload:{index:l,update:{key:e.target.value}}})},onPaste:e=>{d&&0!==Object.entries((0,ey.parseEnv)(e.clipboardData.getData("text"))).length&&(e.preventDefault(),s({type:"import_file",payload:{fileData:e.clipboardData.getData("text"),insertAtIndex:l}}))},placeholder:"CLIENT_KEY…",testId:(0,T.tid)("env-variables","add-form","name-input"),value:o.key}),(0,n.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:(0,n.jsx)(tZ,{"aria-label":"shared environment variable value",autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",inputType:v&&!u?"password":"text",isEditing:u,isSensitive:v,label:t?"value":null,onChange:e=>s({type:"update_kv",payload:{index:l,update:{value:e.target.value}}}),ref:r,type:m?"error":"default",placeholder:v&&u?"This value is sensitive":void 0,value:o.value})}),p&&(0,n.jsx)("div",{className:"flex flex-row items-start justify-start gap-2 flex-initial group-first:mt-7",children:(0,n.jsx)(c.Button,{"aria-label":"remove row",className:tF.default.button,onClick:()=>s({type:"remove_kv",payload:{id:o.tempId}}),svgOnly:!0,title:"Delete row",type:"tertiary",typeName:"button",children:(0,n.jsx)(tU.Trash,{size:16,style:{flexShrink:0}})})})]}),h?(0,n.jsx)(X.Input,{"aria-label":"shared environment variable comment",wrapperClassName:t&&p?tF.default.commentField:void 0,innerWrapperClassName:t?void 0:p?tF.default.commentField:void 0,id:"comment",label:t?"Note":null,maxLength:N.ENV_VAR_COMMENT_MAX_LENGTH,onChange:e=>s({type:"update_kv",payload:{index:l,update:{comment:e.target.value}}}),placeholder:"e.g., Database key from Supabase…",ref:f,value:o.comment}):(0,n.jsx)(c.Button,{onClick:()=>{x(!0),setTimeout(()=>f.current?.focus(),0)},type:"tertiary",typeName:"button",size:"small",className:(0,i.clsx)("w-fit *:px-0 !text-gray-900 hover:!text-gray-1000 hover:!bg-transparent !pl-1 !h-fit","[&::after]:content-[''] [&::after]:absolute [&::after]:left-0 [&::after]:right-0 [&::after]:-inset-y-2 [&::after]:pointer-events-auto"),children:"Add Note"})]})}tZ.displayName="Textarea";var tQ=e.i(1906681);function t0(e){let{dispatch:t,state:r}=e,s=!!r.target.development;return(0,a.useEffect)(()=>{t({type:"sensitive",payload:{sensitive:!r.target.development&&!!r.sensitive}})},[r.target.development]),(0,n.jsx)("div",{className:"flex flex-col gap-1",children:(0,n.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[(0,n.jsx)(g.Tooltip,{disableTriggers:!s,text:"Sensitive environment variables cannot be created in the Development environment.",children:(0,n.jsx)(tQ.Toggle,{"aria-labelledby":"label-for-sensitive-toggle",checked:!!r.sensitive,direction:"switch-first",disabled:s,name:"add-form-sensitive",onChange:()=>{t({type:"sensitive",payload:{sensitive:!r.sensitive}}),!1===r.sensitive&&t({type:"update_target",payload:{target:{development:!1}}})},size:"large",children:(0,n.jsx)("span",{className:(0,i.clsx)("text-label-14",s&&"text-gray-700"),id:"label-for-sensitive-toggle",children:"Sensitive"})})}),(0,n.jsxs)("span",{className:"flex flex-row items-center gap-2",children:[(0,n.jsx)(g.Tooltip,{text:(0,n.jsxs)("span",{children:["Permanently hides values after saving. Use for API keys and secrets."," ",(0,n.jsx)(l.Link,{external:!0,href:"/docs/environment-variables/sensitive-environment-variables",type:"highlight",children:"Learn more"})]}),children:(0,n.jsx)(tj.InformationFillSmall,{className:"text-gray-900",size:16})}),s&&(0,n.jsx)("p",{className:"text-copy-13 text-gray-900",children:"Available for Production and Preview only"})]})]})})}var t1=e.i(809476);function t2(e){let{isEditing:t,envVar:r,teamId:i,onSave:s,onCancel:l,disableEnvironmentPicker:o,containerClassName:d}=e,{can:u,isLoading:m}=(0,eu.default)({teamId:i}),v=u(em.Action.Update,em.Resource.SharedEnvVars),p=(0,j.useToasts)(),{data:h,isLoading:x}=(0,eh.useProjects)(r.projectId,{config:{revalidateOnFocus:!1}}),[f,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{!x&&(r.type===N.EnvType.Sensitive||r.decrypted)&&y({...r,projects:h})},[h,r,x]);let g=(0,a.useCallback)(e=>{let t=new Set(e.projects.map(e=>e.id)),n=new Set(r.projectId),a=[...t].filter(e=>!n.has(e)),s=[...n].filter(e=>!t.has(e));return tm({envVar:r,payload:{...e.kvs[0],target:tE(e.target),projectIdUpdates:{link:a,unlink:s}},teamId:i,applyToAllCustomEnvironments:e.target.customEnvironmentIds.includes(eX)})},[r,i]);return(0,n.jsx)(t5,{arePermissionsLoading:m,bulkEnvVarEnabled:!1,canCreateSharedEnvVars:v,containerClassName:d,disableEnvironmentPicker:o,envVar:r,envVarWithProjects:f,formSubmit:g,isEditing:t,onSave:e=>{p.success("Updated Shared Environment Variable successfully."),s(e)},secondaryAction:(0,n.jsx)(c.Button,{onClick:l,size:"small",type:"secondary",children:"Cancel"}),teamId:i,variant:"shared"})}function t5(e){var t;let{formSubmit:r,onSave:l,isEditing:o,canCreateSharedEnvVars:d,arePermissionsLoading:u,bulkEnvVarEnabled:v,envVar:p,envVarWithProjects:h,secondaryAction:x,destructiveAction:f,teamId:y,fileUploadRef:g,variant:b,formClassName:E,containerClassName:_,restrictToEnvironmentIds:C,disableEnvironmentPicker:S,footerClassName:k}=e,w=p?{gitBranch:(t=p).gitBranch||"",isProcessing:!1,kvs:[],projects:[],sensitive:t.type===N.EnvType.Sensitive,target:t_(t)}:tS,[P,I]=(0,a.useReducer)(tk,w),{team:A,isTeamReady:L,isLoading:V}=(0,tx.useSensitiveEnvironmentVariablePolicy)(),B=L&&!V&&(0,tx.getBooleanValueFromOnOffDefault)(A?.sensitiveEnvironmentVariablePolicy),R=(0,a.useRef)(null),F=(0,a.useRef)(null),D=(0,j.useToasts)();(0,a.useEffect)(()=>{let e=g?.current;if(e)return document.addEventListener("dragenter",t),document.addEventListener("dragover",n),document.addEventListener("dragleave",a),document.addEventListener("drop",s),e.addEventListener("change",i),()=>{document.removeEventListener("dragenter",t),document.removeEventListener("dragover",n),document.removeEventListener("dragleave",a),document.removeEventListener("drop",s),e.removeEventListener("change",i)};function t(e){F.current&&e.dataTransfer?.items[0].kind==="file"&&F.current.classList.add("drag-enter")}function n(e){F.current&&e.target===F.current&&(e.preventDefault(),F.current.classList.add("drag-over"))}function a(e){F.current&&e.target===F.current&&(F.current.classList.remove("drag-over"),F.current.classList.remove("drag-enter"))}function r(e){if(!e||"text/plain"!==e.type&&""!==e.type)return void D.error("Please upload a valid env file");let t=new FileReader;t.onload=e=>{let t=e.target?.result;t&&I({type:"import_file",payload:{fileData:t.toString(),insertAtIndex:P.kvs.length-1}})},t.readAsText(e)}function i(e){r(e.target.files?.[0])}function s(e){F.current&&(e.target===F.current&&(e.preventDefault(),r(e.dataTransfer?.files[0])),F.current.classList.remove("drag-over"),F.current.classList.remove("drag-enter"))}},[g,P.kvs.length,D]),(0,a.useEffect)(()=>{(h?.type===N.EnvType.Sensitive||h?.decrypted)&&I({type:"prefill_form",payload:{envVar:h}})},[h]);let O=(0,a.useCallback)(async()=>{I({type:"processing",payload:{isProcessing:!0}});try{let e,t=await r(P);if(I({type:"form_submitted",payload:{response:t}}),h?.id){let t=new Set(h.projectId),n=new Set(P.projects.map(e=>e.id)),a=[...t].filter(e=>n.has(e)).concat([...n].filter(e=>!t.has(e)));e={id:h.id,key:P.kvs[0].key,value:P.sensitive?"":P.kvs[0].value,target:tE(P.target),projectId:a,type:P.sensitive?N.EnvType.Sensitive:N.EnvType.Encrypted,updatedAt:(h.updatedAt??0)+1}}l(e),I({type:"reset"})}catch(e){I({type:"error",payload:{error:(0,tl.isAPIError)(e)&&"envs_size_too_large"===e.code?Error("Unable to save environment variables. Insufficient space. Consider deleting some variables."):(0,s.normalizeError)(e)}})}I({type:"processing",payload:{isProcessing:!1}}),R.current?.focus()},[h?.id,h?.updatedAt,h?.projectId,r,l,P]),G=P.error?(0,n.jsx)(m.Error,{"data-testid":(0,T.tid)("env-variables","error-message"),error:P.error.errorObject}):null;return(0,n.jsxs)(td,{className:(0,i.clsx)(tF.default.envVarsForm,"flex flex-col flex-1"),"data-testid":(0,T.tid)("env-variables","add-form"),onSubmit:()=>void O(),children:[(0,n.jsx)("div",{className:tF.default.dragEffectBackground,ref:F}),(0,n.jsx)(el.EntityForm,{className:(0,i.clsx)("bg-background-100 p-0 flex flex-col flex-1","!border-0",E),destructiveAction:f,disabled:u||!d,footerClassName:(0,i.clsx)("p-4 bg-background-200 rounded-b-lg env-vars-footer border-t z-50",k),footerNote:null,footerSeparator:!1,primaryAction:(0,n.jsx)(c.Button,{loading:P.isProcessing,size:"small",typeName:"submit",children:"Save"}),secondaryAction:x,title:null,children:(0,n.jsxs)("div",{className:(0,i.clsx)("flex flex-col items-stretch justify-start gap-4 p-4 py-0 flex-1",_),children:[(0,n.jsx)(ts.NuqsAdapter,{children:(0,n.jsx)(tX,{dispatch:I,enableBulk:v,error:P.error,firstInputRef:R,isEditing:o,isLoading:null===h,isSensitive:P.sensitive,kvs:P.kvs})}),(0,n.jsx)("div",{className:(0,i.clsx)({"mt-0 mb-0":o,"mt-3 mb-2":!o}),children:(0,n.jsx)(t1.FullWidthHR,{})}),(0,n.jsxs)("div",{className:"pb-4 space-y-7",children:[(0,n.jsx)(tb,{disableEnvironmentPicker:S,disableDevelopmentEnvironment:!!P.sensitive,dispatch:I,gitBranch:P.gitBranch,mustBeSensitive:B,restrictToEnvironmentIds:C,state:P,teamId:y,variant:b}),"shared"===b&&(0,n.jsx)(tG,{SWRDataToWaitFor:[null===h?void 0:null],dispatch:I,selectedProjects:P.projects}),o||B?null:(0,n.jsx)(t0,{dispatch:I,state:P})]}),G]})})]})}e.s(["ProjectEnvVariablesAddForm",0,function(e){let{teamId:t,onSave:r,formClassName:i,containerClassName:s,restrictToEnvironmentIds:l,stickyFooter:o}=e,{project:d}=(0,es.useParams)()??{project:""},{data:u}=(0,eh.useProject)(d),m=u?.id,{can:v,isLoading:p}=(0,eu.default)({teamId:t}),h=v(em.Action.Create,em.Resource.ProjectEnvVars),x=(0,a.useRef)(null),f=(0,a.useCallback)(e=>{let n=tE(e.target);if(void 0===m)throw Error("Couldn't find project");return(0,th.addEnvs)(m,e.kvs.map(t=>{let a={name:t.key,value:t.value,target:n,type:e.sensitive?N.EnvType.Sensitive:N.EnvType.Encrypted,gitBranch:e.target.gitBranch&&e.gitBranch?e.gitBranch:void 0,comment:t.comment};return a.customEnvironmentIds=e.target.customEnvironmentIds,a}),t)},[m,t]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(t5,{arePermissionsLoading:p,bulkEnvVarEnabled:!0,canCreateSharedEnvVars:h,containerClassName:s,destructiveAction:(0,n.jsxs)("div",{className:"flex-row items-center justify-start gap-3 flex-initial hidden md:flex",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{accept:"env","aria-hidden":!0,multiple:!1,ref:x,style:{display:"none"},type:"file"}),(0,n.jsx)(c.Button,{disabled:!x.current,onClick:()=>x.current?.click(),prefix:(0,n.jsx)(to.CloudUpload,{}),size:"small",type:"secondary",typeName:"button",children:"Import .env"})]}),(0,n.jsx)("p",{className:"text-copy-14 text-gray-900",children:"or paste .env contents in Key input"})]}),fileUploadRef:x,footerClassName:o?"sticky bottom-0":void 0,formClassName:i,formSubmit:f,onSave:e=>{r?.(e)},restrictToEnvironmentIds:l,teamId:t,variant:"project"})})},"TeamEnvVariablesAddForm",0,function(e){let{teamId:t,onSave:r,stickyFooter:i}=e,{can:s,isLoading:l}=(0,eu.default)({teamId:t}),o=s(em.Action.Create,em.Resource.SharedEnvVars),d=(0,j.useToasts)(),u=(0,a.useRef)(null),m=(0,a.useCallback)(e=>tc({kvs:e.kvs,projectId:e.projects.map(e=>e.id),target:tE(e.target),teamId:t,type:e.sensitive?N.EnvType.Sensitive:N.EnvType.Encrypted,applyToAllCustomEnvironments:e.target.customEnvironmentIds.includes(eX)}),[t]);return(0,n.jsx)(t5,{arePermissionsLoading:l,bulkEnvVarEnabled:!0,canCreateSharedEnvVars:o,destructiveAction:(0,n.jsxs)("div",{className:"flex-row items-center justify-start gap-3 flex-initial hidden md:flex",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{accept:"env","aria-hidden":!0,multiple:!1,ref:u,style:{display:"none"},type:"file"}),(0,n.jsx)(c.Button,{disabled:!u.current,onClick:()=>u.current?.click(),prefix:(0,n.jsx)(to.CloudUpload,{}),size:"small",type:"secondary",typeName:"button",children:"Import"})]}),(0,n.jsx)("p",{className:"text-copy-14 text-gray-900",children:"or paste .env contents in Key input"})]}),fileUploadRef:u,footerClassName:i?"sticky bottom-0":void 0,formSubmit:m,onSave:e=>{d.success("Added Shared Environment Variable successfully."),r?.(e)},teamId:t,variant:"shared"})},"TeamEnvVariablesEditForm",0,t2],2215529);var t6=e.i(4251055);function t3(e){let{env:t,secretsMappedById:r,revealType:s,onViewEnvironmentVariable:l}=e,[o,d]=(0,a.useState)("hidden");if((0,a.useEffect)(()=>{void 0!==t.decrypted&&(t.decrypted&&"loading"===o?d("revealed"):t.decrypted||"revealed"!==o||d("hidden"))},[t.decrypted,o,t]),2===s)return(0,n.jsxs)("div",{className:"flex flex-row items-stretch justify-start flex-initial",children:[(0,n.jsxs)(g.Tooltip,{text:"Additional permissions are required to reveal production environment variables values.",children:[(0,n.jsx)(y.Spacer,{x:.1}),(0,n.jsx)(_.Eye,{size:16})]}),(0,n.jsx)(y.Spacer,{x:.5}),(0,n.jsx)("p",{className:`text-copy-14 text-gray-900 ${t6.default.bullets}`,children:"•".repeat(15)})]});if(1===s)return(0,n.jsx)(tt.CopyInlineCode,{value:t.value});if(t.type===N.EnvType.Secret&&r){let e=r[t.value]?.name;return e?(0,n.jsx)("i",{title:`@${e}`,children:`@${e}`}):(0,n.jsx)("i",{title:t.value,children:t.value||"-"})}if(t.type===N.EnvType.Plain)return(0,n.jsx)(O.default,{className:(0,i.clsx)(t6.default.plaintextEnvValue,"env-var-value","geist-ellipsis"),title:t.value,children:t.value});if(t.type===N.EnvType.Encrypted){if(t.decrypted&&!t.value)return(0,n.jsx)("i",{title:"This Environment Variable has no value",children:"Empty"});switch(o){case"revealed":return(0,n.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,n.jsx)(c.Button,{"aria-label":"Click to hide",className:t6.default.reveal,onClick:()=>d("hidden"),svgOnly:!0,title:"Click to hide",variant:"unstyled",children:(0,n.jsx)(E.EyeOff,{size:16})}),(0,n.jsx)(tt.CopyInlineCode,{value:t.value})]});case"hidden":case"loading":return(0,n.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,n.jsx)(c.Button,{"aria-label":"Click to reveal",className:t6.default.reveal,loading:"loading"===o,onClick:()=>{t.decrypted?d("revealed"):d("loading"),l?.(t)},size:"small",svgOnly:!0,title:"Click to reveal",variant:"unstyled",children:"loading"!==o&&(0,n.jsx)(_.Eye,{size:16})}),(0,n.jsx)("p",{className:`text-copy-14 text-gray-900 ${t6.default.bullets}`,children:"•".repeat(15)})]})}}return t.type===N.EnvType.Sensitive?null:(0,n.jsx)("i",{title:t.value,children:t.value})}function t4(e){let{env:t,team:a,projectName:r,resource:i}=e;switch(t.contentHint?.type){case"blob-read-write-token":return(0,n.jsx)(l.Link,{href:a&&r?`/${a.slug}/${r}/stores/blob/${t.contentHint.storeId}`:a?`/${a.slug}/~/stores/blob/${t.contentHint.storeId}`:`/dashboard/stores/blob/${t.contentHint.storeId}`,style:{color:"var(--geist-secondary)"},children:(0,n.jsx)("div",{className:t6.default.dataStoreIconWrapperStyles,children:(0,n.jsx)(tr.DataStore,{size:"small",type:"blob"})})});case"integration-store-secret":return i&&a?(0,n.jsx)(g.Tooltip,{text:"Open linked integration",children:(0,n.jsx)(l.Link,{href:(0,ti.getResourceDetailsPath)(i,a.slug,r),style:{color:"var(--geist-secondary)"},children:(0,n.jsx)(t8,{...t.contentHint})})}):null;case"flags-connection-string":return(0,n.jsx)(g.Tooltip,{text:"Open flags",children:(0,n.jsx)(l.Link,{href:`/${a.slug}/${r}/flags`,style:{color:"var(--geist-secondary)"},children:(0,n.jsx)("div",{className:t6.default.dataStoreIconWrapperStyles,children:(0,n.jsx)(g.Tooltip,{text:"This environment variable connects this project with flags",children:(0,n.jsx)(w.ToggleOnAlt,{size:16})})})})})}return t.edgeConfigId?(0,n.jsx)(g.Tooltip,{desktopOnly:!0,text:"This environment variable connects this project to an Edge Config",children:(0,n.jsx)(l.Link,{href:a&&r?`/${a.slug}/${r}/stores/edge-config/${t.edgeConfigId}`:a?`/${a.slug}/~/stores/edge-config/${t.edgeConfigId}`:`/dashboard/stores/edge-config/${t.edgeConfigId}`,style:{color:"var(--geist-secondary)"},children:(0,n.jsx)("div",{className:t6.default.dataStoreIconWrapperStyles,children:(0,n.jsx)(tr.DataStore,{size:"small",type:"edge-config"})})})}):null}function t8(e){let{integrationId:t,integrationProductId:a}=e,{product:r}=(0,z.useIntegrationAndProduct)({integrationIdOrSlug:t,productIdOrSlug:a});return r?(0,n.jsx)(o.Avatar,{hash:r.iconUrl,size:20,title:r.name}):(0,n.jsx)(S.Linked,{size:12})}function t9(e){let{env:t,className:r,hasConnectedStore:s,onRemove:l,onSave:c,onDetach:u,onSecretAdd:m,secretsMappedById:h,isEditing:f,setIsEditing:y,search:E,canReadProductionValues:_,canUnlinkSharedEnvVariable:C,disableDeleteEnvVariable:S,disableEditEnvVariable:k,onViewEnvironmentVariable:w,team:I,projectId:L,projectName:B,getOverriddenTargetsForSharedEnvVar:O=e=>[],virtuosoIndexData:G,disableMoreMenuProps:$,environment:M,disableNameInput:H,disableComment:z,disableEnvironmentInput:W,customSave:U,editTextareaValueProps:Y,resource:Z}=e,K=(0,A.useIsMobile)(),X=(0,a.useRef)(null),J=(0,e9.isSharedEnv)(t),Q=(0,j.useToasts)(),ee=(0,a.useRef)(!1),et=(0,V.useAgo)(t.updatedAt||t.createdAt,{justNowLabel:"just now"}),en=(0,a.useMemo)(()=>J?O(t):[],[t,O,J]);(0,a.useEffect)(()=>{f&&X.current?.scrollIntoView({behavior:"smooth",block:"nearest"})},[f]),(0,a.useEffect)(()=>{if(ee.current&&t.decrypted){let e=t.type===N.EnvType.Secret&&h?`@${h[t.value]?.name||t.value}`:t.value;(0,ta.copyToClipboard)(`${t.key}=${e}`),Q.success("Copied to clipboard."),ee.current=!1}},[t.decrypted,t.key,t.value,t.type,h,Q]);let ea=(0,a.useMemo)(()=>{var e;return t?(0,n.jsxs)("span",{className:t6.default.varNameContainer,children:[(0,n.jsx)(tn.CopyText,{value:t.key,children:(0,n.jsx)("span",{className:(0,i.clsx)(en.length?t6.default.overriddenEnvVar:void 0,t6.default.varName),style:{fontFamily:"var(--font-mono)",fontWeight:500},title:t.key,children:E?(e=t.key,e.split(RegExp("("+E+")","gi")).map((e,t)=>e.toLowerCase()===E.toLowerCase()?(0,n.jsx)("span",{className:t6.default.suggestionHighlight,children:e},t):e)):t.key},t.id)}),(0,n.jsxs)("div",{className:(0,i.clsx)("flex flex-row items-stretch justify-start gap-2 flex-initial",t6.default.iconsContainer),children:[(0,n.jsx)(t4,{env:t,projectName:B,resource:Z,team:I}),void 0!==t.comment&&""!==t.comment&&(0,n.jsx)(g.Tooltip,{text:t.comment,children:(0,n.jsx)("div",{className:t6.default.commentWrapper,children:(0,n.jsx)(b.FileText,{size:14})})})]}),"sensitive"===t.type?(0,n.jsx)(d.Badge,{size:"sm",style:{marginLeft:"8px",backgroundColor:"var(--geist-secondary-lighter)",color:"var(--geist-secondary-dark)"},children:"Sensitive"}):null]}):null},[t,en.length,L,B,Z,E,I]),er=t.target===N.EnvTarget.Production||Array.isArray(t.target)&&1===t.target.length&&t.target[0]===N.EnvTarget.Production,ei=(0,a.useMemo)(()=>{if(!t.contentHint)return null;switch(t.contentHint.type){case"blob-read-write-token":return(0,n.jsx)(v.MenuItem,{href:I&&B?`/${I.slug}/${B}/stores/blob/${t.contentHint.storeId}/projects`:I?`/${I.slug}/~/stores/blob/${t.contentHint.storeId}/projects`:`/dashboard/stores/blob/${t.contentHint.storeId}/projects`,isLink:!0,children:"Manage Blob Connection"});case"integration-store-secret":return Z&&I?(0,n.jsx)(v.MenuItem,{href:(0,ti.getResourceDetailsPath)(Z,I.slug,B),isLink:!0,children:"Manage Connection"}):null;default:return null}},[t.contentHint,B,Z,I]),es=(0,a.useMemo)(()=>J?B?"Unlink from this Project":"Delete":"Remove",[J,B]),el=t.type===N.EnvType.Sensitive,eo=el||er&&!_?(0,n.jsx)(g.Tooltip,{desktopOnly:!0,style:{width:"100%"},text:el?"Sensitive environment variables cannot be copied.":"You do not have permission to copy this value.",children:(0,n.jsx)(p.MenuItemLocked,{children:"Copy to Clipboard"})}):(0,n.jsx)(v.MenuItem,{onClick:()=>{let{type:e,key:n,value:a,decrypted:r}=t;if(e===N.EnvType.Encrypted&&!r){ee.current=!0,w?.(t);return}let i=e===N.EnvType.Secret&&h?`@${h[a]?.name||a}`:a;(0,ta.copyToClipboard)(`${n}=${i}`),Q.success("Copied to clipboard.")},children:"Copy to Clipboard"});return(0,a.createElement)(R.Entity,{...G,className:(0,i.clsx)(r,t6.default.resultRow,{[t6.default.editing]:f},f&&"pb-0"),disabledDotMenuTooltip:void 0!==$?(0,n.jsx)(n.Fragment,{children:$.tooltip}):(0,n.jsx)(n.Fragment,{children:"Additional permissions are required to manage production environment variables."}),editing:f,footer:f?I&&J?(0,n.jsx)("div",{className:"-mx-4 -mt-4",children:(0,n.jsx)(t2,{containerClassName:"pt-3 border-t",disableEnvironmentPicker:!!M,envVar:t,isEditing:f,onCancel:()=>y(!1),onRemove:()=>{l?.(t)},onSave:e=>{y(!1),c?.(e)},teamId:I.id})}):(0,n.jsx)("div",{className:"pb-4",children:(0,n.jsx)(e8,{customSave:U,disableComment:z,disableEnvironmentInput:W,disableEnvironmentPicker:!!M,disableNameInput:H,editTextareaValueProps:Y,envVariable:t,onDiscard:()=>y(!1),onSave:e=>{y(!1),c?.(e)},onSecretAdd:()=>{m?.()}},t.id)}):null,footerClassName:f?"border-t-0":void 0,indent:!1,isDotMenuDisabled:!_&&er||$?.disabled,key:t.id,menuItems:ei?(0,n.jsxs)(n.Fragment,{children:[ei,eo,!1===s&&(!J||C)?(0,n.jsx)(v.MenuItem,{onClick:()=>{l?.(t)},style:{color:"var(--geist-error)"},children:es}):(0,n.jsx)(g.Tooltip,{desktopOnly:!0,disableTriggers:!s,text:"You can remove this environment variable by disconnecting the project from the connected store.",children:(0,n.jsx)(p.MenuItemLocked,{children:es})})]}):(0,n.jsxs)(n.Fragment,{children:[!(J&&L)&&(k?(0,n.jsx)(p.MenuItemLocked,{children:"Edit"}):(0,n.jsx)(v.MenuItem,{"data-testid":(0,T.tid)("env-vars-table","menu-item","edit",t.key),onClick:()=>y(!0),children:"Edit"})),eo,M&&t.type===N.EnvType.Encrypted&&(()=>{if(J||!M)return!1;let e=0;return t.customEnvironmentIds&&(e+=t.customEnvironmentIds.length),Array.isArray(t.target)?e+=t.target.length:e+=1,e>1})()?(0,n.jsx)(g.Tooltip,{desktopOnly:!0,style:{width:"100%"},text:`Detach this environment variable and create a new copy just for the ${M?(0,P.envName)(M):""} environment.`,children:(0,n.jsx)(v.MenuItem,{onClick:()=>{u?.(t)},children:"Detach"})}):null,(J?C:!S)?(0,n.jsx)(v.MenuItem,{onClick:()=>{l?.(t)},style:{color:"var(--geist-error)"},children:es}):(0,n.jsx)(p.MenuItemLocked,{children:es})]}),ref:X,thumbnail:(0,n.jsx)(F.EntityThumbnail,{size:24,children:(0,n.jsx)(q,{env:t})}),children:[(0,n.jsx)(D.EntityField,{className:(0,i.clsx)(t6.default.key,"min-h-11"),description:(0,n.jsx)(t7,{env:t,overriddenTargets:en}),title:ea}),t.type===N.EnvType.Sensitive&&K?null:(0,n.jsx)(D.EntityField,{children:(0,n.jsx)(t3,{env:t,onViewEnvironmentVariable:w,revealType:!er||_?0:2,secretsMappedById:h})}),(0,n.jsx)(D.EntityField,{avatar:t.updatedBy||t.createdBy?(0,n.jsx)(g.Tooltip,{text:t.lastEditedByDisplayName,children:(0,n.jsx)(o.Avatar,{size:24,uid:t.updatedBy||t.createdBy})}):null,className:t6.default.time,description:t.updatedAt?(0,n.jsxs)(x.RelativeTimeCard,{date:t.updatedAt,side:"left",children:[(0,n.jsxs)("span",{className:t6.default.timeAgoText,children:[t.updatedBy?"Updated":"Added"," "]}),et]}):null,right:!0})]})}function t7(e){let{overriddenTargets:t,env:a}=e;return(0,n.jsx)(ne,{env:a,overriddenTargets:t})}function ne(e){let{overriddenTargets:t,env:a}=e,r=[...Array.isArray(a.target)?a.target:[a.target],...a.customEnvironmentIds||[]].filter(e=>!!e);a.applyToAllCustomEnvironments&&r.push(eX);let{label:i,isLoading:s,environmentNamesList:l}=e2({selectedEnvironmentIds:new Set(r)});return(0,n.jsx)(f.Skeleton,{className:"truncate",show:s,children:(0,n.jsx)(g.Tooltip,{center:!1,delay:!0,desktopOnly:!0,disableTriggers:l.length<1,maxWidth:"300px",padding:"var(--geist-gap-quarter)",position:"top",style:{minWidth:"0",display:"block"},text:l.join(",\n"),children:t.length?(0,n.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-1",children:[(0,n.jsx)(C.Warning,{align:"bottom",size:16}),(0,n.jsx)("span",{children:"Overridden by Project"})]}):a.gitBranch?(0,n.jsxs)("span",{className:"flex flex-wrap gap-1",children:[i,(0,n.jsxs)("span",{className:"flex items-center gap-1",children:[(0,n.jsx)(k.GitBranch,{}),(0,n.jsx)("span",{className:"font-mono",children:a.gitBranch})]})]}):(0,n.jsx)("span",{className:"block w-full truncate",children:i})})})}function nt(e){let t=e.context,a=e.item,{open:r}=(0,eg.useSaveAndRedeploy)();if(!a||!t)return null;let{canReadProductionValues:i,canUnlinkSharedEnvVariable:s,getOverriddenTargetsForSharedEnvVar:l,isStoreDeleted:o,currentEditingEnv:d,onRemove:c,onSave:u,onDetach:m,onSecretAdd:v,onViewEnvironmentVariable:p,project:h,search:x,secretsMappedById:f,setCurrentEditingEnv:y,team:g,shouldDisableEnvRow:j,environment:b,resources:E}=t,_={"data-index":e["data-index"],"data-item-index":e["data-item-index"],"data-known-size":e["data-known-size"]},C=a.contentHint,S=C?.type==="integration-store-secret"?E?.find(e=>e.id===C.storeId):void 0;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(t9,{canReadProductionValues:i,canUnlinkSharedEnvVariable:s,className:t6.default.virtuosoRowOverflowAnchor,disableMoreMenuProps:j?.(a),env:a,environment:b,getOverriddenTargetsForSharedEnvVar:l,hasConnectedStore:!!a.contentHint&&"storeId"in a.contentHint&&!o(a.contentHint.storeId),isEditing:a.id===d,onDetach:m,onRemove:c,onSave:e=>{r("Updated Environment Variable successfully."),u?.(e)},onSecretAdd:v,onViewEnvironmentVariable:p,projectId:h?.id,projectName:h?.name,resource:S?.type==="integration"?S:void 0,search:x,secretsMappedById:f,setIsEditing:e=>{p?.(a),y(e?a.id:null)},team:g,virtuosoIndexData:_},a.id)})}(t={})[t.Encrypted=0]="Encrypted",t[t.AlwaysShow=1]="AlwaysShow",t[t.NeverShow=2]="NeverShow",e.s(["default",0,function(e){let{envVariables:t,onRemove:i,onSave:s,onDetach:l,secretsData:d,onSecretAdd:c,search:m,isLoading:p,withSecrets:h,withEnvs:x,projectId:f,canReadProductionValues:y,canUnlinkSharedEnvVariable:g,disabled:j,onViewEnvironmentVariable:b,textConfig:E,getOverriddenTargetsForSharedEnvVar:_=e=>[],shouldDisableEnvRow:C,environment:S,currentEditingEnv:k,setCurrentEditingEnv:w}=e,{isStoreDeleted:N,data:P}=(0,e7.useResourceList)({resourceIds:t?.map(e=>e.contentHint&&"storeId"in e.contentHint?e.contentHint.storeId:void 0).filter(e=>!!e)??[]}),A=(0,ep.useProjectIdOrName)()||f,{data:L}=(0,eh.useProject)(f),{isReady:V,team:B}=(0,I.useTeam)(),O=(0,a.useMemo)(()=>d?.secrets.reduce((e,t)=>(e[t.uid]=t,e),{})??{},[d?.secrets]),G=!V||p||x&&!Array.isArray(t)||h&&!d,$=(0,a.useMemo)(()=>({canReadProductionValues:y,canUnlinkSharedEnvVariable:g,getOverriddenTargetsForSharedEnvVar:_,isStoreDeleted:N,currentEditingEnv:k,onRemove:i,onSave:s,onDetach:l,onSecretAdd:c,onViewEnvironmentVariable:b,project:L,search:m,secretsMappedById:O,setCurrentEditingEnv:w,team:B,shouldDisableEnvRow:C,environment:S,resources:P?.stores}),[y,g,_,N,k,i,s,l,c,b,L,m,O,w,B,C,S,P?.stores]);return G?(0,n.jsx)("div",{children:["p1","p2"].map(e=>(0,n.jsxs)(R.Entity,{className:t6.default.resultRow,menuItems:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.MenuItem,{children:"Edit"}),(0,n.jsx)(v.MenuItem,{children:"Remove"})]}),placeholder:!0,thumbnail:(0,n.jsx)(F.EntityThumbnail,{size:30}),children:[(0,n.jsx)(D.EntityField,{description:"",descriptionSkeletonWidth:"50%",title:"",titleSkeletonWidth:"40%",width:"40%"}),(0,n.jsx)(D.EntityField,{description:"",descriptionSkeletonWidth:"80%",title:"",titleSkeletonWidth:"20%",width:"27%"}),(0,n.jsx)(D.EntityField,{avatar:(0,n.jsx)(o.Avatar,{size:24}),description:"",descriptionSkeletonWidth:"60%",right:!0})]},e))}):j?(0,n.jsx)(te.AdditionalPermissionsRequired,{resource:A?"Environment Variables of this project":"Environment Variables",team:A?null:B}):m&&t?.length===0?(0,n.jsx)(u.EmptyState.Root,{"data-testid":(0,T.tid)("env-vars-table","container","empty"),description:`Your search for "${m}" did not return any results.`,title:"No Results Found"}):t?.length===0?(0,n.jsx)(u.EmptyState.Root,{description:E?.emptyState.description??"Add Environment Variables to Production, Preview, and Development environments, including branches in Preview.",title:E?.emptyState.title??"No Environment Variables Added"}):(0,n.jsx)("div",{"data-testid":(0,T.tid)("env-vars-table","container"),children:(0,n.jsx)(r.Virtuoso,{components:{Item:nt},context:$,data:t,initialItemCount:Math.min(t?.length??0,10),overscan:1e3,style:{minHeight:t?78*t.length:"auto"},useWindowScroll:!0})})},"useRemoveEnvModal",0,function(e,t){let[r,i]=(0,a.useState)(!1),[l,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),[u,v]=(0,a.useState)(null),{data:p}=(0,eh.useProject)(e),x=(0,j.useToasts)(),{team:f}=(0,I.useTeam)(),g=(0,a.useCallback)(e=>{v(e),i(!0)},[]),b=(0,a.useCallback)(()=>{i(!1)},[]),E=(0,a.useCallback)(()=>{c(!1),o(null),v(null)},[]),_=(0,a.useCallback)(async()=>{if(u){c(!0);try{await (0,e9.deleteEnvVar)({envVars:[u],projectId:e,teamId:f?.id}),b(),x.success("Removed Environment Variable successfully."),await t?.()}catch(e){o((0,s.normalizeError)(e))}finally{c(!1)}}},[u,x,f,e,b,t]),C=[];u?.customEnvironmentIds&&C.push(...u.customEnvironmentIds),u?.target&&((0,L.isArray)(u.target)?C.push(...u.target):C.push(u.target)),u?.applyToAllCustomEnvironments&&C.push(eX);let{environmentNamesList:S}=e2({selectedEnvironmentIds:new Set(C.filter(e=>!!e))});return{modal:(0,a.useMemo)(()=>(0,n.jsxs)(h.Modal.Modal,{active:r,onAnimationDone:E,onClickOutside:b,children:[(0,n.jsxs)(h.Modal.Body,{children:[(0,n.jsx)(h.Modal.Header,{children:(0,n.jsx)(h.Modal.Title,{children:"Remove Environment Variable"})}),(0,n.jsxs)("p",{className:"text-copy-14",children:["You are about to remove an environment variable from your project"," ",(0,n.jsx)("span",{className:"font-medium",children:p?.name}),". This action cannot be undone."]}),(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-6",children:[(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-2",children:[(0,n.jsx)("p",{className:"text-copy-14",children:"Environment Variable:"}),(0,n.jsx)("p",{className:"px-4 py-3 m-0 truncate rounded bg-background-200 text-gray-1000 shadow-border",title:u?.key,children:u?u.key:""})]}),(0,n.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-2",children:[(0,n.jsx)("p",{className:"text-copy-14",children:"Affected Environments:"}),(0,n.jsx)("p",{className:"px-4 py-3 m-0 rounded bg-background-200 text-gray-1000 shadow-border",children:(0,B.toListSentence)(S)})]})]}),l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Spacer,{y:1}),(0,n.jsx)(m.Error,{error:l})]}):null]}),(0,n.jsxs)(h.Modal.Actions,{children:[(0,n.jsx)(h.Modal.Action,{onClick:b,type:"secondary",children:"Cancel"}),(0,n.jsx)(h.Modal.Action,{loading:d,onClick:_,type:"error",children:"Remove"})]})]}),[r,E,b,p?.name,u,l,d,S,_]),open:g,close:b}}],6899807)},996802,6506227,e=>{"use strict";var t=e.i(4205214),n=e.i(8660982),a=e.i(6565161),r=e.i(8248823),i=e.i(455575),s=e.i(7713873),l=e.i(1717203),o=e.i(7557283),d=e.i(6899807),c=e.i(1411137),u=e.i(5927860);function m(e,t){return Array.isArray(e)?e.includes(t):e===t}function v(e){let{envsInput:t,search:a,envOrBranchFilter:r,sortTarget:i}=e,l=(0,n.useMemo)(()=>{if(!t)return[];let e=a?t.filter(e=>e.key.toLowerCase().includes(a.toLowerCase())):t;if((0,s.isEnvFilter)(r)){if(r===s.allEnvironmentsFilter)return e;if(r===s.allCustomEnvironmentsFilter)return e.filter(e=>!!e.applyToAllCustomEnvironments);if(r===(0,s.mapToEnvFilter)(u.EnvTarget.Production))return e.filter(e=>m(e.target,u.EnvTarget.Production));if(r===(0,s.mapToEnvFilter)(u.EnvTarget.Development))return e.filter(e=>m(e.target,u.EnvTarget.Development));if(r===(0,s.mapToEnvFilter)(u.EnvTarget.Preview))return e.filter(e=>m(e.target,u.EnvTarget.Preview));if((0,s.isCustomEnvId)(r))return e.filter(e=>e.applyToAllCustomEnvironments||e.customEnvironmentIds?.includes(r))}return e.filter(e=>e.gitBranch===r)},[t,a,r]);return(0,n.useMemo)(()=>i&&"contentHint"!==i?"createdAt"===i?l.sort((e,t)=>(t.updatedAt??t.createdAt)-(e.updatedAt??e.createdAt)):l.sort((e,t)=>(e[i]?.toString()??"").localeCompare(t[i]?.toString()??"")):l,[l,i])}e.s(["useFilteredEnvs",0,v],6506227);var p=e.i(4171299),h=e.i(5119716);e.s(["TEVTable",0,function(e){let{teamId:u,project:m,withFilters:x=!0,sharedEnvs:f,projectEnvs:y,mutateSharedEnvVarData:g,isLoading:j,SWRCacheKey:b,envOrBranchFilter:E,sortTarget:_,setEnvOrBranchFilter:C,setSortTarget:S,search:k,setSearch:w,currentEditingEnv:T,setCurrentEditingEnv:N}=e,P=(0,i.useToasts)(),{cache:I}=(0,a.useSWRConfig)(),[A,L]=(0,n.useState)(""),[V,B]=(0,n.useState)(E??s.allEnvironmentsFilter),[R,F]=(0,n.useState)("createdAt");!x&&(k&&w&&(A=k,L=w),E&&C&&(V=E,B=C),_&&S&&(R=_,F=S));let D=m?.id,{can:O,isLoading:G}=(0,l.default)(D?{projectIdOrName:D}:void 0),$=O(o.Action.Read,D?o.Resource.ProjectEnvVars:o.Resource.SharedEnvVars),M=O(o.Action.Read,D?o.Resource.ProjectEnvVarsProduction:o.Resource.SharedEnvVarsProduction),H=O(o.Action.Delete,o.Resource.SharedEnvVarConnection),z=(0,d.useRemoveEnvModal)(void 0,g),{decryptEnvVar:W}=(0,h.useDecryptEnvVar)(b,g,{teamId:u,projectId:D}),U=$||M,Y=v({envsInput:f,search:A,envOrBranchFilter:V,sortTarget:R}),q=(0,n.useCallback)(async(e,t)=>{try{await (0,p.removeProjectFromSharedEnvVar)({envVar:e,projectId:t,teamId:u}),g(),P.success("Successfully unlinked Shared Environment Variable")}catch(e){P.error((0,r.normalizeError)(e).message)}},[g,u,P]),Z=(0,n.useCallback)(e=>y?y.filter(t=>t.key===e.key).reduce((t,n)=>((Array.isArray(n.target)?n.target:[n.target]).forEach(n=>{e.target.includes(n)&&t.push(n)}),t),[]):[],[y]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[x?(0,t.jsx)(c.EnvVariablesFilter,{disabled:!1,envOrBranchFilter:V,envs:f,project:D,search:A,setEnvOrBranchFilter:B,setSearch:L,setSortTarget:F,sortTarget:R}):null,(0,t.jsx)(d.default,{canReadProductionValues:M,canUnlinkSharedEnvVariable:H,currentEditingEnv:T,disabled:j||G||!U,envVariables:Y,getOverriddenTargetsForSharedEnvVar:Z,isLoading:j||G,onRemove:e=>{void 0!==D?q(e,D):z.open(e)},onSave:e=>{let t=I.get(b)?.data;if(t.envs.length>0){let n=[...t.envs],a=n.findIndex(t=>t.id===e.id),r={...n[a],...e,decrypted:!1};n[a]=r,g({envs:n},!1),W(r)}},onViewEnvironmentVariable:W,projectId:D,search:A,setCurrentEditingEnv:N,teamId:u,textConfig:{emptyState:{title:D?"No shared variables linked":"No shared variables",description:D?"Link variables from your team's shared environment variables to use them in this project.":"Create shared environment variables to reuse across multiple projects."}},withEnvs:!0,withSecrets:!1})]}),z.modal]})}],996802)}]);

//# debugId=1c266ec2-cb4c-2463-f53e-6492fc82b58e
//# sourceMappingURL=5ad6a2a906d2f555.js.map