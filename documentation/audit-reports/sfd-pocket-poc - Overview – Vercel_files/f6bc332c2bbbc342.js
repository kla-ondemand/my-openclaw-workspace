;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="617d8a69-16e3-8485-0576-b0c7ac73c2dd")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,417184,e=>{e.v({revealContainer:"vercel-agent-build-fix-status-module__qHDxCq__revealContainer",revealText:"vercel-agent-build-fix-status-module__qHDxCq__revealText",revealTextAnimate:"vercel-agent-build-fix-status-module__qHDxCq__revealTextAnimate",softReveal:"vercel-agent-build-fix-status-module__qHDxCq__softReveal"})},1303150,e=>{"use strict";var t=e.i(4205214),s=e.i(8660982),a=e.i(9722978),n=e.i(57106),l=e.i(6352514),i=e.i(1853611),r=e.i(1681029),o=e.i(4478191),d=e.i(8518548),u=e.i(6613731),c=e.i(5338940),m=e.i(6656921),h=e.i(1895466),g=e.i(2504781),p=e.i(5838627),x=e.i(9334091),f=e.i(5468328),y=e.i(5323212),b=e.i(3500331),j=e.i(4237893);function v(e){let{deployment:s,teamId:a}=e,{method:n,setMethod:l,pathname:i,setPathname:r,microViewTab:o,setMicroViewTab:d,requestTab:u,setRequestTab:c,responseTab:v,setResponseTab:C,requestBody:I,setRequestBody:N,responseHar:w,sendRequest:k,urlBase:B,requestHeaders:S,responseHeaders:E}=(0,m.useRequestBuilder)({deploymentId:s.id,deploymentUrl:`https://${s.url}`,teamId:a}),L=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Tabs,{tabs:(0,h.makeTabs)(h.requestTabs),selected:u,setSelected:c,variant:"secondary",className:"my-1 shrink-0"}),"Body"===u?(0,t.jsx)(x.Textarea,{style:{fieldSizing:"content"},className:"flex grow font-mono h-full overflow-y-auto",value:I,onChange:e=>N(e.target.value)}):null,"Params"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:"not yet implemented"}):null,"Headers"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:(0,t.jsx)(p.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(S.reduce((e,t)=>{let{name:s,value:a}=t;return{...e,[s]:a}},{}),null,2)})}):null,"Snippets"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:"not yet implemented"}):null]}),R=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Tabs,{tabs:(0,h.makeTabs)(h.responseTabs),selected:v,setSelected:C,variant:"secondary",className:"my-1 shrink-0"}),(0,t.jsxs)("div",{className:"overflow-y-scroll",children:["Body"===v?(0,t.jsx)(p.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(w,null,2)}):null,"Headers"===v?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:(0,t.jsx)(p.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(E.reduce((e,t)=>{let{name:s,value:a}=t;return{...e,[s]:a}},{}),null,2)})}):null]})]});return(0,t.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-row",style:{borderBottom:"1px solid var(--ds-gray-400)"},children:[(0,t.jsx)(y.Select,{selectClassName:"px-2 w-[54px] rounded-none shadow-none",value:n,onChange:e=>l(e.target.value),size:"small",suffix:null,style:{borderRight:"1px solid var(--ds-gray-400)"},children:h.methods.map(e=>(0,t.jsx)("option",{value:e,children:e},e))}),(0,t.jsx)(b.Input,{"aria-label":"request builder",innerWrapperClassName:"w-full rounded-none shadow-none border-l-1",prefix:(0,t.jsx)(f.Tooltip,{text:`The request will be sent with the base path: ${B}`,children:"/"}),value:i,onChange:e=>{r(e.target.value)},size:"small"}),(0,t.jsx)(f.Tooltip,{text:"Send Request",children:(0,t.jsx)(g.Button,{style:{borderRadius:0},size:"small",onClick:k,children:"Send"})})]}),(0,t.jsxs)("div",{className:"px-3",children:[(0,t.jsx)(j.Tabs,{className:"shrink-0",tabs:(0,h.makeTabs)(h.microViewTabs),selected:o,setSelected:d,tabClassName:"py-2"}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 mt-1 max-h-full",children:["Request"===o?L:null,"Response"===o?R:null]})]})]})}var C=e.i(7087273),I=e.i(9318197),N=e.i(4450569);let w=e=>{let{title:s,message:a,link:l,action:i="Learn More",onDismiss:r}=e;return(0,t.jsxs)(N.default,{style:{padding:"var(--geist-gap)",width:"100%",height:"100%",position:"absolute"},children:[(0,t.jsx)("span",{className:"text-copy-16",children:s}),(0,t.jsx)(I.Spacer,{y:1/3}),(0,t.jsx)(N.default,{className:"min-h-0 break-words",children:(0,t.jsx)(C.Scroller,{children:(0,t.jsx)("p",{className:"text-copy-16 m-0",children:a})})}),(0,t.jsx)(I.Spacer,{y:2/3}),(0,t.jsxs)(N.default,{row:!0,style:{justifyContent:"center",alignItems:"flex-end"},children:[(0,t.jsx)(g.Button,{onClick:r,size:"small",style:{flex:"1"},type:"secondary",children:"Dismiss"}),l?(0,t.jsx)(I.Spacer,{x:.5}):null,l?(0,t.jsx)(n.ButtonLink,{href:l,size:"small",style:{flex:"1"},children:i}):null]})]})};var k=e.i(4597921),B=e.i(6159310);let S=["https://vercel.com/","https://zeit.ink/","https://vercel.link/","https://err.sh/","https://github.com/zeit/","https://github.com/vercel/"];var E=e.i(762945),L=e.i(6226725),R=e.i(2425341),T=e.i(2144405),A=e.i(1438473),D=e.i(8668470),U=e.i(3131132),_=e.i(4469437),F=e.i(1265647),O=e.i(7660824),M=e.i(417184);let P=e=>{let{vercelAgentBuildCodeSuggestion:a,buildFixTaskId:n,isLoading:l}=e,{team:i}=(0,c.useTeam)(),r=i?.vadeReview?.enabled??!1,[o,d]=(0,s.useState)("none"),[u,m]=(0,s.useState)(null),[h,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if("none"===o){if(l&&!u)m(Date.now()),g(!1);else if(!l&&u){let e=2e3-(Date.now()-u);if(e<=0)g(!0),m(null);else{let t=setTimeout(()=>{g(!0),m(null)},e);return()=>clearTimeout(t)}}}},[l,u,o]);let p="none"===o&&(l||u&&!h),x="none"!==o?o:r?p?"loading":n&&a?"build-fix-available":null:"disabled";return x?"disabled"===x?(0,t.jsxs)("div",{className:"relative mt-auto flex flex-row gap-2 justify-center",children:[null,(0,t.jsx)(B.DashboardButtonLink,{route:"/[teamSlug]/~/agent",size:"small",prefix:(0,t.jsx)(D.VercelAgent,{}),type:"secondary",className:"w-full",children:"Enable Vercel Agent to Fix Build Failures"})]}):(0,t.jsxs)("div",{className:"relative flex items-center justify-center",children:[null,(0,t.jsx)(z,{status:x,buildFixTaskId:n,suggestionId:a?.id})]}):null},$=(0,s.memo)(function(e){let{status:s}=e;return(0,t.jsx)(_.AnimatePresence,{mode:"popLayout",initial:!1,children:"build-fix-available"===s?(0,t.jsx)(F.motion.span,{className:(0,a.default)(M.default.revealContainer,"relative z-0"),style:{"--duration-factor":.48999999999999994},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,t.jsxs)("span",{className:(0,a.default)(M.default.revealText,M.default.revealTextAnimate),children:["View Suggestion",(0,t.jsx)(A.ArrowRight,{className:"inline-block ml-2 -translate-y-px"})]})},"build-fix-available"):(0,t.jsx)(F.motion.span,{className:"relative inline-block z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.13999999999999999,ease:"easeOut"},children:"Investigating failed build…"},"loading")})}),z=e=>{let{status:n,buildFixTaskId:l,suggestionId:i}=e,[r,o]=(0,s.useState)(!1),d="build-fix-available"===n;(0,s.useEffect)(()=>{if(!d)return void o(!1);let e=setTimeout(()=>{o(!0)},1120);return()=>{clearTimeout(e)}},[d]);let u=d?r?"idle":"success":"fade";return(0,t.jsx)(f.Tooltip,{text:"build-fix-available"===n?void 0:"Vercel Agent is investigating why the build failed & will suggest a fix soon.",desktopOnly:!0,children:(0,t.jsxs)(F.motion.div,{layout:!0,transition:{ease:"easeInOut",duration:.4},className:"relative",children:[(0,t.jsx)(B.DashboardButtonLink,{route:"/[teamSlug]/~/agent/tasks/[taskId]",params:d?{taskId:l}:void 0,hash:d&&i?`#suggestion-${i}`:void 0,size:"small",type:"tertiary",className:(0,a.default)("isolate relative [&>span]:w-full [&>span]:!px-0 !px-3 !rounded-full","fade"===u||"success"===u?"!text-gray-100 shadow-none pointer-events-none":"!text-gray-1000 !opacity-100 !overflow-visible"),style:{"--height":"34px"},children:(0,t.jsxs)(O.MotionConfig,{transition:{ease:"easeInOut",duration:.7},children:[(0,t.jsx)(F.motion.div,{layout:!0,className:"absolute inset-0 z-0 pointer-events-none",animate:{width:d?"186px":"228px"},style:{transformOrigin:"center center"},transition:{width:{ease:"easeOut",duration:.35,delay:1.19*!!d}},children:(0,t.jsx)(F.motion.div,{className:"absolute inset-0",initial:{backgroundColor:"var(--ds-background-100)",borderColor:"fade"===u||"success"===u?"var(--ds-gray-400)":"var(--ds-gray-1000)",borderRadius:99},animate:{backgroundColor:d?"var(--ds-gray-1000)":"var(--ds-background-100)",width:d?"186px":"228px",borderColor:"fade"===u||"success"===u?"var(--ds-gray-400)":"var(--ds-gray-1000)",borderRadius:99},style:{transformOrigin:"center center",borderWidth:1,borderStyle:"solid"},transition:{backgroundColor:{ease:"easeOut",duration:.35,delay:1.26*!!d},borderColor:{ease:"easeOut",duration:.35,delay:.126*!!d},borderRadius:{ease:"easeOut",duration:.35,delay:1.19*!!d},width:{ease:"easeOut",duration:.35,delay:1.19*!!d}}})}),(0,t.jsxs)(F.motion.span,{className:"flex gap-1 items-center relative z-10 w-fit mx-auto",children:[(0,t.jsx)(F.motion.span,{layout:!0,transition:{delay:.7*!!d,ease:"easeInOut",duration:.7},children:(0,t.jsx)(U.AgentIndicator,{animation:u})}),(0,t.jsx)("span",{className:(0,a.default)("relative isolate h-5",{"w-[134px]":"idle"===u,"w-[176px]":"idle"!==u})})]})]})}),(0,t.jsx)("span",{className:(0,a.default)("absolute right-3 top-1/2 -translate-y-1/2 isolate h-6 pointer-events-none font-medium","idle"===u?"text-gray-100":"text-gray-1000",{"w-[134px]":"idle"===u,"w-[174px]":"idle"!==u}),children:(0,t.jsx)("span",{className:"absolute inset-0 isolate overflow-clip",children:(0,t.jsx)($,{status:"fade"===u||"success"===u?"loading":"build-fix-available"})})})]})})},V=e=>{let{title:s,status:a,link:n,actionButton:l,buttonText:i,message:r,vercelAgentBuildCodeSuggestion:o,buildFixTaskId:d,isVercelAgentBuildFixLoading:u}=e;return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"border-b border-solid border-gray-alpha-400 w-full p-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["ERROR"===a?(0,t.jsx)("span",{className:"text-[var(--geist-error-light)]",children:(0,t.jsx)(E.Warning,{})}):null,"CANCELED"===a?(0,t.jsx)(L.CrossCircle,{color:"gray-900"}):null,"QUEUED"===a?(0,t.jsx)(R.Stopwatch,{color:"gray-900"}):null,"INITIALIZING"===a?(0,t.jsx)(R.Stopwatch,{color:"gray-900"}):null,(0,t.jsx)("h3",{className:"text-label-14 text-gray-1000 font-medium",children:s})]})}),(0,t.jsxs)("div",{className:"p-3 flex flex-col h-[calc(100%-45px)]",children:[(0,t.jsx)(C.Scroller,{children:(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",style:{overflowWrap:"anywhere"},children:r||"Your deployment has failed. Please check out the logs for more details."})}),(0,t.jsx)(G,{status:a,link:n,actionButton:l,buttonText:i,vercelAgentBuildCodeSuggestion:o,buildFixTaskId:d,isVercelAgentBuildFixLoading:u})]})]})},G=e=>{let{status:s,link:a,actionButton:n,buttonText:l,vercelAgentBuildCodeSuggestion:i,buildFixTaskId:r,isVercelAgentBuildFixLoading:o}=e,d=(0,k.useServerFlag)("project-agent-build-fix",!1);return"https://vercel.link/CVE-2025-66478"===a&&a?(0,t.jsxs)("div",{className:"mt-auto flex flex-row gap-2 *:flex-1",children:[(0,t.jsx)(Q,{buttonText:l,link:a,status:s}),(0,t.jsx)(B.DashboardButtonLink,{route:"/[teamSlug]/[project]/fix/[fixType]",params:{fixType:"react2shell"},size:"small",children:"Upgrade"})]}):d&&(o||i&&r)?(0,t.jsx)(P,{vercelAgentBuildCodeSuggestion:i,buildFixTaskId:r,isLoading:o}):a||n?(0,t.jsxs)("div",{className:"mt-auto flex flex-col gap-y-2",children:[a?(0,t.jsx)(Q,{buttonText:l,link:a,status:s}):(0,t.jsx)(I.Spacer,{y:1/6}),n??null]}):null},q=e=>{e.preventDefault();let t=document.querySelector("[data-status=error]");t&&("open"!==t.dataset.state&&t.querySelector("button")?.click(),t.scrollIntoView({behavior:"smooth"}))},Q=e=>{let{status:s,link:a,buttonText:l}=e;return"string"==typeof a&&S.some(e=>a.startsWith(e))?(0,t.jsx)(n.ButtonLink,{href:a,size:"small",type:"secondary",children:"Learn More"}):"QUEUED"===s&&a?(0,t.jsx)(n.ButtonLink,{href:a,size:"small",children:l||"Add Concurrent Builds"}):(0,t.jsx)(g.Button,{passthroughOnClick:q,type:"secondary",children:"View Logs"})};var H=e.i(5255926),W=e.i(5677444),K=e.i(6280036),Y=e.i(6677848);function J(e,t){switch(t.type){case"LIGHT_IMAGE_LOADING":return{...e,lightImage:"pending"};case"LIGHT_IMAGE_SUCCESS":return{...e,lightImage:"success"};case"LIGHT_IMAGE_FAILURE":return{...e,lightImage:"failure"};case"DARK_IMAGE_LOADING":return{...e,darkImage:"pending"};case"DARK_IMAGE_SUCCESS":return{...e,darkImage:"success"};case"DARK_IMAGE_FAILURE":return{...e,darkImage:"failure"};default:return e}}let Z={lightImage:"pending",darkImage:"pending"};function X(e,t,s,a,n){let l=new URL(n?"/api/screenshot/v2":"/api/screenshot","production"!==T.default.env.VERCEL_ENV&&T.default.env.VERCEL_URL?`https://${T.default.env.VERCEL_URL}`:"https://vercel.com");return t?(l.searchParams.set("dark","dark"===e?"1":"0"),l.searchParams.set("deploymentId",t),s&&l.searchParams.set("teamId",s),a&&l.searchParams.set("withStatus","1"),`${l.pathname}${l.search}`):""}function ee(e){let{srcLight:s,srcDark:a,onLoad:n,onError:l,alt:i}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(et,{alt:i,className:"absolute block size-full dark:hidden",onError:()=>l("light"),onLoad:()=>n("light"),src:s}),(0,t.jsx)(et,{alt:i,className:"absolute hidden size-full dark:block",onError:()=>l("dark"),onLoad:()=>n("dark"),src:a})]})}function et(e){let{src:n,onLoad:l,renderScale:i=3,onError:r,className:o,alt:d}=e,u=(0,s.useRef)(null),c=(0,s.useRef)(null),[m,h]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=u.current;if(!e)return;c.current||(c.current=new Image);let t=c.current,s=()=>{let s=e.getContext("2d");if(!s)return;let a=e.offsetWidth,n=e.offsetHeight,l=a*i,r=n*i;e.width=l,e.height=r,s.scale(i,i),s.clearRect(0,0,l,r);let o=Math.min(a/t.width,n/t.height),d=a/2-t.width/2*o;s.drawImage(t,d,0,t.width*o,t.height*o)};if(t.src===n)return;t.src=n,t.onload=()=>{l(),h(!0),s()},t.onerror=()=>{r()};let a=()=>{s()};return window.addEventListener("resize",a),a(),()=>{window.removeEventListener("resize",a)}},[n,i]),(0,t.jsx)("canvas",{"aria-hidden":"true","aria-label":d,className:(0,a.clsx)(o,"size-full",{"animate-blurIn":m}),ref:u,role:"img",style:{width:"100%",height:"100%"}})}let es=s.default.memo(e=>{let{deployment:n,placeholder:l,noBorderRadius:i=!1,withReachable:r=!1,withImageWrapper:o=!0,onReady:d,height:u=400,width:c=640,onScreenshotFailed:m=()=>null}=e,h="string"==typeof n?.url?n.url:"",g="string"==typeof n?.id?n.id:void 0,p=c?{"--width":(0,Y.px)(c)}:{},{teamSlug:x=""}=(0,W.useParams)()??{},f=(0,k.useServerFlag)("enable-screenshot-v2",!1),y=(0,s.useMemo)(()=>X("dark",g,x,r,f),[g,x,r,f]),b=(0,s.useMemo)(()=>X("light",g,x,r,f),[g,x,r,f]),[j,v]=(0,s.useReducer)(J,Z),{resolvedTheme:C}=(0,K.useTheme)(),I=(0,s.useCallback)(e=>{void 0===e?(v({type:"LIGHT_IMAGE_SUCCESS"}),v({type:"DARK_IMAGE_SUCCESS"})):v({type:"dark"===e?"DARK_IMAGE_SUCCESS":"LIGHT_IMAGE_SUCCESS"}),d?.(!0)},[d]),N=(0,s.useCallback)(e=>{y&&b&&(void 0===e?(v({type:"LIGHT_IMAGE_FAILURE"}),v({type:"DARK_IMAGE_FAILURE"}),d?.(!1)):("dark"===e?y:b)&&(v({type:"dark"===e?"DARK_IMAGE_FAILURE":"LIGHT_IMAGE_FAILURE"}),d?.(!1)))},[d,y,b]),w="dark"===C?"failure"===j.darkImage:"failure"===j.lightImage,B=l||("dark"===C?"pending"===j.darkImage:"pending"===j.lightImage);if(w||!B&&!n)return m();let S=(0,t.jsx)(ee,{alt:`Preview Screenshot of ${h}`,onError:N,onLoad:I,srcDark:y,srcLight:b});return(0,t.jsx)(H.Skeleton,{show:B,squared:i,style:{width:"100%",height:"100%"},children:o?(0,t.jsx)("div",{className:(0,a.clsx)("relative aspect-[var(--width,640)/var(--height,400)] size-full",{"rounded-none":i}),style:u?{"--height":(0,Y.px)(u),...p}:{},children:S}):S})});var ea=e.i(7917902),en=e.i(6060673),el=e.i(5129431),ei=e.i(6625227),er=e.i(5072965),eo=e.i(6891161),ed=e.i(455575),eu=e.i(277234),ec=e.i(4244280),em=e.i(1717203),eh=e.i(7557283),eg=e.i(7780974);function ep(e){let a=(0,W.useRouter)(),[l,r]=(0,s.useState)(!1),o=(0,ed.useToasts)(),{can:d}=(0,em.default)(),u=d(eh.Action.Update,eh.Resource.BuildMachine),c=(0,s.useCallback)(async()=>{if(e.deploymentId&&e.teamId&&e.projectName){r(!0),i.analytics.track(eg.VercelActivityAction.DeploymentOverviewEnhancedBuildUpgrade,{},{send_to:{data_warehouse_legacy:!0}});{let t=new URLSearchParams;t.append("teamId",e.teamId),200===(await (0,eu.fetchAPI)(`${(0,ec.API_PROJECTS_VERSION)("v9")}/${e.projectName}?${t.toString()}`,{method:"PATCH",body:JSON.stringify({resourceConfig:{elasticConcurrencyEnabled:!0,buildMachineType:e.buildMachineType}}),throwOnHTTPError:!1,returnStatus:!0})).status?o.success(`Enabled ${e.buildMachineTypeLabel}`):(o.error("Something went wrong"),r(!1),e.onClose())}{let t=new URLSearchParams;t.append("teamId",e.teamId),t.append("forceNew","1"),t.append("withCache","1");let s=`${(0,ec.API_DEPLOYMENTS)("v13")}?${t.toString()}`,n=await (0,eu.fetchAPI)(s,{method:"POST",body:JSON.stringify({deploymentId:e.deploymentId,meta:{action:"redeploy",buildMachineUpgradeReason:e.upgradeReasonCode,buildMachineAfterUpgrade:e.buildMachineType},name:e.projectName}),throwOnHTTPError:!1,returnStatus:!0});if(200===n.status&&n.body.inspectorUrl){e.onSuccess?.();let t=new URL(n.body.inspectorUrl);a.push(t.pathname)}else o.error("Something went wrong")}r(!1)}},[e,o,a]);return(0,t.jsxs)(eo.Modal.Modal,{active:e.active,onClickOutside:e.onClose,width:"500px",children:[(0,t.jsxs)(eo.Modal.Body,{children:[(0,t.jsx)(eo.Modal.Header,{children:(0,t.jsx)(eo.Modal.Title,{children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:["Enable ",e.buildMachineTypeLabel]})})}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["Overcome memory constraints by activating On-demand Concurrency with"," ",e.buildMachineTypeLabel,"."]}),e.teamId&&e.projectName?(0,t.jsxs)("p",{className:"text-copy-14",children:["Adjust this setting anytime via your project's"," ",(0,t.jsx)(n.Link,{as:`/${e.teamId}/${encodeURIComponent(e.projectName)}/settings/build-and-deployment#build-machine`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",variant:"highlight",children:"On-Demand Concurrent Builds"})," ","options."]}):null,(0,t.jsxs)("p",{className:"text-copy-14",children:['By clicking "Confirm & Redeploy" you agree to be charged for On-demand Concurrency.'," ",(0,t.jsx)(n.Link,{href:"/docs/deployments/managing-builds#build-machine-types",target:"_blank",variant:"highlight",children:"Learn more"})]})]})]}),(0,t.jsxs)(eo.Modal.Actions,{children:[(0,t.jsx)(eo.Modal.Action,{loading:!1,onClick:e.onClose,type:"secondary",children:"Close"}),(0,t.jsx)(f.Tooltip,{text:u?void 0:`You don't have permission to Enable ${e.buildMachineTypeLabel}.`,children:(0,t.jsx)(eo.Modal.Action,{disabled:l||!u,loading:l,onClick:c,children:"Confirm & Redeploy"})})]})]})}function ex(e){let{deploy:a,projectName:n,team:l,vercelAgentBuildCodeSuggestion:i,buildFixTaskId:r,isVercelAgentBuildFixLoading:o}=e,{errorMessage:d="Your deployment has failed. Please check out the logs for more details.",errorLink:u=""}=a,c=(0,W.useRouter)(),m=(0,W.useSearchParams)(),h=(0,en.useProject)(n),p=!!m?.has("enabledEnhancedBuilds"),x=(0,s.useMemo)(()=>h.isLoading||!h.data?null:void 0===h.data.resourceConfig||!1===h.data.resourceConfig.elasticConcurrencyEnabled||void 0===h.data.resourceConfig.buildMachineType?"enhanced":"enhanced"===h.data.resourceConfig.buildMachineType?"turbo":null,[h]),f=(0,s.useCallback)(()=>{let e=new URLSearchParams(m?.toString());e.set("enabledEnhancedBuilds","1"),c.replace(`?${e.toString()}`)},[m,c]),y=(0,s.useCallback)(()=>{if(!m?.has("enabledEnhancedBuilds"))return;let e=new URLSearchParams(m?.toString());e.delete("enabledEnhancedBuilds"),c.replace(`?${e.toString()}`)},[m,c]);if(x){let e="out-of-memory"===a.oomReport,s="Your deployment's build step did not complete within the maximum of 45min"===d,i=`${x[0].toUpperCase()+x.slice(1)} Builds`,r=(0,er.createTrackingAttributes)({id:"enable-enhanced-builds-modal-opened",upgradeTarget:x??"",plan:l?.billing?.plan??""});if(e||s){let d,u,c;if(e)d="Build Failed (out of memory)",u=`Your build failed because it exceeded the amount of memory available. Enable ${i} to increase machine size and available memory.`,c=a.oomReport||"out-of-memory";else if(s)d="Build Failed (timed out)",u=`Your build exceeded the 45 minute limit. Enable ${i} to increase machine size and reduce build times.`,c="build-timed-out";else throw Error("This should never happen, satisfy typescript");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V,{title:d,message:u,status:"ERROR",actionButton:(0,t.jsxs)(g.Button,{className:"w-full",onClick:f,size:"small",type:"default",...r,children:["Enable ",i]}),isVercelAgentBuildFixLoading:o}),(0,t.jsx)(ep,{active:p,buildMachineType:x,buildMachineTypeLabel:i,deploymentId:a.id||null,onClose:y,upgradeReasonCode:c,projectName:n??null,teamId:l.slug})]})}}return(0,t.jsx)(V,{link:u,message:d,status:"ERROR",title:"Build Failed",vercelAgentBuildCodeSuggestion:i,buildFixTaskId:r,isVercelAgentBuildFixLoading:o})}e.i(6483798);var ef=e.i(8287059),ey=e.i(9041876);function eb(e){let{team:a,projectName:n}=e,l=(0,en.useProject)(n),i=(0,s.useMemo)(()=>!l.isLoading&&l.data&&a?{enhancedBuilds:(0,ey.isUpgradedBuildMachine)(l.data,a),onDemandBuilds:l.data.resourceConfig?.elasticConcurrencyEnabled??!1}:null,[l,a]);return i&&a&&n?a?.billing?.plan==="hobby"?(0,t.jsx)(ej,{team:a}):i.onDemandBuilds&&i.enhancedBuilds?(0,t.jsx)(eC,{}):i.enhancedBuilds?(0,t.jsx)(ev,{upgradeMessage:"Enable On-Demand Concurrent Builds to skip all queueing and build instantly.",projectName:n,team:a,settings:i,settingsHash:"#on-demand-concurrent-builds",buttonText:"Configure"}):(0,t.jsx)(ev,{upgradeMessage:"Switch to Enhanced Build Machines for faster builds with more CPU and memory.",projectName:n,team:a,settings:i,settingsHash:"#build-machine",buttonText:"Get Faster Builds"}):(0,t.jsx)(eC,{})}function ej(e){let s,{team:a}=e,l=(0,ef.useOpenUpgradeModal)();return(0,t.jsx)(V,{message:"Upgrade to Pro for faster builds with more CPU and memory.",status:"BUILDING",title:"Building…",actionButton:(s=(0,er.createTrackingAttributes)({section:"deployment-status",onDemandBuildsEnabled:"0",id:"faster-builds",plan:a?.billing?.plan??""}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.ButtonLink,{href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",target:"_blank",className:"w-full",size:"small",type:"secondary",children:"Read Docs"}),(0,t.jsx)(g.Button,{className:"w-full",size:"small",type:"default",onClick:()=>{l({teamHint:a.id,source:"deployment-building-status"})},...s,children:"Get Faster Builds with Pro"})]})),isVercelAgentBuildFixLoading:!1})}function ev(e){let s,{projectName:a,team:l,upgradeMessage:i,settings:r,settingsHash:o,buttonText:d}=e;return(0,t.jsx)(V,{message:i,status:"BUILDING",title:"Building…",actionButton:(s=(0,er.createTrackingAttributes)({section:"deployment-status",onDemandBuildsEnabled:r.onDemandBuilds?"1":"0",id:"faster-builds",plan:l?.billing?.plan??""}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.ButtonLink,{href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",target:"_blank",className:"w-full",size:"small",type:"secondary",children:"Read Docs"}),(0,t.jsx)(n.ButtonLink,{href:`/${l.slug}/${encodeURIComponent(a)}/settings/build-and-deployment${o}`,className:"w-full",size:"small",type:"default",...s,children:d})]})),isVercelAgentBuildFixLoading:!1})}function eC(){return(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Building..."})}var eI=e.i(8366444),eN=e.i(380513),ew=e.i(5023172),ek=e.i(542164),eB=e.i(4411675);function eS(e,t){let s=t?.name||e.url;return!s||(0,ek.default)(s)?e.url:s}function eE(e){return null!=e&&"project"in e}function eL(){let e=(0,W.useSearchParams)();return(0,s.useMemo)(()=>{let t=e?.get("fakeDeploymentStatus")??null,s=e?.get("fakeBillingPlan")??null;return{status:t?.toUpperCase(),plan:s?.toLowerCase()}},[e])}let eR=["nitro","express","fastapi","hono","xmcp"],eT=new Map([["enterprise-non-unbundled","Contact sales to enable On-Demand Concurrent Builds"],["pro-non-active","Upgrade to Pro to enable On-Demand Concurrent Builds"],["no-permission","Only project admins and team owners can trigger builds on-demand"]]);function eA(e){let{deploy:a,projectName:l,team:i,user:r,isInSystemBuildsQueue:o,isInConcurrentBuildsQueue:d,compact:u}=e,{data:c}=(0,eN.useFeatureFlag)("enable-team-deployments-page"),m=a.target?eh.Resource.Deployment:eh.Resource.DeploymentPreview,{can:h}=(0,em.default)(),g=h(eh.Action.Update,m),[p,x]=(0,s.useState)(null),f="string"==typeof a.id?a.id:void 0,{enabled:y,disabledReason:b}=(0,eI.useOnDemandConcurrentBuilds)(i,g),j=y||b&&eT.has(b),v=b?eT.get(b):void 0,[C,I]=(0,s.useState)(y),N=j?(0,t.jsx)(eF,{enabled:C,onClick:()=>x(f??null),reasonWhyStartBuildingNowIsDisabled:v}):null,w=eL();if(o)return(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Initializing..."});let k="Deployments",B=c?(0,t.jsx)(n.Link,{href:`/${i.slug}/~/deployments?status=building%2Cqueued`,underline:!0,children:k}):k;if(d){let e=w.plan?w.plan:i.billing?.plan;if("enterprise"===e)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eD,{team:i,user:r,deployments:B,projectName:l,startBuildNowButton:N}),(0,t.jsx)(ew.StartBuildingNowModal,{active:!!p,deploymentId:p,onClose:()=>{x(null)},onSuccess:()=>{I(!1)},projectName:l??null,teamId:i.slug})]});if("pro"===e)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eU,{team:i,deployments:B,projectName:l,startBuildNowButton:N}),(0,t.jsx)(ew.StartBuildingNowModal,{active:!!p,deploymentId:p,onClose:()=>{x(null)},onSuccess:()=>{I(!1)},projectName:l??null,teamId:i.slug})]});if("hobby"===e)return(0,t.jsx)(e_,{team:i,deployments:B})}return u?(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Deployment Queued"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once other"," ",l?(0,t.jsx)(n.Link,{href:`/${i.slug}/${l}/deployments?status=building%2Cqueued`,underline:!0,children:k}):k," ","for this branch have finished."," ",(0,t.jsx)(n.Link,{href:"/docs/builds/build-queues#git-branch-queue",underline:!0,children:"Learn more."})]}),actionButton:N,status:"QUEUED",title:"Deployment Queued",isVercelAgentBuildFixLoading:!1}),(0,t.jsx)(ew.StartBuildingNowModal,{active:!!p,deploymentId:p,onClose:()=>{x(null)},onSuccess:()=>{I(!1)},projectName:l??null,teamId:i.slug})]})}function eD(e){let{team:s,user:a,deployments:l,projectName:i,startBuildNowButton:r}=e,o=new URLSearchParams({content:"I'd like to add extra concurrent builds to my contract."});return a?.email&&o.set("email",a.email),(0,t.jsx)(V,{actionButton:r,status:"QUEUED",title:"Deployment Queued",message:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsxs)("div",{children:["The build will start once your other ",l," have finished."]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.Link,{href:`/contact/sales?${o.toString()}`,underline:!0,children:"Contact Sales"})," ","to add concurrent build slots or use"," ",(0,t.jsx)(n.Link,{as:`/${s.slug}/${encodeURIComponent(i??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]})]}),isVercelAgentBuildFixLoading:!1})}function eU(e){let{team:s,deployments:a,projectName:l,startBuildNowButton:i}=e,r=(s?.billing?.invoiceItems?.concurrentBuilds?.quantity??1)>1,o=s.billing?.planIteration!=="plus"||r?(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",a," have finished. Add"," ",(0,t.jsx)(n.Link,{as:`/${s.slug}/~/settings/build-and-deployment#concurrent-builds`,href:"/[teamSlug]/~/settings/build-and-deployment#concurrent-builds",target:"_blank",underline:!0,children:"concurrent build slots"})," ","or use"," ",(0,t.jsx)(n.Link,{as:`/${s.slug}/${encodeURIComponent(l??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]}):(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",a," have finished. Use"," ",(0,t.jsx)(n.Link,{as:`/${s.slug}/${encodeURIComponent(l??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]});return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(V,{message:o,actionButton:i,status:"QUEUED",title:"Deployment Queued",isVercelAgentBuildFixLoading:!1})})}function e_(e){let{deployments:s,team:a}=e,n=(0,ef.useOpenUpgradeModal)();return(0,t.jsx)(V,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",s," have finished. Pro teams can use On-Demand Concurrent Builds to avoid the queue."]}),status:"QUEUED",title:"Another build is in progress",actionButton:(0,t.jsx)(g.Button,{onClick:()=>{n({teamHint:a.id,source:"concurrent-builds-queue"})},size:"small",type:"default",children:"Upgrade to Pro"}),isVercelAgentBuildFixLoading:!1})}function eF(e){let{onClick:s,enabled:a,reasonWhyStartBuildingNowIsDisabled:n}=e;return void 0!==n?(0,t.jsx)(f.Tooltip,{position:"right",style:{alignItems:"center",flex:"1",justifyContent:"center",width:"100%"},text:n,children:(0,t.jsx)(g.Button,{disabled:!0,size:"small",style:{alignItems:"center",flex:"1",justifyContent:"center"},children:"Start Building Now"})}):(0,t.jsx)(g.Button,{disabled:!a,onClick:s,size:"small",type:"default",children:"Start Building Now"})}let eO=e=>{let{deploy:s,projectName:a}=e,n=(0,en.useProject)(a),{data:l}=(0,ei.default)(s.id),{modal:i,open:r}=(0,el.default)(n.data),o=(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{children:"An unexpected error happened when running this build. This issue is likely temporary."}),(0,t.jsx)("p",{children:"Please try to redeploy in a few minutes."})]})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V,{message:o,status:"ERROR",title:"Build Failed",isVercelAgentBuildFixLoading:!1,actionButton:(0,t.jsx)(g.Button,{className:"w-full",disabled:!l,onClick:()=>{l&&r(l)},size:"small",type:"default",children:"Redeploy"})}),i]})};function eM(e){let{deploy:s,showError:a,isInConcurrentBuildsQueue:n,isInSystemBuildsQueue:l,compact:i,projectName:r,vercelAgentBuildCodeSuggestion:o,buildFixTaskId:d,isVercelAgentBuildFixLoading:u=!1}=e,{status:c,errorMessage:m,errorLink:h=""}=s,g=c,p=eL();p?.status&&(g=p.status);let{user:x,team:y}=(0,ea.useAccount)();return y?"ERROR"===g?a?"temporary_failure"===s.errorCode?(0,t.jsx)(eO,{deploy:s,projectName:r}):(0,t.jsx)(ex,{deploy:s,team:y,projectName:r,vercelAgentBuildCodeSuggestion:o,buildFixTaskId:d,isVercelAgentBuildFixLoading:u}):(0,t.jsx)("p",{className:"m-auto text-center text-sm text-red-600",children:"Deployment Failed"}):"FROZEN"===g||"FAILED"===g?(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"No Screenshot Available"}):"NO_PRODUCTION"===g?(0,t.jsx)(f.Tooltip,{className:"m-auto text-center",delay:!1,text:"To deploy to production, push to the Repository Default branch.",children:(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"No Production Deployment"})}):"CANCELED"===g?a&&m?(0,t.jsx)(V,{link:h,message:m||"Deployment canceled.",status:g,title:"Build Canceled",isVercelAgentBuildFixLoading:!1}):(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Deployment Canceled"}):"QUEUED"===g||"INITIALIZING"===g?(0,t.jsx)(eA,{deploy:s,projectName:r,isInConcurrentBuildsQueue:n,isInSystemBuildsQueue:l,compact:i,user:x,team:y}):(0,t.jsx)(eb,{team:y,projectName:r}):(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Loading…"})}var eP=e.i(8783592),e$=e.i(4628083);e.s(["DeploymentPreview",0,function(e){let{deployment:m,ignoreAliasWarning:h=!0,placeholder:g,toolbarVia:p,customHref:x,compact:f,...y}=e,{showError:b=!1,link:j=!0,empty:C=!1,noHighlight:I,noBorder:N,noBorderRadius:B,useDeploymentUrl:S=!1,onClick:E}=y,L=eE(m)?m.project?.name:void 0,{domain:R}=(0,d.useBestProductionDomain)(L),T=R||y.projectDomain||null,A=(0,k.useServerFlag)("request-builder",!1),[D,U]=function(e){let t=(0,s.useMemo)(()=>e?new eB.LSCache(`show-deployment-warning:${e.uid||e.id}`,!0):null,[e]),[a,n]=(0,s.useState)(()=>{let e=t?.get();return"boolean"!=typeof e||e});return[a,e=>{t?.set(e),n(e)}]}(m),{onClick:_,...F}=(0,u.useWrappedToolbarAuthLinkHandler)({via:p??"project-screenshot",deployment:j?m:void 0}),{team:O}=(0,c.useTeam)(),M=function(e){if(!e||!("microfrontends"in e)||!e.microfrontends)return!1;let t=e.microfrontends;return!t.isDefaultApp&&!t.defaultRoute}(m),P=`/${O?.slug}/${L}/settings/microfrontends#default-route`,$=(()=>{let e=(0,W.useParams)(),{data:t}=(0,en.useProject)(e?.project);return!!t&&"framework"in t&&!!t.framework&&!!eR.includes(t?.framework)})(),z=eE(m)?m.uid||m.id:void 0,G=m?.readyState==="ERROR",{data:q,isEnabled:Q}=(0,eP.useVadeTasksByDeployment)(z,G),H=(0,e$.getVercelAgentBuildFixCodeSuggestion)(q)??void 0,K=q?.id,Y=G&&Q&&void 0===H,J=(0,s.useMemo)(()=>{if(!m)return C?{status:"NO_PRODUCTION"}:null;let e=S?m.url:eS(m,T),t=m.readyStateReason||m.errorMessage;return m.readyStateReason?.startsWith("The deployment failed to build.")&&m.errorMessage&&(t=m.errorMessage),{id:m.uid||m.id,url:e,target:m.target,status:m.readyState,errorCode:m.errorCode,errorMessage:t,errorLink:m.errorLink,aliasWarning:m.aliasWarning,oomReport:m.oomReport}},[S,m,C,T]),Z=!h&&D&&J?.status==="READY"&&J?.aliasWarning?.code==="deprecated_now_sh",X=J&&"READY"!==J.status,ee=J?.status==="ERROR"||m?.aliasError,et=(0,s.useCallback)(()=>(0,t.jsx)(eM,{vercelAgentBuildCodeSuggestion:H,buildFixTaskId:K,deploy:{...J,status:"FAILED"},isInConcurrentBuildsQueue:m?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:m?.isInSystemBuildsQueue,projectName:L,showError:b,isVercelAgentBuildFixLoading:Y}),[J,b,L,m?.isInConcurrentBuildsQueue,m?.isInSystemBuildsQueue,H,K,Y]),ea=(0,s.useMemo)(()=>m?.aliasError?(0,t.jsx)(V,{message:m.aliasError.message,status:"ERROR",title:"Domain Error",isVercelAgentBuildFixLoading:!1}):Z?(0,t.jsx)(w,{link:J.aliasWarning.link,message:J.aliasWarning.message,onDismiss:()=>U(!1),title:"Warning"}):X?(0,t.jsx)(eM,{compact:f,deploy:J,isInConcurrentBuildsQueue:m?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:m?.isInSystemBuildsQueue,projectName:L,showError:b,vercelAgentBuildCodeSuggestion:H,buildFixTaskId:K,isVercelAgentBuildFixLoading:Y}):M?(0,t.jsxs)("div",{className:"flex flex-col gap-2 p-6",children:[(0,t.jsx)("p",{className:"text-heading-16",children:"Default Route Missing"}),(0,t.jsxs)("p",{className:"text-copy-14 text-[var(--geist-secondary)]",children:[(0,t.jsx)(n.Link,{href:P,underline:!0,children:"Set the default route"})," ","for this microfrontend to screenshot the correct path. The default route is used anywhere that the microfrontend domain is referenced for this project."," ",(0,t.jsx)(n.Link,{external:!0,href:"/docs/microfrontends/managing-microfrontends#set-a-default-route",tab:!0,type:"highlight",children:"Learn More"})]})]}):$&&A?(0,t.jsx)(v,{deployment:m,teamId:O?.id}):j&&m?.url?(0,t.jsx)(n.Link,{"aria-label":"Visit Deployment",href:x||(0,o.withDefaultRoute)((0,r.domainToUrl)(S?m.url:eS(m,T)),m.defaultRoute),...F,onClick:e=>{E?.(e),_?.(e),i.analytics.track(l.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_SCREENSHOT,{projectId:m.projectId||T?.projectId,deploymentId:m.id,deploymentTarget:m.target})},style:{width:"100%"},tab:!0,children:(0,t.jsx)(es,{deployment:J,onScreenshotFailed:et,placeholder:g,withReachable:!0,...y})}):(0,t.jsx)(es,{deployment:J,onScreenshotFailed:()=>(0,t.jsx)(eM,{vercelAgentBuildCodeSuggestion:H,buildFixTaskId:K,deploy:{...J,status:"FAILED"},isInConcurrentBuildsQueue:m?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:m?.isInSystemBuildsQueue,projectName:L,showError:b,isVercelAgentBuildFixLoading:Y}),placeholder:g,withReachable:!0,...y}),[J,m,j,T,y,U,X,Z,b,S,et,g,L,E]);return(0,t.jsx)("div",{className:(0,a.clsx)("geist-ratio","size-full p-0","relative after:absolute after:inset-0 after:ring-1 after:ring-inset after:ring-[var(--ds-gray-alpha-400)] after:rounded-[inherit] after:pointer-events-none","rounded-[var(--geist-radius)]","flex flex-none justify-center","overflow-hidden","aspect-[640/400]",{"w-screen max-w-full":X,"bg-[var(--ds-background-200)]":J?.status==="CANCELED"||J?.status==="QUEUED"||J?.status==="INITIALIZING"||J?.status==="FROZEN"||J?.status==="FAILED",group:!I,"after:ring-[var(--geist-error-light)]":ee,"after:ring-[var(--ds-amber-400)]":Z,"min-w-[108px]":J?.status==="NO_PRODUCTION","after:ring-0":N,"rounded-none":B}),style:{"--ratio":"62.5%"},children:ea})}],1303150)}]);

//# debugId=617d8a69-16e3-8485-0576-b0c7ac73c2dd
//# sourceMappingURL=8013f06ed0c1a245.js.map