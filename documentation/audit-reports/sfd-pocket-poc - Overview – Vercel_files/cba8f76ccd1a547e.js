;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="c6bb8449-35db-0004-c43b-6ed1765c11aa")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5976989,e=>{"use strict";e.i(2144405);var t=e.i(4205214),a=e.i(8660982),i=e.i(3500331),n=e.i(6891161),r=e.i(7749291),l=e.i(57106);e.i(8703064);var o=e.i(648779),s=e.i(6838069),c=e.i(2521731);function d(e){let{isOpen:a,searchQuery:i,matchingIntegrations:d,isSubmitting:u,submitSuccess:g,teamSlugOrPublic:p,isFromV0:m,onBack:h,onSubmitAnyway:x,onClose:f}=e;return(0,t.jsxs)(n.Modal.Modal,{active:a,onClickOutside:()=>{u||f()},children:[(0,t.jsxs)(n.Modal.Body,{children:[(0,t.jsxs)(n.Modal.Header,{children:[(0,t.jsxs)(n.Modal.Title,{children:["We found some options for “",i,"”"]}),(0,t.jsx)(n.Modal.Subtitle,{children:"These integrations might be what you're looking for."})]}),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:d.flatMap(e=>{let a=i.toLowerCase().trim(),n=e.products.filter(e=>{let t=e.name.toLowerCase().includes(a),n=(0,c.searchMatchesKV)(i)&&(e.tags?.includes("kv")||e.tags?.includes("redis")),r=(0,c.searchMatchesPostgres)(i)&&e.tags?.some(e=>e.toLowerCase().startsWith("postgres"));return!!t||!!n||!!r});return(n.length>0?n:e.products).map(a=>{let i=a?.iconUrl||e.icon;return(0,t.jsxs)(l.Link,{href:(0,s.getIntegrationDetailsLink)({integrationSlug:e.slug,teamSlugOrPublic:p??{isPublic:!0},isFromV0:m}),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-gray-400 hover:bg-gray-50 transition-colors no-underline",children:[(0,t.jsx)(o.ProductIcon,{icon:i,size:"medium"}),(0,t.jsxs)("div",{className:"flex flex-col gap-0.5 min-w-0 flex-1",children:[(0,t.jsx)("span",{className:"font-medium text-gray-1000",children:a?.name||e.name}),(0,t.jsx)("span",{className:"text-sm text-gray-700 truncate",children:a?.shortDescription||e.shortDescription})]}),(0,t.jsx)(r.ExternalSmall,{className:"size-4 text-gray-500 flex-shrink-0"})]},a.id)})})})]}),(0,t.jsxs)(n.Modal.Actions,{children:[(0,t.jsx)(n.Modal.Action,{onClick:h,type:"secondary",children:"Back"}),(0,t.jsx)(n.Modal.Action,{disabled:!i.trim()||g,loading:u,onClick:x,children:g?"Submitted!":`Request "${i}" anyway`})]})]})}e.s(["RequestIntegrationModal",0,function(e){let{isOpen:r,onClose:l,category:o,isAgentCategory:s=!1,categoryTitle:u="Integration",integrations:g=[],teamSlugOrPublic:p,isFromV0:m}=e,[h,x]=(0,a.useState)(""),[f,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),C=(0,a.useMemo)(()=>{let e=h.trim();return 0===g.length||e.length<2?[]:g.filter(t=>(0,c.integrationMatchesSearch)(t,e))},[h,g]),I=s?"Request an Agent":"Request an Integration",S=s?"Not seeing what you need? Request an agent you'd like to use in a project.":`Not seeing the ${u} you need? Request an integration you'd like to use in a project.`,k=s?"Agent name":"Integration name",P=(0,a.useCallback)(()=>{f||(l(),x(""),j(!1),w(!1))},[f,l]),N=(0,a.useCallback)((e,t)=>{if(e.preventDefault(),f||!h.trim())return;if(C.length>0&&!v&&!t?.bypassSuggestions)return void w(!0);b(!0);let a=s?"agent":"integration",i=o?` (Category: ${o})`:"";fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:"localhost"===window.location.hostname?`https://vercel.com/dev-mode${window.location.pathname}`:window.location.toString(),note:`Requested ${a}: ${h.trim()}${i}`,topic:"Marketplace and Integrations",ua:`front production + ${navigator.userAgent} (${navigator.language||"unknown language"})`})}).then(()=>{j(!0),setTimeout(()=>{l(),x(""),j(!1),w(!1)},2e3)}).catch(e=>{console.error("Failed to submit request:",e)}).finally(()=>{b(!1)})},[h,f,s,o,l,C.length,v]);return(0,t.jsx)(t.Fragment,{children:v?(0,t.jsx)(d,{isOpen:r,searchQuery:h,matchingIntegrations:C,isSubmitting:f,submitSuccess:y,teamSlugOrPublic:p,isFromV0:m,onBack:()=>w(!1),onSubmitAnyway:()=>{N(new Event("submit"),{bypassSuggestions:!0})},onClose:P}):(0,t.jsxs)(n.Modal.Modal,{active:r,onClickOutside:P,children:[(0,t.jsxs)(n.Modal.Body,{children:[(0,t.jsxs)(n.Modal.Header,{children:[(0,t.jsx)(n.Modal.Title,{children:I}),(0,t.jsx)(n.Modal.Subtitle,{children:S})]}),(0,t.jsx)("form",{onSubmit:N,children:(0,t.jsx)(i.Input,{autoFocus:!0,"aria-labelledby":"agent-name-input",disabled:f||y,id:"agent-name-input",onChange:e=>x(e.target.value),placeholder:k,value:h})})]}),(0,t.jsxs)(n.Modal.Actions,{children:[(0,t.jsx)(n.Modal.Action,{onClick:P,type:"secondary",disabled:f,children:"Cancel"}),(0,t.jsx)(n.Modal.Action,{disabled:!h.trim()||y,loading:f,onClick:()=>N(new Event("submit")),children:y?"Submitted!":"Submit"})]})]})})}],5976989)},2483928,6663213,9621575,7045711,431597,4272280,6345985,9120086,2660880,e=>{"use strict";var t=e.i(4205214),a=e.i(8660982),i=e.i(57106),n=e.i(5677444),r=e.i(1853611),l=e.i(8794163);e.i(8703064);var o=e.i(648779),s=e.i(4877814),c=e.i(6838069),d=e.i(4004502),u=e.i(3306538),g=e.i(2504781),p=e.i(5255926),m=e.i(2713868),h=e.i(5468328),x=e.i(7807822),f=e.i(6835270),b=e.i(397094),y=e.i(3758860),j=e.i(9243747);e.i(6887680);var v=e.i(6810699),w=e.i(9668517);function C(e){let{integration:t,marketplaceConfigurations:a}=e,i=(0,w.useTeamSlug)(),n=(0,j.getIntegrationOps)({integration:t}).isSingleProductLayout(),{data:r}=(0,v.useResourceList)({integrationIdOrSlug:t.slug,integrationConfigurationId:a?.[0]?.id,skip:!n||!i});if(!i)return{isLoading:!1,canInstallIntegration:!0};let l=!r&&n;if(!a)return{isLoading:!0};let o=a.at(0);return o?o.deleteRequestedAt?{isLoading:l,canInstallIntegration:!1}:n?r?{isLoading:l,canInstallIntegration:0===r.stores.length}:{isLoading:!0}:{isLoading:!1,canInstallIntegration:!0}:{isLoading:l,canInstallIntegration:!0}}e.s(["useCanInstallIntegration",0,C],6663213);var I=e.i(2521731),S=e.i(8525850);let k=["tag_code_review","tag_code_security","tag_code_testing","tag_security","tag_testing","tag_web_automation","tag_support_agent","tag_optimization","tag_performance","tag_monitoring","tag_dev_tools"];function P(e,t,a,i){if(!e||!t||!a)return{title:"Other",isAgentCategory:!1};let n=e.tagIds||[];if(n.includes("tag_databases")){let t=e.tagIds?.includes("tag_agents")??!1;return"database"===i?{title:"Database",isAgentCategory:t}:{title:"Storage",isAgentCategory:t}}let r=a.find(e=>("tag_database"===e.id||"tag_storage"===e.id)&&n.includes(e.id));if(r){let t=e.tagIds?.includes("tag_agents")??!1;return{title:r.title,isAgentCategory:t}}if(e.tagIds?.includes("tag_agents")){for(let e of k){let t=a.find(t=>t.id===e&&n.includes(t.id));if(t)return{title:t.title,isAgentCategory:!0}}let e=a.find(e=>n.includes(e.id)&&"tag_agents"!==e.id&&!e.id.startsWith("tag_agents_"));if(e)return{title:e.title,isAgentCategory:!0};let t=a.find(e=>"tag_agents"===e.id);return{title:t?.title||"Agents",isAgentCategory:!0}}return{title:(0,S.getProductCategoryDisplayTitle)(e.slug,a,e.tagIds||[]),isAgentCategory:!1}}var N=e.i(1017032),L=e.i(7594446),M=e.i(3584802),F=e.i(6280036),B=e.i(4597921),E=e.i(6264863),O=e.i(4725703);function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[i,n]=(0,a.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.default,{id:"78d34819a030602e",children:"@keyframes drill-bob{0%{transform:translateY(.5px)}to{transform:translateY(-.5px)}}.striped-background.jsx-78d34819a030602e{background:repeating-linear-gradient(-45deg,#ffedcc,#ffedcc 10px,#fff 10px 20px)}.powertool-expanded.jsx-78d34819a030602e{transform:translate(-50%)}.powertool-minimized.jsx-78d34819a030602e{transform:translate(calc(50vw - 100%))}"}),(0,t.jsx)("div",{className:`jsx-78d34819a030602e fixed bottom-4 left-1/2 w-90 z-50 transition-all duration-300 ease-out ${i?"powertool-minimized":"powertool-expanded"}`,children:(0,t.jsxs)("div",{className:`jsx-78d34819a030602e relative ${i?"mr-4":"border border-amber-800 rounded py-3 pl-2 pr-5 striped-background shadow-lg"}`,children:[(0,t.jsx)("button",{type:"button",onClick:()=>n(!0),"aria-label":"Minimize powertool warning",className:`jsx-78d34819a030602e absolute -top-2 -right-2 w-6 h-6 bg-amber-800 cursor-pointer rounded-full flex items-center justify-center transition-opacity duration-300 ease-out ${i?"opacity-0":"opacity-100"}`,children:(0,t.jsx)(O.FullscreenClose,{className:"w-3 h-3",color:"gray-100"})}),(0,t.jsxs)("div",{className:"jsx-78d34819a030602e "+((i?"":"flex items-center gap-5")||""),children:[(0,t.jsxs)("div",{onClick:()=>i&&n(!1),className:"jsx-78d34819a030602e [filter:drop-shadow(0px_1px_0px_rgba(255,255,255,1))_drop-shadow(0px_-1px_0px_rgba(255,255,255,1))_drop-shadow(1px_0px_0px_rgba(255,255,255,1))_drop-shadow(-1px_0px_0px_rgba(255,255,255,1))] flex flex-row gap-0 items-start justify-start rotate-[10deg] cursor-pointer",children:[(0,t.jsx)("img",{src:"https://py8fhxnkzwtsqdo9.public.blob.vercel-storage.com/powertool/PowertoolDrill.svg",alt:"powertool drill",style:{animation:"drill-bob 0.1s ease-in-out infinite alternate",animationTimingFunction:"cubic-bezier(0.4, 0, 0.6, 1)"},className:"jsx-78d34819a030602e w-[21px] h-[24px]"}),(0,t.jsx)("img",{src:"https://py8fhxnkzwtsqdo9.public.blob.vercel-storage.com/powertool/PowertoolHandle.svg",alt:"powertool handle",className:"jsx-78d34819a030602e w-[35px] h-[59px]"})]}),!i&&(0,t.jsxs)("div",{className:"jsx-78d34819a030602e opacity-100 transition-opacity duration-300 ease-out",children:[(0,t.jsx)("div",{className:"jsx-78d34819a030602e text-heading-24 dark:text-gray-100",children:"Powertool active."}),(0,t.jsx)("div",{className:"jsx-78d34819a030602e text-label-13 dark:text-gray-100 font-semibold",children:"Changes are global. Toggle with enablePowertool flag."}),e.integration&&(0,t.jsx)("div",{className:"jsx-78d34819a030602e mt-1 text-label-12 dark:text-gray-100 opacity-90",children:e.integration.name&&(0,t.jsxs)("span",{className:"jsx-78d34819a030602e",children:["Current: ",e.integration.name," (",e.integration.installs," installs)"]})})]})]})]})})]})}e.s(["PowertoolWarning",0,A],9621575);var _=e.i(1720247),R=e.i(2775712),z=e.i(9067013),T=e.i(8139291),D=e.i(6891161),$=e.i(3500331),U=e.i(6881349),q=e.i(4460254);let V={Blue:"#0070F3",Red:"#E5484D",Amber:"#FFB224",Green:"#46A758",Teal:"#12A594",Purple:"#8E4EC6",Pink:"#E93D82"};function W(e){let{value:a,onChange:i,label:n}=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",style:{marginBottom:"4px"},children:n}),(0,t.jsxs)(U.Combobox,{value:a,onChange:e=>{e&&i(e)},placeholder:"Select color","aria-label":"Select an accent color",children:[(0,t.jsx)(U.Combobox.Input,{}),(0,t.jsx)(U.Combobox.List,{children:Object.entries(V).map(e=>{let[a,i]=e;return(0,t.jsx)(U.Combobox.Option,{value:i,prefix:(0,t.jsx)("span",{style:{marginRight:"8px",display:"inline-block",width:"20px",height:"20px",borderRadius:"4px",backgroundColor:i,border:"1px solid var(--ds-gray-400)"}}),children:a},i)})})]})]})}e.s(["ACCENT_COLORS",0,V,"VERCEL_BLOB_URL_PREFIX",0,"https://py8fhxnkzwtsqdo9.public.blob.vercel-storage.com/marketplace-hardcode/"],7045711),e.s(["ColorPicker",0,W,"DragHandle",0,function(e){let{attributes:i,listeners:n,variant:r="default"}=e,l=(0,a.useCallback)(e=>{e.stopPropagation()},[]);return(0,t.jsx)("div",{...i,...n,"data-drag-handle":!0,className:`${"template"===r?"absolute right-2 top-2 z-50":"absolute -right-2 top-1/2 -translate-y-1/2 z-10"} flex h-5 w-4 border border-gray-alpha-400 items-center cursor-grab active:cursor-grabbing justify-center rounded-sm bg-background-200 backdrop-blur-sm text-white hover:bg-gray-200 duration-100 opacity-0 group-hover:opacity-100`,style:{touchAction:"none"},onClick:l,"aria-label":"Drag to reorder",role:"button",tabIndex:0,children:(0,t.jsx)(T.MoreVertical,{color:"gray-900",className:"h-2 w-2"})})},"EditButton",0,function(e){let{onEdit:i,variant:n="default"}=e,r=(0,a.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),i()},[i]);return(0,t.jsx)("button",{type:"button",className:`${"template"===n?"absolute right-2 top-8 z-50":"absolute -right-2 top-4 z-10"} flex h-5 w-4 border border-gray-alpha-400 items-center cursor-pointer justify-center rounded-sm bg-background-200 backdrop-blur-sm text-white hover:bg-gray-200 duration-100 opacity-0 group-hover:opacity-100`,onClick:r,"aria-label":"Edit item",children:(0,t.jsx)(q.Pen,{color:"gray-900",className:"h-2 w-2"})})}],431597);var G=e.i(4585051),H=e.i(9256474),K=e.i(4244280),Y=e.i(277234);let J=(0,a.createContext)(null);function X(){return(0,a.useContext)(J)||{enabled:!1,openEdit:()=>{},closeEdit:()=>{},editingItem:null,isEditModalOpen:!1}}function Z(e){let{attributes:i,listeners:n}=e,r=(0,a.useCallback)(e=>{e.stopPropagation()},[]);return(0,t.jsx)("div",{...i,...n,"data-drag-handle":!0,className:"absolute -right-2 top-1/2 -translate-y-1/2 z-10 flex h-5 w-4 border border-gray-alpha-400 items-center cursor-grab active:cursor-grabbing justify-center rounded-sm bg-background-200 backdrop-blur-sm text-white hover:bg-gray-200 duration-100 opacity-0 group-hover:opacity-100",style:{touchAction:"none"},onClick:r,"aria-label":"Drag to reorder",role:"button",tabIndex:0,children:(0,t.jsx)(T.MoreVertical,{color:"gray-900",className:"h-2 w-2"})})}function Q(e){let{enablePowertool:i=!1,onReorder:n,children:r}=e,l=(0,a.useMemo)(()=>a.default.Children.toArray(r),[r]),{idOrderFromChildren:o,idToElement:s,idToData:c}=(0,a.useMemo)(()=>{let e=[],t=new Map,i=new Map;for(let n of l)if(a.default.isValidElement(n)&&"object"==typeof n.props&&null!==n.props&&"id"in n.props&&"data"in n.props&&"string"==typeof n.props.id){let a=n.props.id;e.push(a),t.set(a,n),i.set(a,n.props.data)}return{idOrderFromChildren:e,idToElement:t,idToData:i}},[l]),[d,u]=(0,a.useState)(o);(0,a.useLayoutEffect)(()=>{u(e=>{if(0===e.length)return o;let t=new Set(o);return e.length===o.length&&e.every(e=>t.has(e))?e:o})},[o]);let[,p]=(0,a.useState)(null),[m,h]=(0,a.useState)(!1),[x,f]=(0,a.useState)(null),[b,y]=(0,a.useState)({integrationName:"",integrationDescription:"",integrationIcon:"",iconBackgroundColor:"#0070F3",website:"",slug:"",tags:[]}),[j,v]=(0,a.useState)(!1),w=(0,_.useSensors)((0,_.useSensor)(_.PointerSensor,{activationConstraint:{distance:8}}),(0,_.useSensor)(_.KeyboardSensor,{coordinateGetter:R.sortableKeyboardCoordinates})),C=(0,a.useCallback)(e=>{f(e),y({integrationName:e.integration.name,integrationDescription:e.integration.shortDescription,integrationIcon:e.integration.icon,iconBackgroundColor:e.product.iconBackgroundColor||e.integration.accentColor||"#0070F3",website:e.integration.website,slug:e.integration.slug,tags:e.product.tags}),h(!0)},[]),I=(0,a.useCallback)(async()=>{if(x){try{let e={slug:x.integration.slug,description:b.integrationDescription,lightImgUrl:b.integrationIcon,darkImgUrl:b.integrationIcon,iconBackgroundColor:b.iconBackgroundColor,categoryTitle:b.tags?.[0]||"Other",boldWords:[x.integration.name]},t=await fetch(K.API_MARKETPLACE_CONFIG,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({featuredItems:{products:[e]}})});if(!t.ok){let e=await t.text();console.error("Failed to save featured section:",e);return}}catch(e){console.error("Error saving featured section:",e)}h(!1),f(null)}},[b,x]),S=(0,a.useCallback)(()=>{h(!1),f(null)},[]),k=(0,a.useCallback)(e=>{p(e.active.id)},[]),P=(0,a.useCallback)(e=>{},[]),N=(0,a.useCallback)(e=>{let{active:t,over:a}=e;p(null),a&&t.id!==a.id&&u(e=>{let i=e.indexOf(String(t.id)),r=e.indexOf(String(a.id));if(-1===i||-1===r)return e;let l=(0,R.arrayMove)(e,i,r);return n&&n(l.map(e=>c.get(e)).filter(e=>!!e)),l})},[c,n]),L={enabled:i,openEdit:C,closeEdit:S,editingItem:x,isEditModalOpen:m},M=(0,t.jsxs)(D.Modal.Modal,{active:m,onClickOutside:()=>h(!1),width:"600px",children:[(0,t.jsxs)(D.Modal.Body,{children:[(0,t.jsx)(D.Modal.Header,{children:(0,t.jsx)(D.Modal.Title,{children:"Edit Integration"})}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px",marginTop:"16px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",style:{marginBottom:"4px"},children:"Integration Name"}),(0,t.jsx)($.Input,{id:"integrationName",value:b.integrationName,onChange:e=>y(t=>({...t,integrationName:e.target.value})),placeholder:"Integration name"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",style:{marginBottom:"4px"},children:"Integration Description"}),(0,t.jsx)($.Input,{id:"integrationDescription",value:b.integrationDescription,onChange:e=>y(t=>({...t,integrationDescription:e.target.value})),placeholder:"Integration description"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",style:{marginBottom:"8px"},children:"Integration Icon"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,t.jsx)(G.Avatar,{hash:b.integrationIcon,size:48,title:"Integration Icon Preview"}),(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsx)($.Input,{id:"integrationIcon",value:b.integrationIcon,onChange:e=>y(t=>({...t,integrationIcon:e.target.value})),placeholder:"Hash or URL (e.g., d84320427d57d47879edfeea213a6275cdc24224)"}),(0,t.jsx)("p",{className:"text-label-12 text-gray-900",style:{marginTop:"4px"},children:"Enter a hash ID or full image URL"})]}),(0,t.jsx)(g.Button,{size:"small",type:"secondary",onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=async e=>{let t=e.target.files?.[0];if(t){v(!0);try{let e=new FileReader;e.onload=async()=>{let t=e.result;try{let e=await (0,Y.fetchAPI)(K.API_MARKETPLACE_FEATURED_IMAGE_UPLOAD,{method:"POST",body:{image:t}});console.log("Image uploaded successfully:",e.url),y(t=>({...t,integrationIcon:e.url}))}catch(e){console.error("Failed to upload image:",e)}finally{v(!1)}},e.readAsDataURL(t)}catch(e){console.error("Error uploading image:",e),v(!1)}}},e.click()},disabled:j,children:j?"Uploading...":"Upload"})]})]}),(0,t.jsx)(W,{label:"Icon Background Color",value:b.iconBackgroundColor,onChange:e=>y(t=>({...t,iconBackgroundColor:e}))}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",style:{marginBottom:"4px"},children:"Website"}),(0,t.jsx)($.Input,{id:"website",value:b.website,onChange:e=>y(t=>({...t,website:e.target.value})),placeholder:"https://example.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",style:{marginBottom:"4px"},children:"Slug"}),(0,t.jsx)($.Input,{id:"slug",value:b.slug,onChange:e=>y(t=>({...t,slug:e.target.value})),placeholder:"integration-slug"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",style:{marginBottom:"4px"},children:"Tags"}),(0,t.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,t.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px",marginBottom:"8px"},children:b.tags.map(e=>{let a=H.integrationCategoryTags.find(t=>t.id===e);return(0,t.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",padding:"4px 8px",backgroundColor:"#f3f4f6",borderRadius:"4px",fontSize:"12px",cursor:"pointer"},onClick:()=>{y(t=>({...t,tags:t.tags.filter(t=>t!==e)}))},children:[a?.title||e," ✕"]},e)})}),(0,t.jsxs)(U.Combobox,{value:"",onChange:e=>{e&&!b.tags.includes(e)&&y(t=>({...t,tags:[...t.tags,e]}))},placeholder:"Add a tag...","aria-label":"Select tags",children:[(0,t.jsx)(U.Combobox.Input,{}),(0,t.jsx)(U.Combobox.List,{children:H.integrationCategoryTags.filter(e=>!b.tags.includes(e.id)).map(e=>(0,t.jsx)(U.Combobox.Option,{value:e.id,children:e.title},e.id))})]})]})]})]})]}),(0,t.jsxs)(D.Modal.Actions,{children:[(0,t.jsx)(D.Modal.Action,{type:"secondary",onClick:S,children:"Cancel"}),(0,t.jsx)(D.Modal.Action,{onClick:I,children:"Save Changes"})]})]});return i?(0,t.jsxs)(J.Provider,{value:L,children:[M,(0,t.jsx)(_.DndContext,{sensors:w,collisionDetection:_.closestCenter,onDragStart:k,onDragOver:P,onDragEnd:N,children:(0,t.jsx)(R.SortableContext,{items:d,strategy:R.rectSortingStrategy,children:(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4 @sm-page:grid-cols-2 @xl-page:grid-cols-3",children:d.map(e=>s.get(e)).filter(Boolean)})})})]}):(0,t.jsx)(J.Provider,{value:L,children:(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4 @sm-page:grid-cols-2 @xl-page:grid-cols-3",children:r})})}Q.Item=function(e){let{id:i,children:n}=e,r=X(),{attributes:l,listeners:o,setNodeRef:s,transform:c,transition:d,isDragging:u}=(0,R.useSortable)({id:i}),g=(0,a.useMemo)(()=>({transform:z.CSS.Transform.toString(c),transition:u?"none":d,opacity:u?.6:1,zIndex:u?1e3:"auto",scale:u?"1.02":"1"}),[c,d,u]),p=(0,a.useCallback)(e=>{if(!r.enabled)return;let t=e.target,a=null!==t.closest("button")||null!==t.closest("[data-drag-handle]")||null!==t.closest("svg")||null!==t.closest("a");(u||a)&&(e.preventDefault(),e.stopPropagation())},[u,r.enabled]);return r.enabled?(0,t.jsxs)("div",{ref:s,style:g,className:`relative group ${u?"shadow-lg":"hover:shadow-md"} transition-shadow duration-200`,onClick:p,children:[(0,t.jsx)(Z,{attributes:l,listeners:o}),n]}):(0,t.jsx)(t.Fragment,{children:n})};var ee=e.i(850302);e.i(2144405);var et=e.i(455575),ea=e.i(9208930);function ei(e){let{integration:i,product:n,productName:r,size:l="small",className:o,variant:s="secondary"}=e,c=(0,et.useToasts)(),[d,u]=(0,a.useState)(!1),[p,m]=(0,a.useState)(()=>{try{let e=`marketplace-subscription-${n?.id||i.slug}`;return"true"===localStorage.getItem(e)}catch{return!1}}),h=(0,a.useCallback)(()=>{d||p||(u(!0),fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:"localhost"===window.location.hostname?`https://vercel.com/dev-mode${window.location.pathname}`:window.location.toString(),note:`Subscribed to ${r}`,topic:"Marketplace and Integrations",ua:`front production + ${navigator.userAgent} (${navigator.language||"unknown language"})`})}).then(()=>{m(!0);try{let e=`marketplace-subscription-${n?.id||i.slug}`;localStorage.setItem(e,"true")}catch(e){console.error("Failed to save subscription state:",e)}c.success(`You're all set! We'll email you as soon as ${r} is available in our marketplace.`)}).catch(e=>{console.error("Failed to subscribe:",e)}).finally(()=>{u(!1)}))},[d,p,r,n?.id,i.slug,c]);return(0,t.jsx)(g.Button,{className:o,disabled:p,loading:d,onClick:h,prefix:(0,t.jsx)(ea.Envelope,{className:"ml-1.5",size:16}),size:l,type:s,typeName:"button",children:p?"Subscribed":"Get notified"})}function en(e){let{product:i,integration:n,categories:r,variant:l="default"}=e;(0,a.useMemo)(()=>P(n,i,r),[n,i,r]);let o=(0,B.useServerFlag)("enable-marketplace-of-products",!1),s=o?i.name:n.name,c=o?i.iconUrl:n.icon,d=c&&(c.startsWith("http")||c.startsWith("https")||c.startsWith("//")),[g,p]=(0,a.useState)({x:50,y:50}),[m,h]=(0,a.useState)(!1),x=(0,a.useRef)(null),f=(0,a.useCallback)(e=>{x.current&&requestAnimationFrame(()=>{if(!x.current)return;let t=x.current.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*100,i=(e.clientY-t.top)/t.height*100;p(e=>{let t=Math.abs(e.x-a),n=Math.abs(e.y-i);return t>2||n>2?{x:a,y:i}:e})})},[]),b=(0,a.useCallback)(()=>{h(!0)},[]),y=(0,a.useCallback)(()=>{h(!1),p({x:50,y:50})},[]),j=(0,a.useMemo)(()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:+!!m,transition:"opacity 0.5s ease",pointerEvents:"none",zIndex:0}),[m]);return(0,t.jsxs)("div",{className:`group relative h-[200px] flex flex-col items-center justify-between gap-3 overflow-hidden p-4 transition-colors ${"agents"===l?"bg-white shadow-border":"rounded border border-dashed border-gray-alpha-400 hover:border-blue-500"}`,ref:x,onMouseMove:f,onMouseEnter:b,onMouseLeave:y,children:[(0,t.jsx)("div",{style:j,className:"[background:radial-gradient(100%_100%_at_0%_0%,#FFFFFF00_80%,#E2F0FF66_100%)] dark:[background:radial-gradient(100%_100%_at_0%_0%,#00000000_80%,#1a3a5230_100%)]"}),(0,t.jsx)("div",{className:"relative z-10 flex w-full flex-row items-center justify-between",children:(0,t.jsx)("div",{className:"flex flex-row gap-2",children:(0,t.jsx)(u.Badge,{size:"sm",className:"bg-blue-100 text-blue-700",children:"Coming Soon"})})}),(0,t.jsxs)("div",{className:"relative z-10 flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:"flex size-[52px] items-center justify-center rounded-full border border-dashed border-gray-alpha-400 transition-colors group-hover:border-blue-500",children:(0,t.jsx)(G.Avatar,{className:"!border-none",...d?{url:c}:{hash:c},size:32})}),(0,t.jsx)("div",{className:"text-label-16",children:(0,t.jsx)("strong",{className:"text-gray-900",children:s})})]}),(0,t.jsx)("div",{className:"relative z-10 w-full",children:(0,t.jsx)(ei,{className:"w-full",integration:n,product:i,productName:s,size:"small",variant:"secondary"})})]})}e.s(["GetNotifiedButton",0,ei],4272280);var er=e.i(5976989);function el(e){let{category:i,categories:n,variant:r="default",integrations:l=[],teamSlugOrPublic:o,isFromV0:s}=e,[c,d]=(0,a.useState)(!1),[u,g]=(0,a.useState)({x:50,y:50}),[p,m]=(0,a.useState)(!1),h=(0,a.useRef)(null),x="agents"===i,f=n.find(e=>e.slug===i),b=f?.title||"Integration",y=`Not seeing the ${b} you need? Request an integration.`,j=(0,a.useCallback)(e=>{h.current&&requestAnimationFrame(()=>{if(!h.current)return;let t=h.current.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*100,i=(e.clientY-t.top)/t.height*100;g(e=>{let t=Math.abs(e.x-a),n=Math.abs(e.y-i);return t>2||n>2?{x:a,y:i}:e})})},[]),v=(0,a.useCallback)(()=>{m(!0)},[]),w=(0,a.useCallback)(()=>{m(!1),g({x:50,y:50})},[]),C=(0,a.useMemo)(()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",background:`radial-gradient(circle at ${u.x}% ${u.y}%, rgba(0, 112, 243, 0.1) 0%, rgba(255,255,255,0) 90%)`,opacity:+!!p,transition:"opacity 0.3s ease-out",pointerEvents:"none",zIndex:0,transform:"translate3d(0, 0, 0)",willChange:p?"opacity":"auto"}),[u.x,u.y,p]),I="agents"===r;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{ref:h,className:`h-[200px] group relative flex cursor-pointer flex-col items-start justify-between gap-3 overflow-hidden transition-colors bg-background-100 ${I?"shadow-border":"rounded border border-gray-alpha-400 hover:border-blue-500"}`,onClick:()=>d(!0),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),d(!0))},onMouseMove:j,onMouseEnter:v,onMouseLeave:w,role:"button",tabIndex:0,children:[p?(0,t.jsx)("div",{style:C}):null,(0,t.jsx)("div",{className:`absolute inset-0 z-0 overflow-hidden ${I?"":"rounded"}`,children:(0,t.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 306 220",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute inset-0",preserveAspectRatio:"none",children:(0,t.jsx)("path",{d:"M-72.6319 0.914097C-72.7551 0.842564 -72.8476 0.788746 -72.9092 0.752964C-72.9398 0.735172 -72.9632 0.721806 -72.9785 0.712925C-72.9861 0.70853 -72.9923 0.705357 -72.9961 0.703159C-72.9979 0.702122 -72.9991 0.700779 -73 0.70023C-73.001 0.699665 -73.0008 0.697788 -72.8135 0.375034L-72.8047 3.43034e-05C-72.8038 4.95621e-05 -72.8024 3.78558e-06 -72.8008 3.4303e-05C-72.7978 9.53379e-05 -72.7901 0.000888794 -72.7832 0.00101086C-72.768 0.00128552 -72.7444 0.00142285 -72.7139 0.00198742C-72.6523 0.00313182 -72.5597 0.00459666 -72.4365 0.00687021L-49.1192 0.437532C-33.3275 0.729462 -9.63991 1.16812 21.9433 1.75198L306.193 7.00684L306.187 7.38184L306.18 7.75586C179.846 5.42042 85.0963 3.6697 21.9297 2.50198C-8.54546 1.93861 -31.6692 1.51138 -47.4414 1.21976C-31.6687 1.97789 -8.53658 3.08919 21.9541 4.55471C85.1207 7.59079 179.871 12.1446 306.204 18.2168L306.187 18.5918L306.169 18.9658C179.836 12.8937 85.0856 8.33982 21.9189 5.30374C-8.52391 3.84051 -31.6313 2.72977 -47.4024 1.97171L306.216 29.4277L306.157 30.1758L-47.3516 2.72855C-31.5803 4.41954 -8.4709 6.89654 21.9765 10.1612L306.227 40.6387L306.146 41.3848L21.8965 10.9073C-8.44054 7.65448 -31.4927 5.18375 -47.2598 3.4932C-31.4905 5.65039 -8.40798 8.80681 21.9873 12.9649C85.1539 21.6061 179.904 34.5682 306.237 51.8506L306.187 52.2217L306.136 52.5938C179.802 35.3114 85.0524 22.3492 21.8857 13.708C-8.37935 9.56778 -31.3941 6.42018 -47.1582 4.2637L306.248 63.0625L306.125 63.8027C179.792 42.7836 85.0416 27.0184 21.875 16.5088L-47.0469 5.04202L22.0088 18.5742C85.1754 30.9522 179.926 49.5186 306.259 74.2744L306.114 75.0107C179.781 50.2549 85.0309 31.6875 21.8642 19.3096C-8.21697 13.415 -31.1357 8.92439 -46.8916 5.83695L22.0195 21.3789C85.1861 35.6252 179.936 56.9949 306.269 85.4873L306.187 85.8525L306.104 86.2188L21.8545 22.1104L-46.7422 6.63968L306.279 96.6992L306.187 97.0625L306.094 97.4268C179.76 65.1975 85.0104 41.0248 21.8437 24.9102L-46.5469 7.46292C-30.7963 11.947 -7.93425 18.4561 22.039 26.9893C85.2057 44.9723 179.956 71.9461 306.289 107.912L306.187 108.273L306.084 108.634L21.834 27.71L-46.3506 8.29886C-30.6062 13.2468 -7.80629 20.4114 22.0488 29.794C85.2155 49.6453 179.966 79.4232 306.299 119.126L306.074 119.841L21.8242 30.5098C-7.74208 21.218 -30.389 14.1009 -46.1162 9.15824C-30.3799 14.5691 -7.65489 22.3827 22.0586 32.5996C85.2252 54.3194 179.975 86.8994 306.309 130.339L306.064 131.048L-45.8574 10.041C-30.1308 15.9138 -7.48909 24.3691 22.0674 35.4063L306.317 141.553L306.187 141.903L306.056 142.255L21.8056 36.1084C-7.4218 25.1941 -29.888 16.8056 -45.5918 10.9414C-29.8759 17.2751 -7.31911 26.3651 22.0771 38.2119C85.2438 63.6684 179.994 101.853 306.327 152.766L306.187 153.114L306.046 153.462L-45.3369 11.8526C-29.632 18.6464 -7.15785 28.3686 22.0849 41.0186C85.2515 68.3434 180.002 109.33 306.335 163.979L306.187 164.324L306.038 164.668L21.7881 41.7061C-7.09944 29.2098 -29.3819 19.5715 -45.0586 12.7901C-29.3665 20.0423 -6.98213 30.3865 22.0937 43.8242C85.2604 73.0174 180.01 116.808 306.344 175.194L306.187 175.534L306.029 175.875C179.696 117.489 84.9459 73.6981 21.7793 44.5049C-6.89497 31.2528 -29.0611 21.0088 -44.7188 13.7725L306.352 186.408L306.187 186.744L306.021 187.081L-44.4072 14.7618C-28.7484 22.9249 -6.57542 34.4831 22.1103 49.4375L306.36 197.622L306.187 197.955L306.013 198.287L21.7637 50.1026C-6.48659 35.3752 -28.4203 23.9416 -44.0362 15.8008L22.1172 52.2442C85.2838 87.0424 180.034 139.239 306.367 208.836L306.187 209.165L306.006 209.493C179.673 139.897 84.9225 87.6997 21.7558 52.9014L-43.6787 16.8535L306.375 220.051L305.998 220.699L-72.6319 0.914097Z",className:"fill-[#EBEBEB] dark:fill-[#2a2a2a]"})})}),(0,t.jsxs)("div",{className:"z-20 p-4 flex flex-col gap-2 items-start justify-end h-full",children:[(0,t.jsx)("div",{className:"relative z-10 w-full text-start text-label-16",children:(0,t.jsx)("strong",{children:x?"Request an Agent":"Request an Integration"})}),(0,t.jsx)("div",{className:"relative z-10 w-full text-start text-copy-13 text-gray-alpha-800",children:y})]})]}),(0,t.jsx)(er.RequestIntegrationModal,{isOpen:c,onClose:()=>d(!1),category:i,isAgentCategory:x,categoryTitle:b,integrations:l,teamSlugOrPublic:o,isFromV0:s})]})}function eo(e){let{variant:n="default"}=e,[r,l]=(0,a.useState)({x:50,y:50}),[o,s]=(0,a.useState)(!1),c=(0,a.useRef)(null),d=(0,a.useCallback)(e=>{c.current&&requestAnimationFrame(()=>{if(!c.current)return;let t=c.current.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*100,i=(e.clientY-t.top)/t.height*100;l(e=>{let t=Math.abs(e.x-a),n=Math.abs(e.y-i);return t>2||n>2?{x:a,y:i}:e})})},[]),u=(0,a.useCallback)(()=>{s(!0)},[]),g=(0,a.useCallback)(()=>{s(!1),l({x:50,y:50})},[]),p=(0,a.useMemo)(()=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",background:`radial-gradient(circle at ${r.x}% ${r.y}%, rgba(0, 112, 243, 0.1) 0%, rgba(255,255,255,0) 90%)`,opacity:+!!o,transition:"opacity 0.3s ease-out",pointerEvents:"none",zIndex:0,transform:"translate3d(0, 0, 0)",willChange:o?"opacity":"auto"}),[r.x,r.y,o]),m="agents"===n;return(0,t.jsx)("div",{ref:c,onMouseMove:d,onMouseEnter:u,onMouseLeave:g,className:"group relative h-[200px]",children:(0,t.jsxs)(i.Link,{href:"/marketplace/program",target:"_blank",className:`relative flex h-full cursor-pointer flex-col items-start justify-between gap-3 overflow-hidden transition-colors no-underline bg-background-100 ${m?"shadow-border":"rounded border border-gray-alpha-400 hover:border-blue-500"}`,children:[o?(0,t.jsx)("div",{style:p}):null,(0,t.jsx)("div",{className:`absolute inset-0 z-0 overflow-hidden ${m?"":"rounded"}`,children:(0,t.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 306 220",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute inset-0",preserveAspectRatio:"none",children:(0,t.jsx)("path",{d:"M-72.6319 0.914097C-72.7551 0.842564 -72.8476 0.788746 -72.9092 0.752964C-72.9398 0.735172 -72.9632 0.721806 -72.9785 0.712925C-72.9861 0.70853 -72.9923 0.705357 -72.9961 0.703159C-72.9979 0.702122 -72.9991 0.700779 -73 0.70023C-73.001 0.699665 -73.0008 0.697788 -72.8135 0.375034L-72.8047 3.43034e-05C-72.8038 4.95621e-05 -72.8024 3.78558e-06 -72.8008 3.4303e-05C-72.7978 9.53379e-05 -72.7901 0.000888794 -72.7832 0.00101086C-72.768 0.00128552 -72.7444 0.00142285 -72.7139 0.00198742C-72.6523 0.00313182 -72.5597 0.00459666 -72.4365 0.00687021L-49.1192 0.437532C-33.3275 0.729462 -9.63991 1.16812 21.9433 1.75198L306.193 7.00684L306.187 7.38184L306.18 7.75586C179.846 5.42042 85.0963 3.6697 21.9297 2.50198C-8.54546 1.93861 -31.6692 1.51138 -47.4414 1.21976C-31.6687 1.97789 -8.53658 3.08919 21.9541 4.55471C85.1207 7.59079 179.871 12.1446 306.204 18.2168L306.187 18.5918L306.169 18.9658C179.836 12.8937 85.0856 8.33982 21.9189 5.30374C-8.52391 3.84051 -31.6313 2.72977 -47.4024 1.97171L306.216 29.4277L306.157 30.1758L-47.3516 2.72855C-31.5803 4.41954 -8.4709 6.89654 21.9765 10.1612L306.227 40.6387L306.146 41.3848L21.8965 10.9073C-8.44054 7.65448 -31.4927 5.18375 -47.2598 3.4932C-31.4905 5.65039 -8.40798 8.80681 21.9873 12.9649C85.1539 21.6061 179.904 34.5682 306.237 51.8506L306.187 52.2217L306.136 52.5938C179.802 35.3114 85.0524 22.3492 21.8857 13.708C-8.37935 9.56778 -31.3941 6.42018 -47.1582 4.2637L306.248 63.0625L306.125 63.8027C179.792 42.7836 85.0416 27.0184 21.875 16.5088L-47.0469 5.04202L22.0088 18.5742C85.1754 30.9522 179.926 49.5186 306.259 74.2744L306.114 75.0107C179.781 50.2549 85.0309 31.6875 21.8642 19.3096C-8.21697 13.415 -31.1357 8.92439 -46.8916 5.83695L22.0195 21.3789C85.1861 35.6252 179.936 56.9949 306.269 85.4873L306.187 85.8525L306.104 86.2188L21.8545 22.1104L-46.7422 6.63968L306.279 96.6992L306.187 97.0625L306.094 97.4268C179.76 65.1975 85.0104 41.0248 21.8437 24.9102L-46.5469 7.46292C-30.7963 11.947 -7.93425 18.4561 22.039 26.9893C85.2057 44.9723 179.956 71.9461 306.289 107.912L306.187 108.273L306.084 108.634L21.834 27.71L-46.3506 8.29886C-30.6062 13.2468 -7.80629 20.4114 22.0488 29.794C85.2155 49.6453 179.966 79.4232 306.299 119.126L306.074 119.841L21.8242 30.5098C-7.74208 21.218 -30.389 14.1009 -46.1162 9.15824C-30.3799 14.5691 -7.65489 22.3827 22.0586 32.5996C85.2252 54.3194 179.975 86.8994 306.309 130.339L306.064 131.048L-45.8574 10.041C-30.1308 15.9138 -7.48909 24.3691 22.0674 35.4063L306.317 141.553L306.187 141.903L306.056 142.255L21.8056 36.1084C-7.4218 25.1941 -29.888 16.8056 -45.5918 10.9414C-29.8759 17.2751 -7.31911 26.3651 22.0771 38.2119C85.2438 63.6684 179.994 101.853 306.327 152.766L306.187 153.114L306.046 153.462L-45.3369 11.8526C-29.632 18.6464 -7.15785 28.3686 22.0849 41.0186C85.2515 68.3434 180.002 109.33 306.335 163.979L306.187 164.324L306.038 164.668L21.7881 41.7061C-7.09944 29.2098 -29.3819 19.5715 -45.0586 12.7901C-29.3665 20.0423 -6.98213 30.3865 22.0937 43.8242C85.2604 73.0174 180.01 116.808 306.344 175.194L306.187 175.534L306.029 175.875C179.696 117.489 84.9459 73.6981 21.7793 44.5049C-6.89497 31.2528 -29.0611 21.0088 -44.7188 13.7725L306.352 186.408L306.187 186.744L306.021 187.081L-44.4072 14.7618C-28.7484 22.9249 -6.57542 34.4831 22.1103 49.4375L306.36 197.622L306.187 197.955L306.013 198.287L21.7637 50.1026C-6.48659 35.3752 -28.4203 23.9416 -44.0362 15.8008L22.1172 52.2442C85.2838 87.0424 180.034 139.239 306.367 208.836L306.187 209.165L306.006 209.493C179.673 139.897 84.9225 87.6997 21.7558 52.9014L-43.6787 16.8535L306.375 220.051L305.998 220.699L-72.6319 0.914097Z",className:"fill-[#EBEBEB] dark:fill-[#2a2a2a]"})})}),(0,t.jsxs)("div",{className:"z-20 p-4 flex flex-col gap-2 items-start justify-end h-full",children:[(0,t.jsx)("div",{className:"relative z-10 w-full text-start text-label-16",children:(0,t.jsx)("strong",{children:"Join the Marketplace"})}),(0,t.jsx)("div",{className:"relative z-10 w-full text-start text-copy-13 text-gray-alpha-800",children:"Offer your solution to millions of Vercel developers."})]})]})})}e.s(["RequestIntegrationCard",0,el],6345985),e.s(["JoinMarketplaceCard",0,eo],9120086);var es=e.i(5806401),ec=e.i(8522580),ed=e.i(6942035),eu=e.i(3993360);e.i(2331088);var eg=e.i(6817234),ep=e.i(545169),em=e.i(9588822),eh=e.i(5338940),ex=e.i(3677672),ef=e.i(8843717),eb=e.i(373291),ey=e.i(2557188),ej=e.i(8647445);function ev(e){return"pre-install"===e.mode?(0,t.jsx)(eC,{...e}):(0,t.jsx)(ew,{...e})}function ew(e){let{integration:a,product:i,configuration:n,source:r,skipBillingPlanSelector:l=!1,onContinue:o}=e,{plan:s}=(0,eg.useMarketplaceBillingPlansContext)(),{hasMetadataErrors:c,metadataState:d,areMetadataChanged:u}=(0,eb.useStoreIntegrationFormContext)(),{protocolSettingsForm:p,protocolSettings:m}=(0,ej.useResourceProtocolSettings)(i),h=s??n.billingPlan,x=!!h;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"border-b border-accents-2 pb-6",children:[(0,t.jsx)(ep.ResourceMetadataFieldsWithErrorBoundary,{integrationId:a.id,isLoading:!1,productId:i.id}),p&&(0,t.jsx)("div",{className:"mt-4",children:p})]}),!l&&(0,t.jsx)("div",{className:"mt-6",children:c?(0,t.jsx)(ey.BillingPlanMetadataErrors,{integrationSlug:a.slug,integrationFlags:a.flags,isInstallationLevel:!0}):(0,t.jsx)(ey.MarketplaceBillingPlanSelectorWithErrorBoundary,{type:"product",areMetadataChanged:u,arePermissionsLoading:!1,hasLogDrainsSupport:!1,hideExpandAll:!0,installationId:n.id,integrationId:a.id,integrationName:a.name,integrationSlug:a.slug,integrationFlags:a.flags,isInstallationLevel:!0,metadata:d,productId:i.id,source:r})}),(0,t.jsx)("div",{className:"mt-6 flex justify-end",children:(0,t.jsx)(g.Button,{onClick:()=>{if(!c){if(!h)throw Error("Billing plan must be selected to continue.");o(h,m)}},disabled:c||!x,children:"Continue"})})]})}function eC(e){let{integration:i,teamId:n,source:r,isInstalling:l,error:o,onBack:s,onContinue:c}=e,{plan:d,isBillingPlanSelectionValid:u}=(0,eg.useMarketplaceBillingPlansContext)(),{hasMetadataErrors:p,metadataState:m,areMetadataChanged:h}=(0,eb.useStoreIntegrationFormContext)(),x=(0,a.useMemo)(()=>Object.keys(i.metadataSchema?.properties??{}).length>0,[i]),f=!!d&&u&&!p&&!l;return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[o&&(0,t.jsx)(ec.Note,{type:"error",children:o}),x&&(0,t.jsx)("div",{className:"border-b border-accents-2 pb-6",children:(0,t.jsx)(ep.ResourceMetadataFieldsWithErrorBoundary,{integrationId:i.id,isLoading:!1,productId:"iap_none"})}),(0,t.jsx)("div",{children:p?(0,t.jsx)(ey.BillingPlanMetadataErrors,{integrationSlug:i.slug,integrationFlags:i.flags,isInstallationLevel:!0}):(0,t.jsx)(ey.MarketplaceBillingPlanSelectorWithErrorBoundary,{areMetadataChanged:h,arePermissionsLoading:!1,hasLogDrainsSupport:!1,integrationId:i.id,integrationName:i.name,integrationSlug:i.slug,integrationFlags:i.flags,isInstallationLevel:!0,metadata:m,source:r,teamId:n,type:"new-installation"})}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)(g.Button,{type:"secondary",onClick:s,disabled:l,children:"Back"}),(0,t.jsx)(g.Button,{onClick:()=>{d&&c({billingPlan:d,metadata:m})},loading:l,disabled:!f,children:"Continue"})]})]})}var eI=e.i(1914640),eS=e.i(553769),ek=e.i(1595844),eP=e.i(1571992),eN=e.i(5074599),eL=e.i(9722978);function eM(e){let{integration:i,product:n,selectedPaymentMethodId:r,onBack:l,onConfirmStart:o}=e,{plan:s,topUpForm:c}=(0,eg.useMarketplaceBillingPlansContext)(),{formError:d,metadataState:u}=(0,eb.useStoreIntegrationFormContext)(),p=(0,a.useMemo)(()=>{let e=n.slug.toLowerCase();n.capabilities?.sandbox&&(e+="-sandbox");let t=Object.entries(n.metadataSchema?.properties||{}).find(e=>{let[t,a]=e;return"git-namespace"===a["ui:control"]});if(t&&u[t[0]]){let a=u[t[0]];if(a&&"string"==typeof a){let t=(0,eP.stringToGitNamespace)(a);t&&(e+=`-${t.slug}`)}}return`${e}-${(0,ek.generateRandomName)()}`},[n,u]),{name:m,setName:h,resourceNameError:x,isAtLimit:f,characterCount:b,maxLength:y,minLength:j}=(0,ek.useResourceName)({product:n,defaultName:p}),v=(0,eN.getResourceNameLabelByProduct)(n);return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)("p",{className:"text-base font-medium",children:"Review Configuration"}),(0,t.jsx)(eI.ReadOnlyMetadataWithErrorBoundary,{integrationId:i.id,metadata:u,metadataErrors:d.metadata,productId:n.id,target:"create"}),(0,t.jsx)(eI.ReadOnlyBillingPlan,{billingPlan:s,isAwsIntegration:(0,eS.isAwsIntegration)(i)})]})}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)($.Input,{id:"resource-name",label:"Resource Name",value:m,maxLength:y+1,minLength:j,onChange:e=>h(e.target.value),placeholder:`My ${n.name}`,width:"100%",bypassCasing:!0,error:x}),(0,t.jsxs)("p",{className:(0,eL.default)("text-label-12",f?"text-red-900":"text-gray-900"),style:{textAlign:"right"},children:[b,"/",y]}),(0,t.jsxs)("p",{className:"text-copy-13 text-gray-900",children:["This is how we call your ",v," in the Vercel dashboard and in ",i.name,"."]}),n.disableResourceRenaming&&(0,t.jsx)(ec.Note,{fill:!0,type:"warning",children:"The name cannot be changed after the resource is created."})]}),(0,t.jsxs)("div",{className:"flex flex-row justify-between gap-3",children:[l?(0,t.jsx)(g.Button,{onClick:l,type:"secondary",children:"Back"}):(0,t.jsx)("div",{}),(0,t.jsx)(g.Button,{onClick:()=>{if(!m.trim()||x)return;let e=s?.type==="prepayment",t=c.rechargeSettingsForm.getValues();o({resourceName:m,metadataState:u,prepaymentAmountCents:e?c.getAmountToAdd():void 0,rechargeSettings:e?{autoRecharge:t.autoRecharge,topUpAmount:t.topUpAmount,topUpThreshold:t.topUpThreshold,periodSpendMaximum:t.periodSpendMaximum}:void 0,integrationId:i.id,productId:n.id,billingPlanId:s?.id??"",selectedPaymentMethodId:r})},disabled:!m.trim()||!!x,children:"Create"})]})]})}var eF=e.i(8735244),eB=e.i(8761240);function eE(e){let{product:a,provisioningStatus:i,onBack:n,onDone:r,onDownloadDebugLog:l}=e,o=(0,eN.getResourceTitleByProduct)(a),s="authorizing"===i.status||"awaiting-authorization"===i.status||"requires-action"===i.status||"creating-resource"===i.status,c="success"===i.status,d="error"===i.status;return(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"relative flex h-[320px]",children:[(0,t.jsxs)("div",{className:"absolute left-1/2 top-1/2 flex w-full -translate-x-1/2 -translate-y-1/2 flex-col items-center gap-4 px-4 text-center",children:[d&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"text-base font-medium text-red-900",children:["Error creating ",o]}),(0,t.jsx)("p",{className:"text-sm text-gray-900",children:i.error})]}),c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eB.CheckCircleFill,{color:"green-800",size:36}),(0,t.jsxs)("p",{className:"text-lg font-medium",children:[o," created"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-900",children:["Your ",o.toLowerCase()," ",(0,t.jsx)("span",{className:"text-gray-1000",children:i.resource.name})," ","has been created"]})]}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eF.Spinner,{size:48}),(0,t.jsxs)("p",{className:"text-base font-medium",children:["Creating ",o,"..."]}),(0,t.jsxs)("p",{className:"text-sm text-gray-900",children:["Setting up your ",o,". This may take a moment..."]})]})]}),d&&(0,t.jsx)(g.Button,{className:"absolute bottom-0 left-0",onClick:n,type:"secondary",children:"Back"}),c&&(0,t.jsx)(g.Button,{className:"absolute bottom-0 right-0",onClick:r,children:"Done"})]}),d&&l&&(0,t.jsx)(ec.Note,{type:"secondary",size:"small",fill:!0,children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("p",{children:["Download the debug log and post it in"," ",(0,t.jsx)("span",{className:"font-medium",children:"#feedback-marketplace-new-checkout-flow"})]}),(0,t.jsx)(g.Button,{size:"small",type:"secondary",onClick:l,suffix:(0,t.jsx)(eu.Download,{}),children:"Download Log"})]})})]})}var eO=e.i(8161149),eA=e.i(1848296),e_=e.i(4543703),eR=e.i(5664412),ez=e.i(3256866),eT=e.i(9373142),eD=e.i(1717203),e$=e.i(7557283),eU=e.i(7722264),eq=e.i(1104046),eV=e.i(6446781),eW=e.i(6482217),eG=e.i(4361526),eH=e.i(7525322),eK=e.i(8132352),eY=e.i(6111613);function eJ(e){let{team:i,configuration:n,paymentMethodState:r,requireNew:l,error:o,onBack:s,onNext:c}=e,d=(0,a.useMemo)(()=>!!l||r.required&&!r.valid,[l,r]),u=async e=>{n&&await (0,ef.updateInstallationPaymentMethod)(i.id,n.id,e),c(e)};return!d&&(0,eY.isMissingBillingAddress)(i)?(0,t.jsx)(e0,{team:i,onBack:s,onNext:c}):(0,ef.requiresSeparatePaymentMethodForInstallation)(i)?(0,t.jsx)(eZ,{team:i,error:o,onBack:s,onContinue:u}):(0,t.jsx)(eX,{team:i,error:o,onBack:s,onContinue:u,makeDefault:!0})}function eX(e){let{team:i,error:n,onBack:r,onContinue:l,makeDefault:o=!1}=e,[s,c]=(0,a.useState)(!1),d=(0,em.useBillingForm)({teamOverride:i}),u=async()=>{c(!0);try{let e=await d.submit({teamId:i.id,assignCardToEntity:!0,shouldUseTeam:!0,makeDefault:o,saveBillingAddress:d.makeDefaultBillingAddress});e&&await l(e)}finally{c(!1)}};return(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[n&&(0,t.jsx)(ec.Note,{type:"error",fill:!0,children:n}),(0,t.jsx)(em.BillingForm,{error:d.error,stripeMode:d.stripeMode,makeDefaultBillingAddress:d.makeDefaultBillingAddress,setMakeDefaultBillingAddress:d.setMakeDefaultBillingAddress,makeDefaultPaymentMethod:d.makeDefaultPaymentMethod,setMakeDefaultPaymentMethod:d.setMakeDefaultPaymentMethod,backgroundClassName:"bg-background-100"}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)(g.Button,{type:"secondary",onClick:r,children:"Back"}),(0,t.jsx)(g.Button,{onClick:u,loading:s||d.submitting,disabled:d.disabled,children:"Continue"})]})]})}function eZ(e){let{team:i,error:n,onBack:r,onContinue:l}=e,{can:o}=(0,eD.default)({teamId:i.id}),s=o(e$.Action.Read,e$.Resource.PaymentMethod),c=o(e$.Action.Write,e$.Resource.PaymentMethod),d=(0,eW.useStripeSourcesForTeam)(i.id),u=(0,a.useMemo)(()=>(d.data?.sources||[]).toSorted((e,t)=>e.id.localeCompare(t.id)),[d]),p=u.length>0,[m,h]=(0,a.useState)(!1),[x,f]=(0,a.useState)(""),[b,y]=(0,a.useState)(!1),j=async()=>{y(!0);try{await l(x)}finally{y(!1)}};return m||!p?(0,t.jsx)(eX,{team:i,error:n,onBack:p?()=>{h(!1),f("")}:r,onContinue:l}):s?(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[n&&(0,t.jsx)(ec.Note,{type:"error",fill:!0,children:n}),(0,t.jsx)(eA.RadioGroup,{onChange:f,value:x,children:(0,t.jsxs)("div",{className:"flex flex-col rounded-lg border border-gray-400",children:[u.map(e=>{let{card:a}=e;return a?(0,t.jsxs)("div",{className:"flex cursor-pointer items-center justify-between border-b border-gray-400 px-4 py-3 last:border-b-0",onClick:()=>f(e.id),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(eQ,{brand:a.brand}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("span",{className:"text-label-14 text-gray-1000",children:[(0,eV.cardBrand)(a.brand)," ",a.funding," ending in ••••"," ",a.last4]}),(0,t.jsxs)("span",{className:"text-copy-13 text-gray-900",children:["Valid until ",a.exp_month,"/",a.exp_year]})]})]}),(0,t.jsx)(eA.RadioGroup.Item,{value:e.id})]},e.id):null}),c&&u.length<3&&(0,t.jsx)("div",{className:"flex cursor-pointer items-center justify-between px-4 py-3",onClick:()=>h(!0),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(eT.CreditCard,{className:"text-gray-900"}),(0,t.jsx)("span",{className:"text-label-14 text-gray-1000",children:"Add a new payment method"})]})})]})}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)(g.Button,{type:"secondary",onClick:r,children:"Back"}),(0,t.jsx)(g.Button,{disabled:!x,loading:b,onClick:j,children:b?"Processing":"Continue"})]})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)(eO.EmptyState.Root,{description:"You don't have permission to view payment methods",icon:(0,t.jsx)(eO.EmptyState.Icon,{icon:(0,t.jsx)(eT.CreditCard,{size:32})})}),(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsx)(g.Button,{type:"secondary",onClick:r,children:"Back"})})]})}function eQ(e){let{brand:a}=e;switch(a){case"visa":return(0,t.jsx)(eR.LogoVisa,{});case"mastercard":return(0,t.jsx)(ez.LogoMastercard,{});case"amex":return(0,t.jsx)(e_.LogoAmex,{});default:return(0,t.jsx)(eT.CreditCard,{})}}function e0(e){let{team:i,onBack:n,onNext:r}=e,{mutate:l}=(0,eh.useTeam)(),[o,s]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1),u=async e=>{s(null),d(!0);let t=(0,eH.validateAddressFormData)(e);if((0,eU.isError)(t)){s("Invalid billing address."),d(!1);return}try{await (0,eG.saveBillingDetails)(i.id,t);try{await l()}finally{r()}}catch(e){e instanceof eq.ApiError?s(e.message):s("There was a problem saving your billing address")}finally{d(!1)}};return(0,t.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:e=>{e.preventDefault(),u(new FormData(e.currentTarget))},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-heading-24",children:"Billing Address"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Please provide a billing address for your active payment."})]}),(0,t.jsx)(eK.FullBillingAddressForm,{disabled:!1,error:o??void 0}),(0,t.jsxs)("div",{className:"flex justify-between border-t border-gray-400 pt-4",children:[(0,t.jsx)(g.Button,{type:"secondary",onClick:n,children:"Back"}),(0,t.jsx)(g.Button,{typeName:"submit",loading:c,children:"Continue"})]})]})}var e1=e.i(4240811),e2=e.i(4469437),e3=e.i(1265647);function e8(e){let{state:a}=e;switch(a){case"complete":return(0,t.jsx)(eB.CheckCircleFill,{color:"gray-700",size:28});case"active":return(0,t.jsx)(e1.ChevronCircleRightFill,{size:28});default:return(0,t.jsx)("div",{className:"h-7 w-7 rounded-full border-2 border-gray-400 bg-background-100"})}}let e4=(0,a.forwardRef)(function(e,a){let{label:i,state:n,isOpen:r,isLastStep:l=!1,children:o}=e;return(0,t.jsxs)("div",{ref:a,className:"relative",children:[(0,t.jsxs)("div",{className:(0,eL.clsx)("overflow-hidden rounded-lg border border-gray-alpha-200"),children:[(0,t.jsx)("div",{className:(0,eL.clsx)("flex w-full items-center justify-between","bg-background-100 p-4","locked"===n&&"opacity-60"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(e8,{state:n}),(0,t.jsx)("span",{className:(0,eL.clsx)("text-md font-medium","active"===n&&"text-gray-1000","active"!==n&&"text-gray-700"),children:i})]})}),(0,t.jsx)(e2.AnimatePresence,{initial:!1,children:r&&o&&(0,t.jsx)(e3.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},style:{overflow:"hidden"},children:(0,t.jsx)("div",{className:"bg-background-100 px-4 py-4",children:o})})})]}),!l&&(0,t.jsx)("div",{className:"absolute left-8 h-6 w-px",style:{top:"100%",backgroundImage:"linear-gradient(to bottom, var(--ds-gray-500) 50%, transparent 50%)",backgroundSize:"1px 6px",backgroundRepeat:"repeat-y"}})]})});var e6=e.i(3788585);function e7(e){let{integration:a,isInstalling:i,error:n,onAccept:r}=e,l="Accept and Create";return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[n&&(0,t.jsx)(ec.Note,{fill:!0,type:"error",children:n}),(0,t.jsx)(e6.TermsAndConditions,{buttonCaption:l,integrations:[a],showHeader:!1}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(g.Button,{onClick:r,loading:i,disabled:i,children:l})})]})}var e9=e.i(7063289);function e5(e){let{topUpForm:i}=(0,eg.useMarketplaceBillingPlansContext)();return(0,a.useEffect)(()=>{i.setup({type:"create",billingPlan:e.billingPlan,currentBalance:e.currentBalanceInCents?(e.currentBalanceInCents/100).toString():void 0})},[i,e.billingPlan,e.currentBalanceInCents]),(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)("form",{children:(0,t.jsx)(e9.TopUpFormFields,{topUpForm:i,variant:"create"})}),(0,t.jsxs)("div",{className:"flex flex-row justify-between gap-3",children:[(0,t.jsx)(g.Button,{onClick:e.onBack,type:"secondary",children:"Back"}),(0,t.jsx)(g.Button,{onClick:async()=>{let t=await i.addFundsForm.trigger(),a=await i.rechargeSettingsForm.trigger();t&&a&&e.onNext()},children:"Continue"})]})]})}var te=e.i(4987761),tt=e.i(9349058),ta=e.i(9219571),ti=e.i(7623643),tn=e.i(5328446),tr=e.i(9186321),tl=e.i(1008179),to=e.i(2781254);class ts{entries=[];startTime;constructor(){this.startTime=Date.now()}log(e,t,a){this.entries.push({timestamp:new Date().toISOString(),elapsed:Date.now()-this.startTime,type:e,message:t,data:a})}transition(e,t){this.log("transition",`${e} → ${t}`)}download(){let e=new Blob([JSON.stringify(this.entries,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`checkout-debug-${new Date().toISOString()}.json`,a.click(),URL.revokeObjectURL(t)}dump(){return[...this.entries]}clear(){this.entries=[],this.startTime=Date.now()}}let tc=e=>Math.round(100*Number.parseFloat(e)),td={type:"object",properties:{}},tu=(0,em.withStripe)(function(e){let{configuration:i,ref:r}=e,l=(0,a.useRef)(new ts),[o,s]=(0,a.useState)({isFlowOpen:!1}),c=(0,a.useCallback)(e=>{s(t=>{let a="function"==typeof e?e(t):e,i=t.isFlowOpen?t.currentStep:"closed",n=a.isFlowOpen?a.currentStep:"closed";return i!==n&&l.current.transition(i,n),a})},[]),d=(0,n.useRouter)(),{team:u}=(0,eh.useTeam)(),p=(0,to.useIsVercelian)(),m=o.isFlowOpen&&"terms"!==o.currentStep?o.configuration:i,{canCreateResource:x,isLoading:f,isDeleteRequested:b}=(0,ex.useInstallationPermissions)(m?.id),{data:y}=(0,ef.useInstallationPaymentMethodState)({integrationConfigurationId:m?.id}),{data:j}=(0,ef.useIntegrationPaymentMethodState)(),v=m?y:j,w=(0,tl.useAwaitData)(v),C=!!o.isFlowOpen&&"isExistingInstallFlow"in o&&o.isExistingInstallFlow,{data:I}=(0,tn.default)(C?m?.id:void 0),k=I?.billingPlan,{data:P}=(0,ta.useMarketplaceBillingBalance)(m?.id),{createAuthorization:N,getAuthorizationState:L,handleUserActions:M}=(0,te.useMarketplaceBillingAuthorizationApi)(),{createResource:F}=(0,tt.useMutateResource)(),B=o.isFlowOpen&&"provisioning"===o.currentStep,E=B?o.configuration.id:void 0,O=B?o.billingPlan.id:void 0,A=(0,a.useCallback)(async(e,t,a)=>{if(!u||!E||!O)return;let i=`/v1/integrations/installations/${E}/resources/${e}/billing/threshold?teamId=${u.id}`;t.autoRecharge&&await (0,Y.fetchAPI)(i,{throwOnHTTPError:!0,method:"POST",body:JSON.stringify({billingPlanId:O,minimumAmountInCents:tc(t.topUpThreshold),purchaseAmountInCents:tc(t.topUpAmount),maximumAmountPerPeriodInCents:tc(t.periodSpendMaximum),metadata:JSON.stringify(a)})})},[u,E,O]),_=(0,a.useCallback)(async e=>{if(u){c(t=>t.isFlowOpen?{...t,provisioningStatus:{status:"creating-resource",authorizationId:e.authorizationId}}:t),l.current.log("api","createResource:start",{configurationId:e.configurationId,productId:e.productId,billingPlanId:e.billingPlanId});try{let t=await F({integrationConfigurationId:e.configurationId,integrationProductIdOrSlug:e.productId,billingPlanId:e.billingPlanId,authorizationId:e.authorizationId,name:e.resourceName,metadata:e.metadataState,protocolSettings:e.protocolSettings,source:"marketplace"});"prepayment"===e.billingPlanType&&e.rechargeSettings&&await A(t.id,e.rechargeSettings,e.metadataState),l.current.log("api","createResource:success",{resourceId:t.id}),c(e=>e.isFlowOpen?{...e,provisioningStatus:{status:"success",resource:t}}:e)}catch(e){l.current.log("error","createResource:failed",{error:e instanceof Error?e.message:String(e)}),console.error("[marketplace-checkout] Flow error — debug log:",l.current.dump()),c(t=>t.isFlowOpen?{...t,provisioningStatus:{status:"error",error:e instanceof Error?e.message:"Failed to create resource"}}:t)}}},[u,F,A]),R=o.isFlowOpen&&"terms"!==o.currentStep&&"billing-plan"!==o.currentStep&&"top-up"!==o.currentStep,z=R?o.billingPlan:null,T=R?o.protocolSettings:void 0,D=R?o.configuration?.id:void 0,$=(0,a.useCallback)(async e=>{if(!u||!R||!z||!D)return;let t=z.type,a={configurationId:D,productId:e.productId,billingPlanId:e.billingPlanId,billingPlanType:t,resourceName:e.resourceName,metadataState:e.metadataState,protocolSettings:T,rechargeSettings:e.rechargeSettings};l.current.log("api","provisioning:start",{productId:e.productId,billingPlanId:e.billingPlanId,configurationId:D});try{let t=e.selectedPaymentMethodId??v?.paymentMethodId,i=await N(u.id,{integrationIdOrSlug:e.integrationId,productId:e.productId,integrationConfigurationId:D,billingPlanId:e.billingPlanId,metadata:e.metadataState,source:"marketplace",prepaymentAmountCents:e.prepaymentAmountCents,paymentMethodId:t});if(!i){l.current.log("api","provisioning:noAuthRequired"),await _(a);return}l.current.log("api","provisioning:authCreated",{authorizationId:i.id}),c(e=>e.isFlowOpen&&"provisioning"===e.currentStep?{...e,provisioningStatus:{status:"awaiting-authorization",authorizationId:i.id}}:e);let n=!1;for(;;){await new Promise(e=>setTimeout(e,1e3));let e=await L(u.id,i.id);if("requires_action"===e.status&&!n){l.current.log("api","provisioning:requiresAction",{authorizationId:e.id}),c(t=>t.isFlowOpen&&"provisioning"===t.currentStep?{...t,provisioningStatus:{status:"requires-action",authorizationId:e.id}}:t),await M(e),n=!0;continue}if("succeeded"===e.status){l.current.log("api","provisioning:authSucceeded",{authorizationId:e.id}),await _({...a,authorizationId:e.id});return}if("failed"===e.status){l.current.log("error","provisioning:authFailed",{authorizationId:e.id}),console.error("[marketplace-checkout] Flow error — debug log:",l.current.dump()),c(e=>e.isFlowOpen&&"provisioning"===e.currentStep?{isFlowOpen:!0,currentStep:"payment-method",integration:e.integration,product:e.product,configuration:e.configuration,billingPlan:e.billingPlan,protocolSettings:e.protocolSettings,error:"Preauthorization failed. Please try again with a different payment method.",isExistingInstallFlow:e.isExistingInstallFlow,isPreInstallPayment:!1}:e);return}}}catch(e){l.current.log("error","provisioning:failed",{error:e instanceof Error?e.message:String(e)}),console.error("[marketplace-checkout] Flow error — debug log:",l.current.dump()),c(t=>t.isFlowOpen&&"provisioning"===t.currentStep?{...t,provisioningStatus:{status:"error",error:e instanceof Error?e.message:"Failed to create authorization"}}:t)}},[u,R,z,T,D,N,v?.paymentMethodId,_,L,M]),U=o.isFlowOpen&&"terms"===o.currentStep,q=U?o.integration:null,V=(0,a.useCallback)(async()=>{if(!u||!U||!q)return null;c(e=>e.isFlowOpen&&"terms"===e.currentStep?{...e,isInstalling:!0,installError:null}:e),l.current.log("api","installIntegration:start");try{let e={},t=new Date().toISOString();q.eulaDocUri&&(e.eula=t),q.privacyDocUri&&(e.privacy=t);let a=await (0,ti.installMarketplaceIntegration)({integration:q,teamId:u.id,acceptedPolicies:e,source:"marketplace"});return l.current.log("api","installIntegration:success",{configId:a.id}),a}catch(e){return l.current.log("error","installIntegration:failed",{error:e instanceof Error?e.message:String(e)}),console.error("[marketplace-checkout] Flow error — debug log:",l.current.dump()),c(t=>t.isFlowOpen&&"terms"===t.currentStep?{...t,isInstalling:!1,installError:e instanceof Error?e.message:"Failed to install integration"}:t),null}},[u,U,q]),W=o.isFlowOpen&&("billing-plan"===o.currentStep||"payment-method"===o.currentStep),G=W?o.integration:null,H=(0,a.useCallback)(async e=>{if(!u||!W||!G)return null;l.current.log("api","authorizeThenInstall:start",{billingPlanId:e.billingPlan.id,paymentMethodRequired:e.billingPlan.paymentMethodRequired}),c(e=>e.isFlowOpen&&("billing-plan"===e.currentStep||"payment-method"===e.currentStep)?{...e,isInstalling:!0,installError:null}:e);try{let t,a={},i=new Date().toISOString();G.eulaDocUri&&(a.eula=i),G.privacyDocUri&&(a.privacy=i);let n=G.flags?.includes(tr.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan);if(e.billingPlan.paymentMethodRequired||n){let a=e.paymentMethodId??v?.paymentMethodId,i=await N(u.id,{integrationIdOrSlug:G.id,billingPlanId:e.billingPlan.id,metadata:e.metadata,integrationConfigurationId:void 0,paymentMethodId:a,source:"marketplace"});if(i){l.current.log("api","authorizeThenInstall:authCreated",{authorizationId:i.id});let e=!1;for(;;){await new Promise(e=>setTimeout(e,1e3));let a=await L(u.id,i.id);if("requires_action"===a.status&&!e){l.current.log("api","authorizeThenInstall:requiresAction"),await M(a),e=!0;continue}if("succeeded"===a.status){l.current.log("api","authorizeThenInstall:authSucceeded"),t=a.id;break}if("failed"===a.status)throw l.current.log("error","authorizeThenInstall:authFailed"),Error("Authorization failed. Please try again with a different payment method.")}}else if(e.billingPlan.paymentMethodRequired)throw Error("Unable to authorize payment. Please try again with a different payment method.")}let r=await (0,ti.installMarketplaceIntegration)({integration:G,teamId:u.id,acceptedPolicies:a,metadata:e.metadata,billingPlanId:e.billingPlan.id,authorizationId:t,source:"marketplace"});return l.current.log("api","authorizeThenInstall:installed",{configId:r.id}),e.paymentMethodId&&await (0,ef.updateInstallationPaymentMethod)(u.id,r.id,e.paymentMethodId),r}catch(e){return l.current.log("error","authorizeThenInstall:failed",{error:e instanceof Error?e.message:String(e)}),console.error("[marketplace-checkout] Flow error — debug log:",l.current.dump()),c(t=>t.isFlowOpen&&("billing-plan"===t.currentStep||"payment-method"===t.currentStep)?{...t,isInstalling:!1,installError:e instanceof Error?e.message:"Failed to install integration"}:t),null}},[u,W,G,v?.paymentMethodId,N,L,M]);(0,a.useImperativeHandle)(r,()=>({openCheckout:(e,t,a)=>{if(!e||!t)throw Error("Integration and product are required to open the flow");l.current=new ts,l.current.log("action","openCheckout",{integrationId:e.id,productId:t.id,isExistingInstall:!!a}),a?c({isFlowOpen:!0,currentStep:"metadata",integration:e,product:t,configuration:a,billingPlan:null,protocolSettings:void 0,error:null,isExistingInstallFlow:!0,skipBillingPlanSelector:!1}):c({isFlowOpen:!0,currentStep:"terms",integration:e,product:t,configuration:null,isInstalling:!1,installError:null,isExistingInstallFlow:!1})},closeCheckout:()=>{c({isFlowOpen:!1})}}),[]);let K=(0,a.useRef)(null),J=o.isFlowOpen?o.currentStep:null;if((0,a.useEffect)(()=>{K.current?.scrollTo({top:0,behavior:"smooth"})},[J]),!o.isFlowOpen)return null;let{integration:X,product:Z}=o,Q="marketplace";function ee(e){e||c({isFlowOpen:!1})}let et=!o.isExistingInstallFlow,ea=e=>"terms"===o.currentStep?"terms"===e?"active":"locked":"billing-plan"===o.currentStep?"terms"===e?"complete":"billing-plan"===e?"active":"locked":"metadata"===o.currentStep?"terms"===e||"billing-plan"===e?"complete":"metadata"===e?"active":"locked":"top-up"===o.currentStep?"terms"===e||"billing-plan"===e||"metadata"===e?"complete":"top-up"===e?"active":"locked":"payment-method"===o.currentStep?"terms"===e||"billing-plan"===e||"metadata"===e||"top-up"===e?"complete":"payment-method"===e?"active":"locked":"confirm"===o.currentStep?"terms"===e||"billing-plan"===e||"metadata"===e||"top-up"===e||"payment-method"===e?"complete":"confirm"===e?"active":"locked":"provisioning"===o.currentStep?"provisioning"===e?"active":"complete":"locked",ei=async()=>{let e=X.flags?.includes(tr.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan);if(l.current.log("action","termsAccepted",{isInstallationOnlyPlanMode:e}),e)c({isFlowOpen:!0,currentStep:"billing-plan",integration:X,product:Z,configuration:null,isInstalling:!1,installError:null,isExistingInstallFlow:!1});else{let e=await V();e&&c({isFlowOpen:!0,currentStep:"metadata",integration:X,product:Z,configuration:e,billingPlan:null,protocolSettings:void 0,error:null,isExistingInstallFlow:!1,skipBillingPlanSelector:!1})}},en=async e=>{if(!u)return;let t=e.billingPlan.paymentMethodRequired?await w:void 0,a=t&&(0,eY.getIsPaymentMethodStepNeeded)(u,t,e.billingPlan);if(l.current.log("action","billingPlanContinue",{needsPaymentMethod:!!a,planId:e.billingPlan.id}),a)return void c({isFlowOpen:!0,currentStep:"payment-method",integration:X,product:Z,configuration:null,billingPlan:e.billingPlan,protocolSettings:void 0,error:null,isExistingInstallFlow:!1,isPreInstallPayment:!0,pendingMetadata:e.metadata});let i=await H({billingPlan:e.billingPlan,metadata:e.metadata,paymentMethodId:t?.paymentMethodId});i&&(Object.keys(Z.metadataSchema?.properties??{}).length>0?c({isFlowOpen:!0,currentStep:"metadata",integration:X,product:Z,configuration:i,billingPlan:null,protocolSettings:void 0,error:null,isExistingInstallFlow:!1,skipBillingPlanSelector:!0}):c({isFlowOpen:!0,currentStep:"confirm",integration:X,product:Z,configuration:i,billingPlan:e.billingPlan,protocolSettings:void 0,selectedPaymentMethodId:void 0,isExistingInstallFlow:!1}))},er=X.flags?.includes(tr.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan),el=Object.keys(Z.metadataSchema?.properties??{}).length>0,eo=C||!er||el,em=(0,t.jsx)(ep.ResourceFormProvider,{metadataSchema:Z.metadataSchema,resourceTitle:Z.name,target:"create",children:(0,t.jsx)(eg.MarketplaceInstallationBillingPlansProvider,{defaultPlan:k??m?.billingPlan,isBillingPlanPreselected:C||o.isFlowOpen&&"metadata"===o.currentStep&&o.skipBillingPlanSelector,target:"create",children:(0,t.jsxs)("div",{className:"flex flex-col gap-6 px-6 pb-6 pt-3",children:[et&&(0,t.jsx)(e4,{label:"Terms of service",state:ea("terms"),isOpen:"terms"===o.currentStep,children:"terms"===o.currentStep&&(0,t.jsx)(e7,{integration:X,isInstalling:o.isInstalling,error:o.installError,onAccept:ei})}),"billing-plan"===o.currentStep&&u&&(0,t.jsx)(e4,{label:"Select Plan",state:ea("billing-plan"),isOpen:"billing-plan"===o.currentStep,children:(0,t.jsx)(ep.ResourceFormProvider,{metadataSchema:X.metadataSchema??td,resourceTitle:X.name,target:"create",children:(0,t.jsx)(ev,{mode:"pre-install",integration:X,teamId:u.id,source:Q,isInstalling:o.isInstalling,error:o.installError,onBack:()=>{c({isFlowOpen:!0,currentStep:"terms",integration:X,product:Z,configuration:null,isInstalling:!1,installError:null,isExistingInstallFlow:!1})},onContinue:en})})}),eo&&(0,t.jsx)(e4,{label:"Parameters and Plan",state:ea("metadata"),isOpen:"metadata"===o.currentStep,children:"metadata"===o.currentStep&&(0,t.jsx)(ev,{integration:X,product:Z,configuration:o.configuration,skipBillingPlanSelector:o.skipBillingPlanSelector,onContinue:(e,t)=>{"prepayment"===e.type&&("installation"!==e.scope||(P?.balance?.currencyValueInCents??0)===0)?c({isFlowOpen:!0,currentStep:"top-up",integration:X,product:Z,configuration:o.configuration,billingPlan:e,protocolSettings:t,error:null,isExistingInstallFlow:o.isExistingInstallFlow}):u&&v&&(0,eY.getIsPaymentMethodStepNeeded)(u,v,e)?c({isFlowOpen:!0,currentStep:"payment-method",integration:X,product:Z,configuration:o.configuration,billingPlan:e,protocolSettings:t,error:null,isExistingInstallFlow:o.isExistingInstallFlow,isPreInstallPayment:!1}):c({isFlowOpen:!0,currentStep:"confirm",integration:X,product:Z,configuration:o.configuration,billingPlan:e,protocolSettings:t,selectedPaymentMethodId:void 0,isExistingInstallFlow:o.isExistingInstallFlow})},source:Q})}),o.isFlowOpen&&"billingPlan"in o&&o.billingPlan?.type==="prepayment"&&(0,t.jsx)(e4,{label:"Balance Top Up",state:ea("top-up"),isOpen:"top-up"===o.currentStep,children:"top-up"===o.currentStep&&(0,t.jsx)(e5,{billingPlan:o.billingPlan,currentBalanceInCents:P?.balance?.currencyValueInCents,onBack:()=>{c({isFlowOpen:!0,currentStep:"metadata",integration:X,product:Z,configuration:o.configuration,billingPlan:null,protocolSettings:void 0,error:null,isExistingInstallFlow:o.isExistingInstallFlow,skipBillingPlanSelector:!1})},onNext:()=>{u&&v&&(0,eY.getIsPaymentMethodStepNeeded)(u,v,o.billingPlan)?c({isFlowOpen:!0,currentStep:"payment-method",integration:X,product:Z,configuration:o.configuration,billingPlan:o.billingPlan,protocolSettings:o.protocolSettings,error:null,isExistingInstallFlow:o.isExistingInstallFlow,isPreInstallPayment:!1}):c({isFlowOpen:!0,currentStep:"confirm",integration:X,product:Z,configuration:o.configuration,billingPlan:o.billingPlan,protocolSettings:o.protocolSettings,selectedPaymentMethodId:void 0,isExistingInstallFlow:o.isExistingInstallFlow})}})}),(0,t.jsx)(e4,{label:"Payment Method",state:ea("payment-method"),isOpen:"payment-method"===o.currentStep,children:"payment-method"===o.currentStep&&u&&v&&(0,t.jsx)(eJ,{team:u,configuration:o.configuration,paymentMethodState:v,error:o.error,onBack:()=>{o.isPreInstallPayment?c({isFlowOpen:!0,currentStep:"billing-plan",integration:X,product:Z,configuration:null,isInstalling:!1,installError:null,isExistingInstallFlow:!1}):o.configuration&&c({isFlowOpen:!0,currentStep:"metadata",integration:X,product:Z,configuration:o.configuration,billingPlan:null,protocolSettings:void 0,error:null,isExistingInstallFlow:o.isExistingInstallFlow,skipBillingPlanSelector:!1})},onNext:async e=>{if(l.current.log("action","paymentNext",{isPreInstall:o.isPreInstallPayment,hasProductMetadata:Object.keys(Z.metadataSchema?.properties??{}).length>0}),o.isPreInstallPayment&&o.pendingMetadata){let t=await H({billingPlan:o.billingPlan,metadata:o.pendingMetadata,paymentMethodId:e});t&&(Object.keys(Z.metadataSchema?.properties??{}).length>0?c({isFlowOpen:!0,currentStep:"metadata",integration:X,product:Z,configuration:t,billingPlan:null,protocolSettings:void 0,error:null,isExistingInstallFlow:!1,skipBillingPlanSelector:!0}):c({isFlowOpen:!0,currentStep:"confirm",integration:X,product:Z,configuration:t,billingPlan:o.billingPlan,protocolSettings:void 0,selectedPaymentMethodId:e,isExistingInstallFlow:!1}))}else o.configuration&&c({isFlowOpen:!0,currentStep:"confirm",integration:X,product:Z,configuration:o.configuration,billingPlan:o.billingPlan,protocolSettings:o.protocolSettings,selectedPaymentMethodId:e,isExistingInstallFlow:o.isExistingInstallFlow})}})}),(0,t.jsx)(e4,{label:"Confirmation",state:ea("confirm"),isOpen:"confirm"===o.currentStep,children:"confirm"===o.currentStep&&(0,t.jsx)(eM,{integration:X,product:Z,selectedPaymentMethodId:o.selectedPaymentMethodId,onBack:eo?()=>{c({isFlowOpen:!0,currentStep:"metadata",integration:X,product:Z,configuration:o.configuration,billingPlan:null,protocolSettings:void 0,error:null,isExistingInstallFlow:o.isExistingInstallFlow,skipBillingPlanSelector:!1})}:void 0,onConfirmStart:e=>{c({isFlowOpen:!0,currentStep:"provisioning",integration:X,product:Z,configuration:o.configuration,billingPlan:o.billingPlan,protocolSettings:o.protocolSettings,resourceName:e.resourceName,metadataState:e.metadataState,prepaymentAmountCents:e.prepaymentAmountCents,rechargeSettings:e.rechargeSettings,provisioningStatus:{status:"authorizing"},selectedPaymentMethodId:e.selectedPaymentMethodId,isExistingInstallFlow:o.isExistingInstallFlow}),$(e)}})}),(0,t.jsx)(e4,{label:`${(0,eN.getResourceTitleByProduct)(Z)} Creation`,state:ea("provisioning"),isOpen:"provisioning"===o.currentStep,isLastStep:!0,children:"provisioning"===o.currentStep&&u&&(0,t.jsx)(eE,{product:Z,provisioningStatus:o.provisioningStatus,onBack:()=>c({isFlowOpen:!0,currentStep:"confirm",integration:X,product:Z,configuration:o.configuration,billingPlan:o.billingPlan,protocolSettings:o.protocolSettings,selectedPaymentMethodId:o.selectedPaymentMethodId,isExistingInstallFlow:o.isExistingInstallFlow}),onDone:()=>{if(c({isFlowOpen:!1}),u&&"success"===o.provisioningStatus.status){let e=(0,S.getResourceDetailsPath)(o.provisioningStatus.resource,u.slug);d.push(e)}},onDownloadDebugLog:p?()=>l.current.download():void 0})})]})})});return(0,t.jsxs)(es.Sheet,{open:!0,onOpenChange:ee,children:[(0,t.jsx)("div",{className:"fixed inset-0 z-[99] bg-background-200/50",onClick:()=>ee(!1),"aria-hidden":"true"}),(0,t.jsx)(es.SheetContent,{side:"right",className:"m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-y-auto rounded-[1rem] bg-white p-0 pb-6 lg:m-6 lg:h-[calc(100%-3rem)] lg:w-3/4 lg:max-w-[640px]",children:(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"relative p-6 pb-2",children:[(0,t.jsxs)(es.SheetTitle,{className:"m-0 text-heading-20 font-medium text-gray-1000",children:["Install ",X.name]}),(0,t.jsxs)("div",{className:"absolute right-6 top-6 flex items-center gap-1",children:[p&&(0,t.jsx)(h.Tooltip,{text:"Download checkout debug log",children:(0,t.jsx)(g.Button,{svgOnly:!0,"aria-label":"Download debug log",shape:"square",size:"tiny",type:"tertiary",onClick:()=>l.current.download(),children:(0,t.jsx)(eu.Download,{})})}),(0,t.jsx)(g.Button,{svgOnly:!0,"aria-label":"Close",shape:"square",size:"tiny",type:"tertiary",onClick:()=>ee(!1),children:(0,t.jsx)(ed.Cross,{})})]})]}),(0,t.jsx)("div",{ref:K,className:"flex-1 overflow-y-auto",children:m&&b?(0,t.jsx)("div",{className:"px-6 pb-6 pt-3",children:(0,t.jsx)(ec.Note,{type:"warning",children:(0,eN.pendingDeletionLabel)("create",Z,u?.name)})}):!m||f||x?em:(0,t.jsx)("div",{className:"px-6 pb-6 pt-3",children:(0,t.jsx)(ec.Note,{type:"warning",children:(0,eN.missingPermissionLabel)("create",Z,u?.name)})})})]})})]})});e.s(["IntegrationCheckout",0,tu],2660880);var tg=e.i(8042625);function tp(e){let{product:i,integration:l,disabled:o,onAddAction:s,tooltip:u,teamSlugOrPublic:p,enableMarketplaceNewCheckout:x,configuration:b}=e,y=(0,n.useRouter)(),j=(0,f.useOpenInstallMarketplaceProductModal)(),{isPublic:v}=p,w=!!l?.comingSoon,C=(0,B.useServerFlag)("enable-marketplace-drawer-checkout-flow",!1),I=(0,B.useServerFlag)("enable-stripe-link",!1),S=(0,a.useRef)(null),k=l.capabilities?.connectedImportResource===!0||l.capabilities?.nativeImportResource===!0,P=I&&k&&!v&&p.teamSlug,N=(0,a.useCallback)(()=>{(r.analytics.track("marketplace_product_install_clicked",{integration_id:l.id,integration_slug:l.slug,integration_name:l.name,product_id:i.id,product_slug:i.slug,product_name:i.name,source:"product_card",is_public:v},{send_to:{product_analytics:!0}}),v)?y.push(`/login?next=${(0,c.getIntegrationDetailsLink)({integrationSlug:l.slug,teamSlugOrPublic:{isPublic:!0}})}`):s?s():S.current?S.current?.openCheckout(l,i,b):x&&p.teamSlug?y.push((0,M.getIntegrationCheckoutUrl)({params:{integrationSlug:l.slug,teamSlug:p.teamSlug},searchParams:{installationId:b?.id,productSlug:i.slug,cancelUrl:`${window.location.pathname}${window.location.search}`}})):j({product:i,integration:l})},[v,y,l,i,s,S,x,p.teamSlug,b,j]),L=(0,a.useCallback)(()=>{if(!p.teamSlug)return;r.analytics.track("marketplace_product_import_clicked",{integration_id:l.id,integration_slug:l.slug,integration_name:l.name,product_id:i.id,product_slug:i.slug,product_name:i.name,team_slug:p.teamSlug,source:"product_card"},{send_to:{product_analytics:!0}});let e=`/${p.teamSlug}/~/integrations/import/${l.slug}${(0,tg.encode)({installationId:b?.id})}`;y.push(e)},[p.teamSlug,l.slug,l.id,l.name,i.id,i.slug,i.name,b?.id,y]),F=!v&&o||w;return P?(0,t.jsxs)(t.Fragment,{children:[C?(0,t.jsx)(tu,{ref:S,configuration:b}):null,(0,t.jsx)(m.SplitButton,{buttonProps:{"data-testid":(0,d.tid)("install-marketplace-modal",i.id),disabled:F,onClick:N,size:"small",type:"secondary"},menuButtonLabel:"Installation options",menuAlignment:"bottom-end",menuProps:{width:"auto"},menuItems:[(0,t.jsx)(m.SplitButtonMenuItem,{title:`Install New ${i.name} ${(0,eN.getResourceTitleByProduct)(i)}`,menuItemProps:{onClick:N}},"install-new"),(0,t.jsx)(m.SplitButtonMenuItem,{title:`Import Existing ${i.name} ${(0,eN.getExistingResourceTitleByProduct)(i)}`,menuItemProps:{onClick:L}},"import-existing")],children:"Install"})]}):(0,t.jsxs)(t.Fragment,{children:[C?(0,t.jsx)(tu,{ref:S,configuration:b}):null,(0,t.jsx)(g.Button,{"data-testid":(0,d.tid)("install-marketplace-modal",i.id),disabled:F,onClick:N,size:"small",type:"secondary",typeName:"button",rel:"nofollow",children:(0,t.jsx)(h.Tooltip,{disableTriggers:!u&&!w,text:w?"This integration is coming soon.":u||"",children:"Install"})})]})}function tm(e){let a=(0,n.useRouter)(),r=(0,B.useServerFlag)("enable-marketplace-of-products",!1),{isPublic:l}=e.teamSlugOrPublic;if(e.integration.comingSoon)return(0,t.jsx)(en,{product:e.product,integration:e.integration,categories:e.categories,variant:e.variant,showMore:e.showMore});let o=(0,t.jsx)(tx,{actionButton:l?null:(0,t.jsx)(th,{...e}),footerContent:e.product.shortBillingPlansDescription,iconElement:(0,t.jsx)(s.GlowProductIcon,{icon:r?e.product.iconUrl:e.integration.icon,size:"large",integrationColor:r?e.product.iconBackgroundColor:e.integration.accentColor}),accentBackground:r?e.product.iconBackgroundColor:e.integration.accentColor,productName:r?e.product.name:e.integration.name,productDescription:r?e.product.shortDescription:e.integration.shortDescription,isPrivate:!(0,I.integrationPubliclyVisible)(e.integration),showMore:e.showMore,categories:e.categories,product:e.product,integration:e.integration,category:e.category});return(0,t.jsx)(i.Link,{"aria-label":`Open ${e.product.name}`,className:`group block no-underline ${e.showMore?"":"rounded"}`,href:e.href,onMouseDown:(0,b.buildOnMouseDown)({href:e.href,router:a}),"data-testid":(0,d.tid)("product-card",e.product.id),children:o})}function th(e){let{integration:r,configurations:l,product:o}=e,s=(0,f.useOpenInstallMarketplaceProductModal)(),d=(0,w.useTeamSlug)(),u=(0,N.filterMarketplaceConfigurations)(l),p=C({integration:r,marketplaceConfigurations:u}),x=(0,n.useRouter)(),{isLoading:b,canCreateIntegrationConfiguration:y}=(0,L.useIntegrationPermissions)(),j=(0,B.useServerFlag)("enable-marketplace-new-checkout",!1),v=(0,B.useServerFlag)("enable-stripe-link",!1),I=!!r?.comingSoon,S=!r.canInstall&&!!r.hiddenAt,k=u.at(0),P=r.capabilities?.connectedImportResource===!0||r.capabilities?.nativeImportResource===!0,F=v&&P&&d,E=(0,a.useCallback)(()=>{j&&d?x.push((0,M.getIntegrationCheckoutUrl)({params:{integrationSlug:r.slug,teamSlug:d},searchParams:{productSlug:o?.slug,cancelUrl:`${window.location.pathname}${window.location.search}`}})):s({product:o,integration:r})},[j,d,x,r,o,s]),O=(0,a.useCallback)(()=>{if(!d)return;let e=new URL(`/${d}/~/integrations/import/${r.slug}`,window.location.origin);k?.id&&e.searchParams.set("installationId",k.id),x.push(e.pathname+e.search)},[d,r.slug,k?.id,x]);if(p.isLoading)return null;let A=b||!y||I;if((!p.canInstallIntegration||S)&&d&&k){let e=(0,c.getInstallationDetailsLink)({teamSlug:d,integrationSlug:r.slug,configurationId:k.id,isMarketplace:!0});return(0,t.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,t.jsx)(i.Link,{href:e,className:"no-underline",children:(0,t.jsx)(g.Button,{"aria-label":"Manage Product",size:"small",type:"secondary",typeName:"button",className:"no-underline",children:"Manage"})})})}return S?null:F?(0,t.jsx)("div",{className:"absolute top-4 right-4 z-10",onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),role:"presentation",children:(0,t.jsx)(m.SplitButton,{buttonProps:{disabled:A,onClick:E,size:"small",type:"secondary"},menuButtonLabel:"Installation options",menuAlignment:"bottom-end",menuProps:{width:"auto"},menuItems:[(0,t.jsx)(m.SplitButtonMenuItem,{title:`Install New${o?` ${o.name} ${(0,eN.getResourceTitleByProduct)(o)}`:""}`,menuItemProps:{onClick:E}}),(0,t.jsx)(m.SplitButtonMenuItem,{title:`Import Existing${o?` ${o.name} ${(0,eN.getExistingResourceTitleByProduct)(o)}`:""}`,menuItemProps:{onClick:O}})],children:"Install"})}):(0,t.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,t.jsx)(h.Tooltip,{disableTriggers:!A,position:"bottom",text:I?"This integration is coming soon.":"You need additional permissions to add integrations.",children:(0,t.jsxs)(g.Button,{"aria-label":"Add Product",size:"small",type:"secondary",typeName:"button",className:"relative",disabled:A,children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 size-full cursor-pointer",tabIndex:0,role:"button","aria-label":`Install ${r.name}`,onClick:e=>{e.preventDefault(),e.stopPropagation(),E()},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),E())}}),"Install"]})})})}function tx(e){let{iconElement:i,productName:n,productDescription:r,categories:l,product:o,integration:s,accentBackground:c,showMore:d,category:g}=e,[p,m]=(0,a.useState)({x:50,y:50}),[h,f]=(0,a.useState)(!1),b=(0,a.useRef)(null),{resolvedTheme:y}=(0,F.useTheme)(),j="dark"===y,v=X().enabled,w=(0,a.useMemo)(()=>P(s,o,l,g),[s,o,l,g]),C=(0,a.useMemo)(()=>{let e=(c||"#0070F3").replace("#",""),t=Number.parseInt(e.substring(0,2),16),a=Number.parseInt(e.substring(2,4),16),i=Number.parseInt(e.substring(4,6),16),n=j?.15:.1;return`rgba(${t}, ${a}, ${i}, ${n})`},[j,c]),I=(0,a.useCallback)(e=>{b.current&&requestAnimationFrame(()=>{if(!b.current)return;let t=b.current.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*100,i=(e.clientY-t.top)/t.height*100;m(e=>{let t=Math.abs(e.x-a),n=Math.abs(e.y-i);return t>2||n>2?{x:a,y:i}:e})})},[]),S=(0,a.useCallback)(()=>{f(!0)},[]),k=(0,a.useCallback)(()=>{f(!1),m({x:50,y:50})},[]),N=(0,a.useMemo)(()=>({zIndex:0,position:"absolute",top:0,left:0,width:"100%",height:"100%",background:`radial-gradient(circle at ${p.x}% ${p.y}%, ${C} 0%, rgba(255,255,255,0) 90%)`,opacity:+!!h,transition:"opacity 0.3s ease-out",pointerEvents:"none",transform:"translate3d(0, 0, 0)",willChange:h?"opacity":"auto"}),[p.x,p.y,h,C]);return(0,t.jsxs)("div",{className:`group relative flex flex-col items-center justify-between gap-3 overflow-hidden p-4 ${d?"pb-7":"h-[200px] rounded"} bg-white shadow-border`,ref:b,onMouseMove:I,onMouseEnter:S,onMouseLeave:k,children:[h?(0,t.jsx)("div",{style:N}):null,(0,t.jsx)("div",{className:"relative z-10 flex w-full flex-row items-center justify-between",children:(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)(u.Badge,{size:"sm",className:"bg-gray-alpha-100",variant:"gray-subtle",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[w.isAgentCategory&&(0,t.jsx)(x.Agents,{className:"size-3"}),w.title]})}),o?.slug==="stripe"?(0,t.jsx)(u.Badge,{size:"sm",variant:"pink",children:"Beta"}):null,s?.installs&&v&&(0,t.jsx)(u.Badge,{size:"sm",className:"bg-blue-alpha-100",variant:"amber",children:s.exactInstalls?s.exactInstalls.toLocaleString():s.installs})]})}),(0,t.jsxs)("div",{className:"relative z-10 flex flex-col items-center gap-2",children:[i,(0,t.jsx)("div",{className:"text-label-16",children:(0,t.jsx)("strong",{children:n})})]}),(0,t.jsx)("div",{className:"relative z-10 w-full text-copy-13 text-gray-900",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",height:"2.6em"},children:r})]})}e.s(["MarketplaceProductCard",0,tm,"MarketplaceProductCardList",0,function(e){let i=(0,a.useMemo)(()=>(function(e){if(!e.category&&!e.search)return(0,S.sortAuthenticationIntegrations)(e.integrations,e.category);if("agents"===e.category){let t=e.integrations.filter(t=>{if(!t.tagIds?.includes("tag_agents"))return!1;if(e.subcategory){let a=`tag_agents_${e.subcategory}`;return t.tagIds?.includes(a)}return!0}).filter(t=>{if(!e.search)return!0;let a=e.search.toLowerCase(),i=t.name.toLowerCase().includes(a),n=t.description?.toLowerCase().includes(a),r=t.products.some(e=>e.name.toLowerCase().includes(a));return i||n||r});return(0,S.sortAuthenticationIntegrations)(t,e.category)}let t=e.integrations.filter(t=>{if(null===e.category)return!0;let a=e.category.replaceAll("-","_"),i=`tag_${a}`;return t.tagIds?.some(e=>e===i||"storage"===a&&"tag_databases"===e||"database"===a&&"tag_databases"===e)}).filter(t=>{if(!e.search)return!0;let a=e.search.toLowerCase(),i=t.products.some(i=>{if((0,I.searchMatchesLogDrains)(e.search)&&(0,y.isProtocolSupported)(i,"logDrain"))return!0;let n=a.replace(/-/g,"").replace(/\s/g,""),r=i.name.toLowerCase().includes(a),l=i.shortDescription.toLowerCase().includes(a),o=t.tagIds?.some(t=>e.categories.find(e=>e.id===t)?.title.toLowerCase().includes(a)),s=i.tags.some(e=>e.toLowerCase().replace(/-/g,"").replace(/\s/g,"").includes(n)),c=(0,I.searchMatchesKV)(e.search)&&(i.tags.includes("redis")||i.tags.includes("kv"));return r||l||o||s||c}),n=t.name.toLowerCase().includes(a);return i||n});return(0,S.sortAuthenticationIntegrations)(t,e.category)})({integrations:e.integrations,search:e.search,category:e.category,subcategory:e.subcategory,categories:e.categories}),[e.integrations,e.search,e.category,e.subcategory,e.categories]),n=(0,B.useServerFlag)("enable-marketplace-of-products",!1),r=(0,B.useServerFlag)("enable-powertool",!1),{data:o,isLoading:s}=(0,ee.default)(K.API_MARKETPLACE_CONFIG,e=>(0,Y.fetchAPI)(e),{revalidateOnFocus:!1,revalidateOnMount:!0,dedupingInterval:6e4}),d=!!(0,l.useV0Marketplace)()?.token,u=(0,a.useMemo)(()=>{if(n){let t=i.flatMap(e=>e.products.map(t=>({type:"product",product:t,integration:e,id:t.id}))),a=void 0!==e.expanded?e.expanded?t.length:5:t.length,n=t.slice(0,a);if(o?.order){let e=new Map(o.order.map((e,t)=>[e,t]));n.sort((t,a)=>(e.get(t.id)??Number.MAX_SAFE_INTEGER)-(e.get(a.id)??Number.MAX_SAFE_INTEGER))}return n}{let t=(void 0!==e.expanded?e.expanded?i:i.slice(0,5):i).map(e=>({type:"integration",integration:e,product:e.products[0],id:e.products[0]?.id||e.id}));if(o?.order){let e=new Map(o.order.map((e,t)=>[e,t]));t.sort((t,a)=>(e.get(t.id)??Number.MAX_SAFE_INTEGER)-(e.get(a.id)??Number.MAX_SAFE_INTEGER))}return t}},[i,e.expanded,n,r,o]);if(s||void 0===o)return(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4 @sm-page:grid-cols-2 @xl-page:grid-cols-3",children:Array.from({length:6},(e,a)=>(0,t.jsx)("div",{className:"relative flex flex-col items-center justify-between gap-3 overflow-hidden p-4 h-[200px] rounded bg-white shadow-border",children:(0,t.jsx)(p.Skeleton,{height:"100%",width:"100%"})},`skeleton-${a}`))});if(!u.length)return(0,t.jsxs)(Q,{enablePowertool:!1,children:[(0,t.jsx)(el,{category:e.category??void 0,categories:e.categories,integrations:e.integrations,teamSlugOrPublic:e.teamSlugOrPublic,isFromV0:d},"request-agent-card"),(0,t.jsx)(eo,{},"provider-card")]});let g=t=>(0,c.getIntegrationDetailsLink)({integrationSlug:t.integration.slug,teamSlugOrPublic:e.teamSlugOrPublic,isFromV0:d});return r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A,{}),(0,t.jsx)(Q,{enablePowertool:r,onReorder:async e=>{try{let t=e.map(e=>e.id),a=await fetch(K.API_MARKETPLACE_CONFIG,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:t})});if(a.ok)console.log("Marketplace order saved successfully");else{let e=await a.text();console.error("Failed to save marketplace order:",e)}}catch(e){console.error("Error saving marketplace order:",e)}},children:u.map(a=>{let i=g(a);if("product"===a.type){let n=e.configurations.filter(e=>e.integrationId===a.integration.id);return(0,t.jsx)(Q.Item,{id:a.id,data:a,children:(0,t.jsx)(tm,{href:i,configurations:n,integration:a.integration,product:a.product,teamSlugOrPublic:e.teamSlugOrPublic,categories:e.categories,category:e.category})},a.id)}{let n=a.integration,r=e.configurations.filter(e=>e.integrationId===n.id);return(0,t.jsx)(Q.Item,{id:a.id,data:a,children:(0,t.jsx)(tm,{href:i,configurations:r,integration:n,product:n.products[0],teamSlugOrPublic:e.teamSlugOrPublic,categories:e.categories,category:e.category})},a.id)}})})]}):(0,t.jsxs)(Q,{enablePowertool:!1,children:[u.map(a=>{if("product"===a.type){let i=e.configurations.filter(e=>e.integrationId===a.integration.id);return(0,t.jsx)(Q.Item,{id:a.id,data:a,children:(0,t.jsx)(tm,{href:g(a),configurations:i,integration:a.integration,product:a.product,teamSlugOrPublic:e.teamSlugOrPublic,categories:e.categories,category:e.category})},a.id)}{let i=a.integration,n=e.configurations.filter(e=>e.integrationId===i.id);return(0,t.jsx)(Q.Item,{id:a.id,data:a,children:(0,t.jsx)(tm,{href:g(a),configurations:n,integration:i,product:i.products[0],teamSlugOrPublic:e.teamSlugOrPublic,categories:e.categories,category:e.category})},a.id)}}),(0,t.jsx)(el,{category:e.category??void 0,categories:e.categories,integrations:e.integrations,teamSlugOrPublic:e.teamSlugOrPublic,isFromV0:d},"request-agent-card"),(0,t.jsx)(eo,{},"provider-card")]})},"MarketplaceProductDetailsCard",0,function(e){let{product:a,integration:i,disabled:n=!1,onAddAction:r,hasAvatar:l,tooltip:s,teamSlugOrPublic:c,enableMarketplaceNewCheckout:d,configuration:g}=e,p=!i.canInstall&&!!i.hiddenAt;return(0,t.jsxs)("div",{className:"flex flex-col justify-between rounded-lg border border-gray-200 bg-white",children:[(0,t.jsx)("div",{className:"flex h-full flex-col gap-1.5 border-gray-200 border-b p-4",children:(0,t.jsxs)("div",{className:"flex flex-row justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[l?(0,t.jsx)(o.ProductIcon,{icon:a.iconUrl,size:"large"}):null,(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)("div",{className:"font-medium",children:a.name}),"published"!==a.reviewStatus?(0,t.jsx)(u.Badge,{size:"sm",variant:"gray-subtle",children:"Private"}):null]}),(0,t.jsx)("div",{className:"text-gray-900",children:a.shortDescription})]})]}),!p&&(0,t.jsx)(tp,{product:a,integration:i,disabled:n,onAddAction:r,tooltip:s,teamSlugOrPublic:c,enableMarketplaceNewCheckout:d,configuration:g})]})}),(0,t.jsx)("div",{className:"rounded-b-lg bg-gray-50 p-3",children:(0,t.jsx)("div",{className:"text-gray-900",children:a.shortBillingPlansDescription})})]})},"MarketplaceProductDetailsCardPlaceholder",0,function(e){let{hasAvatar:a,hasTitle:i}=e;return(0,t.jsxs)("div",{className:"flex flex-col justify-between rounded-lg border border-gray-200 bg-white",children:[(0,t.jsx)("div",{className:"flex h-full flex-row justify-between border-gray-200 border-b p-4",children:(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[a?(0,t.jsx)(p.Skeleton,{boxHeight:36,className:"my-[2px]",height:36,rounded:!0,vcenter:!0,width:36}):null,i?(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(p.Skeleton,{boxHeight:20,height:18,width:140}),(0,t.jsx)(p.Skeleton,{boxHeight:a?18:20,height:18,width:180})]}):(0,t.jsx)("div",{className:"h-[44px]"})]})}),(0,t.jsx)("div",{className:"rounded-b-lg bg-gray-50 p-3",children:(0,t.jsx)(p.Skeleton,{boxHeight:20,height:18,width:200})})]})}],2483928)}]);

//# debugId=c6bb8449-35db-0004-c43b-6ed1765c11aa
//# sourceMappingURL=37e0dbe2aaad02d8.js.map