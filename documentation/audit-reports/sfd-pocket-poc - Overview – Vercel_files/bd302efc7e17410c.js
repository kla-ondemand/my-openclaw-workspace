;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="ce1ce52f-11aa-97e8-1bf4-c183d8dbf95f")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8464143,e=>{"use strict";function t(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)e[r]=i[r]}return e}var i=function e(i,r){function n(e,n,o){if("u">typeof document){"number"==typeof(o=t({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in o)o[a]&&(s+="; "+a,!0!==o[a]&&(s+="="+o[a].split(";")[0]));return document.cookie=e+"="+i.write(n,e)+s}}return Object.create({set:n,get:function(e){if("u">typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],r={},n=0;n<t.length;n++){var o=t[n].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=i.read(s,a),e===a)break}catch(e){}}return e?r[e]:r}},remove:function(e,i){n(e,"",t({},i,{expires:-1}))},withAttributes:function(i){return e(this.converter,t({},this.attributes,i))},withConverter:function(i){return e(t({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(i)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});e.s(["default",0,i])},486333,e=>{"use strict";let t=!!e.i(2144405).default.env.CI,i=window.navigator.webdriver,r=window.self!==window.top||window.parent!==window.self,n=new Set(["Python Requests","Go-http-client","HeadlessChrome"]);e.s(["isBotClient",0,function(){if(void 0===window.navigator||window.navigator.webdriver)return!0;let e=window.navigator.userAgent;return!!n.has(e)||/bot|crawl|spider|slurp|python|curl|wget|headless/i.test(e)},"isCi",0,t,"isDev",0,!1,"isE2E",0,i,"isInIframe",0,r,"isServer",0,!1,"isTest",0,!1])},3198854,5561919,6415792,6247049,e=>{"use strict";let t=Symbol("__v_error"),i=e=>{if(!e)return e;let t={};for(let i in e)void 0!==e[i]&&(t[i]=e[i]);return t};e.s(["removeUndefinedObjectEntries",0,i],5561919);class r extends Error{cause;code;errorId;scope;timestamp;action;attributes;displayMessage;link;metadata;requestId;statusCode;constructor(e,i={}){const{cause:r,errorId:n,name:o,message:s,stack:a,...c}=i;super(e,{cause:r}),this.name=new.target.name,this.errorId=n??function(){let e,t,i;return crypto?.randomUUID?.()??(e=Date.now().toString(36),t=Math.random().toString(36).slice(2,8).padEnd(6,"0"),i=Math.random().toString(36).slice(2,8).padEnd(6,"0"),`${e}-${t}${i}`)}(),this.timestamp=Date.now(),Object.defineProperty(this,t,{value:!0,enumerable:!1,writable:!1,configurable:!1}),Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),Object.assign(this,c)}enrich(e){let{metadata:t,attributes:i,...r}=e;return void 0!==t&&(this.metadata={...this.metadata,...t}),void 0!==i&&(this.attributes={...this.attributes,...i}),Object.assign(this,r),this}toJSON(){return this.serialize()}serialize(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{cause:t,errorId:r,message:n,name:o,stack:s,timestamp:a,...c}=this;return i({__serialized_v_error:!0,errorId:r,message:n,name:o,timestamp:a,...e&&s?{stack:s}:{},...c})}}function n(e){return function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new r(t,{...i,scope:e.scope,attributes:{...e.attributes,...i.attributes||{}},metadata:{...e.metadata,...i.metadata||{}}})}}e.s(["VError",0,r],6415792),e.s(["createErrorFactory",0,n],6247049);let o="dx/cookies",s=n({scope:o});e.s(["logCookieError",0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.error(s(`[${o}] ${e}`,t))}],3198854)},2429523,e=>{"use strict";var t=e.i(8464143),i=e.i(486333),r=e.i(3198854);e.s(["removeCookie",0,function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i.isServer)return void console.warn("[dx/cookies/client/removeCookie] Attempted to remove client cookie on server, skipping");let o={path:"/",...n};try{t.default.remove(e,o)}catch(t){(0,r.logCookieError)(`Failed to remove cookie: ${e}`,{code:"cookie_remove_failed",cause:t,metadata:{cookieName:e,providedRemoveOptions:JSON.stringify(n),finalRemoveOptions:JSON.stringify(o)}})}}])},3013088,e=>{"use strict";var t=e.i(9183349);e.s(["getSafeVercelSubdomainCookieDomain",0,function(e){if(!(0,t.isVercelProd)()||!e)return;let i=e.split(":")[0]?.toLowerCase();if(i&&!(0,t.isVercelSharedInfraDomain)(i)){if(!i)return;let e=i.split(":")[0];if(!e||/^\d+\.\d+\.\d+\.\d+$/.test(e))return;let t=e.split(".");return t.length<2?void 0:`.${t.slice(-2).join(".")}`}}],3013088)},5203382,8134802,e=>{"use strict";var t=e.i(8464143),i=e.i(486333);function r(e){if(!i.isServer)return t.default.get(e)}e.s(["getCookie",0,r],8134802);let n="vercel-cdp-override";function o(){let e=r(n);return"true"===e||"false"!==e&&void 0}e.s(["CDP_OVERRIDE_COOKIE_NAME",0,n,"getCDPOverrideCookieValue",0,o,"hasCDPOverrideCookie",0,function(){return void 0!==o()}],5203382)},9625174,e=>{"use strict";var t=e.i(2144405),i=e.i(9183349),r=e.i(486333),n=e.i(5203382);let o=()=>{let e=(0,n.getCDPOverrideCookieValue)();return void 0!==e?e:"true"===t.default.env.NEXT_PUBLIC_ENABLE_CDP_DEBUG};e.s(["createScopedDebugLogger",0,e=>{var t;return t={isEnabled:o},(0,i.isVercelProd)()||r.isCi||r.isTest||r.isE2E||!t.isEnabled()?()=>{}:function(t,i){for(var n=arguments.length,o=Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];r.isServer?console.debug(`${e} [${t}] ${i}`,...o):console.debug(`%c${e}%c [${t}]%c ${i}`,"color: rgb(120, 120, 120); font-weight: bold;","color: rgb(150, 170, 200);","color: inherit;",...o)}},"isDebugEnabled",0,o],9625174)},486534,1582666,e=>{"use strict";e.i(2144405);var t=e.i(9183349);e.s(["isSecureCookieRequired",0,function(e){return!!((0,t.isVercelProd)()||(0,t.isVercelPreview)())||!e||!!e.startsWith("https:")}],486534),e.s(["DEFAULT_COOKIE_EXPIRES_IN_DAYS",0,30],1582666)},7305223,e=>{"use strict";var t=e.i(8464143),i=e.i(486333),r=e.i(486534),n=e.i(1582666),o=e.i(3198854);e.s(["writeJSONCookie",0,function(e,s,a){try{let c=JSON.stringify(s);!function(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(i.isServer)return console.warn("[dx/cookies] Attempted to write client cookie on server, skipping");let c=(0,r.isSecureCookieRequired)(window.location.href),{expiresInDays:d,path:l,secure:u,sameSite:h,domain:f,httpOnly:p}={...{path:"/",expiresInDays:n.DEFAULT_COOKIE_EXPIRES_IN_DAYS,secure:c,sameSite:"lax"},...a},g={path:l,secure:u,sameSite:h,...f&&{domain:f},...d>0&&{expires:d}};try{t.default.set(e,s,g)}catch(t){(0,o.logCookieError)(`Failed to write cookie: ${e}`,{code:"cookie_write_failed",cause:t,metadata:{cookieName:e,valueLength:s.length,valuePreview:s.substring(0,50)+(s.length>50?"...":""),providedWriteOptions:JSON.stringify(a),finalWriteOptions:JSON.stringify(g)}})}}(e,c,a)}catch(t){(0,o.logCookieError)(`Failed to write JSON data for cookie: ${e}`,{code:"cookie_write_json_failed",cause:t,metadata:{cookieName:e,dataType:typeof s,options:a?JSON.stringify(a):void 0}})}}],7305223)},6465021,e=>{"use strict";var t=e.i(8134802),i=e.i(7305223),r=e.i(2429523),n=e.i(3198854),o=e.i(8464143),s=e.i(486333);e.s(["createVersionedCookie",0,function(e){let{name:a,version:c,writeOptions:d}=e;return{get(i){let r;if(!(r=i?i.get(a):(0,t.getCookie)(a)))return;let o=function(e){if(e)try{return JSON.parse(e)}catch(t){(0,n.logCookieError)("Failed to parse JSON cookie value",{code:"cookie_json_parse_failed",cause:t,metadata:{valueLength:e.length,valuePreview:e.substring(0,100)+(e.length>100?"...":""),startsWithBrace:e.startsWith("{"),endsWithBrace:e.endsWith("}")}});return}}(r);if(!o)return;if(o.version!==c)return void console.warn(`[dx/cookies] Version mismatch for cookie '${e.name}' and no migration configured. Returning undefined.`,{expected:c,received:o.version});let{version:s,...d}=o;return d},write(e){let t={...e,version:c};(0,i.writeJSONCookie)(a,t,d)},delete(){(0,r.removeCookie)(a,{path:d.path,domain:d.domain})},has:e=>e?e.has(a):!s.isServer&&void 0!==o.default.get(a)}}],6465021)},7896447,e=>{"use strict";e.s(["CDP_ATTRIBUTION_COOKIE_NAME",0,"v-attribution","CURRENT_CAMPAIGN_KEY",0,"current_campaign","LAST_TOUCH_CAMPAIGN_KEY",0,"last_touch_campaign","THIRD_PARTY_COOKIE_MAP",0,{},"THIRD_PARTY_URL_PARAMS",0,["gclid","gbraid","wbraid","fbclid","li_fat_id"]])},4516081,5140626,e=>{"use strict";var t=e.i(486534),i=e.i(6465021),r=e.i(3013088);let n=()=>(0,r.getSafeVercelSubdomainCookieDomain)(window.location.hostname);e.s(["getCookieDomain",0,n],5140626);var o=e.i(7896447);let s=(0,i.createVersionedCookie)({name:o.CDP_ATTRIBUTION_COOKIE_NAME,version:1,writeOptions:{get domain(){return n()},sameSite:"lax",expiresInDays:30,secure:(0,t.isSecureCookieRequired)()}});e.s(["attributionCookie",0,s],4516081)},5287165,e=>{"use strict";function t(){return"u">typeof window}function i(){return(t()?window.vam:"production")||"production"}function r(){return"production"===i()}function n(e){return RegExp(`/${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(?=[/?#]|$)`)}e.s(["computeRoute",0,function(e,t){if(!e||!t)return e;let i=e;try{let e=Object.entries(t);for(let[t,r]of e)if(!Array.isArray(r)){let e=n(r);e.test(i)&&(i=i.replace(e,`/[${t}]`))}for(let[t,r]of e)if(Array.isArray(r)){let e=n(r.join("/"));e.test(i)&&(i=i.replace(e,`/[...${t}]`))}return i}catch(t){return e}},"track",0,function(e,n,o){var s,a;if(!t()){let e="[Vercel Web Analytics] Please import `track` from `@vercel/analytics/server` when using this function in a server environment";if(r())console.warn(e);else throw Error(e);return}if(!n){null==(s=window.va)||s.call(window,"event",{name:e,options:o});return}try{let t=function(e,t){if(!e)return;let i=e,r=[];for(let[n,o]of Object.entries(e))"object"==typeof o&&null!==o&&(t.strip?i=function(e,t){let{[e]:i,...r}=t;return r}(n,i):r.push(n));if(r.length>0&&!t.strip)throw Error(`The following properties are not valid: ${r.join(", ")}. Only strings, numbers, booleans, and null are allowed.`);return i}(n,{strip:r()});null==(a=window.va)||a.call(window,"event",{name:e,data:t,options:o})}catch(e){e instanceof Error&&"development"===i()&&console.error(e)}}])},1853611,5975871,496908,458944,e=>{"use strict";var t,i,r,n,o=e.i(2144405),s=e.i(2429523),a=e.i(3013088);let c="_v-anonymous-id";function d(){return(0,a.getSafeVercelSubdomainCookieDomain)(window.location.hostname)}let l="properties",u="universal",h="finalize";var f=e.i(6247049);function p(e){let t=(0,f.createErrorFactory)(e);return{error:t,throw:(i,r)=>{throw t(`[${e.scope}] ${i}`,r)},log:(i,r)=>{let n=t(`[${e.scope}] ${i}`,r);return console.error(n),n}}}var g=((t={}).MISSING_CONFIG="cdp_service_missing_config",t.MISSING_PROVIDERS="cdp_service_missing_providers",t.FAILED_INIT="cdp_service_failed_init",t.FAILED_PROVIDER_INIT="cdp_service_failed_provider_init",t.FAILED_ENRICHMENT="cdp_service_failed_enrichment",t.FAILED_DISPATCH="cdp_service_failed_dispatch",t.FAILED_TO_GET_CONTEXT="cdp_service_failed_to_get_context",t.FAILED_EXTEND="cdp_service_failed_extend",t);let _=p({scope:"@vercel/cdp.service"}),m={missingConfig:{code:g.MISSING_CONFIG,message:"Configuration object is required"},missingProviders:{code:g.MISSING_PROVIDERS,message:"CDP service requires at least one provider"},failedInit:{code:g.FAILED_INIT,message:"Error initializing CDP service"},failedProviderInit:{code:g.FAILED_PROVIDER_INIT,message:"Failed to initialize CDP provider"},failedEnrichment:{code:g.FAILED_ENRICHMENT,message:"Error enriching event"},failedDispatch:{code:g.FAILED_DISPATCH,message:"Error dispatching analytics event"},failedToGetContext:{code:g.FAILED_TO_GET_CONTEXT,message:"Error getting context for enrichment. Context will be undefined for all transforms."}};var v=e.i(9625174),I=((i={}).HARD_LIMIT="cdp_queue_hard_limit",i.TIMEOUT="cdp_queue_timeout",i.EVENT_FAILED="cdp_queue_event_failed",i);let E=p({scope:"@vercel/cdp.queue"}),C=(0,v.createScopedDebugLogger)("@vercel/cdp.queue");class y{maxWaitMs;_isReady;_isInitialized;_isIdentified;_queue;_timeout;_hasWarnedAboutQueueSize;_softLimit;_hardLimit;constructor(e=15e3,t=100,i=1e3){this.maxWaitMs=e,this._isReady=!1,this._isInitialized=!1,this._isIdentified=!1,this._queue=[],this._timeout=null,this._hasWarnedAboutQueueSize=!1,this._softLimit=t,this._hardLimit=i}get isReady(){return this._isReady}get isInitialized(){return this._isInitialized}get isIdentified(){return this._isIdentified}get queueSize(){return this._queue.length}signalReady(){this._isReady||(this._isReady=!0,this.flushEligible())}signalInitialized(){this._isInitialized||(this._isInitialized=!0,this.flushEligible())}signalIdentified(){this._isIdentified||(this._isIdentified=!0,C("identified","ðŸªª Identity established"),this.flushEligible())}resetIdentified(){this._isIdentified=!1,C("identified","ðŸªª Identity reset")}enqueue(e,t){let i={event:e,requiresReady:t?.requiresReady??!1,requiresIdentity:t?.requiresIdentity??!1};this.canDispatchItem(i)?this.safeExecute(e):(this._queue.push(i),this.maybeWarnAboutQueueSize(),this.maybeForceFlush(),this.maybeStartTimeout())}canDispatchItem(e){return!!this._isInitialized&&(!e.requiresReady||!!this._isReady)&&(!e.requiresIdentity||!!this._isIdentified)}flushEligible(){let e=[],t=[];for(let i of this._queue)this.canDispatchItem(i)?e.push(i):t.push(i);if(0!==e.length)for(let i of(this._queue=t,0===t.length&&(this.clearTimeout(),this._hasWarnedAboutQueueSize=!1),C("flush",`ðŸš€ Flushing ${e.length} queued event(s)`),e))this.safeExecute(i.event)}safeExecute(e){try{e()}catch(e){E.log("Queued event failed to execute",{code:I.EVENT_FAILED,cause:e})}}forceFlushAll(e){this.clearTimeout();let t=this._queue;for(let i of(this._queue=[],this._hasWarnedAboutQueueSize=!1,t.length>0&&("timeout"===e?E.log("Queue timeout triggered due to no ready signal. Flushing events.",{code:I.TIMEOUT,metadata:{maxWaitMs:this.maxWaitMs,queueSize:t.length}}):E.log("Queue size hit hard limit. Flushing events to prevent memory issues.",{code:I.HARD_LIMIT,metadata:{queueSize:t.length,hardLimit:this._hardLimit}})),t))this.safeExecute(i.event)}clearTimeout(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)}maybeWarnAboutQueueSize(){!this._hasWarnedAboutQueueSize&&this._queue.length>this._softLimit&&(this._hasWarnedAboutQueueSize=!0,console.warn(`[@vercel/cdp] Queue size (${this._queue.length}) exceeds soft limit (${this._softLimit}). This may indicate signalReady() is not being called, or events are firing before the app is ready. Events will continue to be queued but this could cause memory issues.`))}maybeForceFlush(){this._queue.length>=this._hardLimit&&this.forceFlushAll("force")}maybeStartTimeout(){this._timeout||1!==this._queue.length||(this._timeout=setTimeout(()=>this.forceFlushAll("timeout"),this.maxWaitMs))}}var S=((r={}).GETTER_FAILED="cdp_context_getter_failed",r);let T=p({scope:"@vercel/cdp.context"});class A{_getters=[];add(e){this._getters.push("function"==typeof e?e:()=>e)}clear(){this._getters=[]}resolve(){let e={};for(let t of this._getters)try{Object.assign(e,t())}catch(e){T.log("Context getter threw an error, skipping",{code:S.GETTER_FAILED,cause:e})}return e}}let k={DATA_WAREHOUSE:"data_warehouse",WEB_ANALYTICS:"web_analytics",MARKETING:"marketing",PRODUCT_ANALYTICS:"product_analytics",EXPERIMENTATION:"experimentation",OPERATIONAL:"operational",DATA_WAREHOUSE_LEGACY:"data_warehouse_legacy"};e.s(["DESTINATION_GROUP",0,k],5975871);var w=e.i(8134802);let b="isLoggedIn";function R(e,t){return{id:e,transform:t}}e.s(["createTransform",0,R],496908);let O=R("normalizeEmail",e=>{if(e&&"email"in e&&"string"==typeof e.email)return{...e,email:e.email.toLowerCase().trim()}});var D=e.i(5561919);let P=R("cleanMetadata",e=>{if(e)return(0,D.removeUndefinedObjectEntries)(e)}),L=R("normalizePropertyKeys",e=>{if(e){var t=e;let i={};for(let[e,r]of Object.entries(t))i[e.replace(/([a-z])([A-Z])/g,"$1_$2").replace(/([A-Z])([A-Z][a-z])/g,"$1_$2").toLowerCase()]=r;return i}});var N=e.i(6465021),U=e.i(7896447);let x=[U.CDP_ATTRIBUTION_COOKIE_NAME],q="_v-consent";e.s(["ANALYTICS_COOKIES",0,[],"CDP_CONSENT_COOKIE_NAME",0,q,"MARKETING_COOKIES",0,x],458944);var M=e.i(486534),$=e.i(5140626);let F=(0,N.createVersionedCookie)({name:q,version:1,writeOptions:{get domain(){return(0,$.getCookieDomain)()},sameSite:"lax",expiresInDays:365,secure:(0,M.isSecureCookieRequired)()}}),z=(0,v.createScopedDebugLogger)("@vercel/cdp.service"),V={[k.WEB_ANALYTICS]:!0,[k.DATA_WAREHOUSE]:!0};class G{config;_initInProgress;_isInitialized;_queue;_context;_appSendToConfig;transforms;precomputedTransformStacks;constructor(e){this.config=e,this._initInProgress=!1,this._isInitialized=!1,this._appSendToConfig={},this.transforms=new Map([["traits",[]],[l,[]],[u,[]],[h,[]]]),this.precomputedTransformStacks=new Map,e||_.throw(m.missingConfig.message,{code:m.missingConfig.code,metadata:{method:"constructor"}}),e.providers&&0!==e.providers.length||_.throw(m.missingProviders.message,{code:m.missingProviders.code,metadata:{method:"constructor"}}),this._queue=e.queue??new y,this._context=e.context??new A,this.#e()}#e(){this.registerTransform(u,O),this.registerTransform(l,L),this.registerTransform(h,P)}async init(e){if(this._isInitialized||this._initInProgress)return void console.warn("CDP service is already initialized");if(!this.isServiceEnabled)return void z("init","â­ï¸ Skipping initialization (service disabled)");this._initInProgress=!0;try{z("init","ðŸš€ Initializing service...",{options:e});let t=this.config.providers.filter(e=>e.isEnabled());if(0===t.length)return void z("init","âš ï¸ No enabled providers to initialize");let i=(await Promise.allSettled(t.map(async t=>{try{return await t.init?.(e),t.id}catch(e){throw _.log(m.failedProviderInit.message,{code:m.failedProviderInit.code,cause:e,metadata:{method:"init",providerId:t.id}}),e}}))).filter(e=>"fulfilled"===e.status).map(e=>e.value);i.length>0?(this._isInitialized=!0,this._queue.signalInitialized(),z("init",`ðŸŸ¢ Service successfully initialized with ${i.length} provider(s): ${i.join(", ")}`)):z("init","âš ï¸ No providers successfully initialized")}catch(e){_.log(m.failedInit.message,{code:m.failedInit.code,cause:e,metadata:{method:"init"}})}finally{this._initInProgress=!1}}identify(e,t){z("receive:identify",`ðŸ“¡ Event received`,{userId:e,traits:t}),this._queue.enqueue(()=>{let i=this.#t("identify","traits",t);this.#i("identify",e,i)}),this._queue.signalIdentified()}clearIdentity(){let e,t;z("receive:clearIdentity",`ðŸ“¡ Event received`),e=d(),(0,s.removeCookie)(c,{domain:e}),t=d(),(0,s.removeCookie)("_v-anonymous-id-renewed",{domain:t}),this.clearContext(),this._queue.resetIdentified(),this._queue.enqueue(()=>this.#i("clearIdentity"))}group(e,t){z("receive:group",`ðŸ“¡ Event received`,{groupId:e,traits:t}),this._queue.enqueue(()=>{let i=this.#t("group","traits",t);this.#i("group",e,i)})}alias(e,t){z("receive:alias",`ðŸ“¡ Event received`,{newUserId:e,previousUserId:t}),this._queue.enqueue(()=>this.#i("alias",e,t))}page(e){z("receive:page",`ðŸ“¡ Event received`,{properties:e}),this._queue.enqueue(()=>this.#r(e),{requiresReady:!0,requiresIdentity:this.#n()})}#r(e){let t={...this._context.resolve(),...e},i=this.#t("page","properties",t);this.#i("page",i)}track(e,t,i){z(`receive:track:${e}`,`ðŸ“¡ Event received`,{eventName:e,properties:t,options:i}),this._queue.enqueue(()=>this.#o(e,t,i),{requiresReady:!0,requiresIdentity:this.#n()})}#o(e,t,i){let r={...this._context.resolve(),...t},n=this.#s(i),o=this.#t("track","properties",r);this.#i("track",e,o,n)}#s(e){if("override"===(e?.send_to_strategy??"merge"))return{...e,send_to:e?.send_to??{}};let t={...V,...this._appSendToConfig,...e?.send_to};return{...e,send_to:t}}consent(e,t){z("receive:consent",`ðŸ“¡ Event received`,{allowedConsentIds:e,deniedConsentIds:t}),F.write({analytics:e.includes("analytics"),marketing:e.includes("marketing"),essential:e.includes("essential")}),this._queue.enqueue(()=>this.#i("consent",e,t))}addContext(e){this._context.add(e),z("context","ðŸ“¦ Added context")}clearContext(){this._context.clear(),z("context","ðŸ§¹ Cleared context")}signalReady(){z("ready","ðŸš¦ App signaled ready"),this._queue.signalReady()}get isReady(){return this._queue.isReady}getPublicInterface(){return{identify:this.identify.bind(this),clearIdentity:this.clearIdentity.bind(this),group:this.group.bind(this),alias:this.alias.bind(this),page:this.page.bind(this),track:this.track.bind(this),consent:this.consent.bind(this)}}registerTransform(e,t){let i=Array.isArray(t)?t:[t],r=this.transforms.get(e);if(!r){let t=i.map(e=>e.id).join(", ");z("transform",`âš ï¸ Skipped registration for ${t}: type ${e} not found`);return}i.forEach(e=>{r.push(e)}),this.#a()}registerProvider(e){this.config.providers.some(t=>t.id===e.id)?z("registerProvider",`âš ï¸ Provider ${e.id} is already registered, skipping`):(this.config.providers.push(e),z("registerProvider",`âœ… Provider ${e.id} registered successfully`),this._isInitialized&&e.isEnabled()&&e.init?.())}updateSendToConfig(e){this._appSendToConfig={...this._appSendToConfig,...e},z("updateSendToConfig",`âœ… App send_to config updated`,e)}get isServiceEnabled(){return this.config.enabled}#t(e,t,i){let r=this.precomputedTransformStacks.get(t)||[];if(0===r.length)return i;let n=this.#c(),o=i;for(let e of r)try{o=e.transform(o,n)??o}catch(t){_.log(m.failedEnrichment.message,{code:m.failedEnrichment.code,cause:t,metadata:{method:"enrich",transformId:e.id}})}return this.config.debug&&o!==i&&z(`enrich:${e}`,`âœ¨ Enriched with ${r.length} transform(s)`,{input:i,output:o,transformContext:n,transformStack:r.map(e=>e.id)}),o}#i(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.isServiceEnabled?this.#d(e,i):z(`dispatch:${e}`,`â­ï¸ Skipping (service disabled)`)}#d(e,t){let i="track"===e?t[t.length-1]:void 0;for(let r of this.config.providers){if(!r.isEnabled()){z(`${e}`,`â­ï¸ Skipping provider ${r.id} (disabled)`);continue}if(r.requiredDestinationGroup&&i){let t=r.requiredDestinationGroup;if(!0!==i.send_to?.[t]){z(`${e}`,`â­ï¸ Skipping provider ${r.id} (destination group '${t}' not enabled)`);continue}}let n=r[e];if("function"==typeof n)try{z(`dispatch:${e}`,`â†ªï¸ Forwarding to ${r.id}`),n.apply(r,t)}catch(i){_.log(m.failedDispatch.message,{code:m.failedDispatch.code,cause:i,metadata:{method:"broadcastToProviders",providerId:r.id,methodName:e,methodArgs:t}})}}}#c(){try{return this.config.getEnrichmentContext?.()}catch(e){_.log(m.failedToGetContext.message,{code:m.failedToGetContext.code,cause:e,metadata:{method:"getEnrichmentContext"}})}}#n(){return"1"===(0,w.getCookie)(b)}#a(){for(let[e]of this.transforms)e!==u&&e!==h&&this.precomputedTransformStacks.set(e,[...this.transforms.get(u)||[],...this.transforms.get(e)||[],...this.transforms.get(h)||[]])}_inspectTransformRegistry(){return this.transforms}_inspectPrecomputedTransformStacks(){return this.precomputedTransformStacks}}var K=((n={}).INVALID_CONFIG="cdp_rudderstack_client_invalid_config",n.FAILED_TO_LOAD_SDK="cdp_rudderstack_client_failed_sdk_load",n);let j=p({scope:"@vercel/cdp.provider.rudderstack-client"}),W={invalidConfig:{message:"Invalid Rudderstack configuration provided. Missing required fields",code:K.INVALID_CONFIG},failedToLoadSdk:{message:"Failed to load the Rudderstack SDK snippet",code:K.FAILED_TO_LOAD_SDK}};var B=e.i(486333);let H=()=>{if(!B.isServer)return J(),window.rudderanalytics},Y=["setDefaultInstanceKey","load","ready","page","track","identify","alias","group","reset","setAnonymousId","startSession","endSession","consent"],J=()=>{let e=window;if(e.rudderanalytics)return;let t=[];for(let e of Y)t[e]=function(){for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];t.push([e,...r])};e.rudderanalytics=t},Q=[],X=(0,v.createScopedDebugLogger)("@vercel/cdp.rudderstack.load"),Z=!1,ee=!1,et=async t=>{let{dataplaneUrl:i,writeKey:r,configUrl:n,shouldLoadMarketingScripts:o=!0}=t;if(!Z&&!ee){Z=!0;try{let{RudderAnalytics:t}=await e.A(3351010);if(ee){Z=!1;return}let s=new t,a=function(){let e=F.get();if(!e)return null;let t=[],i=[];for(let[r,n]of Object.entries(e))n?t.push(r):i.push(r);return{allowed:t,denied:i}}(),d={configUrl:n,polyfillIfRequired:!1,consentManagement:{enabled:!0,provider:"custom",...a&&{allowedConsentIds:a.allowed,deniedConsentIds:a.denied}},integrations:function(e){let t={All:!0};if(!1===e.shouldLoadMarketingScripts)for(let e of Q)t[e]=!1;return t}({shouldLoadMarketingScripts:o}),externalAnonymousIdCookieName:c,sameDomainCookiesOnly:void 0===(0,$.getCookieDomain)(),secureCookie:(0,M.isSecureCookieRequired)()};a||(d.preConsent={enabled:!0,events:{delivery:"buffer"}}),X("load","ðŸ“¦ Loading RudderStack SDK",d),s.load(r,i,d),ee=!0}finally{Z=!1}}},ei=(0,v.createScopedDebugLogger)("@vercel/cdp.rudderstack");class er{config;id;validatedSdkConfig;constructor(e){this.config=e,this.id="rudderstack-client"}validateAndGetSdkConfig(e){if(this.validatedSdkConfig)return this.validatedSdkConfig;let t=["configUrl","dataplaneUrl","writeKey"].filter(t=>!e[t]);return t.length>0&&j.throw(W.invalidConfig.message,{code:W.invalidConfig.code,metadata:{method:"validateAndGetSdkConfig",missingFields:t}}),this.validatedSdkConfig={writeKey:e.writeKey,dataplaneUrl:e.dataplaneUrl,configUrl:e.configUrl},this.validatedSdkConfig}isEnabled(){return!B.isServer}async init(e){let t=this.validateAndGetSdkConfig(this.config);ei("init","ðŸš€ Initializing provider...",{options:e});try{await et({writeKey:t.writeKey,dataplaneUrl:t.dataplaneUrl,configUrl:t.configUrl,shouldLoadMarketingScripts:e?.shouldLoadMarketingScripts}),ei("init","ðŸŸ¢ Provider initialized (SDK loaded successfully)")}catch(e){j.throw(W.failedToLoadSdk.message,{code:W.failedToLoadSdk.code,cause:e,metadata:{method:"init"}})}}ready(e){let t=H();t?.ready(e)}identify(e,t,i){let r=H();this.#l(r,e);let n=this.#u("identify",i,{userId:e,traits:t});r?.identify(e,t,{},n)}#l(e,t){let i=e?.getUserId();i?this.#h(t,i):void 0===i&&e?.ready(()=>{let i=e?.getUserId();i&&this.#h(t,i)})}#h(e,t){t!==e&&t===e.toLowerCase()&&(ei("identify","ðŸ”— Merging legacy lowercase userId with correct case",{from:t,to:e}),this.alias(e,t))}clearIdentity(e){let t=H(),i=this.#u("clearIdentity",e);t?.reset({entries:{anonymousId:!0}}),i()}group(e,t,i){ei("group","ðŸš§ Rudderstack group call ignored")}alias(e,t,i){let r=H(),n=this.#u("alias",i,{to:e,from:t});r?.alias(e,t,{},n)}track(e,t,i,r){let n=H(),{properties:o,context:s}=this.#f("track",t),a=this.#p(s,i),c=this.#u("track",r,{event:e,properties:o,context:a});n?.track(e,o,a,c)}#p(e,t){let i=t?.send_to;if(e||i)return{...e,...i&&{send_to:i}}}page(e,t,i){let r=H(),{properties:n,context:o}=this.#f("page",e),s=this.#p(o,t),a=this.#u("page",i,{properties:n,context:s});r?.page(n,s,a)}consent(e,t){let i=H(),r={consentManagement:{allowedConsentIds:e,deniedConsentIds:t}};ei("send:consent","âœ… Consent preferences successfully sent to Rudderstack",r),i?.consent(r)}#f(e,t){if(!t)return{properties:{}};let i={},r={},n=!1;for(let e in t){if(e===U.CURRENT_CAMPAIGN_KEY&&t[U.CURRENT_CAMPAIGN_KEY]){r.campaign=t[U.CURRENT_CAMPAIGN_KEY],n=!0;continue}if(e===U.LAST_TOUCH_CAMPAIGN_KEY&&t[U.LAST_TOUCH_CAMPAIGN_KEY]){r.last_touch_campaign=t[U.LAST_TOUCH_CAMPAIGN_KEY],n=!0;continue}i[e]=t[e]}return ei(`prepare:${e}`,`ðŸ“¦ Prepared final event properties`,{input:t,output:{properties:i,context:n?r:void 0}}),n?{properties:i,context:r}:{properties:i}}#u(e,t,i){return()=>{ei(`send:${e}`,`âœ… Event successfully sent to Rudderstack`,i),t?.()}}}var en=e.i(5287165);let eo=(0,v.createScopedDebugLogger)("@vercel/cdp.vercel-analytics");class es{id="vercel-analytics";requiredDestinationGroup=k.WEB_ANALYTICS;async init(){}isEnabled(){return!B.isServer}track(e,t){let i=this.#f("track",t);(0,en.track)(i?.legacy_action??e,i),eo(`send:${e}`,`âœ… Event successfully sent to Vercel Analytics`,{properties:i})}#f(e,t){if(!t)return;let i={};for(let e in t){let r=t[e];if(null!=r){if(r instanceof Date){i[e]=r.toISOString();continue}if(Array.isArray(r)){i[e]=r.join(",");continue}i[e]=r}}let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{maxDepth:i=1/0,delimiter:r="."}=t;if(0===i)return e;let n={};return!function e(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!(null!==t&&"object"==typeof t&&!Array.isArray(t))||t instanceof Date||t instanceof RegExp){n[o]=t;return}let a=Object.entries(t);if(0===a.length||s>=i){n[o]=t;return}for(let[t,i]of a)e(i,o?`${o}${r}${t}`:t,o?s+1:s)}(e),n}(i);return eo(`prepare:${e}`,`ðŸ“¦ Prepared final event properties`,{input:t,output:r}),r}}class ea{id="NoopCDPService";isServiceEnabled=!1;registerTransform(){}registerProvider(){}updateSendToConfig(){}identify(){}clearIdentity(){}group(){}alias(){}page(){}track(){}consent(){}addContext(){}clearContext(){}signalReady(){}async init(){}getPublicInterface(){return{identify:()=>{},clearIdentity:()=>{},group:()=>{},alias:()=>{},page:()=>{},track:()=>{},consent:()=>{}}}}var ec=e.i(5203382),ed=e.i(4516081);let el="dx/url",eu=(0,f.createErrorFactory)({scope:el}),eh=e=>{if(!B.isServer)try{if(!e)return new URLSearchParams(window.location.search);if(e.includes("://")){let t=new URL(e);return new URLSearchParams(t.search)}return new URLSearchParams(e)}catch(t){!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.error(eu(`[${el}] ${e}`,t))}("Failed to get URLSearchParams",{code:"url_search_params_get_failed",cause:t,metadata:{url:e}});return}},ef=R("attachAttribution",(e,t)=>{let i=window.location.search,r=eg(t?.cookieMap),n=em(t?.cookieMap),o=e_(i);return r||o||n?{...e,...r,...o&&{[U.CURRENT_CAMPAIGN_KEY]:o},...n&&{[U.LAST_TOUCH_CAMPAIGN_KEY]:n}}:e}),ep=Object.entries(U.THIRD_PARTY_COOKIE_MAP),eg=e=>{if(0===ep.length||!e||0===e.size)return;let t={},i=!1;for(let[r,n]of ep){let o=e.get(r);o&&(t[n]=o,i=!0)}return i?t:void 0},e_=e=>{let t={},i=!1;for(let r of U.THIRD_PARTY_URL_PARAMS){let n=eh(e)?.get(r);n&&(t[r]=n,i=!0)}return i?t:void 0},em=e=>{if(e&&0!==e.size&&ed.attributionCookie.has(e))return ed.attributionCookie.get(e)},ev=R("attachIdentity",(e,t)=>{let i=t?.cookieMap;return{...e,anonymous_id:i?.get(c),is_logged_in:i?.get(b)==="1"}});var eI=e.i(9183349);let eE=!1,eC=R("attachVercelEnv",e=>({...e,vercel_app:eI.VERCEL_APP_NAME,vercel_domain:(0,eI.isVercelProd)()?eI.VERCEL_STABLE_PRODUCTION_DOMAIN?eI.VERCEL_STABLE_PRODUCTION_DOMAIN:eI.VERCEL_SHORTEST_PRODUCTION_URL?(eE||(console.warn(`[vercel-cdp.getVercelDomain] Using VERCEL_SHORTEST_PRODUCTION_URL reference in production. This may return an unexpected domain (e.g., "edge.new" instead of "vercel.com"). Recommendation: Set NEXT_PUBLIC_PRODUCTION_DOMAIN in Vercel project settings. Current domain: ${eI.VERCEL_SHORTEST_PRODUCTION_URL}`),eE=!0),eI.VERCEL_SHORTEST_PRODUCTION_URL):(console.error("[vercel-cdp.getVercelDomain] Cannot determine production domain. Neither NEXT_PUBLIC_PRODUCTION_DOMAIN nor VERCEL_PROJECT_PRODUCTION_URL is set. This indicates a critical configuration error."),"unknown"):B.isServer?eI.VERCEL_URL??"localhost":window.location.host,vercel_env:eI.VERCEL_ENV??"development",vercel_region:ey(),vercel_deployment_id:eS()})),ey=()=>o.default.env.VERCEL_REGION,eS=()=>globalThis.NEXT_DEPLOYMENT_ID,eT=e=>e&&""!==e.trim()?e.split("; "):[];var eA=e.i(3198854);function ek(e){let t=new Map;for(let i of e){if(!i)continue;let e=function(e){if(e)try{let[t,...i]=e.split("=");if(!t)return;let r=i.join("=");if(r.includes("%")||r.includes("+"))try{r=decodeURIComponent(r)}catch{}return[t,r]}catch(t){(0,eA.logCookieError)(`Error parsing cookie string: ${e}`,{code:"cookie_parse_failed",cause:t,metadata:{cookieString:e}});return}}(i);if(e){let[i,r]=e;t.set(i,r)}}return t}function ew(){var e;return{environment:"client",cookieMap:(e=B.isServer?[]:eT(document.cookie))?e instanceof Map?e:Array.isArray(e)?ek(e):"string"==typeof e?ek(eT(e)):(console.warn(`[dx/cookies] Unknown cookie source type: ${typeof e}. Returning an empty Map.`),new Map):(console.warn("[dx/cookies] No source provided. Returning an empty Map."),new Map)}}let eb=(()=>{let e=(0,ec.getCDPOverrideCookieValue)();if(!(e??!0)||!(!B.isServer&&!B.isTest&&!B.isCi&&!B.isE2E&&!B.isInIframe&&"1"!==(0,w.getCookie)("vercel_impersonate")&&!(0,B.isBotClient)()))return new ea;let t=new G({enabled:!0,debug:e??"true"===o.default.env.NEXT_PUBLIC_ENABLE_CDP_DEBUG,providers:[new es,new er({configUrl:"https://cdp.vercel.com/rs/config",dataplaneUrl:"https://cdp.vercel.com/rs/stream",writeKey:"34WAqdmAn7gavRAuxcqT8Ekj8FU"})],getEnrichmentContext:ew});return t.registerTransform("properties",[ef,ev,eC]),t})(),eR=eb.getPublicInterface(),eO=function(e){try{e({registerProvider:eb.registerProvider.bind(eb),registerTransform:(e,t)=>{eb.registerTransform(e,t)},updateSendToConfig:eb.updateSendToConfig.bind(eb)})}catch(e){_.log("Failed to extend CDP service",{code:g.FAILED_EXTEND,cause:e,metadata:{method:"extend"}})}};e.s(["_clientCDPService",0,eb,"analytics",0,eR,"extend",0,eO],1853611)}]);

//# debugId=ce1ce52f-11aa-97e8-1bf4-c183d8dbf95f
//# sourceMappingURL=b0704f188d780a05.js.map