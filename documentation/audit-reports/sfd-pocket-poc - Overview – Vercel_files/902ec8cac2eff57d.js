;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="6aba07ca-48db-14a5-26ba-2e9ca56c9ea5")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6269588,e=>{e.v({badge:"bell-module__AXcxMG__badge",badgeMotion:"bell-module__AXcxMG__badgeMotion",btn:"bell-module__AXcxMG__btn",buttonContent:"bell-module__AXcxMG__buttonContent",content:"bell-module__AXcxMG__content",dash:"bell-module__AXcxMG__dash",fadeOut:"bell-module__AXcxMG__fadeOut",focus:"bell-module__AXcxMG__focus",frame:"bell-module__AXcxMG__frame",frameMotion:"bell-module__AXcxMG__frameMotion",hover:"bell-module__AXcxMG__hover",icon:"bell-module__AXcxMG__icon",lg:"bell-module__AXcxMG__lg",md:"bell-module__AXcxMG__md",pressed:"bell-module__AXcxMG__pressed",shadow:"bell-module__AXcxMG__shadow",sm:"bell-module__AXcxMG__sm",statusIcon:"bell-module__AXcxMG__statusIcon",svgNoPointerEvents:"bell-module__AXcxMG__svgNoPointerEvents",text:"bell-module__AXcxMG__text"})},1889129,e=>{e.v({archiveFooter:"feed-module__491t5W__archiveFooter",breakAll:"feed-module__491t5W__breakAll",cell:"feed-module__491t5W__cell",commentsView:"feed-module__491t5W__commentsView",emptyIcon:"feed-module__491t5W__emptyIcon",emptyLabel:"feed-module__491t5W__emptyLabel",feed:"feed-module__491t5W__feed",feedContent:"feed-module__491t5W__feedContent",header:"feed-module__491t5W__header",headerGrid:"feed-module__491t5W__headerGrid",settingsLink:"feed-module__491t5W__settingsLink",tabText:"feed-module__491t5W__tabText",view:"feed-module__491t5W__view"})},6241262,e=>{e.v({archive:"item-module__Hg2RJW__archive",archiveButton:"item-module__Hg2RJW__archiveButton",dot:"item-module__Hg2RJW__dot",fallbackIcon:"item-module__Hg2RJW__fallbackIcon","focus-visible":"item-module__Hg2RJW__focus-visible",focusVisible:"item-module__Hg2RJW__focusVisible",hidden:"item-module__Hg2RJW__hidden",item:"item-module__Hg2RJW__item",link:"item-module__Hg2RJW__link",notificationContent:"item-module__Hg2RJW__notificationContent",subAvatar:"item-module__Hg2RJW__subAvatar",subject:"item-module__Hg2RJW__subject"})},8698247,e=>{e.v({commentWrapper:"comment-item-module__JJqGUq__commentWrapper",selected:"comment-item-module__JJqGUq__selected"})},2977232,e=>{e.v({commentsDetailView:"notifications-module__J76_1G__commentsDetailView"})},6561189,e=>{"use strict";var t=e.i(4205214),i=e.i(8660982),s=e.i(4004502),n=e.i(8634363),a=e.i(1853611),l=e.i(7917902),r=e.i(2144405);e.i(6135811);var o=e.i(9716637),d=e.i(5677444);let c={"mvp-stub-notifications":(e,t,i,s)=>!1,"deployment-failed"(e,t,i,s){let{teamSlug:n,project:a,id:l}=i;return!!(n&&a&&l&&e===`/${n}/${a}/${l}`||e.startsWith("/new/import/"))&&!![...t.getAll("id"),...t.getAll("deploymentIds")].find(e=>{if(e)return(s.data?.actionUrl||"").includes(e.replace("dpl_",""))})}};function u(e){let t=(0,o.useAuthenticatedKnockClient)("pk_cBlwgRRBkMc-3KKgA0J7W-q7LbxjyDuL1u3XXU164p4",e.userId,e.userToken),s=(0,o.useNotifications)(t,"6f1dd852-e25d-4cb7-b99c-6b0acc743109",{page_size:e.pageSize||10,tenant:e.tenant,archived:"archived"===e.tab?"only":"exclude"});if(!s)throw Error("expected feed");let[n,a]=(0,i.useState)(),l=(0,d.usePathname)(),r=(0,d.useSearchParams)(),u=(0,d.useParams)();(0,i.useEffect)(()=>{if("inbox"!==e.tab)return;let t=e=>{let t;l&&r&&u&&(t=e.items.filter(e=>!!(!e.seen_at&&1===e.total_activities&&e.source.key in c&&c[e.source.key](l,r,u,e)))).length&&s.markAsSeen(t)};return s.on("items.received.*",t),()=>s.off("items.received.*",t)},[s,u,l,e.tab,r]),(0,i.useEffect)(()=>{if(e.userId)try{let t=new BroadcastChannel(`__notifier_feed${e.userId}${e.tenant??""}`);t.addEventListener("message",t=>{let{data:i}=t;if("inbox"===e.tab&&(s.getState().setMetadata(i.state.metadata),s.store.setState({items:i.state.items})),"archived"===e.tab&&("markAsArchived"===i.method||"markAllAsArchived"===i.method)){let e=new Date().toISOString();i.changes.forEach(t=>{t.archived_at=e}),s.store.setState({items:i.changes.concat(s.store.getState().items)})}});let i=async e=>{let i=await s.markAsArchived(e),n=Array.isArray(e)?e:[e],{items:a,metadata:l}=s.getState();return t.postMessage({state:{items:a,metadata:l},method:"markAsArchived",changes:n}),i},n=async()=>{let{items:e,metadata:i}=s.store.getState(),n=s.markAllAsArchived();return t.postMessage({state:{items:e,metadata:i},method:"markAllAsArchived",changes:e}),n};return a({markAsArchived:i,markAllAsArchived:n}),()=>{a(void 0),t.close()}}catch(e){}},[s,e.tab,e.tenant,e.userId]);let{loading:m,items:h,metadata:f}=(0,o.useNotificationStore)(s),x=(0,i.useCallback)(async e=>{n?.markAsArchived?await n.markAsArchived(e):await s.markAsArchived(e)},[s,n]),_=(0,i.useCallback)(async()=>{n?.markAllAsArchived?await n.markAllAsArchived():await s.markAllAsArchived()},[s,n]);return{loading:m,items:h??[],metadata:f??{},feed:s,markAsArchived:x,markAllAsArchived:_}}var m=e.i(6352514),h=e.i(4810515),f=e.i(8097508),x=e.i(1581757),_=e.i(1080700);let v=(0,i.createContext)(null);v.displayName="NotificationContext";let b=/vtest314-[^@]+@zeit\.pub/;function p(){let{user:e,team:t,isLoading:i}=(0,l.useAccount)(),{isLoading:s,token:n}=(0,h.useKnockToken)({});if(!i&&!t)return{state:null,isLoading:!1};let a=!!(i||s);return i||(e?.limited!==!0||t)&&(!t||!0!==t.limited)?n?{state:"full",tenant:t?.id,isLoading:a}:e?{state:"placeholder",tenant:t?.id,isLoading:a}:{state:null,isLoading:a}:{state:"limited",tenant:t?.id,isLoading:a}}var g=e.i(9001495),j=e.i(5338940),k=e.i(3322724),C=e.i(4585051),w=e.i(6280036),y=e.i(287495);function A(){let{resolvedTheme:e}=(0,w.useTheme)(),i=(0,y.default)();return(0,t.jsxs)("svg",{fill:"none",height:"36",opacity:+!!e,viewBox:"0 0 36 36",width:"36",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("rect",{fill:i?"#F0FDF4":"#071D10",height:"35",rx:"17.5",width:"35",x:"0.5",y:"0.5"}),(0,t.jsx)("g",{clipPath:"url(#clip0_798_8657)",children:(0,t.jsx)("path",{d:"M14.6667 17.8809L16.75 19.9643L21.2143 15.5M26.3333 18C26.3333 22.6024 22.6024 26.3333 18 26.3333C13.3976 26.3333 9.66666 22.6024 9.66666 18C9.66666 13.3976 13.3976 9.66666 18 9.66666C22.6024 9.66666 26.3333 13.3976 26.3333 18Z",stroke:i?"#0D883B":"#86EFAC",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})}),(0,t.jsx)("rect",{height:"35",rx:"17.5",stroke:i?"#DCFCE7":"#0D3B1E",width:"35",x:"0.5",y:"0.5"}),(0,t.jsx)("defs",{children:(0,t.jsx)("clipPath",{id:"clip0_798_8657",children:(0,t.jsx)("rect",{fill:"white",height:"20",transform:"translate(8 8)",width:"20"})})})]})}function N(){let{resolvedTheme:e}=(0,w.useTheme)(),i=(0,y.default)(),s=i?"#BD5200":"#FDE68A";return(0,t.jsxs)("svg",{fill:"none",height:"36",opacity:+!!e,viewBox:"0 0 36 36",width:"36",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("rect",{fill:i?"#FFFBEB":"#241005",height:"35",rx:"17.5",width:"35",x:"0.5",y:"0.5"}),(0,t.jsxs)("g",{clipPath:"url(#clip0_798_8667)",children:[(0,t.jsx)("path",{d:"M16.575 11.2167L9.51665 23C9.37113 23.252 9.29413 23.5377 9.29331 23.8288C9.2925 24.1198 9.3679 24.4059 9.51201 24.6588C9.65612 24.9116 9.86392 25.1223 10.1147 25.2699C10.3656 25.4174 10.6507 25.4968 10.9417 25.5H25.0583C25.3493 25.4968 25.6344 25.4174 25.8852 25.2699C26.136 25.1223 26.3439 24.9116 26.488 24.6588C26.6321 24.4059 26.7075 24.1198 26.7067 23.8288C26.7058 23.5377 26.6288 23.252 26.4833 23L19.425 11.2167C19.2764 10.9717 19.0673 10.7693 18.8176 10.6287C18.568 10.4882 18.2864 10.4144 18 10.4144C17.7135 10.4144 17.4319 10.4882 17.1823 10.6287C16.9327 10.7693 16.7235 10.9717 16.575 11.2167V11.2167Z",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("path",{d:"M18 22.1667H18.0083",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("path",{d:"M18 15.5V18.8333",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]}),(0,t.jsx)("rect",{height:"35",rx:"17.5",stroke:i?"#FEF3C7":"#411D06",width:"35",x:"0.5",y:"0.5"}),(0,t.jsx)("defs",{children:(0,t.jsx)("clipPath",{id:"clip0_798_8667",children:(0,t.jsx)("rect",{fill:"white",height:"20",transform:"translate(8 8)",width:"20"})})})]})}function E(){let{resolvedTheme:e}=(0,w.useTheme)(),i=(0,y.default)(),s=i?"#D00505":"#FCA5A5";return(0,t.jsxs)("svg",{fill:"none",height:"36",opacity:+!!e,viewBox:"0 0 36 36",width:"36",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("rect",{fill:i?"#FEF2F2":"#2A0909",height:"35",rx:"17.5",width:"35",x:"0.5",y:"0.5"}),(0,t.jsx)("path",{d:"M23.8333 10.5H12.1667C11.2462 10.5 10.5 11.2462 10.5 12.1667V23.8333C10.5 24.7538 11.2462 25.5 12.1667 25.5H23.8333C24.7538 25.5 25.5 24.7538 25.5 23.8333V12.1667C25.5 11.2462 24.7538 10.5 23.8333 10.5Z",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("path",{d:"M15.5 15.5L20.5 20.5",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("path",{d:"M20.5 15.5L15.5 20.5",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("rect",{height:"35",rx:"17.5",stroke:i?"#FEE2E2":"#450C0C",width:"35",x:"0.5",y:"0.5"})]})}function I(){let{resolvedTheme:e}=(0,w.useTheme)(),i=(0,y.default)(),s=i?"#666666":"#888888";return(0,t.jsxs)("svg",{fill:"none",height:"36",opacity:+!!e,viewBox:"0 0 36 36",width:"36",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("rect",{fill:i?"#FAFAFA":"#111111",height:"35",rx:"17.5",width:"35",x:"0.5",y:"0.5"}),(0,t.jsxs)("g",{clipPath:"url(#clip0_1415_8585)",children:[(0,t.jsx)("path",{d:"M18 26.3333C22.6024 26.3333 26.3334 22.6024 26.3334 18C26.3334 13.3976 22.6024 9.66666 18 9.66666C13.3976 9.66666 9.66669 13.3976 9.66669 18C9.66669 22.6024 13.3976 26.3333 18 26.3333Z",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("path",{d:"M18 21.3333V18",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("path",{d:"M18 14.6667H18.0083",stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]}),(0,t.jsx)("rect",{height:"35",rx:"17.5",stroke:i?"#EAEAEA":"#333333",width:"35",x:"0.5",y:"0.5"}),(0,t.jsx)("defs",{children:(0,t.jsx)("clipPath",{id:"clip0_1415_8585",children:(0,t.jsx)("rect",{fill:"white",height:"20",transform:"translate(8 8)",width:"20"})})})]})}var T=e.i(6346477);function M(e){return!!e&&e.startsWith("team_")}var L=e.i(5213664),S=e.i(1473216),P=e.i(804005),F=e.i(5167412),B=e.i(3828603),H=e.i(7901311),O=e.i(2529888),W=e.i(9722978),D=e.i(7171047);let R=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8 2.5C5.79086 2.5 4 4.29086 4 6.5V7.88556C4 8.08007 3.92273 8.26661 3.7852 8.40414L3.21967 8.96967L3 9.18934V9.5V10.25V11H3.75H12.25H13V10.25V9.5V9.18934L12.7803 8.96967L12.2148 8.40414C12.0773 8.26661 12 8.08007 12 7.88556V6.5C12 4.29086 10.2091 2.5 8 2.5ZM5.5 6.5C5.5 5.11929 6.61929 4 8 4C9.38071 4 10.5 5.11929 10.5 6.5V7.88556C10.5 8.47789 10.7353 9.04596 11.1541 9.4648L11.1893 9.5H4.81066L4.84586 9.4648C5.2647 9.04596 5.5 8.47789 5.5 7.88556V6.5ZM8 13.5C9.02516 13.5 9.9062 12.883 10.292 12H5.70802C6.0938 12.883 6.97484 13.5 8 13.5Z" fill="currentColor"/>');var G=e.i(9358876),X=e.i(1288475),V=e.i(9031150),z=e.i(6357175),U=e.i(9482244);let J=(e,t)=>t.ts<e.ts||!["stable","shown"].includes(t.type)?e:{...e,[t.type]:t.value,ts:t.ts},$={ts:0,stable:0,shown:0},q=[.1,.3,.5,.6,.8,1].map(function(e){return 1-Math.pow(1-e,3)});var K=e.i(6269588);let Z=(0,i.forwardRef)(function(e,n){let{unseen:a,disabled:l,disableMotion:o,children:c,onOpenChange:u,...m}=e,h=(0,d.usePathname)(),f=(0,i.useContext)(v),x=!!f?.hasOpened,{focusProps:_,isFocusVisible:b}=(0,F.useFocusRing)(),{hoverProps:p,isHovered:g}=(0,B.useHover)({isDisabled:l}),j=(0,O.useObjectRef)(n),{isPressed:C}=(0,P.useButton)(m,j),w=(0,k.useIsMobile)(),y=function(e,t){let s=(0,U.usePrefersReducedMotion)(),n=!(t.disableMotion||s),[{stable:a,shown:l},r]=(0,i.useReducer)(J,$);(0,i.useEffect)(()=>{if(n&&(!(a<l)||t.animateDown)){let e=a===l?[]:q.map((e,t)=>{let i=Math.round(l+(a-l)*e);if(i!==a||t===q.length-1)return setTimeout(()=>requestAnimationFrame(()=>r({value:i,type:"shown",ts:Date.now()})),50+100*t)});return()=>{for(let t of e)t&&clearTimeout(t)}}r({value:a,type:"shown",ts:Date.now()})},[a,n]);let o=(0,i.useCallback)(e=>r({type:"stable",ts:Date.now(),value:e}),[r]),d=(0,z.useDebouncedValue)(e,100);return(0,i.useEffect)(()=>{o(Number(d))},[d,o]),l}(a,{disableMotion:o}),A=(0,W.clsx)(K.default.btn,{[K.default.focus]:b,[K.default.hover]:g,[K.default.pressed]:C||x,[K.default.shadow]:!w,[K.default.dash]:"true"!==r.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==r.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===r.default.env.NEXT_PUBLIC_DASH}),N="true"!==r.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==r.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===r.default.env.NEXT_PUBLIC_DASH?g?"gray-1000":"gray-900":"gray-1000";return(0,i.useEffect)(()=>{f?.setHasOpened(!1)},[h]),(0,t.jsxs)("div",{children:[f?.hasOpened?(0,t.jsx)("div",{"aria-hidden":!0}):null,(0,t.jsxs)(S.Root,{"aria-label":"Notifications","data-testid":(0,s.tid)("notifications","popover"),onOpenChange:e=>{(0,V.awaitPaint)().then(()=>{f?.setHasOpened(e),u(e)})},open:x,children:[(0,t.jsx)(S.Trigger,{"aria-label":a?`${a} unseen ${(0,G.pluralize)("notification",a)}`:"notifications",...(0,H.mergeProps)(_,p,m),className:A,"data-testid":(0,s.tid)("notifications","bell"),ref:j,children:(0,t.jsxs)("span",{className:K.default.buttonContent,children:[(0,t.jsx)("div",{className:K.default.icon,children:"true"!==r.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==r.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===r.default.env.NEXT_PUBLIC_DASH?(0,t.jsx)(R,{className:K.default.svgNoPointerEvents,color:N}):(0,t.jsx)(D.Bell,{className:K.default.svgNoPointerEvents,color:N})}),y>0?(0,t.jsx)(X.Status,{className:K.default.statusIcon,color:"blue-900"}):null]})}),(0,t.jsx)(S.Portal,{children:(0,t.jsx)(S.Content,{alignOffset:-10,"aria-label":a?`${a} unseen ${(0,G.pluralize)("notification",a)}`:"notifications",className:K.default.content,sideOffset:12,collisionPadding:10,children:c})})]})]})});var Y=e.i(3351853),Q=e.i(313754),ee=e.i(386648),et=e.i(9138164),ei=e.i(6015702),es=e.i(2155064),en=e.i(2504781),ea=e.i(4237893),el=e.i(3306538),er=e.i(1492947),eo=e.i(57106),ed=e.i(5601342),ec=e.i(6817372),eu=e.i(3423911),em=e.i(7796990),eh=e.i(6036663),ef=e.i(9696510),ex=e.i(9563590),e_=e.i(1889129);function ev(e){let{children:i}=e;return(0,t.jsx)(el.Badge,{className:e_.default.tabBadge,size:"sm",variant:"gray-subtle",children:i})}function eb(e){var n,a,r,o,d,c,u,m,h;let{tab:f,setTab:_,settingsLink:b,currentTabEmpty:p,onArchiveAll:j,onScrollEnd:C,children:w,commentsUnread:y=0,commentsIsLoading:A=!1,inboxUnread:N=0,hasNextThread:E,hasPreviousThread:I,clearSelectedThread:T,selectNextThread:M,selectPreviousThread:L,commentsIsStale:S,viewFreshComments:P}=e,{account:F,isLoading:B}=(0,l.useAccount)(),H=(0,ed.usePreferences)(),[O,D]=(0,i.useState)(!1),R=(0,k.useIsMobile)(),G=(0,i.useContext)(v),X=(n={debounce:40,offset:7},r=(a=(0,i.useMemo)(function(){var e,t,i,s;return{offset:null!=(e=null==n?void 0:n.offset)?e:0,debounce:null!=(t=null==n?void 0:n.debounce)?t:200,debounceOptions:null!=(i=null==n?void 0:n.debounceOptions)?i:{leading:!0},triggerOnNoScroll:null!=(s=null==n?void 0:n.triggerOnNoScroll)&&s}},[null==n?void 0:n.offset,null==n?void 0:n.debounce,null==n?void 0:n.debounceOptions,null==n?void 0:n.triggerOnNoScroll])).offset,o=a.triggerOnNoScroll,d=a.debounce,c=a.debounceOptions,u=(0,i.useMemo)(function(){return d?(0,Y.default)(C,d,c):C},[d,C]),m=(0,i.useRef)(null),h=(0,i.useCallback)(function(){if(null!=m.current){var e=m.current,t=Math.round(e.scrollTop+e.clientHeight);Math.round(e.scrollHeight-r)<=t&&u()}else{var i=document.scrollingElement||document.documentElement,s=Math.round(i.scrollTop+window.innerHeight);Math.round(i.scrollHeight-r)<=s&&u()}},[r,C,m.current]),(0,i.useEffect)(function(){var e=m.current;return null!=e?e.addEventListener("scroll",h):window.addEventListener("scroll",h),o&&h(),function(){null!=e?e.removeEventListener("scroll",h):window.removeEventListener("scroll",h)}},[h,d]),m),{filterValues:V,hasSelectedFilters:z}=(0,x.useCommentFilters)(),U=z(),J=V.q[0];(0,i.useEffect)(()=>{let e=H.isChannelEnabled("in_app_feed");e||O?e&&O&&D(!1):D(!0)},[H,O]);let $=(0,ec.useCommentsViewEnabled)("enable-comments-notifications-view"),q=(0,i.useMemo)(()=>[{title:(0,t.jsxs)(ek,{children:["Inbox ",N>0?(0,t.jsx)(ev,{children:N}):null]}),value:"inbox"},{title:(0,t.jsx)(ek,{children:"Archive"}),value:"archived"}],[N]),K=(0,i.useMemo)(()=>$?[...q,{title:(0,t.jsxs)(ek,{children:["Comments"," ",y>0?(0,t.jsx)(ev,{children:y}):null]}),value:"comments"}]:q,[$,q,y]),Z=(0,i.useMemo)(()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ea.Tabs,{border:!1,"data-testid":(0,s.tid)("notifications","tabs"),selected:f,setSelected:_,tabs:K}),(0,t.jsx)(ej,{...b,onClick:()=>{G?.setHasOpened(!1)}})]}),[G,_,b,f,K]),Q=null;if(O&&"inbox"===f)Q=(0,t.jsx)(eg,{onEnable:()=>{H.setChannel({channels:["in_app_feed"],enabled:!0})}});else if(p){let e;"comments"===f&&!A&&(J?e=`No comments found for "${J}".`:U?e="No comments found with the selected filters.":B||F?.enablePreviewFeedback!=="off"||(e="Enable comments on your Preview Deployments to view them here.")),Q=(0,t.jsx)(ep,{label:e,tab:f})}let{thread:ee}=(0,g.useSelectedComment)(),et=(0,t.jsxs)("div",{className:e_.default.feed,"data-tab":f,children:[(0,t.jsx)("div",{className:e_.default.headerGrid,children:ee?(0,t.jsx)(eh.CommentDetailHeader,{clearSelectedThread:T,forceShowBackButton:!0,hasNext:E,hasPrevious:I,selectNextThread:M,selectPreviousThread:L,showContextMenu:!1,showLinearLink:!1,showPreviewLink:!1,thread:ee,className:"flex-1"}):Z}),(0,t.jsxs)("div",{className:e_.default.feedContent,"data-empty":Q?"":null,ref:X,children:[ee?w:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:["comments"===f?(0,t.jsxs)("div",{className:(0,W.clsx)("flex flex-col items-stretch justify-start gap-2 flex-initial pt-4",p?"absolute inset-x-0 top-0":void 0),children:[(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-3 flex-initial px-4",children:[(0,t.jsx)(ef.CommentsSearch,{loading:A,size:"small"}),(0,t.jsx)(eu.FilterMenu,{buttonSize:"small"})]}),(0,t.jsx)(em.ClearFilters,{buttonSize:"small",className:"px-4"})]}):null,(0,t.jsx)("ol",{className:(0,W.clsx)(e_.default.view,{[e_.default.commentsView]:"comments"===f}),"data-empty":Q?"":null,"data-tab":f,children:Q||w})]}),"comments"===f&&S?(0,t.jsx)(ex.CommentsStaleButton,{onClick:P}):null]}),"inbox"===f&&!Q&&(0,t.jsx)("div",{className:e_.default.archiveFooter,children:(0,t.jsx)(en.Button,{"data-testid":(0,s.tid)("notifications","archive-all"),onClick:()=>j(),size:"small",type:"tertiary",children:"Archive All"})})]});return R?(0,t.jsx)(er.Drawer,{onDismiss:()=>{G?.setHasOpened(!1)},show:G?.hasOpened,children:et}):et}function ep(e){let{tab:i,label:n}=e,a="No new notifications";"archived"===i?a="Nothing in the archive":"comments"===i&&(a="No new comments");let l=(0,t.jsx)(Q.Inbox,{"aria-label":"Empty inbox",color:"gray-700",size:20});return"archived"===i?l=(0,t.jsx)(es.Archive,{"aria-label":"Empty archive",color:"gray-700",size:20}):"comments"===i&&(l=(0,t.jsx)(ei.Message,{"aria-label":"Empty inbox",color:"gray-700",size:20})),(0,t.jsx)("li",{"data-testid":(0,s.tid)("notifications","inbox-zero"),className:"flex flex-col items-center justify-center flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-3 flex-initial",children:[(0,t.jsx)("div",{className:e_.default.emptyIcon,children:l}),(0,t.jsx)("p",{className:`text-copy-14 text-gray-900 text-center ${e_.default.emptyLabel}`,children:n??a})]})})}function eg(e){let{onEnable:i}=e;return(0,t.jsx)("li",{"data-testid":(0,s.tid)("notifications","inbox-zero"),className:"flex flex-col items-center justify-center flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-5 flex-initial",children:[(0,t.jsx)("div",{className:e_.default.emptyIcon,children:(0,t.jsx)(ee.BellOff,{color:"gray-700",size:20})}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"You currently have notifications turned off"}),(0,t.jsx)(en.Button,{"data-testid":(0,s.tid)("notifications","turn-on"),onClick:i,size:"small",children:"Turn on notifications"})]})})}function ej(e){let{as:i,href:n,onClick:a}=e,{focusProps:l,isFocused:r,isFocusVisible:o}=(0,F.useFocusRing)(),{hoverProps:d,isHovered:c}=(0,B.useHover)({});return(0,t.jsx)(eo.Link,{"aria-label":"Settings",as:i,className:e_.default.settingsLink,"data-focus-visible":o?"":null,"data-hover":c?"":null,"data-testid":(0,s.tid)("notifications","settings"),href:n,onClick:a,...l,...d,children:(0,t.jsx)("span",{"aria-hidden":!0,style:{height:16},children:(0,t.jsx)(et.SettingsGear,{color:c||r?"gray-1000":"gray-700"})})})}function ek(e){let{children:i}=e;return(0,t.jsx)("p",{className:`text-copy-14 text-inherit ${e_.default.tabText}`,children:i})}var eC=e.i(7218483),ew=e.i(6241262);function ey(e){let{isMobile:n,notification:a,archiveNotification:l,readNotification:r}=e,[o,d]=(0,i.useState)(!1),{isHovered:c,hoverProps:u}=(0,B.useHover)({}),{isHovered:m,hoverProps:h}=(0,B.useHover)({}),{isFocusVisible:f,focusProps:x}=(0,F.useFocusRing)({within:!0}),_=c||o||n,{id:v,mainAvatar:b,subAvatar:p,actionUrl:g,actionButtons:j,ts:k,markup:C,isArchived:w,isSeen:y,workflow:A}=a,N=(0,t.jsxs)("li",{"data-testid":(0,s.tid)("notifications","item",v),...u,...x,className:(0,W.clsx)("flex flex-row items-stretch justify-between gap-4 flex-initial",ew.default.item,{[ew.default.focusVisible]:f}),children:[(0,t.jsxs)("span",{className:ew.default.subject,children:[(0,t.jsx)("span",{children:b}),p?(0,t.jsx)("span",{className:ew.default.subAvatar,children:p}):null]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:[C,j?.length?(0,t.jsx)("div",{className:"my-2 flex flex-row flex-1 gap-x-4",children:j.map(e=>(0,t.jsx)(eo.ButtonLink,{href:e.action,rel:"noopener noreferrer",size:"small",target:"_blank",type:"primary"===e.name?"default":"secondary",typeName:"button",children:e.label},e.action))}):null,(0,t.jsx)(eA,{ts:k})]}),(0,t.jsxs)("div",{"aria-hidden":w?"true":void 0,className:(0,W.clsx)({[ew.default.hidden]:w}),style:{position:"relative",width:32},children:[(0,t.jsx)("div",{className:(0,W.clsx)("flex flex-col items-center justify-center flex-initial",ew.default.dot,{[ew.default.hidden]:y}),style:{left:_?-24:0},children:(0,t.jsx)("div",{"aria-label":"Not seen yet",role:"note"})}),(0,t.jsx)("div",{className:ew.default.archive,style:{opacity:_||f?1:0},...h,children:(0,t.jsx)(en.Button,{"aria-label":"Archive",className:ew.default.archiveButton,onBlur:()=>d(!1),onFocus:()=>d(!0),passthroughOnClick:e=>{e.preventDefault(),l(A)},shape:"circle",style:{width:32,height:32},svgOnly:!0,title:"Archive",type:"tertiary",children:(0,t.jsx)(es.Archive,{"aria-hidden":"true",color:m||f?"gray-1000":"gray-700"})})})]})]});return g?(0,t.jsx)(eo.Link,{"aria-roledescription":`${w?"Archived":y?"Previously seen":"Unseen"} Notification`,className:ew.default.link,"data-inbox":!w,"data-uid":v,href:g,onClick:()=>{r(A)},children:N}):N}function eA(e){let{ts:i}=e,s=(0,eC.useAgo)(i);return(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",title:new Date(i).toLocaleString(),children:[(0,t.jsx)("span",{className:"geist-sr-only",children:", Created "}),s]})}var eN=e.i(4630293),eE=e.i(8719659),eI=e.i(8698247);function eT(e){let{thread:i}=e,{selectThread:s,thread:n}=(0,g.useSelectedComment)(),a=(0,eE.useUpdateComment)(),{team:l}=(0,j.useTeam)();return(0,t.jsx)("li",{children:(0,t.jsx)("button",{className:(0,W.clsx)(eI.default.commentWrapper,{[eI.default.selected]:n?.id===i.id}),onClick:()=>{s(i),i.read||a({threadId:i.id,roomId:i.roomId,read:!0,teamId:l?.id})},type:"button",children:(0,t.jsx)(eN.CommentsListItem,{showMetadata:!1,thread:i,className:"p-4"})})})}var eM=e.i(2977232),eL=e.i(7017723);function eS(e){let{activeFeed:s,inbox:n,comments:l,tab:r,setTab:o,hasOpened:d,setHasOpened:c,settingsLink:u}=e,{team:h}=(0,j.useTeam)(),f=(0,k.useIsMobile)(),x=(0,eL.useIsImpersonating)(),[_,v]=(0,i.useState)({}),b=(0,i.useCallback)(()=>{v(Object.fromEntries(s.items.map(e=>[e.id,function(e,i,s){var n,a;let l,r,o,d=(l=[],r=(a=e).actors,(o=a.data?.icon)&&l.push({level:"primary",icon:o}),a.actors.length&&null!==r[0]&&l.push({level:"primary",id:r[0].id,avatar:r[0].avatar}),a.data?.focus&&!l.find(e=>"primary"===e.level)&&l.push({level:"primary",id:a.data.focus.id,avatar:a.data.focus.avatar}),l),c=e.blocks.find(e=>"body"===e.name),u=e.blocks.find(e=>"action_url"===e.name),m=e.blocks.find(e=>"actions"===e.name),h=u?.rendered??"";try{let e=new URL(h);e.searchParams.set("utm_medium","web"),e.searchParams.set("utm_source","notifications"),h=e.href}catch(e){}return{id:e.id,workflow:e.source.key,mainAvatar:function(e,i){let s=e.find(e=>"primary"===e.level);if(!s)return i?(0,t.jsx)(C.Avatar,{hash:i.avatar,size:36,teamId:i.id}):null;let{id:n,icon:a,avatar:l}=s;if(a){switch(a){case"alert":return(0,t.jsx)(E,{});case"warn":return(0,t.jsx)(N,{});case"success":return(0,t.jsx)(A,{});case"info":return(0,t.jsx)(I,{})}return}return M(n)?(0,t.jsx)(C.Avatar,{hash:l,size:36,teamId:n}):(0,t.jsx)(C.Avatar,{hash:l,size:36,uid:n})}(d,s),subAvatar:function(e,i){let s=e.find(e=>"secondary"===e.level);if(!s||i.hasIcon)return null;let{id:n,avatar:a}=s;return M(n)?(0,t.jsx)(C.Avatar,{hash:a,size:20,teamId:n}):(0,t.jsx)(C.Avatar,{hash:a,size:20,uid:n})}(d,{hasIcon:!!e.data?.icon}),icon:e.data?.icon,isSeen:!!e.seen_at,isArchived:!!e.archived_at,markup:c?(0,t.jsx)("div",{className:i,dangerouslySetInnerHTML:{__html:(n=c.rendered,T.default.sanitize(n))}}):(0,t.jsx)("div",{className:i}),ts:new Date(e.inserted_at).getTime(),actionUrl:h,actionButtons:m?.buttons?.filter(e=>!!e.action)}}(e,ew.default.notificationContent,h)])))},[s.items,h]);(0,i.useEffect)(()=>{d&&b()},[d,s.items]);let p=(0,i.useMemo)(()=>l.threads.map(e=>(0,t.jsx)(eT,{thread:e},e.id)),[l.threads]),{thread:w,clearSelectedThread:y,selectThread:S}=(0,g.useSelectedComment)(),P=(0,i.useCallback)(e=>{if(0===n.items.length?o("comments"):o("inbox"),e){var t;c(!0),a.analytics.track(m.AnalyticsEvent.NOTIFICATIONS_SHOWN,{shownCount:n.unseen,isCountShown:n.unseen>0,shownGroup:0===(t=n.unseen)?"g0":t<=+Number(16)?"g1":t<=2*Number(16)?"g2":t<=3*Number(16)?"g3":t<=4*Number(16)?"g4":"gx"})}else y(),x||n.markAllSeen()},[y,x,o,n,c]),F=(0,i.useCallback)(()=>{x||n.markAllArchived()},[n,x]),B=(0,i.useMemo)(()=>"comments"===r?l.isEmpty:0===s.items.length,[r,s.items,l.isEmpty]),H=(0,i.useCallback)(()=>{if(!w)return;let e=l.threads.findIndex(e=>e.id===w.id);-1===e||e===l.threads.length-1||S(l.threads[e+1])},[l.threads,S,w]),O=(0,i.useCallback)(()=>{if(!w)return;let e=l.threads.findIndex(e=>e.id===w.id);-1===e||0===e||S(l.threads[e-1])},[l.threads,S,w]),W=(0,i.useMemo)(()=>{if(!w)return!1;let e=l.threads.findIndex(e=>e.id===w.id);return -1!==e&&e!==l.threads.length-1},[l.threads,w]),D=(0,i.useMemo)(()=>{if(!w)return!1;let e=l.threads.findIndex(e=>e.id===w.id);return -1!==e&&0!==e},[l.threads,w]);return(0,t.jsx)(Z,{onOpenChange:P,unseen:n.unseen+l.unreadCount,children:(0,t.jsx)(ed.PreferencesProvider,{defaultLoaded:!0,children:(0,t.jsx)(eb,{clearSelectedThread:y,commentsIsLoading:l.isLoading,commentsIsStale:l.isStale,commentsUnread:l.unreadCount,currentTabEmpty:B,hasNextThread:W,hasPreviousThread:D,inboxUnread:n.unseen,onArchiveAll:F,onScrollEnd:s.fetchNextPage,selectNextThread:H,selectPreviousThread:O,setTab:o,settingsLink:u,tab:r,viewFreshComments:l.viewFreshData,children:"comments"===r?(0,t.jsx)(t.Fragment,{children:w?(0,t.jsx)(L.Comments,{className:eM.default.commentsDetailView,source:"dashboard-notifications-center",thread:w}):p}):s.items.map(e=>_[e.id]?(0,t.jsx)(eP,{archiveItem:n.archiveItem,impersonationMode:x,isMobile:f,item:e,presentation:_[e.id],readItem:n.readItem},`${r}-${e.id}`):null)})})})}function eP(e){let{item:s,presentation:n,readItem:a,archiveItem:l,isMobile:r,impersonationMode:o}=e,d=(0,i.useCallback)(e=>{o||l(s,e)},[l,o,s]),c=(0,i.useCallback)(e=>{o||a(s,e)},[o,a,s]);return(0,t.jsx)(ey,{archiveNotification:d,isMobile:r,notification:n,readNotification:c})}var eF=e.i(1110704);function eB(e){let{children:i}=e,s=p();return"full"!==s.state?i:(0,t.jsx)(x.CommentFilterContextProvider,{type:"modal",children:(0,t.jsx)(g.SelectedCommentContextProvider,{children:(0,t.jsx)(eH,{tenant:s.tenant,children:i})})})}function eH(e){let{children:s,tenant:r}=e,o=function(e){let{tenant:t}=e,s=(0,i.useRef)(0),r=p(),{account:o,user:d,team:c}=(0,l.useAccount)(),{token:v}=(0,h.useKnockToken)({}),[g,j]=(0,i.useState)(!1),[k,C]=(0,i.useState)("inbox");if(!d)throw Error("User not available");let w=b.exec(d.email)?"vtest314":d.uid,y=function(e){let{feed:t,items:s,metadata:n,loading:l,onArchiveAll:r,markAsArchived:o,markAllAsArchived:d}=e,c=(0,i.useRef)(!1);(0,i.useEffect)(()=>{c.current||(c.current=!0,t.fetch())},[t]);let u=(0,i.useCallback)(()=>{let e=s.filter(e=>null===e.seen_at);if(0!==e.length)return t.markAsSeen(e)},[t,s]),h=(0,i.useCallback)(()=>{d(),r()},[r,d]),f=(0,i.useCallback)(async(e,t)=>{let i=Date.now(),s=new Date(e.inserted_at).getTime();a.analytics.track(m.AnalyticsEvent.NOTIFICATIONS_ENGAGEMENT,{uid:e.id,workflow:t??"none",action:"archive",messageTs:s,actionTs:i,timeToAction:i-s}),await o(e)},[o]),x=(0,i.useCallback)(async(e,i)=>{let s=Date.now(),n=new Date(e.inserted_at).getTime();a.analytics.track(m.AnalyticsEvent.NOTIFICATIONS_ENGAGEMENT,{uid:e.id,workflow:i??"none",action:"read",messageTs:n,actionTs:s,timeToAction:s-n}),await t.markAsSeen(e).then(()=>t.markAsRead(e))},[t]),_=(0,i.useCallback)(()=>{s.length<n.total_count&&t.fetchNextPage()},[s.length,n.total_count,t]);return{items:s,loading:l,unseen:n.unseen_count,archiveItem:f,readItem:x,markAllSeen:u,markAllArchived:h,fetchNextPage:_}}({onArchiveAll:()=>{s.current=Date.now()},...u({tab:"inbox",userToken:v,userId:w,tenant:t})}),A=function(e){let{fetchEnabled:t,feed:s,items:n,metadata:a,loading:l}=e,[r,o]=(0,i.useState)(!1);(0,i.useEffect)(()=>{t&&!r&&(s.fetch(),o(!0))},[t,s,n,r]);let d=(0,i.useCallback)(()=>{n.length<a.total_count&&s.fetchNextPage()},[n.length,a.total_count,s]);return{loading:l,items:n,fetchNextPage:d,feed:s}}({fetchEnabled:g,...u({tab:"archived",userToken:v,userId:w,tenant:t})}),{filterValues:N}=(0,x.useCommentFilters)(),E="resolved"===N.status[0]||"unresolved"===N.status[0]?N.status[0]:void 0,I=(0,_.getIfNotEmpty)(N.q),T=(0,_.getIfNotEmpty)(N.project),M=(0,_.getIfNotEmpty)(N.author),L=(0,_.getIfNotEmpty)(N.page),S=(0,_.getIfNotEmpty)(N.pageRegex),P=(0,_.getIfNotEmpty)(N.branch),F=(0,f.useToolbarComments)({type:"inbox",q:I&&I[0].length>0?I[0]:void 0,teamId:c?.id,status:E,projectId:T,author:M,page:L,pageGlob:S,branch:P,limit:20,searchHeaderOnly:1}),B=(0,i.useCallback)(()=>A.feed.fetch(),[A.feed]);(0,i.useEffect)(()=>{"archived"===k&&Date.now()-s.current<3e4&&B()},[k,B]);let H={as:c?.slug?`/${c.slug}/~/settings/notifications`:"/account/notifications",href:c?.slug?"/teams/[teamSlug]/settings/notifications":"/account/notifications"},O="inbox"===k?y:A,W=(0,i.useCallback)(e=>{C(e),a.analytics.track(n.VercelSpecificAnalyticsEvent.NOTIFICATIONS_TAB_CHANGE,{tab:k,teamId:c?.id,commentsEnabled:o?.enablePreviewFeedback!=="off"})},[k,c?.id,o?.enablePreviewFeedback]);return{visibility:r,hasOpened:g,setHasOpened:j,tab:k,setTab:W,inbox:y,archive:A,comments:F,settingsLink:H,activeFeed:O}}({tenant:r});return(0,t.jsx)(v.Provider,{value:o,children:s})}function eO(){let e=p(),s=(0,i.useContext)(v);return e.isLoading?(0,t.jsx)(eF.PlaceholderBell,{visibility:e.state}):null===e.state?null:s?(0,t.jsx)(eS,{...s}):(0,t.jsx)(eF.PlaceholderBell,{visibility:e.state})}(0,s.markLoadedForTest)("notifications"),e.s(["NotificationsProviderAndPopover",0,function(){return(0,t.jsx)(eB,{children:(0,t.jsx)(eO,{})})}],6561189)},4100285,e=>{e.n(e.i(6561189))}]);

//# debugId=6aba07ca-48db-14a5-26ba-2e9ca56c9ea5
//# sourceMappingURL=2413081486fef124.js.map