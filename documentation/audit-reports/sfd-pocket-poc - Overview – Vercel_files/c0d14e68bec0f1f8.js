;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="77250b44-4406-79f6-9898-ee4ac5d024d1")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4422059,e=>{"use strict";var t=e.i(8660982);e.s(["usePrevious",0,function(e){let n=(0,t.useRef)(void 0);return(0,t.useEffect)(()=>{n.current=e}),n.current}])},9186321,e=>{"use strict";var t,n=((t={}).MarketplaceStrictAdmin="marketplace-strict-admin",t.MarketplaceDeploymentActions="marketplace-deployment-actions",t.MarketplaceInstallationOnlyPlan="marketplace-installation-only-plan",t.MarketplaceInstallationDeletePendingAt="marketplace-installation-delete-pending-at",t.MarketplaceIntegrationSupportsResourceClaim="marketplace-integration-supports-resource-claim",t.MarketplaceSsoV2="marketplace-sso-v2",t.MarketplaceMcp="marketplace-mcp",t.AwsIntegration="aws-integration",t);e.s(["LaunchDarklyIntegrationFlags",()=>n])},1919132,e=>{"use strict";function t(e){return e.protocolSettings?.logDrain}e.s(["CONNECT_PROJECT_LABEL",0,"Connect Project","PROJECTS_LABEL",0,"Projects","PROJECT_CONNECTIONS_DESCRIPTION",0,"These are the projects that are connected to this product.","getLogDrainProtocol",0,function(e){return e.protocols.logDrain},"getLogDrainProtocolSettings",0,t,"isLogDrainInConnection",0,function(e){return!!t(e)}])},5744676,e=>{"use strict";var t,n=((t={}).JSON="json",t.NDJSON="ndjson",t);e.s(["DeliveryFormats",()=>n,"LogSourcesWithDescription",0,[{label:"Static",value:"static",description:"Requests to static assets like HTML and CSS files"},{label:"External",value:"external",description:"External rewrites to a different domain"},{label:"Edge",value:"edge",description:"Output from Edge Functions like Middleware"},{label:"Build",value:"build",description:"Output from the Build Step"},{label:"Function",value:"lambda",description:"Output from Vercel Functions like API Routes"},{label:"Firewall",value:"firewall",description:"Requests rejected by the Vercel Firewall"}]])},156530,e=>{"use strict";var t=e.i(8660982);e.s(["useModalState",0,function(e){let[n,r]=(0,t.useState)(!1),i=(0,t.useCallback)(()=>{r(!1)},[]),s=(0,t.useCallback)(()=>{r(!0)},[]),[o,l]=(0,t.useState)(0),a=(0,t.useCallback)(()=>{l(e=>e+1)},[l]);return[s,{active:n,onClickOutside:i,key:`${e}${String(o)}`,onAnimationDone:a}]}])},8020240,e=>{"use strict";var t=e.i(4205214),n=e.i(6607601),r=e.i(5744676),i=e.i(1919132);function s(e){return r.LogSourcesWithDescription.find(t=>t.value===e)?.label??e}e.s(["LogDrainConnection",0,function(e){let{connection:r,inlineCode:o,wrap:l}=e,a=(0,i.getLogDrainProtocolSettings)(r);if(!a)return null;let c=`Sampling ${100*a.samplingRate}%`,d=`${a.sources.map(s).join(", ")}, ${c}`;return o||l?(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-end gap-1 flex-initial w-full flex-wrap",children:o?(0,t.jsxs)(t.Fragment,{children:[a.sources.map(e=>(0,t.jsx)("div",{children:(0,t.jsx)(n.InlineCode,{children:s(e)})},e)),(0,t.jsx)("div",{children:(0,t.jsx)(n.InlineCode,{children:c})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900 text-end",children:a.sources.map(s).join(", ")}),",",(0,t.jsx)("p",{className:"text-copy-14 text-gray-900 text-end",children:c})]})}):(0,t.jsx)("p",{className:"text-copy-13-mono text-gray-900 truncate whitespace-nowrap rounded-[var(--geist-radius)] bg-[var(--accents-2)] px-[4px]",title:d,children:d})}])},5098510,7195573,e=>{"use strict";var t=e.i(4205214),n=e.i(8660982),r=e.i(2560270),i=e.i(7399351),s=e.i(6048771),o=e.i(1919132),l=e.i(5927860);function a(e){return e===l.EnvTarget.Production?"Production":e===l.EnvTarget.Preview?"Preview":"Development"}e.s(["getDefaultEnvironmentsForResource",0,function(e){let t=e?.type==="integration"?e.targets:void 0;return t&&t.length>0?{[l.EnvTarget.Development]:t.includes(l.EnvTarget.Development),[l.EnvTarget.Preview]:t.includes(l.EnvTarget.Preview),[l.EnvTarget.Production]:t.includes(l.EnvTarget.Production)}:{[l.EnvTarget.Development]:!0,[l.EnvTarget.Preview]:!0,[l.EnvTarget.Production]:!0}},"getRecommendedTargetsForResource",0,function(e){return e?.type==="integration"?e.targets:void 0},"stringifyTarget",0,a],7195573);var c=e.i(8020240),d=e.i(9722978);function u(e){let{connection:n,index:r}=e,i=3===n.environments.length?"All Environments":n.environments.map(a).join(", ");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,d.clsx)("flex flex-row items-center justify-between gap-2 flex-initial rounded-md p-2",r%2==1&&"bg-[var(--accents-1)]"),children:[(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(s.ProjectLogo,{deploymentId:n.latestDeployment,framework:n.framework,project:n,size:20}),(0,t.jsx)("p",{className:"text-copy-14",children:n.name})]}),(0,t.jsx)("div",{color:"gray-900",className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:i})})]},n.id),(0,o.isLogDrainInConnection)(n)?(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium shrink-0",children:"Log Drain"}),(0,t.jsx)(c.LogDrainConnection,{connection:n,wrap:!0})]},n.id):null]})}e.s(["ProjectConnectionsListInModal",0,function(e){let{connections:s,className:o}=e,[l,a]=(0,n.useState)(!1);if(1===s.length)return(0,t.jsx)(u,{connection:s[0],index:0});let c=l?s:s.slice(0,2);return(0,t.jsxs)("div",{className:(0,d.clsx)("flex flex-col items-stretch justify-start flex-initial p-2 'border-1 relative rounded-md border-gray-alpha-400 bg-[var(--geist-background)] shadow-border",o),children:[s.length>2?(0,t.jsx)("div",{onClick:()=>a(!l),className:"flex flex-col items-center justify-center flex-initial absolute -bottom-3 right-[calc(50%-12px)] size-6 rounded-full border border-solid border-gray-400 bg-background-100",children:l?(0,t.jsx)(i.ChevronUp,{}):(0,t.jsx)(r.ChevronDown,{})}):null,c.map((e,n)=>(0,t.jsx)(u,{connection:e,index:n},e.id))]})}],5098510)},1627296,e=>{"use strict";var t=e.i(4205214),n=e.i(8660982),r=e.i(8735244);e.s(["LoadMore",0,function(e){let{swr:i}=e,s=(0,n.useRef)(null),[o,l]=(0,n.useState)(!1),{loadMore:a,isReachingEnd:c,isLoadingMore:d,initialDataLoaded:u}=i;return((0,n.useEffect)(()=>{u&&!c&&!d&&o&&a()},[u,o,d,c,a]),(0,n.useEffect)(()=>{let e=s.current;if(!e)return;let t=new IntersectionObserver(e=>{l(e[0].isIntersecting)});return t.observe(e),()=>{t.disconnect()}},[l]),!u||c)?null:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-center flex-initial py-2",style:{position:"relative"},children:[(0,t.jsx)("div",{ref:s,style:{position:"absolute",top:"-150px"}}),d?(0,t.jsx)(r.Spinner,{}):null]})}])},1288475,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path d="M13 8C13 10.7614 10.7614 13 8 13C5.23858 13 3 10.7614 3 8C3 5.23858 5.23858 3 8 3C10.7614 3 13 5.23858 13 8Z" fill="currentColor"/>');e.s(["Status",0,t])},7463721,4404233,e=>{"use strict";var t=e.i(9411809);let n=(0,t.createServerReference)("40088764b2ba576fcf74d52c8797a3927ea3eabe2f",t.callServer,void 0,t.findSourceMapURL,"blockConnectionUntilResourceIsAvailable");e.s(["blockConnectionUntilResourceIsAvailable",0,n],7463721),e.s(["areResourceDeploymentsEnabled",0,function(e){if(!e)return!1;if("protocols"in e)return e.protocols.storage?.status==="enabled";if("product"in e){let t=e.product;if("supportedProtocols"in t)return t.supportedProtocols.includes("storage")}return!1}],4404233)},5393630,e=>{"use strict";var t=e.i(4205214),n=e.i(1288475),r=e.i(5255926),i=e.i(5468328);function s(e){let{label:r,type:i}=e,s="teal-600";return"error"===i?s="red-700":"init"===i?s="gray-500":"warning"===i&&(s="amber-600"),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(n.Status,{color:s}),(0,t.jsx)("p",{className:"text-copy-14",children:r})]})}e.s(["ResourceStatus",0,function(e){let{resource:n}=e;switch(n?.status){case"suspended":return(0,t.jsx)(s,{label:"Suspended",type:"error"});case"limits-exceeded-suspended":return(0,t.jsx)(s,{label:"Limits Exceeded",type:"error"});case"limits-exceeded-suspended-store-count":return(0,t.jsx)(s,{label:"Store Count Limit Reached",type:"error"});case"available":return(0,t.jsx)(s,{label:"Available",type:"ok"});case"error":return(0,t.jsx)(s,{label:"Error",type:"error"});case"initializing":return(0,t.jsx)(s,{label:"Initializing",type:"init"});case"onboarding":return(0,t.jsx)(i.Tooltip,{text:"Additional onboarding is required to enable all features. Please complete the setup in the partner dashboard.",children:(0,t.jsx)(s,{label:"Onboarding",type:"warning"})});case"uninstalled":return(0,t.jsx)(s,{label:"Uninstalled",type:"error"});default:return(0,t.jsx)(r.Skeleton,{boxHeight:20,height:16,vcenter:!0,width:114})}}])},8824424,e=>{"use strict";var t=e.i(4205214),n=e.i(8660982),r=e.i(2323372),i=e.i(3306538),s=e.i(6881349),o=e.i(8522580),l=e.i(5169576),a=e.i(2107254),c=e.i(4004502),d=e.i(6048771),u=e.i(1627296);e.s(["ResourceProjectSelector",0,function(e){let{allowSelectConnectedProjects:p,selectedProject:x,account:m,onProjectSelected:f,resource:g,resourceTitle:h,...j}=e,[v,y]=(0,n.useState)(""),b=(0,n.useMemo)(()=>(0,r.throttle)(y,500),[]),[,C]=(0,a.useProjectListInfinite)({limit:20,search:v,latestDeployments:0,slug:m},{},!1,!0),N=C.initialDataLoaded,w=e=>!!e&&("connectedProjectIds"in j?j.connectedProjectIds.includes(e.id):j.includedInConnectedProjects(e)),P=w(x),S=(0,n.useCallback)(e=>{let t=g?.projectFilter;if(!t||0===Object.keys(t).length)return!1;if(t.git){let{git:n}=t,r=function(e){if(!e)return null;switch(e.type){case"github":return{provider:"github",id:e.repoOwnerId?String(e.repoOwnerId):e.org,slug:e.org};case"gitlab":return{provider:"gitlab",id:e.projectNamespace,slug:e.projectNamespace};case"bitbucket":return{provider:"bitbucket",id:e.workspaceUuid,slug:e.owner};default:return null}}(e.link);if(!r)return"No Git";if("*"!==n.providers&&!n.providers.includes(r.provider)||n.owners&&!n.owners.includes(r.id)&&!n.owners.includes(r.slug))return"Git Mismatch"}return!1},[g]);return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsxs)(s.Combobox,{"data-testid":(0,c.tid)("connect-project","select-project-combobox"),filter:e=>e,onChange:e=>{let t=C.projects.find(t=>t.id===e)??null;(!w(t)||p)&&f(t)},onClear:()=>y(""),placeholder:"Search Projects…",prefixIcon:x?.latestDeployments&&x.latestDeployments.length>0?(0,t.jsx)(d.ProjectLogo,{deploymentId:x.latestDeployments[0]?.id??"",framework:x.framework,project:x,size:20}):null,value:x?.name??null,children:[(0,t.jsx)(s.Combobox.Input,{onChange:e=>b(e.target.value)}),(0,t.jsx)(s.Combobox.List,{emptyMessage:N?v?`No project found with the name "${v}".`:"No project under this account.":"Loading…",ListFooterComponent:(0,t.jsx)(u.LoadMore,{swr:C}),children:C.projects.map(e=>{let n=w(e),r=S(e);return(0,t.jsxs)(s.Combobox.Option,{className:"w-full flex-row items-center justify-between gap-2","data-testid":(0,c.tid)("connect-project","select-project",e.id),disabled:n&&!p||!1!==r,value:e.id,children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(d.ProjectLogo,{deploymentId:e.latestDeployments?.[e.latestDeployments.length-1]?.id,framework:e.framework,project:e,size:20}),(0,t.jsx)("p",{className:"text-copy-14",children:e.name})]}),n?(0,t.jsx)(i.Badge,{variant:"gray",children:"connected"}):null,r?(0,t.jsx)(i.Badge,{variant:"gray",children:r}):null]},e.id)})})]}),P&&p?(0,t.jsx)(o.Note,{fill:!0,label:!1,type:"secondary",variant:"contrast",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(l.Information,{className:"stroke-gray-900",size:20}),(0,t.jsxs)("p",{className:"text-[14px] font-medium leading-[24px] text-gray-1000",children:["This project has already been connected to this ",h]})]}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"To connect it again, use a different Environment Variable Name."})]})}):null]})}])},2014455,e=>{"use strict";var t=e.i(4205214),n=e.i(3869281),r=e.i(4030453),i=e.i(8522580),s=e.i(8660982),o=e.i(5927860),l=e.i(7195573);e.s(["ResourceEnvironmentSelector",0,function(e){let{environments:a,error:c,onChange:d,recommendedTargets:u,resourceTitle:p}=e,x={[o.EnvTarget.Development]:"Development",[o.EnvTarget.Preview]:"Preview",[o.EnvTarget.Production]:"Production"},[m,f]=Object.entries(a).reduce((e,t)=>(e[t[0]in x?0:1].push(t),e),[[],[]]),g=(0,s.useMemo)(()=>u&&0!==u.length?Object.entries(a).filter(e=>{let[t,n]=e;return n&&!u.includes(t)}).map(e=>{let[t]=e;return t}):[],[a,u]),h=(0,s.useMemo)(()=>u&&0!==u.length?u.map(l.stringifyTarget).join(", "):"",[u]);return(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Environments"}),(0,t.jsxs)("div",{className:"text-gray-900 text-[13px] leading-4",children:["Choose which environments of the project to make this"," ",p.toLowerCase()," available to."]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"flex flex-row gap-2",children:m.map(e=>{let[r,i]=e;return(0,t.jsx)(n.Checkbox,{checked:i,onChange:()=>{d({...a,[r]:!i})},children:(0,t.jsx)("span",{className:`font-medium ${!i?"text-gray-900":""}`,children:x[r]})},`environment-${r}`)})}),f.length>0&&(0,t.jsx)("div",{className:"flex flex-row gap-4",children:f.map(e=>{let[r,i]=e;return(0,t.jsx)(n.Checkbox,{checked:i,onChange:()=>{d({...a,[r]:!i})},children:r},`environment-${r}`)})})]}),g.length>0&&(0,t.jsxs)(i.Note,{size:"small",type:"warning",children:["This resource is intended only for ",h,". Use for other environments is not recommended."]}),c?(0,t.jsx)(r.Error,{children:c}):null]})}])},7137779,2483721,e=>{"use strict";var t=e.i(4205214),n=e.i(8660982),r=e.i(6891161),i=e.i(455575),s=e.i(4030453),o=e.i(5468328),l=e.i(4004502),a=e.i(57106),c=e.i(5927860),d=e.i(7917902),u=e.i(4422059),p=e.i(134877),x=e.i(7195573),m=e.i(850302),f=e.i(7463721),g=e.i(6060673),h=e.i(8794163),j=e.i(5074599),v=e.i(9584471),y=e.i(3758860),b=e.i(1887803),C=e.i(3183079),N=e.i(648779),w=e.i(39509);e.i(3182268);var P=e.i(7849855),S=e.i(1919132),k=e.i(4404233),E=e.i(5779481),R=e.i(5393630),I=e.i(397510),T=e.i(8824424),D=e.i(3869281),O=e.i(3500331),M=e.i(1906681),L=e.i(9186321),A=e.i(9722978),B=e.i(7743427),q=e.i(2014455);function F(e){let{isLoading:n,store:r,advancedOptions:i,onChangeAdvancedOptions:s,prefixPlaceholder:o,sampleEnvVarName:l,connection:a}=e,c=(0,j.getResourceTitleByResource)(r),d=(0,x.getRecommendedTargetsForResource)(r),u=r?.type==="integration"&&"convex"===r.product.slug;return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)(q.ResourceEnvironmentSelector,{environments:i.environments,error:i.error?.environments,onChange:e=>s({...i,environments:e,error:{...i.error,environments:void 0}}),recommendedTargets:d,resourceTitle:c}),r?.type==="integration"&&(0,k.areResourceDeploymentsEnabled)(r)?(0,t.jsx)($,{advancedOptions:i,onChangeAdvancedOptions:s,store:r,title:c,connection:a}):null,!u&&(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Custom Prefix"}),(0,t.jsxs)("div",{className:"text-gray-900 text-[13px] leading-4",children:["This prefix will be applied to the environment variables that are automatically created for the ",c,"."]})]}),(0,t.jsx)("div",{className:"flex flex-col gap-4",children:(0,t.jsx)("div",{className:"flex flex-col gap-3",children:(0,t.jsx)(O.Input,{"aria-label":"Environment Variables Prefix",disabled:n,error:i.error?.envPrefix,onChange:e=>s({...i,envPrefix:e.currentTarget.value,error:{...i.error,envPrefix:void 0}}),placeholder:o,suffix:l,value:i.envPrefix,width:"100%"})})})]})]})}function $(e){let{store:r,advancedOptions:i,onChangeAdvancedOptions:s,connection:o}=e,{data:l}=(0,B.useIntegration)(r.product.integration.id),d=l?.flags?.includes(L.LaunchDarklyIntegrationFlags.MarketplaceDeploymentActions),{product:u}=(0,B.useIntegrationAndProduct)({integrationIdOrSlug:r.product.integration.id,productIdOrSlug:r.product.id,teamIdOrSlug:r.ownerId}),p=u?.actions??[],x=(0,n.useMemo)(()=>[{target:c.EnvTarget.Preview,name:"Preview"},{target:c.EnvTarget.Production,name:"Production"}],[]);if(!d)return null;let m=i.deployments,f=!!o,g=p.length>0&&(o||m?.required);return f||g?(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[f?(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Resource is Required To Be In An Active State Before Deployment"})}),(0,t.jsx)(M.Toggle,{className:"w-fit",checked:m?.required??!1,direction:"switch-first",onChange:e=>{s({...i,deployments:{...m,required:e,actions:e?m?.actions:{}}})},size:"large",children:(0,t.jsx)("div",{className:"text-[13px] whitespace-normal",children:m?.required?"Required":"Not Required"})})]}):null,g?(0,t.jsx)("div",{className:(0,A.clsx)("flex flex-col gap-6",{"opacity-50":!m?.required}),children:p.map(e=>(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("div",{className:"text-sm font-semibold capitalize",children:e.name}),e.description?(0,t.jsxs)("div",{className:"text-gray-900 text-[13px]",children:[e.description,e.link?(0,t.jsx)(a.Link,{external:!0,href:e.link}):null]}):null]}),(0,t.jsx)("div",{className:"flex flex-row gap-4",children:x.map(n=>(0,t.jsx)(D.Checkbox,{checked:m?.actions?.[e.slug]?.[n.target]??!1,disabled:!m?.required||!i.environments[n.target],onChange:t=>{s({...i,deployments:{...m,actions:{...m?.actions,[e.slug]:{...m?.actions?.[e.slug],[n.target]:t.target.checked}}}})},children:(0,t.jsxs)("span",{className:`font-medium ${!m?.actions?.[e.slug]?.[n.target]?"text-gray-900":""}`,children:[" ",n.name," "]})},n.target))})]},e.slug))}):null]}):null}var z=e.i(808558),U=e.i(5530726);function V(e){let{resource:n}=e;if(!n||"integration"!==n.type)return null;let r=n.product.projectConnectionScopes;if(!r||0===r.length)return null;let i=r.map(e=>(0,U.scopeFormatter)(e)??null).filter(_).reduce((e,t)=>{let{permission:n}=t;return e[n].push(t),e},{Read:[],"Read and Write":[]});return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"This integration requires the following permissions"}),(0,t.jsx)("ul",{"data-testid":(0,l.tid)("connect-project","scopes"),className:"flex flex-col items-stretch justify-start gap-4 flex-initial m-0 list-none p-0",children:Object.entries(i).map(e=>{let[n,r]=e;return 0===r.length?null:(0,t.jsxs)("li",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:[(0,t.jsx)("div",{className:"flex-basis",children:(0,t.jsx)(z.IconDefault,{size:24})}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,t.jsx)("p",{className:"text-heading-14 whitespace-nowrap",children:n})}),(0,t.jsx)("ul",{className:"m-0 list-none p-0",children:r.map((e,n)=>{let{resource:i}=e;return(0,t.jsx)("li",{style:{display:"inline"},children:(0,t.jsxs)("span",{className:"text-copy-14 tailwind-preflight",children:[i,n===r.length-1?null:", "]})},i)})})]})]},n)})})]})}function _(e){return null!=e}function J(e){let{resource:t,blockData:n}=e,r=t?.status;return"uninstalled"!==r&&(n&&!n.blockConnection||t&&"integration"!==t.type||"available"===r)}function W(e){let{backOrCancelLabel:d,project:g,store:C,connection:N,title:w,subtitle:P,onBack:T,onClickOutside:D,onConnectionCreated:O,ProjectSelector:M,initialEnvPrefix:L,resourceId:B}=e,{mutateResourceListAndProject:q}=(0,v.useMutateResourceCache)(),{mutate:$}=(0,E.useResourceItem)({resourceId:B,includeGuides:!0}),{createConnection:z,updateConnection:U}=(0,b.useResourceConnection)(),{token:_}=(0,h.useV0Marketplace)()||{},[W,Z]=(0,n.useState)(!1),H=(0,n.useMemo)(()=>(0,x.getDefaultEnvironmentsForResource)(C),[C]),[K,Q]=(0,n.useState)({envPrefix:L??N?.envVarPrefix??void 0,environments:N?{[c.EnvTarget.Development]:N.environments.includes(c.EnvTarget.Development),[c.EnvTarget.Preview]:N.environments.includes(c.EnvTarget.Preview),[c.EnvTarget.Production]:N.environments.includes(c.EnvTarget.Production)}:H,deployments:N?.deployments?{required:N.deployments.required,actions:N.deployments.actions.reduce((e,t)=>{let{slug:n,environments:r}=t;return e[n]=r.reduce((e,t)=>(e[t]=!0,e),{}),e},{})}:!N&&(0,k.areResourceDeploymentsEnabled)(C)?{required:!0,actions:{}}:void 0,protocolSettings:N?.protocolSettings??void 0,error:null}),[X,Y]=(0,n.useState)(!1),[ee,et]=(0,n.useState)(null),en=(0,u.usePrevious)(g),er=(0,n.useRef)(!1);(0,n.useEffect)(()=>{er.current||g&&(!en||g.id===en.id)||(er.current=!0,Q(e=>({...e,error:null,environments:H})))},[en,g,H]);let ei=(0,n.useCallback)(async()=>{if(g)try{var e,t;let n,r=[c.EnvTarget.Production,c.EnvTarget.Preview,c.EnvTarget.Development].filter(e=>K.environments[e]),s=K.deployments?{required:K.deployments.required??!1,actions:K.deployments.required?Object.entries(K.deployments.actions??{}).map(e=>{let[t,n]=e;return{slug:t,environments:Object.entries(n).reduce((e,t)=>{let[n,i]=t;return i&&r.includes(n)&&e.push(n),e},[])}}).filter(e=>{let{environments:t}=e;return t.length>0}):[]}:void 0;if(Y(!0),et(null),Q({...K,error:null}),0===r.length){Q({...K,error:{environments:"Select at least one Environment for your Environment Variable"}}),Y(!1);return}if(K.envPrefix&&!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(K.envPrefix)){Q({...K,error:{envPrefix:"The prefix contains invalid characters. It must start with a letter and be made of letters, digits, and underscores only."}}),Y(!1);return}let o=(e=C,t=K.protocolSettings,n=(0,S.getLogDrainProtocolSettings)({protocolSettings:t}),e?.type==="integration"&&(0,y.isProtocolSupported)(e.product,"logDrain")&&n&&!n.sources.length?"Select at least one source to enable log draining":null);if(o){Q({...K,error:{protocolSettings:o}}),Y(!1);return}N?await U({resourceId:B,connectionId:N.id,envVarPrefix:K.envPrefix,envVarEnvironments:r,deployments:s,protocolSettings:K.protocolSettings}):await z({projectId:g.id,envVarPrefix:K.envPrefix,envVarEnvironments:r,deployments:s,resourceId:B,protocolSettings:K.protocolSettings,v0token:_}),i.toasts.success({text:`Connected Project ${g.name} to ${(0,j.getResourceTitleByResource)(C)}`,key:g.id}),await q(g.name,C?.type==="integration"?C.product.supportedProtocols[0]:"storage"),await $(),C?.type==="integration"&&C.product.showSSOLinkOnProjectConnection?Z(!0):(O&&await O(),D())}catch(e){if((0,p.isAPIError)(e))e.code===b.ResourceConnectionsErrorCodes.ProjectEnvVarNotUnique?Q({...K,error:{envPrefix:e.message}}):et(e.message);else throw e}finally{Y(!1)}},[g,K,C,N,q,$,U,B,z,_,O,D]),{isWaitingForAvailableResource:es,onSubmit:eo,resourceStatus:el,isSubmitDisabled:ea,isResourceUninstalled:ec}=function(e){let{initialResource:t,resourceId:r,handleSubmit:i}=e,{data:s}=(0,E.useResourceItem)({resourceId:r,revalidateStatus:!0}),[o,l]=(0,n.useState)(!1),a=s?.store.status,c=(0,n.useRef)(!1),d=s?.store??t,u=d?.type==="integration"?d.product.slug:null,{data:p}=(0,m.default)(u?"marketplace-product-block-connection-until-available":null,()=>(0,f.blockConnectionUntilResourceIsAvailable)(u));(0,n.useEffect)(()=>{!c.current&&o&&J({blockData:p,resource:d})&&(c.current=!0,i())},[i,p,o,d]);let x="uninstalled"===a;return{isWaitingForAvailableResource:!!(o&&"available"!==a&&p?.blockConnection&&!x),onSubmit:()=>{J({blockData:p,resource:d})?i():l(!0)},resourceStatus:a,isSubmitDisabled:!d||!!("integration"===d.type&&!p)||x,isResourceUninstalled:x}}({resourceId:B,handleSubmit:ei}),ed=!Object.values(K.environments).some(Boolean);return(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),eo()},children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(r.Modal.Title,{center:!0,children:w}),P?(0,t.jsx)(r.Modal.Subtitle,{children:P}):null]}),(0,t.jsx)(r.Modal.Inset,{last:!0,children:G(C)&&W?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["Project ",g?.name," successfully connected to"," ",(0,j.getResourceTitleByResource)(C)]}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Complete the project configuration in the"," ",C.product.integration.name," Dashboard"]})]}):(0,t.jsxs)("div",{className:(0,A.default)("flex flex-col items-stretch justify-start gap-6 flex-initial",es?"geist-disabled pointer-events-none":void 0),children:[(0,t.jsx)(a.Link,{href:"#",style:{position:"absolute"},children:""}),M,(0,t.jsx)(V,{resource:C}),(0,t.jsx)(F,{advancedOptions:K,isLoading:X,onChangeAdvancedOptions:Q,prefixPlaceholder:(0,y.getEnvPrefixByResource)(C),sampleEnvVarName:(0,y.getSampleEnvVarNameByResource)(C),store:C,connection:N}),ee?(0,t.jsx)(s.Error,{children:ee}):null]})})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{onClick:W?()=>{O&&O(),D()}:T,type:"secondary",children:W?"Later":d}),G(C)&&W?(0,t.jsx)(I.OpenInPartnerDashboardButton,{buttonVariant:"default",componentType:"button",integrationConfigurationId:C.product.integrationConfigurationId,label:`Open in ${C.product.integration.name}`,onClick:()=>{O&&O(),D()},productId:C.product.id,externalResourceId:C.externalResourceId,teamIdOrSlug:C.ownerId,projectId:g?.id,path:"onboarding"}):(0,t.jsx)(o.Tooltip,{text:ec?"This resource is uninstalled and cannot be connected to projects":ed?"Select at least one environment":void 0,children:(0,t.jsx)(r.Modal.Action,{buttonType:"submit","data-testid":(0,l.tid)("connect-project","store-modal-connect-project"),disabled:!g||ea||ed,loading:X||es,type:es?"secondary":"default",children:es?(0,t.jsx)(R.ResourceStatus,{resource:el?{status:el}:null}):N?"Update":"Connect"})})]})]})}function G(e){return!!(e?.type==="integration"&&e.product.showSSOLinkOnProjectConnection)}e.s(["ConnectResourceForCurrentProjectStep",0,function(e){let{resource:r}=e,{onClose:i,onBack:s,state:o,onResourceUpdated:l}=(0,C.useResourceModalsContext)(),{type:a}=r,{projectSlug:c}=(0,P.useProjectSlug)(),d=(0,g.useProject)(c),u=(0,n.useCallback)(()=>{l({resource:r,isConnected:!0})},[l,r]);return o.type!==w.ResourceModalsActionTypes.CreateEnvs||"integration"!==a?null:(0,t.jsx)(W,{backOrCancelLabel:o.backOrCancelLabel,onBack:s,onClickOutside:i,onConnectionCreated:u,project:d.data,resourceId:r.id,store:r,subtitle:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-1.5 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Connect to"}),(0,t.jsx)(N.ProductIcon,{icon:r.product.iconUrl,size:"small"}),(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-gray-1000",children:r.name})]}),title:`Configure ${d.data?.name??""}`})},"CreateResourceConnectionModal",0,function(e){let{active:i,store:s,onClickOutside:o,onAnimationDone:l,onConnectionCreated:a,resourceId:c,initialProjectSlug:u}=e,{data:p}=(0,g.useProject)(u),[x,m]=(0,n.useState)(null),{team:f,user:h}=(0,d.useAccount)();(0,n.useEffect)(()=>{p&&m(e=>e??p)},[p]);let v=f?f.slug:h?.username;return(0,t.jsx)(r.Modal.Modal,{active:i,allowOverflow:!0,onAnimationDone:l,onClickOutside:o,width:540,children:(0,t.jsx)(W,{ProjectSelector:(0,t.jsx)(T.ResourceProjectSelector,{account:v,allowSelectConnectedProjects:s?.type==="integration"&&(0,y.isProtocolSupported)(s.product,"logDrain"),connectedProjectIds:s?.projectsMetadata.map(e=>e.projectId)??[],onProjectSelected:e=>{m(e)},resource:s??void 0,resourceTitle:(0,j.getResourceTitleByResource)(s),selectedProject:x}),backOrCancelLabel:"Cancel",onBack:o,onClickOutside:o,onConnectionCreated:a,project:x,resourceId:c,store:s,title:S.CONNECT_PROJECT_LABEL})})},"CreateResourceConnectionModalStep",0,W,"UpdateResourceConnectionModal",0,function(e){let{active:n,store:i,connection:s,resourceId:o,onClickOutside:l,onAnimationDone:a,onConnectionCreated:c}=e,d=(0,g.useProject)(s.projectId);return"integration"!==i.type?null:(0,t.jsx)(r.Modal.Modal,{active:n,allowOverflow:!0,onAnimationDone:a,onClickOutside:l,width:540,children:(0,t.jsx)(W,{backOrCancelLabel:"Cancel",connection:s,onBack:l,onClickOutside:l,onConnectionCreated:c,project:d.data,resourceId:o,store:i,subtitle:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-1.5 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Connect to"}),(0,t.jsx)(N.ProductIcon,{icon:i.product.iconUrl,size:"small"}),(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-gray-1000",children:i.name})]}),title:`Configure ${d.data?.name??""}`})})}],7137779);var Z=e.i(7722264),H=e.i(3703009),K=e.i(5098510);e.s(["DeleteStoreConnectionModal",0,function(e){let{active:o,onClickOutside:l,connections:a,onAnimationDone:c,resourceId:d,resource:u}=e,{removeConnections:p}=(0,b.useResourceConnection)(),[x,m]=(0,n.useState)(!1),[f,g]=(0,n.useState)(null),h=(0,i.useToasts)(),j=(0,n.useCallback)(async e=>{e.preventDefault(),g(null),m(!0);try{await p({connectionIds:a.map(e=>e.id),resourceId:d}),m(!1),l()}catch(e){m(!1),(0,Z.isError)(e)?g(e):h.error(`Unexpected error while removing the ${u?.name||"resource"} connection`)}},[p,a,d,l,h,u]),v=a.some(e=>(0,S.isLogDrainInConnection)(e));return(0,t.jsx)(r.Modal.Modal,{active:o,onAnimationDone:c,onClickOutside:l,children:(0,t.jsxs)("form",{onSubmit:e=>void j(e),children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)(r.Modal.Title,{center:!1,children:["Remove"," ",v?"Project Connection & Log Drain":"Project Connection"]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"Are you sure you want to remove this project connection?"}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Removing the connection will delete the associated environment variables from the project and future deployments will not be able to access"," ",u?.name?(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"inline-block align-bottom",children:(0,t.jsx)(H.StoreIconOrAvatar,{icon:"integration"===u.type?u.product.integration.icon:void 0,size:"small",type:u.type})})," ",(0,t.jsx)("span",{className:"align-bottom font-semibold",children:u.name})]}):"this resource","."]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Projects"}),(0,t.jsx)(K.ProjectConnectionsListInModal,{connections:a})]}),f?(0,t.jsx)(s.Error,{children:f.message}):null]})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{disabled:x,onClick:l,type:"secondary",children:"Cancel"}),(0,t.jsx)(r.Modal.Action,{buttonType:"submit",disabled:x,loading:x,children:1===a.length?"Remove Connection":`Remove ${a.length} Connections`})]})]})})}],2483721)}]);

//# debugId=77250b44-4406-79f6-9898-ee4ac5d024d1
//# sourceMappingURL=d5e1dbc1c19deb25.js.map