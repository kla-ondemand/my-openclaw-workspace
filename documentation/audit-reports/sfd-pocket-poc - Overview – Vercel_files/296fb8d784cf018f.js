;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="2040cd30-c6c4-cf95-2444-b7b9014bf0e2")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8384463,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M5.75 0C3.95507 0 2.5 1.45507 2.5 3.25V3.75C2.5 5.54493 3.95507 7 5.75 7H6.25C8.04493 7 9.5 5.54493 9.5 3.75V3.25C9.5 1.45507 8.04493 0 6.25 0H5.75ZM4 3.25C4 2.2835 4.7835 1.5 5.75 1.5H6.25C7.2165 1.5 8 2.2835 8 3.25V3.75C8 4.7165 7.2165 5.5 6.25 5.5H5.75C4.7835 5.5 4 4.7165 4 3.75V3.25ZM12.25 7.25V9H13.75V7.25H15.5V5.75H13.75V4H12.25V5.75H10.5V7.25H12.25ZM1.5 13.1709V14.5H10.5V13.1709C9.68042 11.5377 8.00692 10.5 6.17055 10.5H5.82945C3.99308 10.5 2.31958 11.5377 1.5 13.1709ZM0.0690305 12.6857C1.10604 10.4388 3.35483 9 5.82945 9H6.17055C8.64517 9 10.894 10.4388 11.931 12.6857L12 12.8353V13V15.25V16H11.25H0.75H0V15.25V13V12.8353L0.0690305 12.6857Z" fill="currentColor"/>');e.s(["UserPlus",0,t])},681883,e=>{"use strict";var t=e.i(8660982),i=e.i(5677444),n=e.i(850302),l=e.i(7222834),a=e.i(9326329),s=e.i(8042625),o=e.i(277234),r=e.i(4244280),c=e.i(9668517),d=e.i(5338940),u=e.i(1717203),p=e.i(7557283),m=e.i(7873387);e.s(["PROJECT_MEMBERS_LIMIT",0,20,"default",0,function(e){let{limit:t=20,until:l}=e,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isReady:m,team:x}=(0,d.useTeam)(),{isLoading:h,can:y}=(0,u.default)(),f=(0,a.useRouter)(),g=(0,i.useParams)(),j=f?f.query.project:g?.project;return(0,n.default)(()=>j&&m&&x&&!h&&y(p.Action.List,p.Resource.ProjectMember)?`${(0,r.API_PROJECTS_MEMBERS)(j)}${(0,s.encode)({until:l,limit:t,teamId:x.id})}`:null,e=>(0,o.fetchAPI)(e,{throwOnHTTPError:!0}),c)},"useProjectMembersInfinite",0,function(e){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=arguments.length>2&&void 0!==arguments[2]&&arguments[2],y=arguments.length>3&&void 0!==arguments[3]&&arguments[3],f=e?.search,g=(0,c.useTeamSlug)(),{isReady:j,team:b}=(0,d.useTeam)(),{isLoading:v,can:C}=(0,u.default)(),E=(0,a.useRouter)(),k=(0,i.useParams)(),w=E?E.query.project:k?.project,A=(0,l.default)((e,t)=>{if(!j||!b||!w||v||!C(p.Action.List,p.Resource.ProjectMember))return null;if(!e)return`${(0,r.API_PROJECTS_MEMBERS)(w)}${(0,s.encode)({limit:20,...f?{search:f}:null,teamId:b.id})}`;let i=t?.pagination?.hasNext?t?.pagination.next:null;return i?`${(0,r.API_PROJECTS_MEMBERS)(w)}${(0,s.encode)({limit:20,until:i,...f?{search:f}:null,teamId:b.id})}`:null},e=>(0,o.fetchAPI)(e,{throwOnHTTPError:!0}),{...x,use:h?[m.default]:[]});(0,t.useEffect)(()=>{h&&A.resetLaggy()},[g,h]);let I=(0,t.useMemo)(()=>A.data?.flatMap(e=>e.members.slice(0,20))||[],[A.data]),P=!!A.data,N=P&&0===I.length,T=!!(P&&A.data&&A.size>A.data.length),M=!!(P&&A.data&&!A.data[A.data.length-1]?.pagination.hasNext);return(0,n.default)(()=>{if(!y||!A.data||M||!w||!j||!b||v||!C(p.Action.List,p.Resource.ProjectMember))return null;let e=A.data[A.data.length-1],t=e?.pagination?.hasNext?e?.pagination.next:null;return`${(0,r.API_PROJECTS_MEMBERS)(w)}${(0,s.encode)({limit:20,until:t,search:f,teamId:b.id})}`},e=>(0,o.fetchAPI)(e,{throwOnHTTPError:!0})),[A,{members:I,initialDataLoaded:P,isEmpty:N,loadMore:()=>A.setSize(A.size+1),isLoadingMore:T,isReachingEnd:M,isLagging:A.isLagging}]},"useProjectMembersSummary",0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isReady:i,team:l}=(0,d.useTeam)(),{isLoading:a,can:c}=(0,u.default)();return(0,n.default)(()=>e&&i&&l&&!a&&c(p.Action.List,p.Resource.ProjectMember)?`${(0,r.API_PROJECTS_MEMBERS)(e)}/summary${(0,s.encode)({teamId:l.id})}`:null,e=>(0,o.fetchAPI)(e,{throwOnHTTPError:!0}),t)}])},4123527,e=>{"use strict";var t=e.i(4205214),i=e.i(455575),n=e.i(6891161),l=e.i(8660982),a=e.i(3322724);e.s(["ToastMobileAware",0,function(e){let{actionText:s,active:o,cancelActionText:r,children:c,onAction:d,onCancelAction:u,preserve:p=!1,toastKey:m}=e,x=(0,i.useToasts)(),h=(0,a.useIsMobile)(),[y,f]=(0,l.useState)(!1),[g,j]=(0,l.useState)(!1),b=!h;return((0,l.useEffect)(()=>{b&&(o?(j(!0),f(!0)):(j(!0),f(!1)))},[o,b]),(0,l.useEffect)(()=>{!b||g&&(j(!1),y?x.message({key:m,text:c,preserve:p,action:s,cancelAction:r,onAction:d,onCancelAction:u}):x.removeToastByKey(m))},[s,r,c,d,u,p,b,m,y,x,g]),h)?(0,t.jsxs)(n.Modal.Modal,{active:o,disableFocusTrap:!0,onClickOutside:()=>{j(!1),u?.()},children:[(0,t.jsx)(n.Modal.Body,{children:c}),(0,t.jsxs)(n.Modal.Actions,{children:[r?(0,t.jsx)(n.Modal.Action,{onClick:()=>{j(!1),u?.()},type:"secondary",children:r}):null,s?(0,t.jsx)(n.Modal.Action,{onClick:()=>{j(!1),d?.()},children:s}):null]})]}):null}])},6617350,e=>{"use strict";var t=e.i(7222834),i=e.i(8660982),n=e.i(8042625),l=e.i(7917902);let a=function(){let{limit:e=10,scope:a,access:s,projectIds:o,projectNames:r,aliases:c,userIds:d,includeRequestCount:u,until:p,since:m}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{team:x,isTeam:h,user:y}=(0,l.useAccount)(),f=h?x?.id:y?.uid,g=(0,t.default)((t,i)=>f?`/api/deployments/protection-bypasses${(0,n.encode)({teamId:x?.id,limit:e,scope:a,access:s,until:i?.pagination.next||p,since:m,projectIds:o&&o.length>0?o:void 0,projectNames:r&&r.length>0?r:void 0,aliases:c&&c.length>0?c:void 0,userIds:d&&d.length>0?d:void 0,includeRequestCount:u})}`:null,async e=>{let t=await fetch(e);if(!t.ok)throw Error(t.statusText);return t.json()}),j=!!g.data,b=!!(g.data&&g.data[g.data.length-1]?.protectionBypasses?.length<e),v=(0,i.useMemo)(()=>g.data?g.data.flatMap(e=>e.protectionBypasses):[],[g.data]),C=(0,i.useMemo)(()=>g.data?g.data[0].requestCount:void 0,[g.data]),E=j&&0===v.length,k=!!(g.data&&g.size>g.data.length);return[g,{isEmpty:E,protectionBypasses:v,requestCount:C,initialDataLoaded:j,isReachingEnd:b,loadMore:()=>g.setSize(e=>e+1),isLoadingMore:k,isValidating:g.isValidating}]};e.s(["useAliasProtectionBypasses",0,a,"useHasGrantedCollaborator",0,()=>{let[e,{protectionBypasses:t,initialDataLoaded:i}]=a({scope:"user",access:"granted",limit:1});return{hasGrantedCollaborator:t.length>0,isLoading:!i,mutate:e.mutate}}])},7901966,e=>{"use strict";var t=e.i(4205214),i=e.i(57106),n=e.i(4123527),l=e.i(6159310);e.s(["HobbyLimitAction",0,function(e){let{onUpgradeClick:a,setShowHobbyLimitAction:s,showHobbyLimitAction:o}=e,r=(0,l.useLink)();return(0,t.jsx)(n.ToastMobileAware,{actionText:"Upgrade to Pro",active:o,cancelActionText:"Cancel",onAction:()=>{s(!1),a()},onCancelAction:()=>{s(!1)},preserve:!0,toastKey:"approve-hobby-limit-confirmation",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"You can only share with 1 external collaborator at a time on Hobby. Upgrade to Pro for unlimited external collaborators."}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Manage your existing collaborators"," ",(0,t.jsx)(i.Link,{href:r("/[teamSlug]/~/settings/deployment-protection",{search:{view:"access",s:"user"}}),children:"here"}),"."]})]})})}])},2882012,e=>{"use strict";var t=e.i(8042625),i=e.i(277234),n=e.i(4244280);async function l(e){let{projectIdOrName:l,teamId:a,body:s}=e;return(0,i.fetchAPI)(`${(0,n.API_PROJECTS_VERSION)("v10")}/${l}/protection-bypass${(0,t.encode)({teamId:a})}`,{method:"PATCH",body:JSON.stringify(s),throwOnHTTPError:!0})}async function a(e){let{aliasId:l,teamId:a,body:s}=e;return(0,i.fetchAPI)(`${n.API_ALIASES}/${l}/protection-bypass${(0,t.encode)({teamId:a})}`,{method:"PATCH",body:JSON.stringify(s),throwOnHTTPError:!0})}async function s(e){let{aliasId:l,teamId:a,inviteeEmails:s,message:o}=e;return(0,i.fetchAPI)(`${n.API_ALIASES}/${l}/protection-bypass/invite${(0,t.encode)({teamId:a})}`,{body:JSON.stringify({inviteeEmails:s,message:o}),method:"POST",throwOnHTTPError:!0})}e.s(["insertInviteToAliasProtectionBypass",0,s,"updateAliasProtectionBypass",0,a,"updateProjectProtectionBypass",0,l])},4595422,e=>{"use strict";function t(e){return e?.scope==="automation-bypass"&&!1!==e.isEnvVar}e.s(["createShareableLink",0,(e,t)=>`${e}?_vercel_share=${t}`,"getDefaultAutomationBypass",0,e=>e.protectionBypass?Object.entries(e.protectionBypass).find(e=>{let[i,n]=e;return t(n)})?.[0]??null:null,"getShareableLinkBypass",0,e=>e.protectionBypass&&Object.keys(e.protectionBypass).find(t=>e.protectionBypass?.[t].scope==="shareable-link")||null,"isDefaultAutomationBypass",0,t])},1475969,e=>{"use strict";e.s(["getAliasDeploymentProtectionException",0,e=>{let t=e?.["*"];return t?.scope==="alias-protection-override"?t:null}])},2563635,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)(`<path d="M11.25 4.25V3.5C9.35033 2.86678 6 2.58921 6 0C6 2.58921 2.64967 2.86678 0.75 3.5V9.52717C0.75 11.2011 1.67915 12.7367 3.16197 13.5134L4.5 14.2143" stroke="currentColor" stroke-width="1.5" stroke-linecap="square" fill="transparent" />
  <circle cx="11.5" cy="11.5" r="3.875" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" fill="transparent" />
  <path d="M8 11.5H15.25" stroke="currentColor" stroke-linejoin="bevel"/>
  <path d="M10.75 15V15C10.0964 12.7124 10.0964 10.2876 10.75 8V8" stroke="currentColor" stroke-linejoin="bevel"/>
  <path d="M12.25 15V15C12.9036 12.7124 12.9036 10.2876 12.25 8V8" stroke="currentColor" stroke-linejoin="bevel"/>`);e.s(["ShieldGlobe",0,t])},131102,e=>{"use strict";var t=e.i(5677444),i=e.i(818351),n=e.i(134877),l=e.i(7952834),a=e.i(7101053);e.s(["useDeploymentOverviewProject",0,function(e){let{teamSlug:s}=(0,t.useParams)()??{},o=(0,a.useDefaultProjectParams)();return(0,i.useIsomorphicSWR)(e?(0,l.getProjectKey)(e,{teamId:s,...o}):null,async(e,t)=>{try{let i=await t(e);return(0,l.transformDeploymentOverviewProject)(i)}catch(e){if((0,n.isAPIErrorForbidden)(e)||(0,n.isAPIErrorNotFound)(e))return null;throw e}})}])},8382149,9148684,e=>{"use strict";var t=e.i(4205214),i=e.i(8660982),n=e.i(8159863),l=e.i(3212616),a=e.i(5129431),s=e.i(2645806),o=e.i(9365163),r=e.i(6619197),c=e.i(57106),d=e.i(4030453),u=e.i(6891161),p=e.i(9318197),m=e.i(455575),x=e.i(4004502),h=e.i(277234),y=e.i(4244280),f=e.i(5338940),g=e.i(609109),j=e.i(2695633),b=e.i(5677444),v=e.i(131102);let C=(0,i.memo)(function(e){let{active:n,onClose:l,deployment:a,teamId:s}=e,[o,r]=(0,i.useState)(!1),c=(0,b.useRouter)(),{teamSlug:d,project:p}=(0,b.useParams)()??{},{data:m}=(0,v.useDeploymentOverviewProject)(p),x=(0,i.useCallback)(async()=>{r(!0);let e=s?`?teamId=${s}`:"";await (0,h.fetchAPI)(`${(0,y.API_DEPLOYMENTS)("v2")}/${a.id}${e}`,{throwOnHTTPError:!0,method:"DELETE"}),c.replace(`/${d??""}/${encodeURIComponent(m?.name||"")}?deploymentDeleted=1`),r(!1)},[a,s,c,m,d]);return(0,t.jsxs)(u.Modal.Modal,{active:n,onClickOutside:l,width:"500px",children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{children:"Delete Deployment"})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:[(0,t.jsx)("b",{children:"NOTE:"})," Deployments that are not actively receiving any traffic do not generate any costs nor count towards any limits."]}),(0,t.jsx)("p",{className:"text-copy-14",children:"Deleting this deployment will prevent you from instantly reverting and might break links used in integrations, such as the ones in the pull requests of your Git provider."}),(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:0},children:"Are you sure you want to continue?"})]})]}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{loading:!1,onClick:l,type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{disabled:o,loading:o,onClick:x,children:"Delete"})]})]})});var E=e.i(1857939),k=e.i(1717203),w=e.i(7557283);function A(e){let{project:t,deployment:i}=e,{can:n,isLoading:l}=(0,k.default)({projectIdOrName:t?.name}),{isLoggedOut:a}=(0,E.useIsLoggedIn)(),s=i?.target==="production"?w.Resource.DeploymentFromProductionBranch:w.Resource.DeploymentPreview,o=n(w.Action.Create,s),r=n(w.Action.Update,s),c=n(w.Action.Read,s)||!!(a&&i?.public),d=n(w.Action.Delete,s),u=n(w.Action.Create,w.Resource.Deployment),p=n(w.Action.Update,w.Resource.SkewProtection),m=n(w.Action.Create,w.Resource.DeploymentFromProductionBranch)&&u;return{isLoading:l,permissions:{canCreateDeployment:o,canUpdateDeployment:r,canReadDeployment:c,canDeleteDeployment:d,canPromoteToProduction:u,canUpdateSkewProtection:p,canRedeployProduction:m,canRollbackDeployment:n(w.Action.Create,w.Resource.DeploymentRollback)}}}e.s(["useDeploymentPermissions",0,A],9148684);var I=e.i(850302),P=e.i(3657238);let N="deployment-modal:redeploy",T="deployment-modal:cancel",M="deployment-modal:promote",S="deployment-modal:rollback",D="deployment-modal:skew-protection",R="deployment-modal:delete";function L(){let{data:e=!1}=(0,I.default)(N,null);return{shouldOpen:e,trigger:()=>(0,P.mutate)(N,!0,!1),reset:()=>(0,P.mutate)(N,!1,!1)}}function _(){let{data:e=!1}=(0,I.default)(T,null);return{shouldOpen:e,trigger:()=>(0,P.mutate)(T,!0,!1),reset:()=>(0,P.mutate)(T,!1,!1)}}function O(){let{data:e=!1}=(0,I.default)(M,null);return{shouldOpen:e,trigger:()=>(0,P.mutate)(M,!0,!1),reset:()=>(0,P.mutate)(M,!1,!1)}}function B(){let{data:e=!1}=(0,I.default)(S,null);return{shouldOpen:e,trigger:()=>(0,P.mutate)(S,!0,!1),reset:()=>(0,P.mutate)(S,!1,!1)}}function U(){let{data:e=!1}=(0,I.default)(D,null);return{shouldOpen:e,trigger:()=>(0,P.mutate)(D,!0,!1),reset:()=>(0,P.mutate)(D,!1,!1)}}function H(){let{data:e=!1}=(0,I.default)(R,null);return{shouldOpen:e,trigger:()=>(0,P.mutate)(R,!0,!1),reset:()=>(0,P.mutate)(R,!1,!1)}}let V=(0,i.createContext)(void 0);function F(e){let{setIsLoadingModals:i,setModalsContext:n}=e,{data:a}=(0,l.useCurrentDashboardDeploymentOverviewProject)();return a?(0,t.jsx)($,{project:a,setIsLoadingModals:i,setModalsContext:n}):null}function $(e){let{setIsLoadingModals:l,setModalsContext:b,project:v}=e,{data:E,mutate:k}=(0,n.useCurrentDashboardDeploymentInterval)(),{permissions:w}=A({project:v,deployment:E}),I=L(),P=_(),N=O(),T=B(),M=U(),S=H(),{modal:D,open:R}=(0,a.default)(v),{canRollbackDeployment:V,rollbackModal:F,openRollbackModal:$,previousDeployment:z}=(0,o.useInstantRollbackModal)(v),{modal:q,open:X}=function(e){let[n,l]=(0,i.useState)(!1),[a,s]=(0,i.useState)(!1),[o,r]=(0,i.useState)(null),[b,v]=(0,i.useState)(null),C=(0,m.useToasts)(),{team:E}=(0,f.useTeam)(),k=E?.id,w=(0,j.getGitMeta)(o?.meta),A=(0,i.useCallback)(e=>{r(e),l(!0)},[]),I=(0,i.useCallback)(()=>{l(!1)},[]),P=(0,i.useCallback)(()=>{s(!1),r(null),v(null)},[]),N=(0,i.useCallback)(()=>{if(!e)throw v({message:"projectIdOrName is required to save skew protection"}),Error("projectIdOrName is required to save skew protection");if(!o)throw v({message:"deployment is required to save skew protection"}),Error("deployment is required to save skew protection");s(!0),v(null),(0,h.fetchAPI)(`${(0,y.API_PROJECTS_VERSION)("v9")}/${encodeURIComponent(e)}${k?`?teamId=${k}`:""}`,{method:"PATCH",body:JSON.stringify({skewProtectionBoundaryAt:o.createdAt}),throwOnHTTPError:!0}).then(e=>{e&&(C.success("Successfully configured Skew Protection."),I())}).catch(e=>{v(e)}).finally(()=>{s(!1)})},[e,o,k,C,I]);return{modal:(0,i.useMemo)(()=>(0,t.jsxs)(u.Modal.Modal,{active:n,"data-testid":(0,x.tid)("skew-protection-modal","modal"),onAnimationDone:P,onClickOutside:I,width:"500px",children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{children:"Skew Protection Threshold"})}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Deployments created before"," ",w?(0,t.jsx)(c.Link,{external:!0,href:w.commitUrl,title:"Open git commit in a new window",type:"highlight",children:w.sha.slice(0,7)}):"the selected deployment"," ","(",(0,t.jsx)("em",{children:(0,g.formatDateAndTime)(new Date(o?.createdAt??0))}),")"," ","will no longer use Skew Protection."]}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsx)("p",{className:"text-copy-14",children:"This overrides the maximum age set in your project settings to define a specific deployment as the cutoff."}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsx)("p",{className:"text-copy-14",children:"While uncommon, this may be necessary if there is a specific problematic deployment you want to ensure no longer resolves requests from any other active clients."}),(0,t.jsx)(p.Spacer,{y:1}),b?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Error,{error:b}),(0,t.jsx)(p.Spacer,{y:1})]}):null,(0,t.jsxs)("p",{className:"text-copy-14",children:["Learn more about"," ",(0,t.jsx)(c.Link,{external:!0,href:"https://vercel.com/docs/skew-protection",type:"highlight",children:"Skew Protection"})]})]}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{loading:!1,onClick:I,type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{"data-testid":(0,x.tid)("skew-protection-modal","save-button"),loading:a,onClick:N,children:"Set"})]})]}),[I,P,n,a,b,N,o,w]),close:I,open:A}}(v.id),Y=(0,i.useCallback)(()=>{k()},[k]),{modal:G,open:W}=(0,r.default)(E.projectId,v,{onDeploymentPromoted:Y}),[K,J]=(0,i.useState)(!1),[Z,Q]=(0,i.useState)(!1),ee=(0,i.useCallback)(()=>{R(E)},[R,E]),et=(0,i.useCallback)(()=>{J(!0)},[]),ei=(0,i.useCallback)(()=>{W(E)},[W,E]),en=(0,i.useCallback)(()=>{$(E)},[$,E]),el=(0,i.useCallback)(()=>{X(E)},[X,E]),ea=(0,i.useCallback)(()=>{Q(!0)},[]);return(0,i.useEffect)(()=>{I.shouldOpen&&(ee(),I.reset())},[I,ee]),(0,i.useEffect)(()=>{P.shouldOpen&&(et(),P.reset())},[P,et]),(0,i.useEffect)(()=>{N.shouldOpen&&(ei(),N.reset())},[N,ei]),(0,i.useEffect)(()=>{T.shouldOpen&&(en(),T.reset())},[T,en]),(0,i.useEffect)(()=>{M.shouldOpen&&(el(),M.reset())},[M,el]),(0,i.useEffect)(()=>{S.shouldOpen&&(ea(),S.reset())},[S,ea]),(0,i.useEffect)(()=>{l(!1),b({openRedeployModal:ee,openCancelDeploymentModal:et,openPromoteToProductionModal:ei,openInstantRollbackModal:en,openSkewProtectionModal:el,openDeleteDeploymentModal:ea,canRollbackDeployment:V,isLoadingModals:!1,previousDeployment:z})},[V,ee,et,ei,en,el,ea,b,l,z]),(0,t.jsxs)(t.Fragment,{children:[F,q,G,D,(0,t.jsx)(s.default,{active:K,deployment:E,onClose:()=>J(!1),teamId:E.team?E.team.id:null}),w.canDeleteDeployment?(0,t.jsx)(C,{active:Z,deployment:E,onClose:()=>Q(!1),teamId:E.team?.id}):null]})}V.displayName="DeploymentModalsContext",e.s(["DeploymentModalsProvider",0,function(e){let{children:n}=e,[l,a]=(0,i.useState)(!0),[s,o]=(0,i.useState)({openRedeployModal:()=>{},openCancelDeploymentModal:()=>{},openPromoteToProductionModal:()=>{},openInstantRollbackModal:()=>{},openSkewProtectionModal:()=>{},openDeleteDeploymentModal:()=>{},canRollbackDeployment:!1,isLoadingModals:l,previousDeployment:void 0});return(0,t.jsxs)(V.Provider,{value:s,children:[n,(0,t.jsx)(i.Suspense,{fallback:null,children:(0,t.jsx)(F,{setIsLoadingModals:a,setModalsContext:o})})]})},"useDeploymentModals",0,()=>{let e=(0,i.useContext)(V),t=L(),n=_(),l=O(),a=B(),s=U(),o=H();return e||{openRedeployModal:t.trigger,openCancelDeploymentModal:n.trigger,openPromoteToProductionModal:l.trigger,openInstantRollbackModal:a.trigger,openSkewProtectionModal:s.trigger,openDeleteDeploymentModal:o.trigger,canRollbackDeployment:!1,isLoadingModals:!1,previousDeployment:void 0}}],8382149)},3872400,e=>{"use strict";var t=e.i(2144405),i=e.i(4205214),n=e.i(8660982),l=e.i(5677444),a=e.i(4004502),s=e.i(8893913),o=e.i(3753138),r=e.i(8876434),c=e.i(5255926),d=e.i(2504781),u=e.i(5468328),p=e.i(8674454),m=e.i(4991687),x=e.i(6694387),h=e.i(8459493),y=e.i(7448864),f=e.i(5326905),g=e.i(5257834),j=e.i(455575),b=e.i(1295503),v=e.i(6352514),C=e.i(1853611),E=e.i(3981247),k=e.i(1857939),w=e.i(57106),A=e.i(545405),I=e.i(475038),P=e.i(8382149),N=e.i(380513),T=e.i(9148684),M=e.i(472117),S=e.i(4443312),D=e.i(6619197),R=e.i(9365163);function L(){return(0,i.jsx)(c.Skeleton,{children:(0,i.jsx)(_,{})})}function _(){return(0,i.jsx)(u.Tooltip,{position:"bottom",text:(0,i.jsxs)(i.Fragment,{children:["Additional permissions are required to manage Deployment."," ",(0,i.jsx)(w.Link,{href:"/docs/deployments",variant:"highlight",children:"Learn More â†’"})]}),children:(0,i.jsx)(d.Button,{"aria-label":"Deployment Actions","data-testid":(0,a.tid)("deployment-actions","more-button"),disabled:!0,shape:"square",svgOnly:!0,type:"secondary",children:(0,i.jsx)(r.MoreHorizontal,{})})})}function O(e){let{readyState:t}=e;return"QUEUED"!==t&&"BUILDING"!==t}e.s(["DeploymentMetadataMenuSkeleton",0,L,"DeploymentMoreMenu",0,function(e){let{project:c,deployment:d}=e,{permissions:w,isLoading:B}=(0,T.useDeploymentPermissions)({project:c,deployment:d}),{data:U}=(0,E.useRollingRelease)({teamIdOrSlug:c?.accountId,projectSlug:c?.name}),H=(0,M.useChecksPrivateBetaFlag)(),V=(0,M.useCiChecksAndPoliciesFlagV2)(),F=H||V,{data:$}=(0,N.useFeatureFlag)("enable-team-deployments-page"),{isLoggedOut:z}=(0,k.useIsLoggedIn)(),q=(0,I.useIsViewingPublicDeployment)(),X=(0,j.useToasts)(),{openRedeployModal:Y,openPromoteToProductionModal:G,openSkewProtectionModal:W,openInstantRollbackModal:K,openDeleteDeploymentModal:J,canRollbackDeployment:Z,isLoadingModals:Q,previousDeployment:ee}=(0,P.useDeploymentModals)(),et=(0,n.useCallback)(e=>{(0,A.copyToClipboard)(e),X.message("Copied to clipboard!"),C.analytics.track(v.AnalyticsEvent.DEPLOYMENT_OVERVIEW_COPIED_DEPLOYMENT_URL,{projectId:d.projectId,deploymentId:d.id,deploymentTarget:d.target})},[d,X]),ei=Object.values(w).every(e=>!e),en=Object.values(w).every(e=>e),{teamSlug:el,project:ea}=(0,l.useParams)()??{},es=(0,n.useMemo)(()=>{if(!el||!ea)return null;let e=new URLSearchParams,t=d.gitSource?.ref;return t?(e.set("filterBranch",t),`/${el}/${ea}/deployments?${e.toString()}`):null},[el,ea,d]),eo=(0,n.useMemo)(()=>{if(!el)return null;let e=new URLSearchParams,t=d.gitSource?.ref;return t?(e.set("filterBranch",t),`/${el}/~/deployments?${e.toString()}`):null},[el,d]),er=$&&eo?eo:es,ec=!!(c?.link?.type==="github"&&c.link.org&&c.link.repo&&d.meta?.githubCommitSha),{data:ed}=(0,S.useProjectCheckRuns)({deploymentId:d.id,enableCiChecksAndPolicies:F}),eu=!!ec&&!!ed&&!ed.runs.every(e=>"succeeded"===e.conclusion&&"completed"===e.status),ep=(0,D.usePromoteTooltip)(d),em=(0,R.useRollbackTooltip)(d,ee);if(ei)return"true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH?(0,i.jsx)(b.ActionMenuItem,{"aria-disabled":!0,disabled:!0,children:"More Actions"}):(0,i.jsx)(_,{});if(!q&&B&&!z)return"true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH?(0,i.jsx)(b.ActionMenuItem,{"aria-disabled":!0,disabled:!0,children:"Loading..."}):(0,i.jsx)(L,{});let ex="production"===d.target?w.canRedeployProduction:w.canCreateDeployment;if("true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH){let e=!!em,t=!!ep,n="production"===d.target,l=t?"Promote":U?.rollingRelease?.state==="ACTIVE"?"Queue for Promotion":n&&eu&&F?"Force Promote":n?"Promote":eu?"Force Promote to Production":"Promote to Production";return(0,i.jsxs)(i.Fragment,{children:[q?null:(0,i.jsxs)(i.Fragment,{children:[w.canRollbackDeployment?e?(0,i.jsx)(u.Tooltip,{text:em,children:(0,i.jsx)("div",{children:(0,i.jsx)(b.ActionMenuItem,{disabled:!0,suffix:(0,i.jsx)(s.RotateCounterClockwise,{color:"gray-600"}),children:"Instant Rollback"})})}):(0,i.jsx)(b.ActionMenuItem,{onClick:K,suffix:(0,i.jsx)(s.RotateCounterClockwise,{color:"gray-900"}),children:"Instant Rollback"}):null,w.canPromoteToProduction?(0,i.jsx)(b.ActionMenuItem,{"aria-disabled":t||Q||void 0,disabled:t||Q,onClick:t?void 0:G,suffix:(0,i.jsx)(o.ArrowCircleUp,{color:t?"gray-600":"gray-900"}),children:l}):null,ex?(0,i.jsx)(b.ActionMenuItem,{"aria-disabled":q||Q||void 0,disabled:q||Q,onClick:Y,children:"Redeploy"}):null]}),w.canReadDeployment?(0,i.jsx)(b.ActionMenuItem,{onClick:()=>et(`https://${d.url}`),children:"Copy URL"}):null,!q&&er?(0,i.jsx)(b.ActionMenuLink,{href:er,children:"View All Branch Deployments"}):null,!q&&w.canUpdateSkewProtection?(0,i.jsx)(b.ActionMenuItem,{"aria-disabled":Q||!c?.skewProtectionMaxAge||void 0,disabled:Q||!c?.skewProtectionMaxAge,onClick:W,children:"Skew Protection Threshold"}):null,!q&&w.canDeleteDeployment?(0,i.jsx)(b.ActionMenuItem,{"aria-disabled":!O(d)||Q||void 0,disabled:!O(d)||Q,onClick:J,type:"error",children:"Delete"}):null]})}let eh=null;Z&&(eh=em?(0,i.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,i.jsx)(u.Tooltip,{position:"top",boxAlign:"center",style:{width:"100%"},text:em,children:(0,i.jsx)(h.MenuItem,{disabled:!0,style:{width:"100%"},suffix:(0,i.jsx)(s.RotateCounterClockwise,{color:"gray-600"}),children:(0,i.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,i.jsx)("span",{className:"text-copy-14",style:{fontSize:"inherit",color:"inherit"},children:"Instant Rollback"})})})})}):(0,i.jsx)(h.MenuItem,{onClick:K,suffix:(0,i.jsx)(s.RotateCounterClockwise,{color:"gray-900"}),title:em||void 0,children:(0,i.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,i.jsx)("span",{className:"text-copy-14",style:{fontSize:"inherit",color:"inherit"},children:"Instant Rollback"})})}));let ey=null;if(w.canPromoteToProduction){let e=!!ep,t="production"===d.target,n=e?"Promote":U?.rollingRelease?.state==="ACTIVE"?"Queue for Promotion":t&&eu&&F?"Force Promote":t?"Promote":eu?"Force Promote to Production":"Promote to Production";ey=e?(0,i.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,i.jsx)(u.Tooltip,{boxAlign:"center",position:"top",style:{width:"100%"},text:ep,children:(0,i.jsx)(h.MenuItem,{disabled:!0,style:{width:"100%"},suffix:(0,i.jsx)(o.ArrowCircleUp,{color:"gray-600"}),children:(0,i.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,i.jsx)("span",{className:"text-copy-14",style:{fontSize:"inherit",color:"inherit"},children:n})})})})}):(0,i.jsx)(h.MenuItem,{disabled:Q,onClick:G,suffix:(0,i.jsx)(o.ArrowCircleUp,{color:"gray-900"}),children:n})}let ef=(0,i.jsxs)(i.Fragment,{children:[q?null:(0,i.jsxs)(i.Fragment,{children:[eh,ey,ex?(0,i.jsx)(h.MenuItem,{disabled:q||Q,onClick:Y,children:"Redeploy"}):null]}),w.canReadDeployment?(0,i.jsx)(h.MenuItem,{onClick:()=>et(`https://${d.url}`),children:"Copy URL"}):null,!q&&er?(0,i.jsx)(g.MenuLink,{href:er,children:"View All Branch Deployments"}):null,!q&&w.canUpdateSkewProtection?(0,i.jsx)(h.MenuItem,{disabled:Q||!c?.skewProtectionMaxAge,onClick:W,children:"Skew Protection Threshold"}):null,!q&&w.canDeleteDeployment?(0,i.jsx)(h.MenuItem,{disabled:!O(d)||Q,onClick:J,type:"error",children:"Delete"}):null,!en&&!z&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.MenuDivider,{}),q?null:(0,i.jsxs)(i.Fragment,{children:[Z?null:(0,i.jsx)(y.MenuItemLocked,{children:"Instant Rollback"}),w.canPromoteToProduction?null:(0,i.jsx)(y.MenuItemLocked,{children:"Promote"}),ex?null:(0,i.jsx)(y.MenuItemLocked,{children:"Redeploy"})]}),w.canReadDeployment?null:(0,i.jsx)(y.MenuItemLocked,{children:"Copy URL"}),q||w.canUpdateSkewProtection?null:(0,i.jsx)(y.MenuItemLocked,{children:"Skew Protection Threshold"}),q||w.canDeleteDeployment?null:(0,i.jsx)(y.MenuItemLocked,{children:"Delete"})]})]});return(0,i.jsxs)(m.MenuContainer,{position:"bottom-end",children:[(0,i.jsx)(x.MenuButton,{"aria-label":"Deployment Actions","data-testid":(0,a.tid)("deployment-actions","more-button"),disabled:!d,shape:"square",svgOnly:!0,type:"secondary",children:(0,i.jsx)(r.MoreHorizontal,{})}),(0,i.jsx)(p.Menu,{width:"auto",children:ef})]})}])},310143,5580399,8152065,e=>{"use strict";var t=e.i(2144405),i=e.i(4205214),n=e.i(9722978),l=e.i(2504781),a=e.i(5468328),s=e.i(1295503),o=e.i(7917902),r=e.i(5044530),c=e.i(8893913),d=e.i(475038),u=e.i(100247),p=e.i(8660982),m=e.i(9166951),x=e.i(5585544),h=e.i(3353711),y=e.i(8735244),f=e.i(5255926),g=e.i(6891161),j=e.i(9668517),b=e.i(2695633),v=e.i(3089600),C=e.i(5229375),E=e.i(4896636),k=e.i(1585391),w=e.i(243249),A=e.i(3228096),I=e.i(4345845),P=e.i(5479400);let N=e=>{let{team:t,user:i,projectName:n}=e,l=t?.slug||i?.username;return l&&n?`/${l}/${n}/settings/deployment-protection`:""};function T(e,t,i){return e.id===t?I.GitBranch:e.url===i.url?P.GitCommit:A.Globe}var M=e.i(3306538),S=e.i(8674454),D=e.i(6694387),R=e.i(4991687),L=e.i(8459493),_=e.i(8522580),O=e.i(7087273),B=e.i(455575),U=e.i(57106),H=e.i(1438473),V=e.i(6318858),F=e.i(2560270),$=e.i(9138164),z=e.i(2375916),q=e.i(2563635),X=e.i(3814652),Y=e.i(6352514),G=e.i(1853611),W=e.i(7780974),K=e.i(3322724),J=e.i(1717203),Z=e.i(7557283),Q=e.i(5677444),ee=e.i(2882012);e.i(6483798);var et=e.i(8287059),ei=e.i(1475969),en=e.i(4595422),el=e.i(9481787),ea=e.i(1136434),es=e.i(5756088);let eo=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M14 6V4.5C14 3.39543 13.1046 2.5 12 2.5C10.8954 2.5 10 3.39543 10 4.5V6H10.5H12V7.5V12.5C12 13.8807 10.8807 15 9.5 15H2.5C1.11929 15 0 13.8807 0 12.5V7.5V6H1.5H8.5V4.5C8.5 2.567 10.067 1 12 1C13.933 1 15.5 2.567 15.5 4.5V6H14ZM10.5 7.5H10H8.5H1.5V12.5C1.5 13.0523 1.94772 13.5 2.5 13.5H9.5C10.0523 13.5 10.5 13.0523 10.5 12.5V7.5Z" fill="currentColor"/>');var er=e.i(198667),ec=e.i(5326905),ed=e.i(4670733),eu=e.i(1138941),ep=e.i(8529990),em=e.i(4469437),ex=e.i(7660824),eh=e.i(1265647),ey=e.i(1201436);let ef={visible:{opacity:1,scale:1,filter:"blur(0px)"},hidden:{opacity:0,scale:.6,filter:"blur(2px)"}};function eg(e){let{"aria-label":t,classNameSuccess:a,textToCopy:s,onClick:o,label:r,isLoading:c,...d}=e,u=(0,B.useToasts)(),[m,x]=(0,p.useState)(!1),[h,f]=(0,p.useState)(!1),g=(0,p.useRef)(null);return(0,p.useEffect)(()=>{m&&s&&(x(!1),g.current&&clearTimeout(g.current),f(!0),navigator.clipboard.writeText(s).catch(()=>u.error("Failed to copy to clipboard")),g.current=setTimeout(()=>{f(!1)},1e3))},[u,s,m]),(0,i.jsx)(l.Button,{"aria-label":t,disabled:d.disabled||m,onClick:()=>{x(!0),o?.()},...d,className:(0,n.clsx)(d.className,{[a||""]:h}),children:(0,i.jsx)("div",{className:"flex items-center gap-1.5",children:(0,i.jsxs)(ex.MotionConfig,{transition:{duration:.1},children:[(0,i.jsx)(em.AnimatePresence,{initial:!1,mode:"wait",children:c?(0,i.jsx)(y.Spinner,{}):h?(0,i.jsx)(eh.motion.div,{animate:"visible",exit:"hidden",initial:"hidden",variants:ef,children:(0,i.jsx)(V.Check,{})},"check"):(0,i.jsx)(eh.motion.div,{animate:"visible",exit:"hidden",initial:"hidden",variants:ef,children:(0,i.jsx)(ey.Copy,{})},"copy")}),r]})})})}var ej=e.i(1681029);function eb(e){let{alias:t,protectionBypass:i,protectionEnabledForDeployment:n}=e;if(!t)return;let l=(0,ej.domainToUrl)(t);return i&&n?(0,en.createShareableLink)(l,i):l}var ev=e.i(4123527);function eC(e){let{alias:t,deployment:a,isLoading:s,previewCommentsEnabledForDeployment:r,protectionBypass:c,protectionEnabledForDeployment:d,git:u,onCreateShareableLink:m,onDeleteShareableLink:x,onRegenerateShareableLink:h,openUpgradeModal:y,canUpdateShareableLink:f,viewAndCommentDescription:g}=e,j=(0,K.useIsMobile)(),b=(0,K.useMediaQuery)(430),{team:v,account:C}=(0,o.useAccount)(),E=(0,eu.useProjectIdOrName)(),k=C?.billing?.plan==="hobby",[w,A]=(0,p.useState)(c?"anyone":"team"),[I,P]=(0,p.useState)(!1),N=t&&eb({alias:t,protectionBypass:c,protectionEnabledForDeployment:d||!!c}),T=!d&&!r,M=(0,i.jsx)(eg,{"aria-label":"Copy Link",className:"!h-8 !w-auto !justify-start !px-1",disabled:s||!t||I,onClick:()=>G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_COPY_LINK,{projectId:E,deploymentType:"alias"}),textToCopy:N||"",type:"secondary",label:b?"Link":"Copy Link",isLoading:s||I}),D=(0,ep.getGitInfoFromDeployment)(a),_=(0,ed.useNewFeedbackSharingModal)().value||!1,O=D&&!D.isPublic,B=!!(_&&O&&k),H=(0,p.useCallback)(()=>{G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:E,isHobbyPrivate:B}),y()},[B,y,E]),F=(0,p.useCallback)(e=>{if("anyone"===e&&k||A(e),"anyone"!==e||c)c&&x();else{if(k)return void P(!0);m()}},[k,c,m,x]);(0,p.useEffect)(()=>{I&&c&&P(!1)},[I,P,c,w]),(0,p.useEffect)(()=>{s||A(c?"anyone":"team")},[c,s]);let $=_&&B&&!!v&&(0,i.jsxs)(i.Fragment,{children:["To allow external collaborators to comment on the Hobby plan, the repository"," ",(0,i.jsx)("span",{style:{display:"inline-block",transform:"scale(0.85) translateY(2px)"},children:u?.logo})," ",D?.repoName," ",(0,i.jsx)(es.LockClosed,{size:12})," visibility must be public."]}),z=(0,p.useMemo)(()=>{if(!f)return"You need additional permissions to manage sharing"},[f]),q="Only people with access",X=d?"Anyone with the link":"Publicly accessible",W=(c||s)&&d;return T?(0,i.jsxs)(eE,{notActionable:!0,children:[(0,i.jsx)("div",{className:"flex flex-row items-center justify-start gap-2.5 flex-initial",children:(0,i.jsx)("p",{className:(0,n.clsx)("text-copy-14 text-left text-pretty [&_svg]:align-text-top"),children:"Publicly accessible"})}),M]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(R.MenuContainer,{children:["team"===w?(0,i.jsxs)(eE,{disabled:s||I,notActionable:!!z,children:[(0,i.jsx)(ew,{disabled:s||I,isActionable:!z,children:(0,i.jsx)("div",{className:"flex flex-row items-center justify-start gap-2.5 flex-initial",children:(0,i.jsx)(ek,{forceHide:!z,text:z,children:(0,i.jsxs)("p",{className:"text-copy-14 text-left flex flex-nowrap items-center gap-1 text-pretty",children:[q,b?null:` can ${g}`,z?null:(0,i.jsx)(ea.ChevronDownSmall,{})]})})})}),M]}):(0,i.jsxs)(eE,{disabled:s,notActionable:!!z,children:[(0,i.jsx)(ew,{disabled:s,isActionable:!z,children:(0,i.jsx)("div",{className:"flex flex-row items-center justify-start gap-2.5 flex-initial",children:(0,i.jsx)(ek,{forceHide:!z,text:z,children:(0,i.jsxs)("div",{className:"flex flex-col items-start justify-start flex-initial",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,i.jsxs)("p",{className:(0,n.clsx)("text-copy-14 text-left text-pretty [&_svg]:align-text-top",z?"text-gray-800":void 0),children:[X,d&&!b?` can ${g}`:null]}),z?null:(0,i.jsx)(ea.ChevronDownSmall,{})]}),r?(0,i.jsxs)("p",{className:(0,n.clsx)("text-copy-13",z?"text-gray-800":"text-gray-900"),children:["Visitors must"," ",(0,i.jsx)("span",{className:"geist-hide-on-mobile",children:"be logged in"})," ",(0,i.jsx)("span",{className:"geist-show-on-mobile",children:"log in"})," to comment"]}):null]})})})}),M]}),(0,i.jsxs)(S.Menu,{width:300,children:[(0,i.jsx)(ek,{forceHide:!z,text:z,children:(0,i.jsx)(L.MenuItem,{disabled:s||!!z,onClick:()=>F("team"),prefix:(0,i.jsx)(es.LockClosed,{}),style:{width:"100%"},suffix:"team"===w?(0,i.jsx)(V.Check,{}):null,children:q})}),(0,i.jsx)(ek,{forceHide:!(z||$),text:z||$,children:(0,i.jsx)(L.MenuItem,{disabled:s||B||!!z||I,innerMenuItemClassName:"!pointer-events-auto",onClick:()=>{F("anyone")},prefix:(0,i.jsx)(eo,{}),style:{width:"100%"},suffix:"anyone"===w?(0,i.jsx)(V.Check,{}):null,children:(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial w-full",children:[X,B?(0,i.jsx)(l.Button,{onClick:H,size:"small",style:{cursor:"pointer",background:"var(--geist-foreground)",color:"var(--geist-background)"},children:"Upgrade"}):null]})})}),W?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ec.MenuDivider,{}),(0,i.jsx)(ek,{text:"Regenerate shareable link",children:(0,i.jsx)(L.MenuItem,{onClick:h,prefix:(0,i.jsx)(er.RefreshClockwise,{}),style:{width:"100%"},children:"Reset link"})})]}):null]})]}),(0,i.jsx)(ev.ToastMobileAware,{actionText:"Confirm",active:I,cancelActionText:"Cancel",onAction:()=>{A("anyone"),m()},onCancelAction:()=>{P(!1)},preserve:!0,toastKey:"create-shareable-link-hobby-confirmation",children:(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,i.jsxs)("p",{className:"text-copy-14",children:["You can only have 1 shareable link at a time on Hobby."," ",(0,i.jsx)(U.Link,{external:!0,icon:!1,onClick:()=>{P(!1),H()},underline:!j||void 0,variant:j?"highlight":void 0,children:"Upgrade to Pro"})," ","for unlimited shareable links."]}),(0,i.jsx)("p",{className:"text-copy-14",children:"Continuing will revoke any existing shareable links."})]})})]})}function eE(e){let{disabled:t=!1,children:l,notActionable:a}=e;return(0,i.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial w-full",children:(0,i.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial w-full",children:(0,i.jsx)("div",{className:(0,n.clsx)("flex flex-col items-stretch justify-start flex-initial w-full py-0 pl-0.5",{"cursor-not-allowed":t,"cursor-default":a&&!t}),children:(0,i.jsx)("div",{className:"flex flex-row items-stretch justify-between flex-initial w-full",children:l})})})})}function ek(e){let{children:t,forceHide:n,text:l}=e;return(0,i.jsx)(a.Tooltip,{desktopOnly:!0,forceHide:n,maxWidth:350,padding:10,style:{width:"100%"},text:l,children:t})}function ew(e){let{isActionable:t,children:n,disabled:l}=e;return t?(0,i.jsx)(D.MenuButton,{disabled:l,variant:"unstyled",className:"hover:bg-gray-100 rounded-md",children:n}):(0,i.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial pl-1.5",children:n})}var eA=e.i(4585051),eI=e.i(6942035),eP=e.i(2988836),eN=e.i(1448582),eT=e.i(681883),eM=e.i(7898658),eS=e.i(9523111);function eD(){return(0,i.jsx)("div",{className:"flex flex-col items-center justify-center flex-initial max-w-max overflow-hidden rounded-full border border-gray-400 bg-gray-700 p-2 font-bold text-white",children:(0,i.jsx)(eS.Email,{size:16})})}var eR=e.i(6617350),eL=e.i(7901966);function e_(e){let{target:t,canUpdateProtectionBypass:n=!0,hideStaticTeamMembersBanner:l=!1,onUpgradeClick:a,project:s,revalidateAlias:o,branchAliasId:r,branchName:c}=e;return t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eO,{branchAliasId:r,branchName:c,canUpdateProtectionBypass:n,filter:"requests",onUpgradeClick:a,project:s,revalidateAlias:o,target:t}),(0,i.jsx)(eO,{canUpdateProtectionBypass:n,filter:"granted",hideStaticTeamMembersBanner:l,onUpgradeClick:a,project:s,revalidateAlias:o,target:t})]}):null}function eO(e){let{target:t,canUpdateProtectionBypass:n=!0,filter:l,hideStaticTeamMembersBanner:s=!1,onUpgradeClick:r,project:c,revalidateAlias:d,branchAliasId:u,branchName:m}=e,{team:x,user:h}=(0,o.useAccount)(),{data:y}=(0,eT.default)({limit:1},{revalidateIfStale:!1,revalidateOnFocus:!1}),f=(0,p.useMemo)(()=>Object.entries(t.protectionBypass??{}).map(e=>{let[t,i]=e;return"user"===i.scope?{...i,userId:t}:"email_invite"===i.scope?{...i,email:t}:void 0}).filter(e=>void 0!==e).sort((e,t)=>t.createdAt>e.createdAt?1:-1),[t.protectionBypass]),g=l?f.filter(e=>("user"===e.scope&&"requested"===e.access)==("requests"===l)):f,j=(0,p.useCallback)(async e=>{await (0,ee.updateAliasProtectionBypass)({aliasId:t.id,teamId:x?.id,body:e}),await d()},[t.id,x?.id,d]),b=(0,p.useMemo)(()=>{if(u&&t.id.startsWith("dpl_"))return async e=>{await (0,ee.insertInviteToAliasProtectionBypass)({aliasId:u,teamId:x?.id,inviteeEmails:[e],message:""}),await d()}},[u,d,t.id,x?.id]);if(0===g.length&&!("granted"===l&&!s))return null;let v=y?.members.length;return(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,i.jsx)("p",{className:"text-copy-14 font-medium",children:"requests"===l?"Access requests":"People with access"}),(0,i.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,i.jsxs)("div",{className:"space-y-2",children:[s||"granted"!==l?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eU,{thumbnail:(0,i.jsx)(eA.Avatar,{size:20,teamId:x?.id,username:x?void 0:h?.username}),title:(0,i.jsxs)("span",{className:"flex flex-row items-stretch justify-start gap-1 flex-initial",children:[(0,i.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:x?.name||"You"}),x?(0,i.jsx)(i.Fragment,{children:/\bteam\b/i.test(x.name)?" members":" team members"}):null,v?(0,i.jsx)(a.Tooltip,{text:"Excluding contributors without access to this project.",children:(0,i.jsx)(eP.InformationFillSmall,{})}):null]})}),v?(0,i.jsx)(eU,{thumbnail:(0,i.jsx)(e$,{project:c}),title:(0,i.jsxs)("span",{className:"text-copy-14",children:[(0,i.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:c.name})," ",(0,i.jsx)("span",{className:"text-copy-14",children:"project contributors"})]})}):null]}),g.map(e=>(0,i.jsx)(eB,{branchName:m,canUpdateProtectionBypass:n,onUpgradeClick:r,targetUrl:t.url,updateBranchAccess:b,updateUserAccess:j,user:e},"user"===e.scope?e.userId:e.email))]})})]})}function eB(e){let{canUpdateProtectionBypass:t,onUpgradeClick:n,user:l,updateUserAccess:a,updateBranchAccess:s,branchName:r,targetUrl:c}=e,d=(0,B.useToasts)(),{account:u}=(0,o.useAccount)(),[m,x]=(0,p.useState)(void 0),h=u?.billing?.plan==="hobby",{hasGrantedCollaborator:y,mutate:f}=(0,eR.useHasGrantedCollaborator)(),[g,j]=(0,p.useState)(!1),b="user"===l.scope,v=async(e,t)=>{x(e);try{let i=b?{scope:{userId:l.userId,access:e}}:{scope:{email:l.email,access:"denied"}};await Promise.all([a(i),l.email&&t&&s&&"granted"===e?s(l.email):void 0]),await f()}catch{d.error("An error occurred, please try again later.")}finally{x(void 0)}},C=async e=>{h&&y?j(!0):await v("granted",e)},E=void 0!==m;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eU,{actions:(0,i.jsx)(eH,{branchName:r,canUpdateProtectionBypass:t,isAccessRequested:!!b&&"requested"===l.access,isInvitationFlagEnabled:!0,isLoading:E,isUpdating:m,onAccessGranted:C,showBranchOption:!!(s&&l.email)&&!h,showHobbyLimitAction:g,targetUrl:c,updateAccess:v}),description:b?l.email:void 0,thumbnail:"user"===l.scope?(0,i.jsx)(eA.Avatar,{size:20,username:b?l.username:void 0}):(0,i.jsx)(eD,{}),title:b?l.username??l.userId:l.email}),(0,i.jsx)(eV,{isInvitationFlagEnabled:!0,isLoading:E,onUpgradeClick:n,setShowHobbyLimitAction:j,showHobbyLimitAction:g,onConfirm:()=>v("granted")})]})}function eU(e){let{actions:t,description:n,thumbnail:l,title:a}=e;return(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[l,(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,i.jsx)("p",{className:"text-copy-14",children:a}),(0,i.jsx)("p",{className:"text-copy-13 text-gray-900",children:n})]})]}),t]})}function eH(e){let{canUpdateProtectionBypass:t=!0,isAccessRequested:n,isInvitationFlagEnabled:s,isLoading:o,isUpdating:r,onAccessGranted:c,showHobbyLimitAction:d,updateAccess:u,showBranchOption:p,branchName:m,targetUrl:x}=e,h=(0,i.jsx)(eI.Cross,{}),f=(0,i.jsx)(V.Check,{}),g=t?void 0:"You need additional permissions to manage access requests",j=d||!t,b=p?(0,i.jsxs)(R.MenuContainer,{children:[(0,i.jsx)(D.MenuButton,{"aria-label":"Approve",disabled:j,shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:f}),(0,i.jsxs)(S.Menu,{width:"auto",children:[(0,i.jsx)(L.MenuItem,{innerMenuItemClassName:"h-auto py-2",onClick:()=>void c(),prefix:(0,i.jsx)(P.GitCommit,{}),children:(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,i.jsx)("p",{className:"text-copy-14",children:"Approve for Deployment"}),(0,i.jsx)("p",{className:"text-copy-13 text-gray-900",children:x})]})}),(0,i.jsx)(L.MenuItem,{innerMenuItemClassName:"h-auto py-2",onClick:()=>void c(!0),prefix:(0,i.jsx)(I.GitBranch,{}),children:(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,i.jsx)("p",{className:"text-copy-14",children:"Approve for Deployment and Branch"}),(0,i.jsx)("p",{className:"text-copy-13 text-gray-900",children:m})]})})]})]}):(0,i.jsx)(l.Button,{"aria-label":"Approve",disabled:j,onClick:()=>void c(),shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:f});return(0,i.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,i.jsx)(a.Tooltip,{desktopOnly:!0,text:g??(n?"Decline":"Revoke"),children:o?(0,i.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial mx-2",children:"denied"===r?(0,i.jsx)(y.Spinner,{size:16}):h}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(l.Button,{"aria-label":"Decline",disabled:!t,onClick:()=>void u("denied"),shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:h})})}),n?(0,i.jsx)(a.Tooltip,{desktopOnly:!0,text:g??"Approve",children:o?(0,i.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial mx-2",children:"granted"===r?(0,i.jsx)(y.Spinner,{size:16}):f}):b}):null]})}function eV(e){let{isInvitationFlagEnabled:t,isLoading:n,onUpgradeClick:l,setShowHobbyLimitAction:a,showHobbyLimitAction:s,onConfirm:o}=e;return t&&l?(0,i.jsx)(eL.HobbyLimitAction,{onUpgradeClick:l,setShowHobbyLimitAction:a,showHobbyLimitAction:s,onConfirm:o}):(0,i.jsx)(eF,{isLoading:n,setShowHobbyLimitAction:a,showHobbyLimitAction:s,onConfirm:o})}function eF(e){let{isLoading:t,setShowHobbyLimitAction:n,showHobbyLimitAction:s,onConfirm:o}=e;return(0,i.jsx)(em.AnimatePresence,{children:s&&!t?(0,i.jsx)(eN.m.div,{animate:{height:"auto"},className:"relative box-border rounded border border-gray-400 bg-gray-100 dark:bg-gray-100",exit:{height:0},initial:{height:0},style:{padding:0},transition:{ease:"easeInOut"},children:(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial px-4",children:[(0,i.jsx)("p",{className:"text-copy-13 text-gray-900",children:"Hobby plans have a limit of 1 external collaborator at a time. Confirm to remove any existing user access."}),(0,i.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,i.jsx)(a.Tooltip,{desktopOnly:!0,text:"Cancel",children:(0,i.jsx)(l.Button,{"aria-label":"Cancel",onClick:()=>{n(!1)},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,i.jsx)(eI.Cross,{})})}),(0,i.jsx)(a.Tooltip,{desktopOnly:!0,text:"Confirm",children:(0,i.jsx)(l.Button,{"aria-label":"Confirm",onClick:()=>{n(!1),o()},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,i.jsx)(V.Check,{})})})]})]})},"hobby-limit-actions"):null})}function e$(e){let{size:t=20,style:n,project:l,title:a}=e,{data:s,isLoading:o}=(0,eM.default)({project:l}),r=(0,eu.useFramework)(l);return!o&&(r||s)?(0,i.jsx)(eA.Avatar,{size:t,src:s?.src||r?.logo,style:n,title:a??r?.name}):(0,i.jsx)(f.Skeleton,{height:t,rounded:!0,style:{flexShrink:0},width:t})}var ez=e.i(8248823),eq=e.i(4030453),eX=e.i(9334091),eY=e.i(8384463),eG=e.i(6734680),eW=e.i(8587921);function eK(e){let{inputText:t,navIndex:n,onPicked:l,setNavIndex:a,suggestions:s}=e;return t?(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,i.jsx)(eJ,{index:-1,isSelected:-1===n,onClick:()=>{l({label:t,value:t})},onMouseMove:()=>{a(-1)},option:{label:t,value:t}}),s?.map((e,t)=>(0,i.jsx)(eJ,{index:t,isSelected:t===n,onClick:()=>{l(e)},onMouseMove:()=>{a(t)},option:e},e.value))]}):null}function eJ(e){let{index:t,isSelected:l,onClick:a,onMouseMove:s,option:o}=e,{member:r}=o,c=(0,p.useRef)(null);(0,p.useEffect)(()=>{c.current&&l&&c.current.scrollIntoView({behavior:"smooth",block:-1===t?"end":"nearest"})},[t,l]);let d=r?.name||r?.username,u=d||o.value;return(0,i.jsxs)("div",{onClick:a,onMouseMove:s,ref:c,className:(0,n.clsx)("flex flex-row items-center justify-start gap-2 flex-initial relative cursor-default rounded-md transition-colors duration-150 hover:bg-gray-100",{'after:content-["_"] after:box-content after:absolute after:-left-2 after:bg-gray-alpha-100 after:w-full after:h-full after:rounded after:p-2':l}),children:[r?(0,i.jsx)(eA.Avatar,{size:32,username:r.username}):(0,i.jsx)(eD,{}),(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial overflow-hidden",children:[(0,i.jsx)("p",{className:"text-copy-14 truncate",children:u}),d?(0,i.jsx)("p",{className:"text-copy-13 text-gray-900",children:o.value}):null]})]})}var eZ=e.i(9980739),eQ=e.i(5592888),e0=e.i(4565610),e1=e.i(746491),e5=e.i(2203852),e2=e.i(712031),e4=e.i(7033292),e3=e.i(6831779),e8=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],e6=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=String(e).toLowerCase(),l=String(i.getOptionValue(t)).toLowerCase(),a=String(i.getOptionLabel(t)).toLowerCase();return l===n||a===n},e7=function(e){return'Create "'.concat(e,'"')},e9=function(e,t,i,n){return!(!e||t.some(function(t){return e6(e,t,n)})||i.some(function(t){return e6(e,t,n)}))},te=function(e,t){return{label:t,value:e,__isNew__:!0}};e.i(8080906),e.i(3537861);var tt=(0,p.forwardRef)(function(e,t){var i,n,l,a,s,o,r,c,d,u,m,x,h,y,f,g,j,b,v,C,E,k,w,A,I,P,N,T,M=(l=void 0!==(n=(i=(0,e1.u)(e)).allowCreateWhileLoading)&&n,s=void 0===(a=i.createOptionPosition)?"last":a,r=void 0===(o=i.formatCreateLabel)?e7:o,d=void 0===(c=i.isValidNewOption)?e9:c,m=void 0===(u=i.getNewOptionData)?te:u,x=i.onCreateOption,y=void 0===(h=i.options)?[]:h,f=i.onChange,b=void 0===(j=(g=(0,e4.default)(i,e8)).getOptionValue)?e0.g:j,C=void 0===(v=g.getOptionLabel)?e0.b:v,E=g.inputValue,k=g.isLoading,w=g.isMulti,A=g.value,I=g.name,P=(0,p.useMemo)(function(){return d(E,(0,e3.H)(A),y,{getOptionValue:b,getOptionLabel:C})?m(E,r(E)):void 0},[r,m,C,b,E,d,y,A]),N=(0,p.useMemo)(function(){return(l||!k)&&P?"first"===s?[P].concat((0,e2.default)(y)):[].concat((0,e2.default)(y),[P]):y},[l,s,k,P,y]),T=(0,p.useCallback)(function(e,t){if("select-option"!==t.action)return f(e,t);var i=Array.isArray(e)?e:[e];if(i[i.length-1]===P){if(x)x(E);else{var n=m(E,E);f((0,e3.D)(w,[].concat((0,e2.default)((0,e3.H)(A)),[n]),n),{action:"create-option",name:I,option:n})}return}f(e,t)},[m,E,w,I,P,x,f,A]),(0,e5.default)((0,e5.default)({},g),{},{options:N,onChange:T}));return p.createElement(e0.S,(0,eQ.default)({ref:t},M))}),ti=e.i(6401841),tn=e.i(9096446),tl=e.i(6143247);let ta={control:e=>(0,tl.cn)("w-full border border-solid border-gray-alpha-400 bg-white rounded min-h-10 transition-colors duration-200",e.isFocused&&"hover:border-gray-alpha-600 bg-white shadow-focus-border",e.isDisabled&&"bg-gray-100"),valueContainer:()=>"px-2 py-1.5",input:()=>"py-0.5 m-0.5 text-gray-1000 text-base lg:text-sm",placeholder:()=>"mx-0.5 text-gray-600",indicatorsContainer:()=>"flex items-center px-2",indicatorSeparator:()=>"hidden",dropdownIndicator:()=>"text-gray-600 hover:text-gray-800 transition-colors duration-150",clearIndicator:()=>"text-gray-600 hover:text-gray-800 transition-colors duration-150 cursor-pointer",menu:()=>"bg-white border border-gray-alpha-400 rounded-md shadow-lg mt-1 z-50",menuList:()=>"py-1 max-h-60 overflow-auto",option:e=>(0,tl.cn)("px-3 py-2 text-sm cursor-pointer transition-colors duration-150 text-gray-1000 hover:bg-gray-100",e.isFocused&&"bg-gray-alpha-100",e.isSelected&&"bg-blue-500 text-white"),multiValue:()=>"inline-flex items-center bg-gray-200 rounded text-sm",multiValueLabel:()=>"pl-1 pr-0 py-1 flex font-medium text-xs",multiValueRemove:()=>"pl-0.5 pr-1 cursor-pointer rounded-xs flex items-center text-inherit box-border hover:bg-transparent hover:text-inherit"},ts=(0,p.forwardRef)(function(e,t){let{disabled:n,disabledText:l,inputText:s,invitationFocused:o,invitees:r,onInputBlur:c,onInputChangeHandler:d,onInputFocused:u,onKeyDown:m,placeholder:x,setInvitees:h}=e,y=(0,p.useCallback)((e,t)=>{e&&Array.isArray(e)&&h(e)},[h]),f=(0,i.jsx)(tt,{autoFocus:o,classNames:ta,components:{MultiValue:to,MultiValueRemove:tc,Option:td,NoOptionsMessage:tm,DropdownIndicator:()=>null},formatCreateLabel:e=>e,inputValue:s,isClearable:!1,isDisabled:n,isLoading:!1,isMulti:!0,isSearchable:!0,menuIsOpen:!1,onBlur:()=>c(),onChange:y,onFocus:()=>u(),onInputChange:d,onKeyDown:m,openMenuOnClick:!1,placeholder:x,ref:t,value:r,unstyled:!0});return n?(0,i.jsx)(a.Tooltip,{desktopOnly:!0,style:{width:"100%",display:"block"},text:l,children:f}):f});function to(e){let t=e.data,l=!(0,eG.default)(t.value),a={...{innerProps:{className:(0,n.clsx)(e.className,"m-0.5 flex min-h-6 items-center overflow-hidden rounded-full leading-none",{"bg-red-300 hover:bg-red-400 text-red-900 [&_span>div>svg]:hover:stroke-red-500":l,"bg-gray-300 text-gray-1000 hover:bg-gray-400":!l})}},...e};return(0,i.jsx)(eZ.components.MultiValue,{...a,children:(0,i.jsx)(tr,{isEmailInvalid:l,option:t})})}function tr(e){let{isEmailInvalid:t,option:l}=e;return t?(0,i.jsx)(a.Tooltip,{text:"Not a valid email address",children:(0,i.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,i.jsx)(tp,{}),l.value]})}):(0,i.jsxs)("div",{className:`flex flex-row items-center justify-start gap-1 flex-initial ${(0,n.clsx)({"ml-0.5":!l.member})}`,children:[l.member?(0,i.jsx)(eA.Avatar,{className:"border-none",size:16,username:l.member.username}):null,l.value]})}function tc(e){let{innerProps:t}=e;return(0,i.jsx)("div",{...t,children:(0,i.jsx)(tn.CrossSmall,{})})}function td(e){let t=e.data;return(0,i.jsx)(eZ.components.Option,{...e,children:(0,i.jsx)(tu,{text:t.label})})}function tu(e){let{text:t}=e;return(0,i.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,i.jsx)(eD,{}),(0,i.jsx)("p",{className:"text-copy-14",children:t})]})}function tp(){return(0,i.jsx)(ti.Stop,{"aria-hidden":!0,className:"fill-red-900 stroke-red-300",size:19})}function tm(){return(0,i.jsx)("div",{className:"flex flex-col items-center justify-center flex-initial min-h-[70px] text-sm text-gray-600",children:(0,i.jsx)("p",{className:"text-copy-14 text-gray-700",children:"No options â€¦"})})}function tx(e){let{canUpdateProtectionBypass:t,header:n,branchAliasId:s,selectedTarget:r,invitationFocused:c,onCancel:d,onFinished:u,onFocus:m,openUpgradeModal:x,previewCommentsEnabledForDeployment:h,revalidateAlias:f,teamId:j,viewAndCommentDescription:b,deployment:v}=e,C=(0,B.useToasts)(),{account:E}=(0,o.useAccount)(),k=(0,eu.useProjectIdOrName)(),w=E?.billing?.plan==="hobby",{hasGrantedCollaborator:A,mutate:I}=(0,eR.useHasGrantedCollaborator)(),[P,N]=(0,p.useState)(!1),M=(0,p.useRef)(null),[S,D]=(0,p.useState)(!1),[R,L]=(0,p.useState)(""),[O,V]=(0,p.useState)([]),[F,$]=(0,p.useState)(""),[z,q]=(0,p.useState)(null),X=w&&O.length>1,K=O.some(e=>!(0,eG.default)(e.value)),J=F.length>250,Z=(0,p.useMemo)(()=>J||K?"Please correct the form input errors to continue":O.length?X?"Upgrade your plan to invite multiple external collaborators":void 0:"Input must not be empty",[K,O.length,X,J]),Q=(0,p.useCallback)(()=>{G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:k}),x()},[x,k]),et=()=>{M.current&&M.current.focus()},ei=(0,p.useCallback)(async()=>{G.analytics.track(W.VercelActivityAction.DeploymentInviteSent,{count:O.length,teamMemberCount:O.filter(e=>void 0!==e.member).length},{send_to:{data_warehouse_legacy:!0}}),q(null),D(!0);try{await (0,ee.insertInviteToAliasProtectionBypass)({aliasId:r.id,teamId:j,inviteeEmails:O.map(e=>e.value),message:F});let e=1===O.length?"Invite was sent":"Invites were sent";C.message({text:e}),V([]),$(""),u(),await f(),await I()}catch(e){q((0,ez.normalizeError)(e))}D(!1)},[r.id,O,F,u,f,I,j,C]),[,{isLagging:en,members:el}]=(0,eW.useMembersInfinite)({revalidateIfStale:!1},{search:R},!0),ea=(0,p.useMemo)(()=>el.map(e=>({label:e.name,value:e.email,member:e})).filter(e=>!O.some(t=>t.value===e.value)),[O,el]),es=function(e){let[t,i]=(0,p.useState)(-1);return{lowBorder:-1,highBorder:e-1,navIndex:t,resetNavIndex:()=>i(-1),setNavIndex:i}}(ea.length),{navIndex:eo,resetNavIndex:er,setNavIndex:ec}=es,ed=(0,p.useCallback)((e,t)=>{"input-change"!==t.action||e.length>320||O.length>50||(L(e),q(null))},[O.length]),ep=(0,p.useCallback)(()=>{R||O.length||d()},[R,O.length,d]),ex=(0,p.useCallback)(()=>{R||O.length?(L(""),et(),er()):d()},[R,O.length,d,er]),eh=(0,p.useCallback)(e=>{O.some(t=>t.value===e.value)||(V([...O,e.member?e:ea.find(t=>t.value===e.value)||e]),L(""),et(),er())},[O,er,ea]),{onInputKeyDownHandler:ey}=function(e){let{inputText:t,navIndexState:i,onEscape:n,onPicked:l,suggestions:a}=e,{lowBorder:s,highBorder:o,navIndex:r,setNavIndex:c}=i;return{onInputKeyDownHandler:e=>{switch(e.key){case"Escape":e.stopPropagation(),n();break;case"Enter":case"Tab":if(!t)break;e.preventDefault(),-1===r?l({label:t,value:t}):l(a[r]);break;case"ArrowUp":e.preventDefault(),c(r>s?r-1:o);break;case"ArrowDown":e.preventDefault(),c(r<o?r+1:s)}}}}({inputText:R,navIndexState:es,onEscape:ex,onPicked:eh,suggestions:ea});(0,p.useEffect)(()=>{R||er()},[R,er]);let ef=T(r,s,v);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(th,{header:n,invitationFocused:c,children:[(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-3",children:[(0,i.jsxs)("span",{className:"text-copy-14",children:[t?"Choose":"People"," who can"," ",(0,i.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:b}),h?" on ":" ",(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsx)(ef,{color:"gray-900",className:"inline-block align-sub"})," ",(0,i.jsx)("span",{className:"font-medium text-copy-13-mono",children:(0,i.jsx)(U.Link,{href:r.url,title:"URL",children:r.url})})]})]}),(0,i.jsx)("form",{className:"mt-2",children:(0,i.jsx)(ts,{disabled:!t,disabledText:"You need additional permissions to invite collaborators",inputText:R,invitationFocused:c,invitees:O,onInputBlur:ep,onInputChangeHandler:ed,onInputFocused:m,onKeyDown:ey,placeholder:"Add team members or emailsâ€¦",ref:M,setInvitees:V})}),(0,i.jsx)(em.AnimatePresence,{children:X?(0,i.jsx)(eN.m.div,{animate:{height:"auto"},exit:{height:0},initial:{height:0},style:{padding:0},transition:{ease:"easeInOut"},children:(0,i.jsx)(_.Note,{action:(0,i.jsx)(l.Button,{"aria-label":"Upgrade your plan to invite multiple external collaborators.",onClick:()=>{N(!1),Q()},shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,i.jsx)(H.ArrowRight,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Upgrade your plan to invite multiple external collaborators."})},"hobby-limit-actions"):null})]}),c?(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial h-[132px]",children:[(0,i.jsx)(eK,{inputText:R,navIndex:eo,onPicked:eh,setNavIndex:ec,suggestions:ea}),R||O.length?null:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-start flex-initial gap-4 px-6 py-8 text-gray-600",children:[(0,i.jsx)("div",{className:"flex flex-col items-center justify-center flex-initial overflow-hidden font-bold text-gray-600 border border-gray-300 border-solid rounded-sm size-8",children:(0,i.jsx)(eY.UserPlus,{})}),(0,i.jsx)("p",{className:"text-copy-14 text-inherit",children:"Search team members or enter an email to invite collaborators."})]}),R&&en?(0,i.jsx)("div",{className:"flex flex-col items-center justify-start flex-initial",children:(0,i.jsx)(y.Spinner,{})}):null,!R&&O.length?(0,i.jsx)(eX.Textarea,{onChange:e=>{$(e.target.value)},placeholder:"Add an optional message",resize:"vertical",rows:3,value:F}):null,J?(0,i.jsx)(eq.Error,{error:`The message should be 250 characters or less (current length: ${F.length})`,size:"small"}):null,z?(0,i.jsx)(eq.Error,{error:z}):null]}):null,(0,i.jsx)(eL.HobbyLimitAction,{onUpgradeClick:Q,setShowHobbyLimitAction:N,showHobbyLimitAction:P,onConfirm:ei})]}),c?(0,i.jsxs)(g.Modal.Actions,{children:[(0,i.jsx)(g.Modal.Action,{onClick:()=>{P?N(!1):(q(null),V([]),$(""),d())},type:"secondary",children:"Cancel"}),(0,i.jsx)(g.Modal.Action,{disabled:X||P||S||K||J||!O.length,loading:S||P,onClick:()=>{w&&A?N(!0):ei()},children:(0,i.jsx)(a.Tooltip,{text:Z,children:"Invite"})})]}):null]})}function th(e){let{children:t,header:n,invitationFocused:l}=e;return l?(0,i.jsx)(g.Modal.Body,{className:"px-0 py-3.5",padding:!1,children:(0,i.jsx)(O.Scroller,{overflow:"y",scrollerClassName:"px-1 py-2.5",children:(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial min-h-[285px] px-5",children:[n,t]})})}):(0,i.jsx)(i.Fragment,{children:t})}var ty=e.i(545405);function tf(e){let{targets:t,branchAliasId:n,deployment:l,git:a,isLoading:s,isPreviewDeployment:o,modalClose:r,previewCommentsEnabledForBranch:c,previewCommentsEnabledForDeployment:d,productionProtectionEnabled:u,project:m,protectionEnabledForDeployment:x,protectionEnabledForProject:h,revalidateAlias:y,setIsLoading:f,team:j,user:b,branchAlias:v}=e,{teamSlug:C,project:E}=(0,Q.useParams)()??{},[k,w]=(0,p.useState)(()=>t.sort((e,t)=>{let i=e=>!(e.url.endsWith("vercel.app")||j?.previewDeploymentSuffix&&e.url.endsWith(j.previewDeploymentSuffix)),a=e=>{let t=e.pendingRequests>0,a=i(e),s=e.id===n,o=e.url===l.url;return t&&a?1:t?2:a?3:s||o?s?5:6:4};return a(e)-a(t)})[0]?.id||l.id),A=t.find(e=>e.id===k),P=(0,en.getShareableLinkBypass)(A??{});(0,p.useEffect)(()=>{G.analytics.track(W.VercelActivityAction.DeploymentShareOpened,{},{send_to:{data_warehouse_legacy:!0}})},[]);let[T,M]=(0,p.useState)(!1);(0,p.useEffect)(()=>{T&&G.analytics.track(W.VercelActivityAction.DeploymentInviteScreenOpened,{},{send_to:{data_warehouse_legacy:!0}})},[T]);let S=(0,p.useMemo)(()=>(e=>{let{previewCommentsEnabledForDeployment:t,protectionEnabledForDeployment:i}=e;return!t&&i?"view":t&&!i?"comment":"view and comment"})({previewCommentsEnabledForDeployment:d,protectionEnabledForDeployment:!!x}),[d,x]),D=(0,B.useToasts)(),R=(0,p.useCallback)(async e=>{if(!s&&A&&("create"===e||P)){switch(e){case"create":G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_GENERATE_EXTERNAL_LINK,{projectId:m.id});break;case"delete":G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_DISABLE_EXTERNAL_LINK,{projectId:m.id});break;case"regenerate":G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_REGENERATE_EXTERNAL_LINK,{projectId:m.id})}f(!0);try{let t=await (0,ee.updateAliasProtectionBypass)({teamId:j?.id,aliasId:A.id,body:"create"!==e?{revoke:{secret:P||"",regenerate:"regenerate"===e}}:{}});if("create"===e){let e=eb({alias:A.url,protectionBypass:(0,en.getShareableLinkBypass)(t),protectionEnabledForDeployment:!0});e&&(0,ty.copyToClipboard)(e),D.success("A shareable link was generated and copied to your clipboard.")}}catch{D.error("An error occurred, please try again later.")}await y(),f(!1)}},[A,s,m.id,P,y,D,j?.id,f]),{can:L}=(0,J.default)(),V=L(Z.Action.Update,"production"===l.target?Z.Resource.ProductionAliasProtectionBypass:Z.Resource.AliasProtectionBypass),F=(0,et.useOpenUpgradeModal)(),z=(0,ei.getAliasDeploymentProtectionException)(A?.protectionBypass),q=(0,i.jsx)(tg,{branchAliasId:n,canUpdateProtectionBypass:V,getLinkToProtectionSettingsInner:()=>N({team:j,user:b,projectName:m.name}),isPreviewDeployment:o,productionProtectionEnabled:u,protectionBypass:P,protectionEnabledForDeployment:x,selectedTargetId:k,setSelectedTargetId:w,targets:t,deployment:l}),X=C&&E&&v?.deploymentId?(0,el.getDashboardHref)(`/${E}/${v.deploymentId.replace("dpl_","")}`,C):void 0,K=k===l.id&&v?.deploymentId&&v.deploymentId!==l.id&&X?(0,i.jsxs)(_.Note,{action:(0,i.jsx)(U.ButtonLink,{"aria-label":"Go to latest branch deployment",href:X,shape:"square",size:"small",svgOnly:!0,children:(0,i.jsx)(H.ArrowRight,{})}),className:"!text-gray-1000",fill:!0,type:"secondary",children:["There is a newer deployment for"," ",a?.branchName?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(I.GitBranch,{className:"mr-0.5 align-middle",size:14}),(0,i.jsx)("span",{className:"text-copy-14-mono",children:a.branchName})]}):"this branch",". To share it go to the latest."]}):null;return T&&(d||x)&&A?(0,i.jsx)(tx,{branchAliasId:n,canUpdateProtectionBypass:V,deployment:l,header:q,invitationFocused:T,onCancel:()=>M(!1),onFinished:()=>M(!1),onFocus:()=>void 0,openUpgradeModal:()=>{r(),F({source:"deployment-protection-access-hobby-limit",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d,revalidateAlias:y,selectedTarget:A,teamId:j?.id,viewAndCommentDescription:S}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.Modal.Body,{className:"px-5 py-6",padding:!1,children:(0,i.jsx)(O.Scroller,{overflow:"y",scrollerClassName:"px-1 max-h-[80vh]",children:(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-6",children:[q,K,z?(0,i.jsxs)(_.Note,{fill:!0,type:"warning",variant:"contrast",children:["This domain is listed in"," ",(0,i.jsx)(U.Link,{href:`${N({team:j,user:b,projectName:m.name})}#deployment-protection-exceptions`,variant:"underline",children:"Deployment Protection Exceptions"}),", making it is currently"," ",(0,i.jsx)("span",{className:"text-heading-14 text-inherit",children:"unprotected"})," ","and"," ",(0,i.jsx)("span",{className:"text-heading-14 text-inherit",children:"publicly available"}),"."]}):null,d||x?A&&(0,i.jsx)(tx,{branchAliasId:n,canUpdateProtectionBypass:V,deployment:l,header:q,invitationFocused:T,onCancel:()=>void 0,onFinished:()=>void 0,onFocus:()=>M(!0),openUpgradeModal:()=>{r(),F({source:"deployment-protection-access-hobby-limit",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d,revalidateAlias:y,selectedTarget:A,teamId:j?.id,viewAndCommentDescription:S}):null,(0,i.jsx)(e_,{branchAliasId:n,branchName:a?.branchName,canUpdateProtectionBypass:V,hideStaticTeamMembersBanner:!x&&!d,onUpgradeClick:()=>{r(),G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:m.id}),F({source:"deployment-protection-access-hobby-limit",trialBehavior:"choose"})},project:m,revalidateAlias:y,target:A}),!d&&o?(0,i.jsx)(i.Fragment,{children:c?(0,i.jsx)(_.Note,{className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,size:"small",type:"secondary",children:"Comments will be available for new builds."}):(0,i.jsx)(_.Note,{action:(0,i.jsx)(U.ButtonLink,{"aria-label":"Enable Comments",href:(e=>{let{team:t}=e;return t?`/${t.slug}/~/settings/general#toolbar`:"/account/general#toolbar"})({team:j}),onClick:()=>{G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_CLICK_ON_ENABLE_PREVIEW_COMMENTS,{projectId:m.id})},shape:"square",size:"tiny",svgOnly:!0,tab:!0,type:"tertiary",children:(0,i.jsx)($.SettingsGear,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Enable comments for this deployment."})}):null,h?null:(0,i.jsx)(_.Note,{action:(0,i.jsx)(U.ButtonLink,{"aria-label":"Enable Deployment Protection",href:N({team:j,user:b,projectName:m.name}),onClick:()=>{G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_SHARE_CLICK_ON_ENABLE_VERCEL_AUTHENTICATION,{projectId:m.id})},shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,i.jsx)(H.ArrowRight,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Enable Deployment Protection for this project."})]})})}),(0,i.jsx)(g.Modal.Actions,{children:(0,i.jsx)(eC,{alias:A?.url,canUpdateShareableLink:V,deployment:l,git:a,isLoading:s,onCreateShareableLink:()=>void R("create"),onDeleteShareableLink:()=>void R("delete"),onRegenerateShareableLink:()=>void R("regenerate"),openUpgradeModal:()=>{r(),F({source:"Hobby account shareable link limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d??!1,protectionBypass:P,protectionEnabledForDeployment:x,viewAndCommentDescription:S})})]})}function tg(e){let{canUpdateProtectionBypass:t,getLinkToProtectionSettingsInner:n,isPreviewDeployment:l,productionProtectionEnabled:a,protectionBypass:s,protectionEnabledForDeployment:o,targets:r,selectedTargetId:c,setSelectedTargetId:d,branchAliasId:u,deployment:p}=e,m=r.some(e=>e.pendingRequests>0&&e.id!==c);return(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between flex-initial",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,i.jsx)("p",{className:"text-heading-24",children:"Share"}),r.length>1?(0,i.jsxs)(R.MenuContainer,{children:[(0,i.jsxs)(D.MenuButton,{"aria-label":"Select URL",shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:[(0,i.jsx)(F.ChevronDown,{}),m?(0,i.jsx)("div",{className:"absolute -right-0.5 -top-0.5 size-2 rounded-full bg-green-500"}):null]}),(0,i.jsx)(S.Menu,{width:"auto",children:r.map(e=>{let t=T(e,u,p);return(0,i.jsx)(L.MenuItem,{onClick:()=>{d(e.id)},prefix:(0,i.jsx)(t,{}),suffix:e.id===c?(0,i.jsx)(V.Check,{}):null,children:(0,i.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[e.url,e.pendingRequests>0?(0,i.jsx)(M.Badge,{className:"min-w-5",size:"sm",variant:"blue",children:e.pendingRequests}):null]})},e.id)})})]}):null]}),t&&(l||o)?(0,i.jsx)(tj,{getLinkToProtectionSettingsInner:n,isProtectionBypassShareableLink:!!s,productionProtectionEnabled:a,protectionEnabledForDeployment:o}):null]})}function tj(e){let{getLinkToProtectionSettingsInner:t,productionProtectionEnabled:n,isProtectionBypassShareableLink:l,protectionEnabledForDeployment:s}=e,o=(0,K.useIsMobile)(),r=l?"Deployment Protection can be bypassed with the Shareable Link":`${n?"All":"Preview"} deployments ${!o?"in this project ":""}are protected`,c=l?(0,i.jsx)(q.ShieldGlobe,{}):(0,i.jsx)(z.Shield,{}),d=s?c:(0,i.jsx)(X.ShieldOff,{});return(0,i.jsx)(a.Tooltip,{desktopOnly:!0,text:s?r:"Deployment Protection is not enabled and deployments are publicly accessible",children:(0,i.jsx)(U.ButtonLink,{align:"center","aria-label":"Settings",href:t(),label:"Settings",shape:"circle",size:"small",svgOnly:!0,type:"tertiary",children:d})})}function tb(e){let{deployment:n,project:a,mutateDeployment:s,...r}=e,{user:c,team:d,account:u}=(0,o.useAccount)(),A=u?.billing?.plan==="hobby",I=!!n.buildSkipped,{targets:P,branchAliasId:N,branchAlias:T,isLoading:M,mutate:S}=function(e){let{data:t}=(0,k.useCurrentDashboardDeploymentDomains)({revalidateIfStale:!1,revalidateOnFocus:!1}),i=(0,j.useTeamSlug)(),{data:n,mutate:l,isLoading:a}=(0,C.useAliasesV2)({deploymentId:e?.id,teamId:i??void 0}),s=t.branch??e?.meta.branchAlias??(e?.alias?e.alias[e.alias.length-1]:void 0),o=(0,p.useMemo)(()=>{let i,l=e?[{id:e.id,url:e.url,protectionBypass:e.protectionBypass,pendingRequests:tv(e)}]:[];if(!n)return{targets:l};for(let t of n.aliases){if(t.redirect)continue;t.alias===s&&(i=t.uid);let n={id:t.uid,url:t.alias,protectionBypass:t.protectionBypass,pendingRequests:tv(t)};if(e&&n.url===e.url){let t=l.findIndex(t=>t.id===e.id);-1!==t&&(l[t]=n)}else l.push(n)}let a=[t.commit,t.branch??"",...t.aliases].filter(Boolean);return l.sort((e,t)=>a.indexOf(e.url)-a.indexOf(t.url)),{targets:l,branchAliasId:i}},[s,n,e,t]),r=s&&!o.branchAliasId,{data:c,mutate:d,isLoading:u}=(0,E.default)({domain:r?s:void 0});return{isLoading:a||u,mutate:async()=>{await l(),await d()},targets:o.targets,branchAliasId:o.branchAliasId||c?.uid,branchAlias:c}}(n),D=(0,b.getGitMeta)(n.meta),R=(0,p.useMemo)(()=>P.some(e=>e.pendingRequests>0),[P]),L="production"!==n.target,{value:_}=(0,w.useArePreviewCommentsEnabled)({target:L?"preview":"production",branch:D?.branchName}),[O,B]=(0,p.useState)(!1),{protectionEnabledForDeployment:U,protectionEnabledForProject:H,isLoading:V,productionProtectionEnabled:F}=(e=>{let{deployment:t,project:i,isProjectLoading:n=!1}=e;if(!t||!i)return n?{isLoading:!0,protectionEnabledForDeployment:null,protectionEnabledForProject:null,productionProtectionEnabled:null}:{isLoading:!1,protectionEnabledForDeployment:!1,protectionEnabledForProject:!1,productionProtectionEnabled:!1};let{passwordProtection:l,ssoProtection:a,trustedIps:s}=i,o="production"!==t.target,r=["preview","prod_deployment_urls_and_all_previews","all_except_custom_domains"],c=l?.deploymentType==="all"||o&&l?.deploymentType&&r.includes(l.deploymentType),d=a?.deploymentType==="all"||o&&a?.deploymentType&&r.includes(a.deploymentType),u=s?.deploymentType==="all"||!o&&s?.deploymentType==="production"||o&&s?.deploymentType&&r.includes(s.deploymentType);return{productionProtectionEnabled:l?.deploymentType==="all"||a?.deploymentType==="all"||s?.deploymentType==="all",protectionEnabledForProject:!!(l||a||s),protectionEnabledForDeployment:!!(c||d||u),isLoading:!1}})({deployment:n,project:a}),$=(0,w.useCommentsEnabledForDeployment)(n),z=(0,p.useMemo)(()=>O?(0,i.jsx)(y.Spinner,{}):U?A?(0,i.jsx)(m.User,{}):(0,i.jsx)(x.Users,{}):(0,i.jsx)(h.Share,{}),[U,A,O]),[q,X,Y]=(()=>{let[e,t]=(0,p.useState)(!1);return[e,(0,p.useCallback)(()=>t(!0),[]),(0,p.useCallback)(()=>t(!1),[])]})();return((0,v.default)("openSharing",()=>{X()}),M||V)?"true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH?(0,i.jsx)(f.Skeleton,{className:(0,tl.cn)(r.className,"!w-full @md-page:!w-[84px]"),height:"small"===r.size?32:40}):L||$?(0,i.jsx)(f.Skeleton,{className:r.className,height:"small"===r.size?32:40,width:"true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH?84:80}):null:$||U?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.Button,{disabled:I||0===P.length,onClick:X,prefix:z,style:{color:I||0===P.length?void 0:"gray-900"},type:"secondary",typeName:"button",...r,children:["Share",R?(0,i.jsx)("div",{className:"absolute -right-0.5 -top-0.5 size-2 rounded-full bg-geist-success"}):null]}),(0,i.jsx)(g.Modal.Modal,{active:q,disableFocusTrap:!0,onClickOutside:Y,children:(0,i.jsx)(tf,{branchAlias:T,branchAliasId:N,deployment:n,git:D,isLoading:O,isPreviewDeployment:L,modalClose:Y,previewCommentsEnabledForBranch:_??$,previewCommentsEnabledForDeployment:$,productionProtectionEnabled:F,project:a,protectionEnabledForDeployment:U,protectionEnabledForProject:H,revalidateAlias:async()=>{await S(),await s()},setIsLoading:B,targets:P,team:d,user:c})})]}):null}function tv(e){return Object.values(e?.protectionBypass??{}).filter(e=>"user"===e.scope&&"requested"===e.access).length}e.s(["ShareDeployment",0,tb],5580399);var tC=e.i(8382149),tE=e.i(6613731),tk=e.i(4478191),tw=e.i(9267266),tA=e.i(9148684),tI=e.i(109803);function tP(e){let{className:t,...l}=e;return(0,i.jsx)(U.ButtonLink,{className:(0,n.clsx)(t,"min-w-[80px] flex-1"),...l})}function tN(e){let{className:t,...a}=e;return(0,i.jsx)(l.Button,{className:(0,n.clsx)(t,"min-w-[96px] flex-1"),...a})}function tT(e){let{deployment:n,project:l,size:a}=e,{user:s,team:r}=(0,o.useAccount)(),{areChecksRunning:c,areDomainsAssigning:p}=(0,u.getDeploymentStatus)(n),m=(0,tw.useShouldVisitWithTheToolbar)(n),{permissions:x}=(0,tA.useDeploymentPermissions)({project:l,deployment:n}),h=n.readyState,y=(0,d.useIsViewingPublicDeployment)(),{onClick:f,...g}=(0,tE.useWrappedToolbarAuthLinkHandler)({via:"deployment-visit-button",deployment:y?void 0:n});return c?(0,i.jsx)(tN,{disabled:!0,size:a,children:"Waiting for Checks"}):p?(0,i.jsx)(tN,{disabled:!0,size:a,children:"Waiting for Domains"}):(s||r)&&x.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(n.readyState)?null:"READY"===h?m&&"production"===n.target?(0,i.jsx)(tw.VisitWithToolbarButton,{Component:"true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH?U.ButtonLink:tP,buttonProps:{href:(0,tk.withDefaultRoute)((0,ej.domainToUrl)(n.url),n.defaultRoute),onClick:()=>{G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_VISIT_BUTTON,{projectId:n.projectId||l?.id,deploymentId:n.id,deploymentTarget:n.target})},passthroughOnClick:f,...g,target:"_blank",size:a},className:"true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH?"-m-px [&>a]:!px-1 [&>button]:!px-0.5 [&>*]:!h-[34px] flex-1 @md-page:flex-none [&>a]:flex-1 @md-page:[&>a]:flex-initial":void 0,page:n.defaultRoute?.startsWith("/")?n.defaultRoute:`/${n.defaultRoute??""}`,url:(0,tk.withDefaultRoute)((0,ej.domainToUrl)(n.url),n.defaultRoute),via:"deployment-visit-button",children:"Visit"}):(0,i.jsx)(tP,{href:(0,tk.withDefaultRoute)((0,ej.domainToUrl)(n.url),n.defaultRoute),onClick:()=>{G.analytics.track(Y.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_VISIT_BUTTON,{projectId:n.projectId||l?.id,deploymentId:n.id,deploymentTarget:n.target})},passthroughOnClick:f,...g,target:"_blank",size:a,prefix:(0,i.jsx)(tI.External,{}),children:"Visit"}):(0,i.jsx)(tP,{disabled:!0,href:`https://${n.host}`,...g,size:a,children:"Visit"})}e.s(["VisitDeploymentButton",0,tT],8152065);let tM="min-w-[96px] flex-1 px-[10px]";function tS(e){let{className:t,...a}=e;return(0,i.jsx)(l.Button,{className:(0,n.clsx)(tM,t),...a})}e.s(["DeploymentActionButton",0,function(e){let{deployment:n,project:l,mutateDeployment:p}=e,{user:m,team:x}=(0,o.useAccount)(),{areChecksRunning:h,areDomainsAssigning:y}=(0,u.getDeploymentStatus)(n),{permissions:f}=(0,tA.useDeploymentPermissions)({project:l,deployment:n}),{openRedeployModal:g,openCancelDeploymentModal:j,isLoadingModals:b}=(0,tC.useDeploymentModals)(),v=n.readyState,C=(0,d.useIsViewingPublicDeployment)();if("true"!==t.default.env.NEXT_PUBLIC_TESTMODE&&"true"!==t.default.env.NEXT_PUBLIC_TESTSERVER&&"1"===t.default.env.NEXT_PUBLIC_DASH){if(h)return(0,i.jsx)(s.ActionMenuItem,{"aria-disabled":!0,disabled:!0,children:"Waiting for Checks"});if(y)return(0,i.jsx)(s.ActionMenuItem,{"aria-disabled":!0,disabled:!0,children:"Waiting for Domains"});if("ERROR"===v){let e="production"===n.target?f.canRedeployProduction:f.canCreateDeployment,t=C||!e||b;return(0,i.jsx)(s.ActionMenuItem,{"aria-disabled":t||void 0,disabled:t,onClick:g,suffix:(0,i.jsx)(c.RotateCounterClockwise,{color:"gray-900"}),children:"Redeploy"})}return(m||x)&&f.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(n.readyState)?(0,i.jsx)(s.ActionMenuItem,{onClick:j,suffix:(0,i.jsx)(r.StopCircle,{color:"gray-900"}),children:"Cancel"}):null}if(h)return(0,i.jsx)(tS,{disabled:!0,children:"Waiting for Checks"});if(y)return(0,i.jsx)(tS,{disabled:!0,children:"Waiting for Domains"});if("ERROR"===v){let e="production"===n.target?f.canRedeployProduction:f.canCreateDeployment;return C||!e?(0,i.jsx)(a.Tooltip,{className:"min-w-x[96px] flex-1",position:"top",text:"You are not the owner of this deployment. In turn, you cannot re-deploy it.",children:(0,i.jsx)(tS,{disabled:!0,prefix:(0,i.jsx)(c.RotateCounterClockwise,{}),type:"secondary",children:"Redeploy"})}):(0,i.jsx)(tS,{disabled:b,onClick:g,prefix:(0,i.jsx)(c.RotateCounterClockwise,{}),type:"secondary",children:"Redeploy"})}return(m||x)&&f.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(n.readyState)?(0,i.jsx)(tS,{onClick:j,prefix:(0,i.jsx)(r.StopCircle,{}),style:{paddingInline:6},type:"secondary",children:"Cancel"}):(0,i.jsxs)(i.Fragment,{children:[l?(0,i.jsx)(tb,{className:tM,deployment:n,mutateDeployment:p,project:l}):null,(0,i.jsx)(tT,{deployment:n,project:l})]})}],310143)}]);

//# debugId=2040cd30-c6c4-cf95-2444-b7b9014bf0e2
//# sourceMappingURL=e0a46ff415ffec9f.js.map