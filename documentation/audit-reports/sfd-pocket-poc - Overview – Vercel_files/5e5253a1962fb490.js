;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="44bfc93d-0619-b224-f9eb-5f2bfd67c186")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7954409,(e,t,a)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,n={},l={SYMBOL_FOR_REQ_CONTEXT:()=>c,getContext:()=>d};for(var p in l)r(n,p,{get:l[p],enumerable:!0});t.exports=((e,t,a,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))i.call(e,l)||l===a||r(e,l,{get:()=>t[l],enumerable:!(n=o(t,l))||n.enumerable});return e})(r({},"__esModule",{value:!0}),n);let c=Symbol.for("@vercel/request-context");function d(){let e=globalThis;return e[c]?.get?.()??{}}},6439780,(e,t,a)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,n={},l={getContext:()=>c.getContext,getVercelOidcToken:()=>d,getVercelOidcTokenSync:()=>u};for(var p in l)r(n,p,{get:l[p],enumerable:!0});t.exports=((e,t,a,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))i.call(e,l)||l===a||r(e,l,{get:()=>t[l],enumerable:!(n=o(t,l))||n.enumerable});return e})(r({},"__esModule",{value:!0}),n);var c=e.r(7954409);async function d(){return""}function u(){return""}},3820729,45404,e=>{"use strict";var t,a,r,o,s,i,n,l,p,c,d,u,h,g,m,v,y,f,b,I,E,w,S,_,T,A,x,R,M,k,j,C,O,N,D,P,F,z,U,H,J,Y=e.i(8660982);e.i(2144405);var V=e.i(329294),B=e.i(3685753),L=e.i(9866797);e.i(9439603),e.i(408667);var q=e.i(5207889),q=q;e.i(3512434);var G=e.i(9835407),K=e.i(6439780),W=Symbol.for("vercel.ai.gateway.error"),$=class e extends(a=Error,t=W,a){constructor({message:e,statusCode:a=500,cause:r}){super(e),this[t]=!0,this.statusCode=a,this.cause=r}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&W in e&&!0===e[W]}},Q="GatewayAuthenticationError",X=Symbol.for(`vercel.ai.gateway.error.${Q}`),Z=class e extends(o=$,r=X,o){constructor({message:e="Authentication failed",statusCode:t=401,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[r]=!0,this.name=Q,this.type="authentication_error"}static isInstance(e){return $.hasMarker(e)&&X in e}static createContextualError(t){let{apiKeyProvided:a,oidcTokenProvided:r,message:o="Authentication failed",statusCode:s=401,cause:i}=t;return new e({message:a?`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:r?`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,statusCode:s,cause:i})}},ee="GatewayInvalidRequestError",et=Symbol.for(`vercel.ai.gateway.error.${ee}`),ea=class extends(i=$,s=et,i){constructor({message:e="Invalid request",statusCode:t=400,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[s]=!0,this.name=ee,this.type="invalid_request_error"}static isInstance(e){return $.hasMarker(e)&&et in e}},er="GatewayRateLimitError",eo=Symbol.for(`vercel.ai.gateway.error.${er}`),es=class extends(l=$,n=eo,l){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[n]=!0,this.name=er,this.type="rate_limit_exceeded"}static isInstance(e){return $.hasMarker(e)&&eo in e}},ei="GatewayModelNotFoundError",en=Symbol.for(`vercel.ai.gateway.error.${ei}`),el=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({modelId:q.string()}))),ep=class extends(c=$,p=en,c){constructor({message:e="Model not found",statusCode:t=404,modelId:a,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[p]=!0,this.name=ei,this.type="model_not_found",this.modelId=a}static isInstance(e){return $.hasMarker(e)&&en in e}},ec="GatewayInternalServerError",ed=Symbol.for(`vercel.ai.gateway.error.${ec}`),eu=class extends(u=$,d=ed,u){constructor({message:e="Internal server error",statusCode:t=500,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[d]=!0,this.name=ec,this.type="internal_server_error"}static isInstance(e){return $.hasMarker(e)&&ed in e}},eh="GatewayResponseError",eg=Symbol.for(`vercel.ai.gateway.error.${eh}`),em=class extends(g=$,h=eg,g){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:a,validationError:r,cause:o}={}){super({message:e,statusCode:t,cause:o}),this[h]=!0,this.name=eh,this.type="response_error",this.response=a,this.validationError=r}static isInstance(e){return $.hasMarker(e)&&eg in e}};async function ev(e){let{response:t,statusCode:a,defaultMessage:r="Gateway request failed",cause:o,authMethod:s}=e,i=await (0,B.safeValidateTypes)({value:t,schema:ey});if(!i.success)return new em({message:`Invalid error response format: ${r}`,statusCode:a,response:t,validationError:i.error,cause:o});let n=i.value,l=n.error.type,p=n.error.message;switch(l){case"authentication_error":return Z.createContextualError({apiKeyProvided:"api-key"===s,oidcTokenProvided:"oidc"===s,statusCode:a,cause:o});case"invalid_request_error":return new ea({message:p,statusCode:a,cause:o});case"rate_limit_exceeded":return new es({message:p,statusCode:a,cause:o});case"model_not_found":{let e=await (0,B.safeValidateTypes)({value:n.error.param,schema:el});return new ep({message:p,statusCode:a,modelId:e.success?e.value.modelId:void 0,cause:o})}default:return new eu({message:p,statusCode:a,cause:o})}}var ey=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({error:q.object({message:q.string(),type:q.string().nullish(),param:q.unknown().nullish(),code:q.union([q.string(),q.number()]).nullish()})})));function ef(e,t){var a;return $.isInstance(e)?e:L.APICallError.isInstance(e)?ev({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(a=e.statusCode)?a:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):ev({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var eb="ai-gateway-auth-method";async function eI(e){let t=await (0,B.safeValidateTypes)({value:e[eb],schema:eE});return t.success?t.value:void 0}var eE=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.union([q.literal("api-key"),q.literal("oidc")]))),ew=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await (0,B.getFromApi)({url:`${this.config.baseURL}/config`,headers:await (0,B.resolve)(this.config.headers()),successfulResponseHandler:(0,B.createJsonResponseHandler)(eS),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw await ef(e)}}async getCredits(){try{let e=new URL(this.config.baseURL),{value:t}=await (0,B.getFromApi)({url:`${e.origin}/v1/credits`,headers:await (0,B.resolve)(this.config.headers()),successfulResponseHandler:(0,B.createJsonResponseHandler)(e_),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return t}catch(e){throw await ef(e)}}},eS=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({models:q.array(q.object({id:q.string(),name:q.string(),description:q.string().nullish(),pricing:q.object({input:q.string(),output:q.string(),input_cache_read:q.string().nullish(),input_cache_write:q.string().nullish()}).transform(e=>{let{input:t,output:a,input_cache_read:r,input_cache_write:o}=e;return{input:t,output:a,...r?{cachedInputTokens:r}:{},...o?{cacheCreationInputTokens:o}:{}}}).nullish(),specification:q.object({specificationVersion:q.literal("v3"),provider:q.string(),modelId:q.string()}),modelType:q.enum(["language","embedding","image"]).nullish()}))}))),e_=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({balance:q.string(),total_used:q.string()}).transform(e=>{let{balance:t,total_used:a}=e;return{balance:t,totalUsed:a}}))),eT=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){let{abortSignal:t,...a}=e;return{args:this.maybeEncodeFileParts(a),warnings:[]}}async doGenerate(e){let{args:t,warnings:a}=await this.getArgs(e),{abortSignal:r}=e,o=await (0,B.resolve)(this.config.headers());try{let{responseHeaders:s,value:i,rawValue:n}=await (0,B.postJsonToApi)({url:this.getUrl(),headers:(0,B.combineHeaders)(o,e.headers,this.getModelConfigHeaders(this.modelId,!1),await (0,B.resolve)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,B.createJsonResponseHandler)(q.any()),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),...r&&{abortSignal:r},fetch:this.config.fetch});return{...i,request:{body:t},response:{headers:s,body:n},warnings:a}}catch(e){throw await ef(e,await eI(o))}}async doStream(e){let{args:t,warnings:a}=await this.getArgs(e),{abortSignal:r}=e,o=await (0,B.resolve)(this.config.headers());try{let{value:s,responseHeaders:i}=await (0,B.postJsonToApi)({url:this.getUrl(),headers:(0,B.combineHeaders)(o,e.headers,this.getModelConfigHeaders(this.modelId,!0),await (0,B.resolve)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,B.createEventSourceResponseHandler)(q.any()),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),...r&&{abortSignal:r},fetch:this.config.fetch});return{stream:s.pipeThrough(new TransformStream({start(e){a.length>0&&e.enqueue({type:"stream-start",warnings:a})},transform(t,a){if(t.success){let r=t.value;("raw"!==r.type||e.includeRawChunks)&&("response-metadata"===r.type&&r.timestamp&&"string"==typeof r.timestamp&&(r.timestamp=new Date(r.timestamp)),a.enqueue(r))}else a.error(t.error)}})),request:{body:t},response:{headers:i}}}catch(e){throw await ef(e,await eI(o))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),a=V.Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${a}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"3","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},eA=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed(e){var t;let{values:a,headers:r,abortSignal:o,providerOptions:s}=e,i=await (0,B.resolve)(this.config.headers());try{let{responseHeaders:e,value:n,rawValue:l}=await (0,B.postJsonToApi)({url:this.getUrl(),headers:(0,B.combineHeaders)(i,null!=r?r:{},this.getModelConfigHeaders(),await (0,B.resolve)(this.config.o11yHeaders)),body:{values:a,...s?{providerOptions:s}:{}},successfulResponseHandler:(0,B.createJsonResponseHandler)(ex),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),...o&&{abortSignal:o},fetch:this.config.fetch});return{embeddings:n.embeddings,usage:null!=(t=n.usage)?t:void 0,providerMetadata:n.providerMetadata,response:{headers:e,body:l},warnings:[]}}catch(e){throw await ef(e,await eI(i))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"3","ai-model-id":this.modelId}}},ex=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({embeddings:q.array(q.array(q.number())),usage:q.object({tokens:q.number()}).nullish(),providerMetadata:q.record(q.string(),q.record(q.string(),q.unknown())).optional()}))),eR=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxImagesPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate(e){var t;let{prompt:a,n:r,size:o,aspectRatio:s,seed:i,files:n,mask:l,providerOptions:p,headers:c,abortSignal:d}=e,u=await (0,B.resolve)(this.config.headers());try{let{responseHeaders:e,value:h,rawValue:g}=await (0,B.postJsonToApi)({url:this.getUrl(),headers:(0,B.combineHeaders)(u,null!=c?c:{},this.getModelConfigHeaders(),await (0,B.resolve)(this.config.o11yHeaders)),body:{prompt:a,n:r,...o&&{size:o},...s&&{aspectRatio:s},...i&&{seed:i},...p&&{providerOptions:p},...n&&{files:n.map(e=>eM(e))},...l&&{mask:eM(l)}},successfulResponseHandler:(0,B.createJsonResponseHandler)(ej),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),...d&&{abortSignal:d},fetch:this.config.fetch});return{images:h.images,warnings:null!=(t=h.warnings)?t:[],providerMetadata:h.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:e}}}catch(e){throw ef(e,await eI(u))}}getUrl(){return`${this.config.baseURL}/image-model`}getModelConfigHeaders(){return{"ai-image-model-specification-version":"3","ai-model-id":this.modelId}}};function eM(e){return"file"===e.type&&e.data instanceof Uint8Array?{...e,data:(0,B.convertUint8ArrayToBase64)(e.data)}:e}var ek=q.object({images:q.array(q.unknown()).optional()}).catchall(q.unknown()),ej=q.object({images:q.array(q.string()),warnings:q.array(q.object({type:q.literal("other"),message:q.string()})).optional(),providerMetadata:q.record(q.string(),ek).optional()}),eC=(0,B.lazySchema)(()=>(0,B.zodSchema)(G.z.object({query:G.z.union([G.z.string(),G.z.array(G.z.string())]).describe("Search query (string) or multiple queries (array of up to 5 strings). Multi-query searches return combined results from all queries."),max_results:G.z.number().optional().describe("Maximum number of search results to return (1-20, default: 10)"),max_tokens_per_page:G.z.number().optional().describe("Maximum number of tokens to extract per search result page (256-2048, default: 2048)"),max_tokens:G.z.number().optional().describe("Maximum total tokens across all search results (default: 25000, max: 1000000)"),country:G.z.string().optional().describe("Two-letter ISO 3166-1 alpha-2 country code for regional search results (e.g., 'US', 'GB', 'FR')"),search_domain_filter:G.z.array(G.z.string()).optional().describe("List of domains to include or exclude from search results (max 20). To include: ['nature.com', 'science.org']. To exclude: ['-example.com', '-spam.net']"),search_language_filter:G.z.array(G.z.string()).optional().describe("List of ISO 639-1 language codes to filter results (max 10, lowercase). Examples: ['en', 'fr', 'de']"),search_after_date:G.z.string().optional().describe("Include only results published after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),search_before_date:G.z.string().optional().describe("Include only results published before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),last_updated_after_filter:G.z.string().optional().describe("Include only results last updated after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),last_updated_before_filter:G.z.string().optional().describe("Include only results last updated before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),search_recency_filter:G.z.enum(["day","week","month","year"]).optional().describe("Filter results by relative time period. Cannot be used with search_after_date or search_before_date.")}))),eO=(0,B.lazySchema)(()=>(0,B.zodSchema)(G.z.union([G.z.object({results:G.z.array(G.z.object({title:G.z.string(),url:G.z.string(),snippet:G.z.string(),date:G.z.string().optional(),lastUpdated:G.z.string().optional()})),id:G.z.string()}),G.z.object({error:G.z.enum(["api_error","rate_limit","timeout","invalid_input","unknown"]),statusCode:G.z.number().optional(),message:G.z.string()})]))),eN=(0,B.createProviderToolFactoryWithOutputSchema)({id:"gateway.perplexity_search",inputSchema:eC,outputSchema:eO}),eD={perplexitySearch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return eN(e)}};async function eP(){var e;return null==(e=(0,K.getContext)().headers)?void 0:e["x-vercel-id"]}async function eF(e){let t=(0,B.loadOptionalSetting)({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});return t?{token:t,authMethod:"api-key"}:{token:await (0,K.getVercelOidcToken)(),authMethod:"oidc"}}!function(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null,o=null,s=null!=(e=a.metadataCacheRefreshMillis)?e:3e5,i=0,n=null!=(t=(0,B.withoutTrailingSlash)(a.baseURL))?t:"https://ai-gateway.vercel.sh/v3/ai",l=async()=>{try{let e=await eF(a);return(0,B.withUserAgentSuffix)({Authorization:`Bearer ${e.token}`,"ai-gateway-protocol-version":"0.0.1",[eb]:e.authMethod,...a.headers},"ai-sdk/gateway/3.0.17")}catch(e){throw Z.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401,cause:e})}},p=()=>{let e=(0,B.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=(0,B.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),a=(0,B.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let r=await eP();return{...e&&{"ai-o11y-deployment-id":e},...t&&{"ai-o11y-environment":t},...a&&{"ai-o11y-region":a},...r&&{"ai-o11y-request-id":r}}}},c=e=>new eT(e,{provider:"gateway",baseURL:n,headers:l,fetch:a.fetch,o11yHeaders:p()}),d=async()=>{var e,t,p;let c=null!=(p=null==(t=null==(e=a._internal)?void 0:e.currentDate)?void 0:t.call(e).getTime())?p:Date.now();return(!r||c-i>s)&&(i=c,r=new ew({baseURL:n,headers:l,fetch:a.fetch}).getAvailableModels().then(e=>(o=e,e)).catch(async e=>{throw await ef(e,await eI(await l()))})),o?Promise.resolve(o):r},u=async()=>new ew({baseURL:n,headers:l,fetch:a.fetch}).getCredits().catch(async e=>{throw await ef(e,await eI(await l()))}),h=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return c(e)};h.specificationVersion="v3",h.getAvailableModels=d,h.getCredits=u,h.imageModel=e=>new eR(e,{provider:"gateway",baseURL:n,headers:l,fetch:a.fetch,o11yHeaders:p()}),h.languageModel=c;let g=e=>new eA(e,{provider:"gateway",baseURL:n,headers:l,fetch:a.fetch,o11yHeaders:p()});h.embeddingModel=g,h.textEmbeddingModel=g,h.tools=eD}();var ez=L,q=q;e.i(4048866),e.i(6370374),e.i(6423085);var eU=Object.defineProperty,eH=Symbol.for("vercel.ai.error.AI_InvalidArgumentError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolApprovalError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolInputError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallNotFoundForApprovalError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");ez.AISDKError;var eJ="AI_NoObjectGeneratedError",eY=`vercel.ai.error.${eJ}`,eV=Symbol.for(eY),eB=class extends ez.AISDKError{constructor({message:e="No object generated.",cause:t,text:a,response:r,usage:o,finishReason:s}){super({name:eJ,message:e,cause:t}),this[m]=!0,this.text=a,this.response=r,this.usage=o,this.finishReason=s}static isInstance(e){return ez.AISDKError.hasMarker(e,eY)}};m=eV;Symbol.for("vercel.ai.error.AI_NoOutputGeneratedError");ez.AISDKError,ez.AISDKError;Symbol.for("vercel.ai.error.AI_NoSuchToolError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallRepairError");ez.AISDKError,ez.AISDKError;var eL="AI_UIMessageStreamError",eq=`vercel.ai.error.${eL}`,eG=Symbol.for(eq),eK=class extends ez.AISDKError{constructor({chunkType:e,chunkId:t,message:a}){super({name:eL,message:a}),this[v]=!0,this.chunkType=e,this.chunkId=t}static isInstance(e){return ez.AISDKError.hasMarker(e,eq)}};v=eG;Symbol.for("vercel.ai.error.AI_InvalidDataContentError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_MessageConversionError");ez.AISDKError;Symbol.for("vercel.ai.error.AI_RetryError");ez.AISDKError;var eW="6.0.42",e$=q.union([q.string(),q.instanceof(Uint8Array),q.instanceof(ArrayBuffer),q.custom(e=>{var t,a;return null!=(a=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&a},{message:"Must be a Buffer"})]),eQ=q.lazy(()=>q.union([q.null(),q.string(),q.number(),q.boolean(),q.record(q.string(),eQ.optional()),q.array(eQ)])),eX=q.record(q.string(),q.record(q.string(),eQ.optional())),eZ=q.object({type:q.literal("text"),text:q.string(),providerOptions:eX.optional()}),e0=q.object({type:q.literal("image"),image:q.union([e$,q.instanceof(URL)]),mediaType:q.string().optional(),providerOptions:eX.optional()}),e1=q.object({type:q.literal("file"),data:q.union([e$,q.instanceof(URL)]),filename:q.string().optional(),mediaType:q.string(),providerOptions:eX.optional()}),e2=q.object({type:q.literal("reasoning"),text:q.string(),providerOptions:eX.optional()}),e4=q.object({type:q.literal("tool-call"),toolCallId:q.string(),toolName:q.string(),input:q.unknown(),providerOptions:eX.optional(),providerExecuted:q.boolean().optional()}),e5=q.discriminatedUnion("type",[q.object({type:q.literal("text"),value:q.string(),providerOptions:eX.optional()}),q.object({type:q.literal("json"),value:eQ,providerOptions:eX.optional()}),q.object({type:q.literal("execution-denied"),reason:q.string().optional(),providerOptions:eX.optional()}),q.object({type:q.literal("error-text"),value:q.string(),providerOptions:eX.optional()}),q.object({type:q.literal("error-json"),value:eQ,providerOptions:eX.optional()}),q.object({type:q.literal("content"),value:q.array(q.union([q.object({type:q.literal("text"),text:q.string(),providerOptions:eX.optional()}),q.object({type:q.literal("media"),data:q.string(),mediaType:q.string()}),q.object({type:q.literal("file-data"),data:q.string(),mediaType:q.string(),filename:q.string().optional(),providerOptions:eX.optional()}),q.object({type:q.literal("file-url"),url:q.string(),providerOptions:eX.optional()}),q.object({type:q.literal("file-id"),fileId:q.union([q.string(),q.record(q.string(),q.string())]),providerOptions:eX.optional()}),q.object({type:q.literal("image-data"),data:q.string(),mediaType:q.string(),providerOptions:eX.optional()}),q.object({type:q.literal("image-url"),url:q.string(),providerOptions:eX.optional()}),q.object({type:q.literal("image-file-id"),fileId:q.union([q.string(),q.record(q.string(),q.string())]),providerOptions:eX.optional()}),q.object({type:q.literal("custom"),providerOptions:eX.optional()})]))})]),e3=q.object({type:q.literal("tool-result"),toolCallId:q.string(),toolName:q.string(),output:e5,providerOptions:eX.optional()}),e6=q.object({type:q.literal("tool-approval-request"),approvalId:q.string(),toolCallId:q.string()}),e8=q.object({type:q.literal("tool-approval-response"),approvalId:q.string(),approved:q.boolean(),reason:q.string().optional()}),e7=q.object({role:q.literal("system"),content:q.string(),providerOptions:eX.optional()}),e9=q.object({role:q.literal("user"),content:q.union([q.string(),q.array(q.union([eZ,e0,e1]))]),providerOptions:eX.optional()}),te=q.object({role:q.literal("assistant"),content:q.union([q.string(),q.array(q.union([eZ,e1,e2,e4,e3,e6]))]),providerOptions:eX.optional()}),tt=q.object({role:q.literal("tool"),content:q.array(q.union([e3,e8])),providerOptions:eX.optional()});q.union([e7,e9,te,tt]);var ta={},tr={array:()=>tl,choice:()=>tp,json:()=>tc,object:()=>tn,text:()=>ti};for(var to in tr)eU(ta,to,{get:tr[to],enumerable:!0});async function ts(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await (0,B.safeParseJSON)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await (0,B.safeParseJSON)({text:function(e){let t=["ROOT"],a=-1,r=null;function o(e,o,s){switch(e){case'"':a=o,t.pop(),t.push(s),t.push("INSIDE_STRING");break;case"f":case"t":case"n":a=o,r=o,t.pop(),t.push(s),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":a=o,t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"{":a=o,t.pop(),t.push(s),t.push("INSIDE_OBJECT_START");break;case"[":a=o,t.pop(),t.push(s),t.push("INSIDE_ARRAY_START")}}function s(e,r){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":a=r,t.pop()}}function i(e,r){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":a=r,t.pop()}}for(let n=0;n<e.length;n++){let l=e[n];switch(t[t.length-1]){case"ROOT":o(l,n,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":a=n,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(l,n,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":s(l,n);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),a=n;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:a=n}break;case"INSIDE_ARRAY_START":"]"===l?(a=n,t.pop()):(a=n,o(l,n,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":a=n,t.pop();break;default:a=n}break;case"INSIDE_ARRAY_AFTER_COMMA":o(l,n,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),a=n;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":a=n;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,n);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,n);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(r,n+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?a=n:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?s(l,n):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n))}}}let n=e.slice(0,a+1);for(let a=t.length-1;a>=0;a--)switch(t[a]){case"INSIDE_STRING":n+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":n+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":n+="]";break;case"INSIDE_LITERAL":{let t=e.substring(r,e.length);"true".startsWith(t)?n+="true".slice(t.length):"false".startsWith(t)?n+="false".slice(t.length):"null".startsWith(t)&&(n+="null".slice(t.length))}}return n}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}var ti=()=>({name:"text",responseFormat:Promise.resolve({type:"text"}),async parseCompleteOutput(e){let{text:t}=e;return t},async parsePartialOutput(e){let{text:t}=e;return{partial:t}},createElementStreamTransform(){}}),tn=e=>{let{schema:t,name:a,description:r}=e,o=(0,B.asSchema)(t);return{name:"object",responseFormat:(0,B.resolve)(o.jsonSchema).then(e=>({type:"json",schema:e,...null!=a&&{name:a},...null!=r&&{description:r}})),async parseCompleteOutput(e,t){let{text:a}=e,r=await (0,B.safeParseJSON)({text:a});if(!r.success)throw new eB({message:"No object generated: could not parse the response.",cause:r.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=await (0,B.safeValidateTypes)({value:r.value,schema:o});if(!s.success)throw new eB({message:"No object generated: response did not match schema.",cause:s.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});return s.value},async parsePartialOutput(e){let{text:t}=e,a=await ts(t);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:a.value}}},createElementStreamTransform(){}}},tl=e=>{let{element:t,name:a,description:r}=e,o=(0,B.asSchema)(t);return{name:"array",responseFormat:(0,B.resolve)(o.jsonSchema).then(e=>{let{$schema:t,...o}=e;return{type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:o}},required:["elements"],additionalProperties:!1},...null!=a&&{name:a},...null!=r&&{description:r}}}),async parseCompleteOutput(e,t){let{text:a}=e,r=await (0,B.safeParseJSON)({text:a});if(!r.success)throw new eB({message:"No object generated: could not parse the response.",cause:r.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=r.value;if(null==s||"object"!=typeof s||!("elements"in s)||!Array.isArray(s.elements))throw new eB({message:"No object generated: response did not match schema.",cause:new ez.TypeValidationError({value:s,cause:"response must be an object with an elements array"}),text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});for(let e of s.elements){let r=await (0,B.safeValidateTypes)({value:e,schema:o});if(!r.success)throw new eB({message:"No object generated: response did not match schema.",cause:r.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason})}return s.elements},async parsePartialOutput(e){let{text:t}=e,a=await ts(t);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=a.value;if(null==e||"object"!=typeof e||!("elements"in e)||!Array.isArray(e.elements))return;let t="repaired-parse"===a.state&&e.elements.length>0?e.elements.slice(0,-1):e.elements,r=[];for(let e of t){let t=await (0,B.safeValidateTypes)({value:e,schema:o});t.success&&r.push(t.value)}return{partial:r}}}},createElementStreamTransform(){let e=0;return new TransformStream({transform(t,a){let{partialOutput:r}=t;if(null!=r)for(;e<r.length;e++)a.enqueue(r[e])}})}}},tp=e=>{let{options:t,name:a,description:r}=e;return{name:"choice",responseFormat:Promise.resolve({type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:t}},required:["result"],additionalProperties:!1},...null!=a&&{name:a},...null!=r&&{description:r}}),async parseCompleteOutput(e,a){let{text:r}=e,o=await (0,B.safeParseJSON)({text:r});if(!o.success)throw new eB({message:"No object generated: could not parse the response.",cause:o.error,text:r,response:a.response,usage:a.usage,finishReason:a.finishReason});let s=o.value;if(null==s||"object"!=typeof s||!("result"in s)||"string"!=typeof s.result||!t.includes(s.result))throw new eB({message:"No object generated: response did not match schema.",cause:new ez.TypeValidationError({value:s,cause:"response must be an object that contains a choice value."}),text:r,response:a.response,usage:a.usage,finishReason:a.finishReason});return s.result},async parsePartialOutput(e){let{text:a}=e,r=await ts(a);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=r.value;if(null==e||"object"!=typeof e||!("result"in e)||"string"!=typeof e.result)return;let a=t.filter(t=>t.startsWith(e.result));if("successful-parse"===r.state)return a.includes(e.result)?{partial:e.result}:void 0;return 1===a.length?{partial:a[0]}:void 0}}},createElementStreamTransform(){}}},tc=function(){let{name:e,description:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"json",responseFormat:Promise.resolve({type:"json",...null!=e&&{name:e},...null!=t&&{description:t}}),async parseCompleteOutput(e,t){let{text:a}=e,r=await (0,B.safeParseJSON)({text:a});if(!r.success)throw new eB({message:"No object generated: could not parse the response.",cause:r.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});return r.value},async parsePartialOutput(e){let{text:t}=e,a=await ts(t);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return void 0===a.value?void 0:{partial:a.value}}},createElementStreamTransform(){}}};(0,B.createIdGenerator)({prefix:"aitxt",size:24}),TransformStream;var td=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.union([q.strictObject({type:q.literal("text-start"),id:q.string(),providerMetadata:eX.optional()}),q.strictObject({type:q.literal("text-delta"),id:q.string(),delta:q.string(),providerMetadata:eX.optional()}),q.strictObject({type:q.literal("text-end"),id:q.string(),providerMetadata:eX.optional()}),q.strictObject({type:q.literal("error"),errorText:q.string()}),q.strictObject({type:q.literal("tool-input-start"),toolCallId:q.string(),toolName:q.string(),providerExecuted:q.boolean().optional(),providerMetadata:eX.optional(),dynamic:q.boolean().optional(),title:q.string().optional()}),q.strictObject({type:q.literal("tool-input-delta"),toolCallId:q.string(),inputTextDelta:q.string()}),q.strictObject({type:q.literal("tool-input-available"),toolCallId:q.string(),toolName:q.string(),input:q.unknown(),providerExecuted:q.boolean().optional(),providerMetadata:eX.optional(),dynamic:q.boolean().optional(),title:q.string().optional()}),q.strictObject({type:q.literal("tool-input-error"),toolCallId:q.string(),toolName:q.string(),input:q.unknown(),providerExecuted:q.boolean().optional(),providerMetadata:eX.optional(),dynamic:q.boolean().optional(),errorText:q.string(),title:q.string().optional()}),q.strictObject({type:q.literal("tool-approval-request"),approvalId:q.string(),toolCallId:q.string()}),q.strictObject({type:q.literal("tool-output-available"),toolCallId:q.string(),output:q.unknown(),providerExecuted:q.boolean().optional(),dynamic:q.boolean().optional(),preliminary:q.boolean().optional()}),q.strictObject({type:q.literal("tool-output-error"),toolCallId:q.string(),errorText:q.string(),providerExecuted:q.boolean().optional(),dynamic:q.boolean().optional()}),q.strictObject({type:q.literal("tool-output-denied"),toolCallId:q.string()}),q.strictObject({type:q.literal("reasoning-start"),id:q.string(),providerMetadata:eX.optional()}),q.strictObject({type:q.literal("reasoning-delta"),id:q.string(),delta:q.string(),providerMetadata:eX.optional()}),q.strictObject({type:q.literal("reasoning-end"),id:q.string(),providerMetadata:eX.optional()}),q.strictObject({type:q.literal("source-url"),sourceId:q.string(),url:q.string(),title:q.string().optional(),providerMetadata:eX.optional()}),q.strictObject({type:q.literal("source-document"),sourceId:q.string(),mediaType:q.string(),title:q.string(),filename:q.string().optional(),providerMetadata:eX.optional()}),q.strictObject({type:q.literal("file"),url:q.string(),mediaType:q.string(),providerMetadata:eX.optional()}),q.strictObject({type:q.custom(e=>"string"==typeof e&&e.startsWith("data-"),{message:'Type must start with "data-"'}),id:q.string().optional(),data:q.unknown(),transient:q.boolean().optional()}),q.strictObject({type:q.literal("start-step")}),q.strictObject({type:q.literal("finish-step")}),q.strictObject({type:q.literal("start"),messageId:q.string().optional(),messageMetadata:q.unknown().optional()}),q.strictObject({type:q.literal("finish"),finishReason:q.enum(["stop","length","content-filter","tool-calls","error","other"]).optional(),messageMetadata:q.unknown().optional()}),q.strictObject({type:q.literal("abort"),reason:q.string().optional()}),q.strictObject({type:q.literal("message-metadata"),messageMetadata:q.unknown()})])));function tu(e){return e.type.startsWith("tool-")}function th(e){return tu(e)||"dynamic-tool"===e.type}function tg(e){return e.type.split("-").slice(1).join("-")}async function tm(e){let{stream:t,onError:a}=e,r=t.getReader();try{for(;;){let{done:e}=await r.read();if(e)break}}catch(e){null==a||a(e)}finally{r.releaseLock()}}(0,B.createIdGenerator)({prefix:"aitxt",size:24}),(0,B.lazySchema)(()=>(0,B.zodSchema)(q.array(q.object({id:q.string(),role:q.enum(["system","user","assistant"]),metadata:q.unknown().optional(),parts:q.array(q.union([q.object({type:q.literal("text"),text:q.string(),state:q.enum(["streaming","done"]).optional(),providerMetadata:eX.optional()}),q.object({type:q.literal("reasoning"),text:q.string(),state:q.enum(["streaming","done"]).optional(),providerMetadata:eX.optional()}),q.object({type:q.literal("source-url"),sourceId:q.string(),url:q.string(),title:q.string().optional(),providerMetadata:eX.optional()}),q.object({type:q.literal("source-document"),sourceId:q.string(),mediaType:q.string(),title:q.string(),filename:q.string().optional(),providerMetadata:eX.optional()}),q.object({type:q.literal("file"),mediaType:q.string(),filename:q.string().optional(),url:q.string(),providerMetadata:eX.optional()}),q.object({type:q.literal("step-start")}),q.object({type:q.string().startsWith("data-"),id:q.string().optional(),data:q.unknown()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("input-streaming"),input:q.unknown().optional(),providerExecuted:q.boolean().optional(),callProviderMetadata:eX.optional(),output:q.never().optional(),errorText:q.never().optional(),approval:q.never().optional()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("input-available"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),approval:q.never().optional()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("approval-requested"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),approval:q.object({id:q.string(),approved:q.never().optional(),reason:q.never().optional()})}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("approval-responded"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),approval:q.object({id:q.string(),approved:q.boolean(),reason:q.string().optional()})}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("output-available"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.unknown(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),preliminary:q.boolean().optional(),approval:q.object({id:q.string(),approved:q.literal(!0),reason:q.string().optional()}).optional()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("output-error"),input:q.unknown(),rawInput:q.unknown().optional(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.string(),callProviderMetadata:eX.optional(),approval:q.object({id:q.string(),approved:q.literal(!0),reason:q.string().optional()}).optional()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("output-denied"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),approval:q.object({id:q.string(),approved:q.literal(!1),reason:q.string().optional()})}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("input-streaming"),providerExecuted:q.boolean().optional(),callProviderMetadata:eX.optional(),input:q.unknown().optional(),output:q.never().optional(),errorText:q.never().optional(),approval:q.never().optional()}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("input-available"),providerExecuted:q.boolean().optional(),input:q.unknown(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),approval:q.never().optional()}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("approval-requested"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),approval:q.object({id:q.string(),approved:q.never().optional(),reason:q.never().optional()})}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("approval-responded"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),approval:q.object({id:q.string(),approved:q.boolean(),reason:q.string().optional()})}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("output-available"),providerExecuted:q.boolean().optional(),input:q.unknown(),output:q.unknown(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),preliminary:q.boolean().optional(),approval:q.object({id:q.string(),approved:q.literal(!0),reason:q.string().optional()}).optional()}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("output-error"),providerExecuted:q.boolean().optional(),input:q.unknown(),rawInput:q.unknown().optional(),output:q.never().optional(),errorText:q.string(),callProviderMetadata:eX.optional(),approval:q.object({id:q.string(),approved:q.literal(!0),reason:q.string().optional()}).optional()}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("output-denied"),providerExecuted:q.boolean().optional(),input:q.unknown(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:eX.optional(),approval:q.object({id:q.string(),approved:q.literal(!1),reason:q.string().optional()})})])).nonempty("Message must contain at least one part")})).nonempty("Messages array must not be empty"))),(0,B.createIdGenerator)({prefix:"aiobj",size:24});var tv=class{constructor(){this.queue=[],this.isProcessing=!1}async processQueue(){if(!this.isProcessing){for(this.isProcessing=!0;this.queue.length>0;)await this.queue[0](),this.queue.shift();this.isProcessing=!1}}async run(e){return new Promise((t,a)=>{this.queue.push(async()=>{try{await e(),t()}catch(e){a(e)}}),this.processQueue()})}};(0,B.createIdGenerator)({prefix:"aiobj",size:24});Symbol.for("vercel.ai.error.AI_NoSuchProviderError");async function ty(e){if(null==e)return[];if(!globalThis.FileList||!(e instanceof globalThis.FileList))throw Error("FileList is not supported in the current environment");return Promise.all(Array.from(e).map(async e=>{let{name:t,type:a}=e;return{type:"file",mediaType:a,filename:t,url:await new Promise((t,a)=>{let r=new FileReader;r.onload=e=>{var a;t(null==(a=e.target)?void 0:a.result)},r.onerror=e=>a(e),r.readAsDataURL(e)})}}))}ez.NoSuchModelError,ez.AISDKError;var tf=class{constructor({api:e="/api/chat",credentials:t,headers:a,body:r,fetch:o,prepareSendMessagesRequest:s,prepareReconnectToStreamRequest:i}){this.api=e,this.credentials=t,this.headers=a,this.body=r,this.fetch=o,this.prepareSendMessagesRequest=s,this.prepareReconnectToStreamRequest=i}async sendMessages(e){var t,a,r,o,s;let{abortSignal:i,...n}=e,l=await (0,B.resolve)(this.body),p=await (0,B.resolve)(this.headers),c=await (0,B.resolve)(this.credentials),d={...(0,B.normalizeHeaders)(p),...(0,B.normalizeHeaders)(n.headers)},u=await (null==(t=this.prepareSendMessagesRequest)?void 0:t.call(this,{api:this.api,id:n.chatId,messages:n.messages,body:{...l,...n.body},headers:d,credentials:c,requestMetadata:n.metadata,trigger:n.trigger,messageId:n.messageId})),h=null!=(a=null==u?void 0:u.api)?a:this.api,g=(null==u?void 0:u.headers)!==void 0?(0,B.normalizeHeaders)(u.headers):d,m=(null==u?void 0:u.body)!==void 0?u.body:{...l,...n.body,id:n.chatId,messages:n.messages,trigger:n.trigger,messageId:n.messageId},v=null!=(r=null==u?void 0:u.credentials)?r:c,y=null!=(o=this.fetch)?o:globalThis.fetch,f=await y(h,{method:"POST",headers:(0,B.withUserAgentSuffix)({"Content-Type":"application/json",...g},`ai-sdk/${eW}`,(0,B.getRuntimeEnvironmentUserAgent)()),body:JSON.stringify(m),credentials:v,signal:i});if(!f.ok)throw Error(null!=(s=await f.text())?s:"Failed to fetch the chat response.");if(!f.body)throw Error("The response body is empty.");return this.processResponseStream(f.body)}async reconnectToStream(e){var t,a,r,o,s;let i=await (0,B.resolve)(this.body),n=await (0,B.resolve)(this.headers),l=await (0,B.resolve)(this.credentials),p={...(0,B.normalizeHeaders)(n),...(0,B.normalizeHeaders)(e.headers)},c=await (null==(t=this.prepareReconnectToStreamRequest)?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...i,...e.body},headers:p,credentials:l,requestMetadata:e.metadata})),d=null!=(a=null==c?void 0:c.api)?a:`${this.api}/${e.chatId}/stream`,u=(null==c?void 0:c.headers)!==void 0?(0,B.normalizeHeaders)(c.headers):p,h=null!=(r=null==c?void 0:c.credentials)?r:l,g=null!=(o=this.fetch)?o:globalThis.fetch,m=await g(d,{method:"GET",headers:(0,B.withUserAgentSuffix)(u,`ai-sdk/${eW}`,(0,B.getRuntimeEnvironmentUserAgent)()),credentials:h});if(204===m.status)return null;if(!m.ok)throw Error(null!=(s=await m.text())?s:"Failed to fetch the chat response.");if(!m.body)throw Error("The response body is empty.");return this.processResponseStream(m.body)}},tb=class extends tf{constructor(e={}){super(e)}processResponseStream(e){return(0,B.parseJsonEventStream)({stream:e,schema:td}).pipeThrough(new TransformStream({async transform(e,t){if(!e.success)throw e.error;t.enqueue(e.value)}}))}},tI=class{constructor({generateId:e=B.generateId,id:t=e(),transport:a=new tb,messageMetadataSchema:r,dataPartSchemas:o,state:s,onError:i,onToolCall:n,onFinish:l,onData:p,sendAutomaticallyWhen:c}){var d=this;this.activeResponse=void 0,this.jobExecutor=new tv,this.sendMessage=async(e,t)=>{var a,r,o,s;let i;if(null==e)return void await this.makeRequest({trigger:"submit-message",messageId:null==(a=this.lastMessage)?void 0:a.id,...t});if(i="text"in e||"files"in e?{parts:[...Array.isArray(e.files)?e.files:await ty(e.files),..."text"in e&&null!=e.text?[{type:"text",text:e.text}]:[]]}:e,null!=e.messageId){let t=this.state.messages.findIndex(t=>t.id===e.messageId);if(-1===t)throw Error(`message with id ${e.messageId} not found`);if("user"!==this.state.messages[t].role)throw Error(`message with id ${e.messageId} is not a user message`);this.state.messages=this.state.messages.slice(0,t+1),this.state.replaceMessage(t,{...i,id:e.messageId,role:null!=(r=i.role)?r:"user",metadata:e.metadata})}else this.state.pushMessage({...i,id:null!=(o=i.id)?o:this.generateId(),role:null!=(s=i.role)?s:"user",metadata:e.metadata});await this.makeRequest({trigger:"submit-message",messageId:e.messageId,...t})},this.regenerate=async function(){let{messageId:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=null==e?d.state.messages.length-1:d.state.messages.findIndex(t=>t.id===e);if(-1===a)throw Error(`message ${e} not found`);d.state.messages=d.state.messages.slice(0,"assistant"===d.messages[a].role?a:a+1),await d.makeRequest({trigger:"regenerate-message",messageId:e,...t})},this.resumeStream=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await d.makeRequest({trigger:"resume-stream",...e})},this.clearError=()=>{"error"===this.status&&(this.state.error=void 0,this.setStatus({status:"ready"}))},this.addToolApprovalResponse=async e=>{let{id:t,approved:a,reason:r}=e;return this.jobExecutor.run(async()=>{var e,o;let s=this.state.messages,i=s[s.length-1],n=e=>th(e)&&"approval-requested"===e.state&&e.approval.id===t?{...e,state:"approval-responded",approval:{id:t,approved:a,reason:r}}:e;this.state.replaceMessage(s.length-1,{...i,parts:i.parts.map(n)}),this.activeResponse&&(this.activeResponse.state.message.parts=this.activeResponse.state.message.parts.map(n)),"streaming"!==this.status&&"submitted"!==this.status&&(null==(e=this.sendAutomaticallyWhen)?void 0:e.call(this,{messages:this.state.messages}))&&this.makeRequest({trigger:"submit-message",messageId:null==(o=this.lastMessage)?void 0:o.id})})},this.addToolOutput=async e=>{let{state:t="output-available",tool:a,toolCallId:r,output:o,errorText:s}=e;return this.jobExecutor.run(async()=>{var e,a;let i=this.state.messages,n=i[i.length-1],l=e=>th(e)&&e.toolCallId===r?{...e,state:t,output:o,errorText:s}:e;this.state.replaceMessage(i.length-1,{...n,parts:n.parts.map(l)}),this.activeResponse&&(this.activeResponse.state.message.parts=this.activeResponse.state.message.parts.map(l)),"streaming"!==this.status&&"submitted"!==this.status&&(null==(e=this.sendAutomaticallyWhen)?void 0:e.call(this,{messages:this.state.messages}))&&this.makeRequest({trigger:"submit-message",messageId:null==(a=this.lastMessage)?void 0:a.id})})},this.addToolResult=this.addToolOutput,this.stop=async()=>{var e;("streaming"===this.status||"submitted"===this.status)&&(null==(e=this.activeResponse)?void 0:e.abortController)&&this.activeResponse.abortController.abort()},this.id=t,this.transport=a,this.generateId=e,this.messageMetadataSchema=r,this.dataPartSchemas=o,this.state=s,this.onError=i,this.onToolCall=n,this.onFinish=l,this.onData=p,this.sendAutomaticallyWhen=c}get status(){return this.state.status}setStatus(e){let{status:t,error:a}=e;this.status!==t&&(this.state.status=t,this.state.error=a)}get error(){return this.state.error}get messages(){return this.state.messages}get lastMessage(){return this.state.messages[this.state.messages.length-1]}set messages(e){this.state.messages=e}async makeRequest(e){var t,a,r,o;let{trigger:s,metadata:i,headers:n,body:l,messageId:p}=e;this.setStatus({status:"submitted",error:void 0});let c=this.lastMessage,d=!1,u=!1,h=!1;try{let e,t={state:function(e){let{lastMessage:t,messageId:a}=e;return{message:(null==t?void 0:t.role)==="assistant"?t:{id:a,metadata:void 0,role:"assistant",parts:[]},activeTextParts:{},activeReasoningParts:{},partialToolCalls:{}}}({lastMessage:this.state.snapshot(c),messageId:this.generateId()}),abortController:new AbortController};if(t.abortController.signal.addEventListener("abort",()=>{d=!0}),this.activeResponse=t,"resume-stream"===s){let t=await this.transport.reconnectToStream({chatId:this.id,metadata:i,headers:n,body:l});if(null==t)return void this.setStatus({status:"ready"});e=t}else e=await this.transport.sendMessages({chatId:this.id,messages:this.state.messages,abortSignal:t.abortController.signal,metadata:i,headers:n,body:l,trigger:s,messageId:p});let a=e=>this.jobExecutor.run(()=>e({state:t.state,write:()=>{var e;this.setStatus({status:"streaming"}),t.state.message.id===(null==(e=this.lastMessage)?void 0:e.id)?this.state.replaceMessage(this.state.messages.length-1,t.state.message):this.state.pushMessage(t.state.message)}}));await tm({stream:function(e){let{stream:t,messageMetadataSchema:a,dataPartSchemas:r,runUpdateMessageJob:o,onError:s,onToolCall:i,onData:n}=e;return t.pipeThrough(new TransformStream({async transform(e,t){await o(async o=>{var l,p,c,d;let{state:u,write:h}=o;function g(e){let t=u.message.parts.filter(th).find(t=>t.toolCallId===e);if(null==t)throw new eK({chunkType:"tool-invocation",chunkId:e,message:`No tool invocation found for tool call ID "${e}".`});return t}function m(e){var t;let a=u.message.parts.find(t=>tu(t)&&t.toolCallId===e.toolCallId);null!=a?(a.state=e.state,a.input=e.input,a.output=e.output,a.errorText=e.errorText,a.rawInput=e.rawInput,a.preliminary=e.preliminary,void 0!==e.title&&(a.title=e.title),a.providerExecuted=null!=(t=e.providerExecuted)?t:a.providerExecuted,null!=e.providerMetadata&&(a.callProviderMetadata=e.providerMetadata)):u.message.parts.push({type:`tool-${e.toolName}`,toolCallId:e.toolCallId,state:e.state,title:e.title,input:e.input,output:e.output,rawInput:e.rawInput,errorText:e.errorText,providerExecuted:e.providerExecuted,preliminary:e.preliminary,...null!=e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}})}function v(e){var t,a;let r=u.message.parts.find(t=>"dynamic-tool"===t.type&&t.toolCallId===e.toolCallId);null!=r?(r.state=e.state,r.toolName=e.toolName,r.input=e.input,r.output=e.output,r.errorText=e.errorText,r.rawInput=null!=(t=e.rawInput)?t:r.rawInput,r.preliminary=e.preliminary,void 0!==e.title&&(r.title=e.title),r.providerExecuted=null!=(a=e.providerExecuted)?a:r.providerExecuted,null!=e.providerMetadata&&(r.callProviderMetadata=e.providerMetadata)):u.message.parts.push({type:"dynamic-tool",toolName:e.toolName,toolCallId:e.toolCallId,state:e.state,input:e.input,output:e.output,errorText:e.errorText,preliminary:e.preliminary,providerExecuted:e.providerExecuted,title:e.title,...null!=e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}})}async function y(e){if(null!=e){let t=null!=u.message.metadata?function e(t,a){if(void 0===t&&void 0===a)return;if(void 0===t)return a;if(void 0===a)return t;let r={...t};for(let o in a)if(Object.prototype.hasOwnProperty.call(a,o)){let s=a[o];if(void 0===s)continue;let i=o in t?t[o]:void 0,n=null!==s&&"object"==typeof s&&!Array.isArray(s)&&!(s instanceof Date)&&!(s instanceof RegExp),l=null!=i&&"object"==typeof i&&!Array.isArray(i)&&!(i instanceof Date)&&!(i instanceof RegExp);n&&l?r[o]=e(i,s):r[o]=s}return r}(u.message.metadata,e):e;null!=a&&await (0,B.validateTypes)({value:t,schema:a}),u.message.metadata=t}}switch(e.type){case"text-start":{let t={type:"text",text:"",providerMetadata:e.providerMetadata,state:"streaming"};u.activeTextParts[e.id]=t,u.message.parts.push(t),h();break}case"text-delta":{let t=u.activeTextParts[e.id];if(null==t)throw new eK({chunkType:"text-delta",chunkId:e.id,message:`Received text-delta for missing text part with ID "${e.id}". Ensure a "text-start" chunk is sent before any "text-delta" chunks.`});t.text+=e.delta,t.providerMetadata=null!=(l=e.providerMetadata)?l:t.providerMetadata,h();break}case"text-end":{let t=u.activeTextParts[e.id];if(null==t)throw new eK({chunkType:"text-end",chunkId:e.id,message:`Received text-end for missing text part with ID "${e.id}". Ensure a "text-start" chunk is sent before any "text-end" chunks.`});t.state="done",t.providerMetadata=null!=(p=e.providerMetadata)?p:t.providerMetadata,delete u.activeTextParts[e.id],h();break}case"reasoning-start":{let t={type:"reasoning",text:"",providerMetadata:e.providerMetadata,state:"streaming"};u.activeReasoningParts[e.id]=t,u.message.parts.push(t),h();break}case"reasoning-delta":{let t=u.activeReasoningParts[e.id];if(null==t)throw new eK({chunkType:"reasoning-delta",chunkId:e.id,message:`Received reasoning-delta for missing reasoning part with ID "${e.id}". Ensure a "reasoning-start" chunk is sent before any "reasoning-delta" chunks.`});t.text+=e.delta,t.providerMetadata=null!=(c=e.providerMetadata)?c:t.providerMetadata,h();break}case"reasoning-end":{let t=u.activeReasoningParts[e.id];if(null==t)throw new eK({chunkType:"reasoning-end",chunkId:e.id,message:`Received reasoning-end for missing reasoning part with ID "${e.id}". Ensure a "reasoning-start" chunk is sent before any "reasoning-end" chunks.`});t.providerMetadata=null!=(d=e.providerMetadata)?d:t.providerMetadata,t.state="done",delete u.activeReasoningParts[e.id],h();break}case"file":u.message.parts.push({type:"file",mediaType:e.mediaType,url:e.url}),h();break;case"source-url":u.message.parts.push({type:"source-url",sourceId:e.sourceId,url:e.url,title:e.title,providerMetadata:e.providerMetadata}),h();break;case"source-document":u.message.parts.push({type:"source-document",sourceId:e.sourceId,mediaType:e.mediaType,title:e.title,filename:e.filename,providerMetadata:e.providerMetadata}),h();break;case"tool-input-start":{let t=u.message.parts.filter(tu);u.partialToolCalls[e.toolCallId]={text:"",toolName:e.toolName,index:t.length,dynamic:e.dynamic,title:e.title},e.dynamic?v({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-streaming",input:void 0,providerExecuted:e.providerExecuted,title:e.title,providerMetadata:e.providerMetadata}):m({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-streaming",input:void 0,providerExecuted:e.providerExecuted,title:e.title,providerMetadata:e.providerMetadata}),h();break}case"tool-input-delta":{let t=u.partialToolCalls[e.toolCallId];if(null==t)throw new eK({chunkType:"tool-input-delta",chunkId:e.toolCallId,message:`Received tool-input-delta for missing tool call with ID "${e.toolCallId}". Ensure a "tool-input-start" chunk is sent before any "tool-input-delta" chunks.`});t.text+=e.inputTextDelta;let{value:a}=await ts(t.text);t.dynamic?v({toolCallId:e.toolCallId,toolName:t.toolName,state:"input-streaming",input:a,title:t.title}):m({toolCallId:e.toolCallId,toolName:t.toolName,state:"input-streaming",input:a,title:t.title}),h();break}case"tool-input-available":e.dynamic?v({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-available",input:e.input,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,title:e.title}):m({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-available",input:e.input,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,title:e.title}),h(),i&&!e.providerExecuted&&await i({toolCall:e});break;case"tool-input-error":e.dynamic?v({toolCallId:e.toolCallId,toolName:e.toolName,state:"output-error",input:e.input,errorText:e.errorText,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}):m({toolCallId:e.toolCallId,toolName:e.toolName,state:"output-error",input:void 0,rawInput:e.input,errorText:e.errorText,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}),h();break;case"tool-approval-request":{let t=g(e.toolCallId);t.state="approval-requested",t.approval={id:e.approvalId},h();break}case"tool-output-denied":g(e.toolCallId).state="output-denied",h();break;case"tool-output-available":{let t=g(e.toolCallId);"dynamic-tool"===t.type?v({toolCallId:e.toolCallId,toolName:t.toolName,state:"output-available",input:t.input,output:e.output,preliminary:e.preliminary,providerExecuted:e.providerExecuted,title:t.title}):m({toolCallId:e.toolCallId,toolName:tg(t),state:"output-available",input:t.input,output:e.output,providerExecuted:e.providerExecuted,preliminary:e.preliminary,title:t.title}),h();break}case"tool-output-error":{let t=g(e.toolCallId);"dynamic-tool"===t.type?v({toolCallId:e.toolCallId,toolName:t.toolName,state:"output-error",input:t.input,errorText:e.errorText,providerExecuted:e.providerExecuted,title:t.title}):m({toolCallId:e.toolCallId,toolName:tg(t),state:"output-error",input:t.input,rawInput:t.rawInput,errorText:e.errorText,providerExecuted:e.providerExecuted,title:t.title}),h();break}case"start-step":u.message.parts.push({type:"step-start"});break;case"finish-step":u.activeTextParts={},u.activeReasoningParts={};break;case"start":null!=e.messageId&&(u.message.id=e.messageId),await y(e.messageMetadata),(null!=e.messageId||null!=e.messageMetadata)&&h();break;case"finish":null!=e.finishReason&&(u.finishReason=e.finishReason),await y(e.messageMetadata),null!=e.messageMetadata&&h();break;case"message-metadata":await y(e.messageMetadata),null!=e.messageMetadata&&h();break;case"error":null==s||s(Error(e.errorText));break;default:if(e.type.startsWith("data-")){if((null==r?void 0:r[e.type])!=null&&await (0,B.validateTypes)({value:e.data,schema:r[e.type]}),e.transient){null==n||n(e);break}let t=null!=e.id?u.message.parts.find(t=>e.type===t.type&&e.id===t.id):void 0;null!=t?t.data=e.data:u.message.parts.push(e),null==n||n(e),h()}}t.enqueue(e)})}}))}({stream:e,onToolCall:this.onToolCall,onData:this.onData,messageMetadataSchema:this.messageMetadataSchema,dataPartSchemas:this.dataPartSchemas,runUpdateMessageJob:a,onError:e=>{throw e}}),onError:e=>{throw e}}),this.setStatus({status:"ready"})}catch(e){if(d||"AbortError"===e.name)return d=!0,this.setStatus({status:"ready"}),null;h=!0,e instanceof TypeError&&(e.message.toLowerCase().includes("fetch")||e.message.toLowerCase().includes("network"))&&(u=!0),this.onError&&e instanceof Error&&this.onError(e),this.setStatus({status:"error",error:e})}finally{try{null==(a=this.onFinish)||a.call(this,{message:this.activeResponse.state.message,messages:this.state.messages,isAbort:d,isDisconnect:u,isError:h,finishReason:null==(t=this.activeResponse)?void 0:t.state.finishReason})}catch(e){console.error(e)}this.activeResponse=void 0}(null==(r=this.sendAutomaticallyWhen)?void 0:r.call(this,{messages:this.state.messages}))&&!h&&await this.makeRequest({trigger:"submit-message",messageId:null==(o=this.lastMessage)?void 0:o.id,metadata:i,headers:n,body:l})}},tE=e.i(7561030);e.i(850302);var tw=(e,t,a)=>{if(!t.has(e))throw TypeError("Cannot "+a)},tS=(e,t,a)=>(tw(e,t,"read from private field"),a?a.call(e):t.get(e)),t_=(e,t,a)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,a)},tT=(e,t,a,r)=>(tw(e,t,"write to private field"),r?r.call(e,a):t.set(e,a),a),tA=class{constructor(e=[]){t_(this,y,void 0),t_(this,f,"ready"),t_(this,b,void 0),t_(this,I,new Set),t_(this,E,new Set),t_(this,w,new Set),this.pushMessage=e=>{tT(this,y,tS(this,y).concat(e)),tS(this,S).call(this)},this.popMessage=()=>{tT(this,y,tS(this,y).slice(0,-1)),tS(this,S).call(this)},this.replaceMessage=(e,t)=>{tT(this,y,[...tS(this,y).slice(0,e),this.snapshot(t),...tS(this,y).slice(e+1)]),tS(this,S).call(this)},this.snapshot=e=>structuredClone(e),this["~registerMessagesCallback"]=(e,t)=>{let a=t?null!=t?(0,tE.default)(e,t):e:e;return tS(this,I).add(a),()=>{tS(this,I).delete(a)}},this["~registerStatusCallback"]=e=>(tS(this,E).add(e),()=>{tS(this,E).delete(e)}),this["~registerErrorCallback"]=e=>(tS(this,w).add(e),()=>{tS(this,w).delete(e)}),t_(this,S,()=>{tS(this,I).forEach(e=>e())}),t_(this,_,()=>{tS(this,E).forEach(e=>e())}),t_(this,T,()=>{tS(this,w).forEach(e=>e())}),tT(this,y,e)}get status(){return tS(this,f)}set status(e){tT(this,f,e),tS(this,_).call(this)}get error(){return tS(this,b)}set error(e){tT(this,b,e),tS(this,T).call(this)}get messages(){return tS(this,y)}set messages(e){tT(this,y,[...e]),tS(this,S).call(this)}};y=new WeakMap,f=new WeakMap,b=new WeakMap,I=new WeakMap,E=new WeakMap,w=new WeakMap,S=new WeakMap,_=new WeakMap,T=new WeakMap;var tx=class extends tI{constructor({messages:e,...t}){const a=new tA(e);super({...t,state:a}),t_(this,A,void 0),this["~registerMessagesCallback"]=(e,t)=>tS(this,A)["~registerMessagesCallback"](e,t),this["~registerStatusCallback"]=e=>tS(this,A)["~registerStatusCallback"](e),this["~registerErrorCallback"]=e=>tS(this,A)["~registerErrorCallback"](e),tT(this,A,a)}};A=new WeakMap,e.s(["useChat",0,function(){let{experimental_throttle:e,resume:t=!1,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,Y.useRef)("chat"in a?{}:{onToolCall:a.onToolCall,onData:a.onData,onFinish:a.onFinish,onError:a.onError,sendAutomaticallyWhen:a.sendAutomaticallyWhen});"chat"in a||(r.current={onToolCall:a.onToolCall,onData:a.onData,onFinish:a.onFinish,onError:a.onError,sendAutomaticallyWhen:a.sendAutomaticallyWhen});let o={...a,onToolCall:e=>{var t,a;return null==(a=(t=r.current).onToolCall)?void 0:a.call(t,e)},onData:e=>{var t,a;return null==(a=(t=r.current).onData)?void 0:a.call(t,e)},onFinish:e=>{var t,a;return null==(a=(t=r.current).onFinish)?void 0:a.call(t,e)},onError:e=>{var t,a;return null==(a=(t=r.current).onError)?void 0:a.call(t,e)},sendAutomaticallyWhen:e=>{var t,a,o;return null!=(o=null==(a=(t=r.current).sendAutomaticallyWhen)?void 0:a.call(t,e))&&o}},s=(0,Y.useRef)("chat"in a?a.chat:new tx(o));("chat"in a&&a.chat!==s.current||"id"in a&&s.current.id!==a.id)&&(s.current="chat"in a?a.chat:new tx(o));let i=(0,Y.useCallback)(t=>s.current["~registerMessagesCallback"](t,e),[e,s.current.id]),n=(0,Y.useSyncExternalStore)(i,()=>s.current.messages,()=>s.current.messages),l=(0,Y.useSyncExternalStore)(s.current["~registerStatusCallback"],()=>s.current.status,()=>s.current.status),p=(0,Y.useSyncExternalStore)(s.current["~registerErrorCallback"],()=>s.current.error,()=>s.current.error),c=(0,Y.useCallback)(e=>{"function"==typeof e&&(e=e(s.current.messages)),s.current.messages=e},[s]);return(0,Y.useEffect)(()=>{t&&s.current.resumeStream()},[t,s]),{id:s.current.id,messages:n,setMessages:c,sendMessage:s.current.sendMessage,regenerate:s.current.regenerate,clearError:s.current.clearError,stop:s.current.stop,error:p,resumeStream:s.current.resumeStream,status:l,addToolResult:s.current.addToolOutput,addToolOutput:s.current.addToolOutput,addToolApprovalResponse:s.current.addToolApprovalResponse}}],3820729);var q=q,tR=Symbol.for("vercel.ai.gateway.error"),tM=class e extends(R=Error,x=tR,R){constructor({message:e,statusCode:t=500,cause:a}){super(e),this[x]=!0,this.statusCode=t,this.cause=a}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&tR in e&&!0===e[tR]}},tk="GatewayAuthenticationError",tj=Symbol.for(`vercel.ai.gateway.error.${tk}`),tC=class e extends(k=tM,M=tj,k){constructor({message:e="Authentication failed",statusCode:t=401,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[M]=!0,this.name=tk,this.type="authentication_error"}static isInstance(e){return tM.hasMarker(e)&&tj in e}static createContextualError(t){let{apiKeyProvided:a,oidcTokenProvided:r,message:o="Authentication failed",statusCode:s=401,cause:i}=t;return new e({message:a?`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:r?`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,statusCode:s,cause:i})}},tO="GatewayInvalidRequestError",tN=Symbol.for(`vercel.ai.gateway.error.${tO}`),tD=class extends(C=tM,j=tN,C){constructor({message:e="Invalid request",statusCode:t=400,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[j]=!0,this.name=tO,this.type="invalid_request_error"}static isInstance(e){return tM.hasMarker(e)&&tN in e}},tP="GatewayRateLimitError",tF=Symbol.for(`vercel.ai.gateway.error.${tP}`),tz=class extends(N=tM,O=tF,N){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[O]=!0,this.name=tP,this.type="rate_limit_exceeded"}static isInstance(e){return tM.hasMarker(e)&&tF in e}},tU="GatewayModelNotFoundError",tH=Symbol.for(`vercel.ai.gateway.error.${tU}`),tJ=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({modelId:q.string()}))),tY=class extends(P=tM,D=tH,P){constructor({message:e="Model not found",statusCode:t=404,modelId:a,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[D]=!0,this.name=tU,this.type="model_not_found",this.modelId=a}static isInstance(e){return tM.hasMarker(e)&&tH in e}},tV="GatewayInternalServerError",tB=Symbol.for(`vercel.ai.gateway.error.${tV}`),tL=class extends(z=tM,F=tB,z){constructor({message:e="Internal server error",statusCode:t=500,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[F]=!0,this.name=tV,this.type="internal_server_error"}static isInstance(e){return tM.hasMarker(e)&&tB in e}},tq="GatewayResponseError",tG=Symbol.for(`vercel.ai.gateway.error.${tq}`),tK=class extends(H=tM,U=tG,H){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:a,validationError:r,cause:o}={}){super({message:e,statusCode:t,cause:o}),this[U]=!0,this.name=tq,this.type="response_error",this.response=a,this.validationError=r}static isInstance(e){return tM.hasMarker(e)&&tG in e}};async function tW(e){let{response:t,statusCode:a,defaultMessage:r="Gateway request failed",cause:o,authMethod:s}=e,i=await (0,B.safeValidateTypes)({value:t,schema:t$});if(!i.success)return new tK({message:`Invalid error response format: ${r}`,statusCode:a,response:t,validationError:i.error,cause:o});let n=i.value,l=n.error.type,p=n.error.message;switch(l){case"authentication_error":return tC.createContextualError({apiKeyProvided:"api-key"===s,oidcTokenProvided:"oidc"===s,statusCode:a,cause:o});case"invalid_request_error":return new tD({message:p,statusCode:a,cause:o});case"rate_limit_exceeded":return new tz({message:p,statusCode:a,cause:o});case"model_not_found":{let e=await (0,B.safeValidateTypes)({value:n.error.param,schema:tJ});return new tY({message:p,statusCode:a,modelId:e.success?e.value.modelId:void 0,cause:o})}default:return new tL({message:p,statusCode:a,cause:o})}}var t$=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({error:q.object({message:q.string(),type:q.string().nullish(),param:q.unknown().nullish(),code:q.union([q.string(),q.number()]).nullish()})})));function tQ(e,t){var a;return tM.isInstance(e)?e:L.APICallError.isInstance(e)?tW({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(a=e.statusCode)?a:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):tW({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var tX="ai-gateway-auth-method";async function tZ(e){let t=await (0,B.safeValidateTypes)({value:e[tX],schema:t0});return t.success?t.value:void 0}var t0=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.union([q.literal("api-key"),q.literal("oidc")]))),t1=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await (0,B.getFromApi)({url:`${this.config.baseURL}/config`,headers:await (0,B.resolve)(this.config.headers()),successfulResponseHandler:(0,B.createJsonResponseHandler)(t2),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw await tQ(e)}}async getCredits(){try{let e=new URL(this.config.baseURL),{value:t}=await (0,B.getFromApi)({url:`${e.origin}/v1/credits`,headers:await (0,B.resolve)(this.config.headers()),successfulResponseHandler:(0,B.createJsonResponseHandler)(t4),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return t}catch(e){throw await tQ(e)}}},t2=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({models:q.array(q.object({id:q.string(),name:q.string(),description:q.string().nullish(),pricing:q.object({input:q.string(),output:q.string(),input_cache_read:q.string().nullish(),input_cache_write:q.string().nullish()}).transform(e=>{let{input:t,output:a,input_cache_read:r,input_cache_write:o}=e;return{input:t,output:a,...r?{cachedInputTokens:r}:{},...o?{cacheCreationInputTokens:o}:{}}}).nullish(),specification:q.object({specificationVersion:q.literal("v3"),provider:q.string(),modelId:q.string()}),modelType:q.enum(["language","embedding","image"]).nullish()}))}))),t4=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({balance:q.string(),total_used:q.string()}).transform(e=>{let{balance:t,total_used:a}=e;return{balance:t,totalUsed:a}}))),t5=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){let{abortSignal:t,...a}=e;return{args:this.maybeEncodeFileParts(a),warnings:[]}}async doGenerate(e){let{args:t,warnings:a}=await this.getArgs(e),{abortSignal:r}=e,o=await (0,B.resolve)(this.config.headers());try{let{responseHeaders:s,value:i,rawValue:n}=await (0,B.postJsonToApi)({url:this.getUrl(),headers:(0,B.combineHeaders)(o,e.headers,this.getModelConfigHeaders(this.modelId,!1),await (0,B.resolve)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,B.createJsonResponseHandler)(q.any()),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),...r&&{abortSignal:r},fetch:this.config.fetch});return{...i,request:{body:t},response:{headers:s,body:n},warnings:a}}catch(e){throw await tQ(e,await tZ(o))}}async doStream(e){let{args:t,warnings:a}=await this.getArgs(e),{abortSignal:r}=e,o=await (0,B.resolve)(this.config.headers());try{let{value:s,responseHeaders:i}=await (0,B.postJsonToApi)({url:this.getUrl(),headers:(0,B.combineHeaders)(o,e.headers,this.getModelConfigHeaders(this.modelId,!0),await (0,B.resolve)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,B.createEventSourceResponseHandler)(q.any()),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),...r&&{abortSignal:r},fetch:this.config.fetch});return{stream:s.pipeThrough(new TransformStream({start(e){a.length>0&&e.enqueue({type:"stream-start",warnings:a})},transform(t,a){if(t.success){let r=t.value;("raw"!==r.type||e.includeRawChunks)&&("response-metadata"===r.type&&r.timestamp&&"string"==typeof r.timestamp&&(r.timestamp=new Date(r.timestamp)),a.enqueue(r))}else a.error(t.error)}})),request:{body:t},response:{headers:i}}}catch(e){throw await tQ(e,await tZ(o))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),a=V.Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${a}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"3","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},t3=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed(e){var t;let{values:a,headers:r,abortSignal:o,providerOptions:s}=e,i=await (0,B.resolve)(this.config.headers());try{let{responseHeaders:e,value:n,rawValue:l}=await (0,B.postJsonToApi)({url:this.getUrl(),headers:(0,B.combineHeaders)(i,null!=r?r:{},this.getModelConfigHeaders(),await (0,B.resolve)(this.config.o11yHeaders)),body:{values:a,...s?{providerOptions:s}:{}},successfulResponseHandler:(0,B.createJsonResponseHandler)(t6),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),...o&&{abortSignal:o},fetch:this.config.fetch});return{embeddings:n.embeddings,usage:null!=(t=n.usage)?t:void 0,providerMetadata:n.providerMetadata,response:{headers:e,body:l},warnings:[]}}catch(e){throw await tQ(e,await tZ(i))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"3","ai-model-id":this.modelId}}},t6=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.object({embeddings:q.array(q.array(q.number())),usage:q.object({tokens:q.number()}).nullish(),providerMetadata:q.record(q.string(),q.record(q.string(),q.unknown())).optional()}))),t8=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxImagesPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate(e){var t;let{prompt:a,n:r,size:o,aspectRatio:s,seed:i,files:n,mask:l,providerOptions:p,headers:c,abortSignal:d}=e,u=await (0,B.resolve)(this.config.headers());try{let{responseHeaders:e,value:h,rawValue:g}=await (0,B.postJsonToApi)({url:this.getUrl(),headers:(0,B.combineHeaders)(u,null!=c?c:{},this.getModelConfigHeaders(),await (0,B.resolve)(this.config.o11yHeaders)),body:{prompt:a,n:r,...o&&{size:o},...s&&{aspectRatio:s},...i&&{seed:i},...p&&{providerOptions:p},...n&&{files:n.map(e=>t7(e))},...l&&{mask:t7(l)}},successfulResponseHandler:(0,B.createJsonResponseHandler)(ae),failedResponseHandler:(0,B.createJsonErrorResponseHandler)({errorSchema:q.any(),errorToMessage:e=>e}),...d&&{abortSignal:d},fetch:this.config.fetch});return{images:h.images,warnings:null!=(t=h.warnings)?t:[],providerMetadata:h.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:e}}}catch(e){throw tQ(e,await tZ(u))}}getUrl(){return`${this.config.baseURL}/image-model`}getModelConfigHeaders(){return{"ai-image-model-specification-version":"3","ai-model-id":this.modelId}}};function t7(e){return"file"===e.type&&e.data instanceof Uint8Array?{...e,data:(0,B.convertUint8ArrayToBase64)(e.data)}:e}var t9=q.object({images:q.array(q.unknown()).optional()}).catchall(q.unknown()),ae=q.object({images:q.array(q.string()),warnings:q.array(q.object({type:q.literal("other"),message:q.string()})).optional(),providerMetadata:q.record(q.string(),t9).optional()}),at=(0,B.lazySchema)(()=>(0,B.zodSchema)(G.z.object({query:G.z.union([G.z.string(),G.z.array(G.z.string())]).describe("Search query (string) or multiple queries (array of up to 5 strings). Multi-query searches return combined results from all queries."),max_results:G.z.number().optional().describe("Maximum number of search results to return (1-20, default: 10)"),max_tokens_per_page:G.z.number().optional().describe("Maximum number of tokens to extract per search result page (256-2048, default: 2048)"),max_tokens:G.z.number().optional().describe("Maximum total tokens across all search results (default: 25000, max: 1000000)"),country:G.z.string().optional().describe("Two-letter ISO 3166-1 alpha-2 country code for regional search results (e.g., 'US', 'GB', 'FR')"),search_domain_filter:G.z.array(G.z.string()).optional().describe("List of domains to include or exclude from search results (max 20). To include: ['nature.com', 'science.org']. To exclude: ['-example.com', '-spam.net']"),search_language_filter:G.z.array(G.z.string()).optional().describe("List of ISO 639-1 language codes to filter results (max 10, lowercase). Examples: ['en', 'fr', 'de']"),search_after_date:G.z.string().optional().describe("Include only results published after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),search_before_date:G.z.string().optional().describe("Include only results published before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),last_updated_after_filter:G.z.string().optional().describe("Include only results last updated after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),last_updated_before_filter:G.z.string().optional().describe("Include only results last updated before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),search_recency_filter:G.z.enum(["day","week","month","year"]).optional().describe("Filter results by relative time period. Cannot be used with search_after_date or search_before_date.")}))),aa=(0,B.lazySchema)(()=>(0,B.zodSchema)(G.z.union([G.z.object({results:G.z.array(G.z.object({title:G.z.string(),url:G.z.string(),snippet:G.z.string(),date:G.z.string().optional(),lastUpdated:G.z.string().optional()})),id:G.z.string()}),G.z.object({error:G.z.enum(["api_error","rate_limit","timeout","invalid_input","unknown"]),statusCode:G.z.number().optional(),message:G.z.string()})]))),ar=(0,B.createProviderToolFactoryWithOutputSchema)({id:"gateway.perplexity_search",inputSchema:at,outputSchema:aa}),ao={perplexitySearch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ar(e)}};async function as(){var e;return null==(e=(0,K.getContext)().headers)?void 0:e["x-vercel-id"]}async function ai(e){let t=(0,B.loadOptionalSetting)({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});return t?{token:t,authMethod:"api-key"}:{token:await (0,K.getVercelOidcToken)(),authMethod:"oidc"}}!function(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null,o=null,s=null!=(e=a.metadataCacheRefreshMillis)?e:3e5,i=0,n=null!=(t=(0,B.withoutTrailingSlash)(a.baseURL))?t:"https://ai-gateway.vercel.sh/v3/ai",l=async()=>{try{let e=await ai(a);return(0,B.withUserAgentSuffix)({Authorization:`Bearer ${e.token}`,"ai-gateway-protocol-version":"0.0.1",[tX]:e.authMethod,...a.headers},"ai-sdk/gateway/3.0.16")}catch(e){throw tC.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401,cause:e})}},p=()=>{let e=(0,B.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=(0,B.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),a=(0,B.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let r=await as();return{...e&&{"ai-o11y-deployment-id":e},...t&&{"ai-o11y-environment":t},...a&&{"ai-o11y-region":a},...r&&{"ai-o11y-request-id":r}}}},c=e=>new t5(e,{provider:"gateway",baseURL:n,headers:l,fetch:a.fetch,o11yHeaders:p()}),d=async()=>{var e,t,p;let c=null!=(p=null==(t=null==(e=a._internal)?void 0:e.currentDate)?void 0:t.call(e).getTime())?p:Date.now();return(!r||c-i>s)&&(i=c,r=new t1({baseURL:n,headers:l,fetch:a.fetch}).getAvailableModels().then(e=>(o=e,e)).catch(async e=>{throw await tQ(e,await tZ(await l()))})),o?Promise.resolve(o):r},u=async()=>new t1({baseURL:n,headers:l,fetch:a.fetch}).getCredits().catch(async e=>{throw await tQ(e,await tZ(await l()))}),h=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return c(e)};h.specificationVersion="v3",h.getAvailableModels=d,h.getCredits=u,h.imageModel=e=>new t8(e,{provider:"gateway",baseURL:n,headers:l,fetch:a.fetch,o11yHeaders:p()}),h.languageModel=c;let g=e=>new t3(e,{provider:"gateway",baseURL:n,headers:l,fetch:a.fetch,o11yHeaders:p()});h.embeddingModel=g,h.textEmbeddingModel=g,h.tools=ao}();var an=L,q=q,al=Object.defineProperty,ap=Symbol.for("vercel.ai.error.AI_InvalidArgumentError");an.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");an.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolApprovalError");an.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolInputError");an.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallNotFoundForApprovalError");an.AISDKError;Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");an.AISDKError;var ac="AI_NoObjectGeneratedError",ad=`vercel.ai.error.${ac}`,au=Symbol.for(ad),ah=class extends an.AISDKError{constructor({message:e="No object generated.",cause:t,text:a,response:r,usage:o,finishReason:s}){super({name:ac,message:e,cause:t}),this[J]=!0,this.text=a,this.response=r,this.usage=o,this.finishReason=s}static isInstance(e){return an.AISDKError.hasMarker(e,ad)}};J=au;Symbol.for("vercel.ai.error.AI_NoOutputGeneratedError");an.AISDKError,an.AISDKError;Symbol.for("vercel.ai.error.AI_NoSuchToolError");an.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallRepairError");an.AISDKError,an.AISDKError;Symbol.for("vercel.ai.error.AI_UIMessageStreamError");an.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidDataContentError");an.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError");an.AISDKError;Symbol.for("vercel.ai.error.AI_MessageConversionError");an.AISDKError;Symbol.for("vercel.ai.error.AI_RetryError");an.AISDKError;var ag="6.0.41",am=q.union([q.string(),q.instanceof(Uint8Array),q.instanceof(ArrayBuffer),q.custom(e=>{var t,a;return null!=(a=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&a},{message:"Must be a Buffer"})]),av=q.lazy(()=>q.union([q.null(),q.string(),q.number(),q.boolean(),q.record(q.string(),av.optional()),q.array(av)])),ay=q.record(q.string(),q.record(q.string(),av.optional())),af=q.object({type:q.literal("text"),text:q.string(),providerOptions:ay.optional()}),ab=q.object({type:q.literal("image"),image:q.union([am,q.instanceof(URL)]),mediaType:q.string().optional(),providerOptions:ay.optional()}),aI=q.object({type:q.literal("file"),data:q.union([am,q.instanceof(URL)]),filename:q.string().optional(),mediaType:q.string(),providerOptions:ay.optional()}),aE=q.object({type:q.literal("reasoning"),text:q.string(),providerOptions:ay.optional()}),aw=q.object({type:q.literal("tool-call"),toolCallId:q.string(),toolName:q.string(),input:q.unknown(),providerOptions:ay.optional(),providerExecuted:q.boolean().optional()}),aS=q.discriminatedUnion("type",[q.object({type:q.literal("text"),value:q.string(),providerOptions:ay.optional()}),q.object({type:q.literal("json"),value:av,providerOptions:ay.optional()}),q.object({type:q.literal("execution-denied"),reason:q.string().optional(),providerOptions:ay.optional()}),q.object({type:q.literal("error-text"),value:q.string(),providerOptions:ay.optional()}),q.object({type:q.literal("error-json"),value:av,providerOptions:ay.optional()}),q.object({type:q.literal("content"),value:q.array(q.union([q.object({type:q.literal("text"),text:q.string(),providerOptions:ay.optional()}),q.object({type:q.literal("media"),data:q.string(),mediaType:q.string()}),q.object({type:q.literal("file-data"),data:q.string(),mediaType:q.string(),filename:q.string().optional(),providerOptions:ay.optional()}),q.object({type:q.literal("file-url"),url:q.string(),providerOptions:ay.optional()}),q.object({type:q.literal("file-id"),fileId:q.union([q.string(),q.record(q.string(),q.string())]),providerOptions:ay.optional()}),q.object({type:q.literal("image-data"),data:q.string(),mediaType:q.string(),providerOptions:ay.optional()}),q.object({type:q.literal("image-url"),url:q.string(),providerOptions:ay.optional()}),q.object({type:q.literal("image-file-id"),fileId:q.union([q.string(),q.record(q.string(),q.string())]),providerOptions:ay.optional()}),q.object({type:q.literal("custom"),providerOptions:ay.optional()})]))})]),a_=q.object({type:q.literal("tool-result"),toolCallId:q.string(),toolName:q.string(),output:aS,providerOptions:ay.optional()}),aT=q.object({type:q.literal("tool-approval-request"),approvalId:q.string(),toolCallId:q.string()}),aA=q.object({type:q.literal("tool-approval-response"),approvalId:q.string(),approved:q.boolean(),reason:q.string().optional()}),ax=q.object({role:q.literal("system"),content:q.string(),providerOptions:ay.optional()}),aR=q.object({role:q.literal("user"),content:q.union([q.string(),q.array(q.union([af,ab,aI]))]),providerOptions:ay.optional()}),aM=q.object({role:q.literal("assistant"),content:q.union([q.string(),q.array(q.union([af,aI,aE,aw,a_,aT]))]),providerOptions:ay.optional()}),ak=q.object({role:q.literal("tool"),content:q.array(q.union([a_,aA])),providerOptions:ay.optional()});q.union([ax,aR,aM,ak]);var aj={},aC={array:()=>aF,choice:()=>az,json:()=>aU,object:()=>aP,text:()=>aD};for(var aO in aC)al(aj,aO,{get:aC[aO],enumerable:!0});async function aN(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await (0,B.safeParseJSON)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await (0,B.safeParseJSON)({text:function(e){let t=["ROOT"],a=-1,r=null;function o(e,o,s){switch(e){case'"':a=o,t.pop(),t.push(s),t.push("INSIDE_STRING");break;case"f":case"t":case"n":a=o,r=o,t.pop(),t.push(s),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":a=o,t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"{":a=o,t.pop(),t.push(s),t.push("INSIDE_OBJECT_START");break;case"[":a=o,t.pop(),t.push(s),t.push("INSIDE_ARRAY_START")}}function s(e,r){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":a=r,t.pop()}}function i(e,r){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":a=r,t.pop()}}for(let n=0;n<e.length;n++){let l=e[n];switch(t[t.length-1]){case"ROOT":o(l,n,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":a=n,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(l,n,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":s(l,n);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),a=n;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:a=n}break;case"INSIDE_ARRAY_START":"]"===l?(a=n,t.pop()):(a=n,o(l,n,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":a=n,t.pop();break;default:a=n}break;case"INSIDE_ARRAY_AFTER_COMMA":o(l,n,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),a=n;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":a=n;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,n);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,n);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(r,n+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?a=n:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?s(l,n):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n))}}}let n=e.slice(0,a+1);for(let a=t.length-1;a>=0;a--)switch(t[a]){case"INSIDE_STRING":n+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":n+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":n+="]";break;case"INSIDE_LITERAL":{let t=e.substring(r,e.length);"true".startsWith(t)?n+="true".slice(t.length):"false".startsWith(t)?n+="false".slice(t.length):"null".startsWith(t)&&(n+="null".slice(t.length))}}return n}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}var aD=()=>({name:"text",responseFormat:Promise.resolve({type:"text"}),async parseCompleteOutput(e){let{text:t}=e;return t},async parsePartialOutput(e){let{text:t}=e;return{partial:t}},createElementStreamTransform(){}}),aP=e=>{let{schema:t,name:a,description:r}=e,o=(0,B.asSchema)(t);return{name:"object",responseFormat:(0,B.resolve)(o.jsonSchema).then(e=>({type:"json",schema:e,...null!=a&&{name:a},...null!=r&&{description:r}})),async parseCompleteOutput(e,t){let{text:a}=e,r=await (0,B.safeParseJSON)({text:a});if(!r.success)throw new ah({message:"No object generated: could not parse the response.",cause:r.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=await (0,B.safeValidateTypes)({value:r.value,schema:o});if(!s.success)throw new ah({message:"No object generated: response did not match schema.",cause:s.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});return s.value},async parsePartialOutput(e){let{text:t}=e,a=await aN(t);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:a.value}}},createElementStreamTransform(){}}},aF=e=>{let{element:t,name:a,description:r}=e,o=(0,B.asSchema)(t);return{name:"array",responseFormat:(0,B.resolve)(o.jsonSchema).then(e=>{let{$schema:t,...o}=e;return{type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:o}},required:["elements"],additionalProperties:!1},...null!=a&&{name:a},...null!=r&&{description:r}}}),async parseCompleteOutput(e,t){let{text:a}=e,r=await (0,B.safeParseJSON)({text:a});if(!r.success)throw new ah({message:"No object generated: could not parse the response.",cause:r.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=r.value;if(null==s||"object"!=typeof s||!("elements"in s)||!Array.isArray(s.elements))throw new ah({message:"No object generated: response did not match schema.",cause:new an.TypeValidationError({value:s,cause:"response must be an object with an elements array"}),text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});for(let e of s.elements){let r=await (0,B.safeValidateTypes)({value:e,schema:o});if(!r.success)throw new ah({message:"No object generated: response did not match schema.",cause:r.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason})}return s.elements},async parsePartialOutput(e){let{text:t}=e,a=await aN(t);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=a.value;if(null==e||"object"!=typeof e||!("elements"in e)||!Array.isArray(e.elements))return;let t="repaired-parse"===a.state&&e.elements.length>0?e.elements.slice(0,-1):e.elements,r=[];for(let e of t){let t=await (0,B.safeValidateTypes)({value:e,schema:o});t.success&&r.push(t.value)}return{partial:r}}}},createElementStreamTransform(){let e=0;return new TransformStream({transform(t,a){let{partialOutput:r}=t;if(null!=r)for(;e<r.length;e++)a.enqueue(r[e])}})}}},az=e=>{let{options:t,name:a,description:r}=e;return{name:"choice",responseFormat:Promise.resolve({type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:t}},required:["result"],additionalProperties:!1},...null!=a&&{name:a},...null!=r&&{description:r}}),async parseCompleteOutput(e,a){let{text:r}=e,o=await (0,B.safeParseJSON)({text:r});if(!o.success)throw new ah({message:"No object generated: could not parse the response.",cause:o.error,text:r,response:a.response,usage:a.usage,finishReason:a.finishReason});let s=o.value;if(null==s||"object"!=typeof s||!("result"in s)||"string"!=typeof s.result||!t.includes(s.result))throw new ah({message:"No object generated: response did not match schema.",cause:new an.TypeValidationError({value:s,cause:"response must be an object that contains a choice value."}),text:r,response:a.response,usage:a.usage,finishReason:a.finishReason});return s.result},async parsePartialOutput(e){let{text:a}=e,r=await aN(a);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=r.value;if(null==e||"object"!=typeof e||!("result"in e)||"string"!=typeof e.result)return;let a=t.filter(t=>t.startsWith(e.result));if("successful-parse"===r.state)return a.includes(e.result)?{partial:e.result}:void 0;return 1===a.length?{partial:a[0]}:void 0}}},createElementStreamTransform(){}}},aU=function(){let{name:e,description:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"json",responseFormat:Promise.resolve({type:"json",...null!=e&&{name:e},...null!=t&&{description:t}}),async parseCompleteOutput(e,t){let{text:a}=e,r=await (0,B.safeParseJSON)({text:a});if(!r.success)throw new ah({message:"No object generated: could not parse the response.",cause:r.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});return r.value},async parsePartialOutput(e){let{text:t}=e,a=await aN(t);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return void 0===a.value?void 0:{partial:a.value}}},createElementStreamTransform(){}}};(0,B.createIdGenerator)({prefix:"aitxt",size:24}),TransformStream;var aH=(0,B.lazySchema)(()=>(0,B.zodSchema)(q.union([q.strictObject({type:q.literal("text-start"),id:q.string(),providerMetadata:ay.optional()}),q.strictObject({type:q.literal("text-delta"),id:q.string(),delta:q.string(),providerMetadata:ay.optional()}),q.strictObject({type:q.literal("text-end"),id:q.string(),providerMetadata:ay.optional()}),q.strictObject({type:q.literal("error"),errorText:q.string()}),q.strictObject({type:q.literal("tool-input-start"),toolCallId:q.string(),toolName:q.string(),providerExecuted:q.boolean().optional(),providerMetadata:ay.optional(),dynamic:q.boolean().optional(),title:q.string().optional()}),q.strictObject({type:q.literal("tool-input-delta"),toolCallId:q.string(),inputTextDelta:q.string()}),q.strictObject({type:q.literal("tool-input-available"),toolCallId:q.string(),toolName:q.string(),input:q.unknown(),providerExecuted:q.boolean().optional(),providerMetadata:ay.optional(),dynamic:q.boolean().optional(),title:q.string().optional()}),q.strictObject({type:q.literal("tool-input-error"),toolCallId:q.string(),toolName:q.string(),input:q.unknown(),providerExecuted:q.boolean().optional(),providerMetadata:ay.optional(),dynamic:q.boolean().optional(),errorText:q.string(),title:q.string().optional()}),q.strictObject({type:q.literal("tool-approval-request"),approvalId:q.string(),toolCallId:q.string()}),q.strictObject({type:q.literal("tool-output-available"),toolCallId:q.string(),output:q.unknown(),providerExecuted:q.boolean().optional(),dynamic:q.boolean().optional(),preliminary:q.boolean().optional()}),q.strictObject({type:q.literal("tool-output-error"),toolCallId:q.string(),errorText:q.string(),providerExecuted:q.boolean().optional(),dynamic:q.boolean().optional()}),q.strictObject({type:q.literal("tool-output-denied"),toolCallId:q.string()}),q.strictObject({type:q.literal("reasoning-start"),id:q.string(),providerMetadata:ay.optional()}),q.strictObject({type:q.literal("reasoning-delta"),id:q.string(),delta:q.string(),providerMetadata:ay.optional()}),q.strictObject({type:q.literal("reasoning-end"),id:q.string(),providerMetadata:ay.optional()}),q.strictObject({type:q.literal("source-url"),sourceId:q.string(),url:q.string(),title:q.string().optional(),providerMetadata:ay.optional()}),q.strictObject({type:q.literal("source-document"),sourceId:q.string(),mediaType:q.string(),title:q.string(),filename:q.string().optional(),providerMetadata:ay.optional()}),q.strictObject({type:q.literal("file"),url:q.string(),mediaType:q.string(),providerMetadata:ay.optional()}),q.strictObject({type:q.custom(e=>"string"==typeof e&&e.startsWith("data-"),{message:'Type must start with "data-"'}),id:q.string().optional(),data:q.unknown(),transient:q.boolean().optional()}),q.strictObject({type:q.literal("start-step")}),q.strictObject({type:q.literal("finish-step")}),q.strictObject({type:q.literal("start"),messageId:q.string().optional(),messageMetadata:q.unknown().optional()}),q.strictObject({type:q.literal("finish"),finishReason:q.enum(["stop","length","content-filter","tool-calls","error","other"]).optional(),messageMetadata:q.unknown().optional()}),q.strictObject({type:q.literal("abort"),reason:q.string().optional()}),q.strictObject({type:q.literal("message-metadata"),messageMetadata:q.unknown()})])));function aJ(e){return"dynamic-tool"===e.type}function aY(e){return e.type.startsWith("tool-")||aJ(e)}(0,B.createIdGenerator)({prefix:"aitxt",size:24}),(0,B.lazySchema)(()=>(0,B.zodSchema)(q.array(q.object({id:q.string(),role:q.enum(["system","user","assistant"]),metadata:q.unknown().optional(),parts:q.array(q.union([q.object({type:q.literal("text"),text:q.string(),state:q.enum(["streaming","done"]).optional(),providerMetadata:ay.optional()}),q.object({type:q.literal("reasoning"),text:q.string(),state:q.enum(["streaming","done"]).optional(),providerMetadata:ay.optional()}),q.object({type:q.literal("source-url"),sourceId:q.string(),url:q.string(),title:q.string().optional(),providerMetadata:ay.optional()}),q.object({type:q.literal("source-document"),sourceId:q.string(),mediaType:q.string(),title:q.string(),filename:q.string().optional(),providerMetadata:ay.optional()}),q.object({type:q.literal("file"),mediaType:q.string(),filename:q.string().optional(),url:q.string(),providerMetadata:ay.optional()}),q.object({type:q.literal("step-start")}),q.object({type:q.string().startsWith("data-"),id:q.string().optional(),data:q.unknown()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("input-streaming"),input:q.unknown().optional(),providerExecuted:q.boolean().optional(),callProviderMetadata:ay.optional(),output:q.never().optional(),errorText:q.never().optional(),approval:q.never().optional()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("input-available"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),approval:q.never().optional()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("approval-requested"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),approval:q.object({id:q.string(),approved:q.never().optional(),reason:q.never().optional()})}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("approval-responded"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),approval:q.object({id:q.string(),approved:q.boolean(),reason:q.string().optional()})}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("output-available"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.unknown(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),preliminary:q.boolean().optional(),approval:q.object({id:q.string(),approved:q.literal(!0),reason:q.string().optional()}).optional()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("output-error"),input:q.unknown(),rawInput:q.unknown().optional(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.string(),callProviderMetadata:ay.optional(),approval:q.object({id:q.string(),approved:q.literal(!0),reason:q.string().optional()}).optional()}),q.object({type:q.literal("dynamic-tool"),toolName:q.string(),toolCallId:q.string(),state:q.literal("output-denied"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),approval:q.object({id:q.string(),approved:q.literal(!1),reason:q.string().optional()})}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("input-streaming"),providerExecuted:q.boolean().optional(),callProviderMetadata:ay.optional(),input:q.unknown().optional(),output:q.never().optional(),errorText:q.never().optional(),approval:q.never().optional()}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("input-available"),providerExecuted:q.boolean().optional(),input:q.unknown(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),approval:q.never().optional()}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("approval-requested"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),approval:q.object({id:q.string(),approved:q.never().optional(),reason:q.never().optional()})}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("approval-responded"),input:q.unknown(),providerExecuted:q.boolean().optional(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),approval:q.object({id:q.string(),approved:q.boolean(),reason:q.string().optional()})}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("output-available"),providerExecuted:q.boolean().optional(),input:q.unknown(),output:q.unknown(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),preliminary:q.boolean().optional(),approval:q.object({id:q.string(),approved:q.literal(!0),reason:q.string().optional()}).optional()}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("output-error"),providerExecuted:q.boolean().optional(),input:q.unknown(),rawInput:q.unknown().optional(),output:q.never().optional(),errorText:q.string(),callProviderMetadata:ay.optional(),approval:q.object({id:q.string(),approved:q.literal(!0),reason:q.string().optional()}).optional()}),q.object({type:q.string().startsWith("tool-"),toolCallId:q.string(),state:q.literal("output-denied"),providerExecuted:q.boolean().optional(),input:q.unknown(),output:q.never().optional(),errorText:q.never().optional(),callProviderMetadata:ay.optional(),approval:q.object({id:q.string(),approved:q.literal(!1),reason:q.string().optional()})})])).nonempty("Message must contain at least one part")})).nonempty("Messages array must not be empty"))),(0,B.createIdGenerator)({prefix:"aiobj",size:24}),(0,B.createIdGenerator)({prefix:"aiobj",size:24});Symbol.for("vercel.ai.error.AI_NoSuchProviderError");an.NoSuchModelError,an.AISDKError;var aV=class{constructor({api:e="/api/chat",credentials:t,headers:a,body:r,fetch:o,prepareSendMessagesRequest:s,prepareReconnectToStreamRequest:i}){this.api=e,this.credentials=t,this.headers=a,this.body=r,this.fetch=o,this.prepareSendMessagesRequest=s,this.prepareReconnectToStreamRequest=i}async sendMessages(e){var t,a,r,o,s;let{abortSignal:i,...n}=e,l=await (0,B.resolve)(this.body),p=await (0,B.resolve)(this.headers),c=await (0,B.resolve)(this.credentials),d={...(0,B.normalizeHeaders)(p),...(0,B.normalizeHeaders)(n.headers)},u=await (null==(t=this.prepareSendMessagesRequest)?void 0:t.call(this,{api:this.api,id:n.chatId,messages:n.messages,body:{...l,...n.body},headers:d,credentials:c,requestMetadata:n.metadata,trigger:n.trigger,messageId:n.messageId})),h=null!=(a=null==u?void 0:u.api)?a:this.api,g=(null==u?void 0:u.headers)!==void 0?(0,B.normalizeHeaders)(u.headers):d,m=(null==u?void 0:u.body)!==void 0?u.body:{...l,...n.body,id:n.chatId,messages:n.messages,trigger:n.trigger,messageId:n.messageId},v=null!=(r=null==u?void 0:u.credentials)?r:c,y=null!=(o=this.fetch)?o:globalThis.fetch,f=await y(h,{method:"POST",headers:(0,B.withUserAgentSuffix)({"Content-Type":"application/json",...g},`ai-sdk/${ag}`,(0,B.getRuntimeEnvironmentUserAgent)()),body:JSON.stringify(m),credentials:v,signal:i});if(!f.ok)throw Error(null!=(s=await f.text())?s:"Failed to fetch the chat response.");if(!f.body)throw Error("The response body is empty.");return this.processResponseStream(f.body)}async reconnectToStream(e){var t,a,r,o,s;let i=await (0,B.resolve)(this.body),n=await (0,B.resolve)(this.headers),l=await (0,B.resolve)(this.credentials),p={...(0,B.normalizeHeaders)(n),...(0,B.normalizeHeaders)(e.headers)},c=await (null==(t=this.prepareReconnectToStreamRequest)?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...i,...e.body},headers:p,credentials:l,requestMetadata:e.metadata})),d=null!=(a=null==c?void 0:c.api)?a:`${this.api}/${e.chatId}/stream`,u=(null==c?void 0:c.headers)!==void 0?(0,B.normalizeHeaders)(c.headers):p,h=null!=(r=null==c?void 0:c.credentials)?r:l,g=null!=(o=this.fetch)?o:globalThis.fetch,m=await g(d,{method:"GET",headers:(0,B.withUserAgentSuffix)(u,`ai-sdk/${ag}`,(0,B.getRuntimeEnvironmentUserAgent)()),credentials:h});if(204===m.status)return null;if(!m.ok)throw Error(null!=(s=await m.text())?s:"Failed to fetch the chat response.");if(!m.body)throw Error("The response body is empty.");return this.processResponseStream(m.body)}},aB=class extends aV{constructor(e={}){super(e)}processResponseStream(e){return(0,B.parseJsonEventStream)({stream:e,schema:aH}).pipeThrough(new TransformStream({async transform(e,t){if(!e.success)throw e.error;t.enqueue(e.value)}}))}};e.s(["DefaultChatTransport",0,aB,"getToolOrDynamicToolName",0,function(e){return aJ(e)?e.toolName:e.type.split("-").slice(1).join("-")},"isToolOrDynamicToolUIPart",0,aY,"isToolUIPart",0,aY],45404)}]);

//# debugId=44bfc93d-0619-b224-f9eb-5f2bfd67c186
//# sourceMappingURL=0f827600eb1c2094.js.map