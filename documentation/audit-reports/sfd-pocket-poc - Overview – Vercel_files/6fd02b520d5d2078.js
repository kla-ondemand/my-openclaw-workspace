;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="8bde1c10-6ee4-daf6-4f3d-2992c2b157ce")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,895016,e=>{"use strict";var t=e.i(4205214),a=e.i(6942035),r=e.i(8660982);let l="ai-gateway-get-started-dismissed";e.s(["GetStartedBlockClient",0,function(e){let{teamSlug:o,children:n}=e,[s,i]=(0,r.useState)(()=>{try{return"true"===localStorage.getItem(`${l}-${o}`)}catch{return!1}});return s?null:(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("button",{type:"button",className:"absolute -right-2 -top-2 z-10 flex h-5 w-5 border border-gray-alpha-400 items-center justify-center rounded-full bg-white backdrop-blur-sm hover:bg-gray-100 duration-100 opacity-0 group-hover:opacity-100",onClick:()=>{try{localStorage.setItem(`${l}-${o}`,"true"),i(!0)}catch{}},"aria-label":"Dismiss",children:(0,t.jsx)(a.Cross,{color:"gray-900",className:"h-2 w-2"})}),n]})}])},3677363,e=>{"use strict";var t=e.i(4205214),a=e.i(5481907),r=e.i(8660982),l=e.i(6881349),o=e.i(6891161),n=e.i(2504781),s=e.i(992159),i=e.i(7467654),u=e.i(665316),c=e.i(409142),m=e.i(4597921);let d={aiModel:{defaultValue:void 0},aiProvider:{defaultValue:void 0},environment:{defaultValue:"all"},keyType:{defaultValue:"all"},authType:{defaultValue:"all"}};function p(){let{set:e,state:t}=(0,c.useSearchParamsState)(d);return[t,e]}let g=[{value:"all",label:"All environments"},{value:"production",label:"Production"},{value:"preview",label:"Preview"},{value:"development",label:"Development"}],h=[{value:"ai-gateway",label:"Non-BYOK"},{value:"byok",label:"BYOK"}],y=[{value:"api-key",label:"AI Gateway API Key"},{value:"oidc",label:"Vercel OIDC Token"}];function x(){let e,[a,r]=p(),o=a.environment??"all";return(0,t.jsxs)(l.Combobox,{clearable:!1,value:o,noInputPrefix:!0,width:(e=g.find(e=>e.value===o)?.label??"",`${Math.min(8.6*e.length+48,200)}px`),onChange:e=>{e&&r({environment:e})},noRawSelectedValue:!0,children:[(0,t.jsx)(l.Combobox.Input,{}),(0,t.jsx)(l.Combobox.List,{maxWidth:300,children:g.map(e=>(0,t.jsx)(l.Combobox.Option,{value:e.value,children:e.label},e.value))})]})}function v(){let[e,o]=p(),[n,s]=(0,r.useState)(""),[c,m]=(0,r.useState)(""),{data:d}=(0,a.useSonarQuery)({event:"aiGatewayRequest",rollups:{value:{measure:"count",aggregation:"sum"}},groupBy:["aiModel","aiProvider"],limit:100,tailRollup:"truncate",summaryOnly:!0},{noEnvironmentFilter:!0}),{data:g}=(0,a.useSonarQuery)({event:"aiGatewayRequest",rollups:{value:{measure:"count",aggregation:"sum"}},groupBy:["aiProvider"],limit:50,tailRollup:"truncate",summaryOnly:!0},{noEnvironmentFilter:!0}),x=(0,r.useMemo)(()=>d?.summary?d.summary.map(e=>({model:e.aiModel,provider:e.aiProvider,count:e.value??0})).filter(e=>e.model&&e.provider).sort((e,t)=>t.count-e.count):[],[d]),v=(0,r.useMemo)(()=>g?.summary?g.summary.map(e=>({provider:e.aiProvider,count:e.value??0})).filter(e=>e.provider).sort((e,t)=>t.count-e.count):[],[g]),f=(0,r.useMemo)(()=>{if(!n)return v;let e=n.toLowerCase();return v.filter(t=>t.provider.toLowerCase().includes(e)||(0,i.getOrganizationDisplayName)(t.provider).toLowerCase().includes(e))},[v,n]),j=(0,r.useMemo)(()=>{if(!c)return x;let e=c.toLowerCase();return x.filter(t=>t.model.toLowerCase().includes(e)||t.provider.toLowerCase().includes(e)||(0,i.getOrganizationDisplayName)(t.provider).toLowerCase().includes(e))},[x,c]),b=(0,r.useMemo)(()=>{if(!e.aiModel)return null;let t=x.find(t=>t.model===e.aiModel);return t?.provider??null},[e.aiModel,x]);return(0,t.jsxs)("div",{className:"flex flex-col gap-3 p-4 min-w-[280px]",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{htmlFor:"provider-filter",className:"text-sm font-medium text-gray-1000",children:"Provider"}),(0,t.jsxs)(l.Combobox,{clearable:!0,onChange:e=>{o({aiProvider:e??void 0}),s("")},onClear:()=>s(""),placeholder:"All Providers",value:e.aiProvider??null,prefixIcon:e.aiProvider?(0,t.jsx)(u.ModelLogo,{name:e.aiProvider,size:"small"}):null,children:[(0,t.jsx)(l.Combobox.Input,{id:"provider-filter",onChange:e=>s(e.target.value),"aria-label":"Search providers"}),(0,t.jsx)(l.Combobox.List,{emptyMessage:"No providers found",children:f.map(e=>(0,t.jsx)(l.Combobox.Option,{value:e.provider,prefix:(0,t.jsx)(u.ModelLogo,{name:e.provider,size:"small"}),children:(0,i.getOrganizationDisplayName)(e.provider)},e.provider))})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{htmlFor:"model-filter",className:"text-sm font-medium text-gray-1000",children:"Model"}),(0,t.jsxs)(l.Combobox,{clearable:!0,onChange:e=>{o({aiModel:e??void 0}),m("")},onClear:()=>m(""),placeholder:"All Models",value:e.aiModel??null,prefixIcon:e.aiModel&&b?(0,t.jsx)(u.ModelLogo,{name:b,size:"small"}):null,children:[(0,t.jsx)(l.Combobox.Input,{id:"model-filter",onChange:e=>m(e.target.value),"aria-label":"Search models"}),(0,t.jsx)(l.Combobox.List,{emptyMessage:"No models found",children:j.map(e=>(0,t.jsx)(l.Combobox.Option,{value:e.model,prefix:(0,t.jsx)(u.ModelLogo,{name:e.provider,size:"small"}),children:e.model},`${e.provider}/${e.model}`))})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{htmlFor:"key-type-filter",className:"text-sm font-medium text-gray-1000",children:"Key Type"}),(0,t.jsxs)(l.Combobox,{clearable:!0,value:e.keyType&&"all"!==e.keyType?e.keyType:null,onChange:e=>{o({keyType:e??"all"})},placeholder:"All Keys",noRawSelectedValue:!0,children:[(0,t.jsx)(l.Combobox.Input,{id:"key-type-filter"}),(0,t.jsx)(l.Combobox.List,{children:h.map(e=>(0,t.jsx)(l.Combobox.Option,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{htmlFor:"auth-type-filter",className:"text-sm font-medium text-gray-1000",children:"Auth Type"}),(0,t.jsxs)(l.Combobox,{clearable:!0,value:e.authType&&"all"!==e.authType?e.authType:null,onChange:e=>{o({authType:e??"all"})},placeholder:"All Auth Types",noRawSelectedValue:!0,children:[(0,t.jsx)(l.Combobox.Input,{id:"auth-type-filter"}),(0,t.jsx)(l.Combobox.List,{children:y.map(e=>(0,t.jsx)(l.Combobox.Option,{value:e.value,children:e.label},e.value))})]})]})]})}e.s(["AIGatewayEnvironmentFilter",0,function(){return(0,t.jsx)(x,{})},"AIGatewayFiltersButton",0,function(){let e=(0,m.useServerFlag)("enable-upgraded-ai-observability",!1),[a,l]=(0,r.useState)(!1);return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Button,{type:"secondary",prefix:(0,t.jsx)(s.Filter,{}),onClick:()=>l(!0),children:"Filters"}),(0,t.jsxs)(o.Modal.Modal,{active:a,onClickOutside:()=>l(!1),children:[(0,t.jsxs)(o.Modal.Body,{children:[(0,t.jsx)(o.Modal.Header,{children:(0,t.jsx)(o.Modal.Title,{children:"Filters"})}),(0,t.jsx)(v,{})]}),(0,t.jsx)(o.Modal.Actions,{children:(0,t.jsx)(o.Modal.Action,{onClick:()=>l(!1),children:"Done"})})]})]}):null},"buildFilterString",0,function(e){let t=[];if(e.aiModel){let a=e.aiModel.replace(/'/g,"''");t.push(`aiModel eq '${a}'`)}if(e.aiProvider){let a=e.aiProvider.replace(/'/g,"''");t.push(`aiProvider eq '${a}'`)}return e.environment&&"all"!==e.environment&&t.push(`environment eq '${e.environment}'`),e.keyType&&"all"!==e.keyType&&("ai-gateway"===e.keyType?t.push("isByok eq 'not-byok'"):"byok"===e.keyType&&t.push("isByok eq 'byok'")),e.authType&&"all"!==e.authType&&("api-key"===e.authType?t.push("(keyId ne null and keyId ne '')"):"oidc"===e.authType&&t.push("(keyId eq null or keyId eq '')")),t.length>0?t.join(" and "):void 0},"useAIGatewayFilters",0,p])},5921511,e=>{"use strict";var t=e.i(4205214),a=e.i(409142),r=e.i(9179929),l=e.i(5481907),o=e.i(8151845),n=e.i(5182595),s=e.i(3351543);function i(e){let{title:a,titleElement:r,rollupElement:l,href:o,data:i}=e;return(0,t.jsxs)(s.ChartCard,{children:[r||o&&(0,t.jsx)(s.CardHeader,{href:o,title:a}),l,(0,t.jsx)("div",{className:"h-[190px]",children:(0,t.jsx)(n.LineChart,{...i,marginTop:16,marginRight:8,marginBottom:16})})]})}var u=e.i(2749380);function c(e,t){let a=(0,u.getTimeRangePresets)(!1),r=m(e),l=m(t);for(let e of Object.values(a)){let t=e.end??new Date;if(m(e.start)===r&&m(t)===l)return!0}return!1}function m(e){return Math.floor(e.getTime()/6e4)}var d=e.i(8674454),p=e.i(6694387),g=e.i(4991687),h=e.i(8459493),y=e.i(5255926),x=e.i(2560270),v=e.i(3677363),f=e.i(8660982),j=e.i(8633387);let b=[{value:"aiModel",label:"by Model",menuLabel:"by Model"},{value:"aiProvider",label:"by Provider",menuLabel:"by Provider"},{value:"total",label:"Total",menuLabel:"Total"}];function T(){return(0,t.jsx)(p.MenuButton,{"aria-label":"Select grouping",size:"tiny",className:"!h-6",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(x.ChevronDown,{size:12,color:"gray-900"})})}function C(e){let{projectName:a,projectSlug:n}=e,{start:s,end:u}=(0,o.useRangeFromQueryState)(),[m,p]=(0,f.useState)("aiModel"),[x]=(0,v.useAIGatewayFilters)(),C=(0,v.buildFilterString)(x),{data:k}=(0,j.useDashboardProject)({projectSlug:n}),w=k?.id,N=(()=>{let e=[];if(C&&e.push(C),"no-project"===a)e.push("(projectId eq null or projectId eq '')");else if(a){let t=a.replace(/'/g,"''");e.push(`projectName eq '${t}'`)}return e.length>0?e.join(" and "):void 0})(),{data:M,isLoading:S,builderQuery:I}=(0,l.useSonarQuery)({event:"aiGatewayRequest",rollups:{value:{measure:"cost",aggregation:"sum"}},groupBy:"total"===m?["costCurrency"]:[m,"costCurrency"],limitRanking:"top_by_summary",limit:"total"===m?1:5,tailRollup:"total"===m?"truncate":"others",summaryOnly:!1,filter:N,...!a&&w&&{contextFilter:{projectId:w}}},{noEnvironmentFilter:!0}),F=(0,r.useTimeseriesData)(M,"total"===m?{singleCategoryName:"Total"}:{category:m}),P=(0,r.useSum)(M),q=null!==P?`$${P.toFixed(2)}`:"$0.00",D=b.find(e=>e.value===m)?.label??"by Model",R=(0,t.jsx)("div",{className:"-mx-3 -mt-3 pl-1 pt-3 hide-from-share-dom-copy",children:(0,t.jsxs)("div",{className:"flex flex-row items-center gap-1 px-[11.5px]",children:[(0,t.jsxs)("span",{className:"text-gray-900",children:["Spend ","total"===m?"":D]}),(0,t.jsxs)(g.MenuContainer,{position:"bottom-start",children:[(0,t.jsx)(T,{}),(0,t.jsx)(d.Menu,{width:120,children:b.map(e=>(0,t.jsx)(h.MenuItem,{onClick:()=>p(e.value),children:e.menuLabel},e.value))})]})]})}),A=(0,t.jsx)("div",{className:"pl-1 text-[14px] text-gray-1000 leading-none font-medium tabular-nums",children:S?(0,t.jsx)(y.Skeleton,{height:14,width:60}):q});return(0,t.jsx)(i,{title:"Spend",titleElement:R,rollupElement:A,data:{builderQuery:I?.value,sonarQueryResults:M,data:F??[],disableLegend:!0,isLoading:S,isRelativeTime:c(s,u),lineType:"linear",formatValue:e=>`$${e.toFixed(2)}`,yAxisWidth:50,marginLeft:7}})}var k=e.i(7797615);let w=[{value:"aiModel",label:"by Model",menuLabel:"by Model"},{value:"aiProvider",label:"by Provider",menuLabel:"by Provider"},{value:"total",label:"Total",menuLabel:"Total"}];function N(){return(0,t.jsx)(p.MenuButton,{"aria-label":"Select grouping",size:"tiny",className:"!h-6",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(x.ChevronDown,{size:12,color:"gray-900"})})}function M(e){let{projectName:a,projectSlug:n}=e,{start:s,end:u}=(0,o.useRangeFromQueryState)(),[m,p]=(0,f.useState)("aiModel"),[x]=(0,v.useAIGatewayFilters)(),b=(0,v.buildFilterString)(x),{data:T}=(0,j.useDashboardProject)({projectSlug:n}),C=T?.id,M=(()=>{let e=[];if(b&&e.push(b),"no-project"===a)e.push("(projectId eq null or projectId eq '')");else if(a){let t=a.replace(/'/g,"''");e.push(`projectName eq '${t}'`)}return e.length>0?e.join(" and "):void 0})(),{data:S,isLoading:I,builderQuery:F}=(0,l.useSonarQuery)({event:"aiGatewayRequest",rollups:{value:{measure:"count",aggregation:"sum"}},groupBy:"total"===m?["costCurrency"]:[m,"costCurrency"],limitRanking:"top_by_summary",limit:"total"===m?1:5,tailRollup:"total"===m?"truncate":"others",summaryOnly:!1,filter:M,...!a&&C&&{contextFilter:{projectId:C}}},{noEnvironmentFilter:!0}),P=(0,r.useTimeseriesData)(S,"total"===m?{singleCategoryName:"Total"}:{category:m}),q=(0,r.useSum)(S),D=(0,k.formatNumberCompact)(q??0),R=w.find(e=>e.value===m)?.label??"by Model",A=(0,t.jsx)("div",{className:"-mx-3 -mt-3 pl-1 pt-3 hide-from-share-dom-copy",children:(0,t.jsxs)("div",{className:"flex flex-row items-center gap-1 px-[11.5px]",children:[(0,t.jsxs)("span",{className:"text-gray-900",children:["Requests ","total"===m?"":R]}),(0,t.jsxs)(g.MenuContainer,{position:"bottom-start",children:[(0,t.jsx)(N,{}),(0,t.jsx)(d.Menu,{width:120,children:w.map(e=>(0,t.jsx)(h.MenuItem,{onClick:()=>p(e.value),children:e.menuLabel},e.value))})]})]})}),L=(0,t.jsx)("div",{className:"pl-1 text-[14px] text-gray-1000 leading-none font-medium tabular-nums",children:I?(0,t.jsx)(y.Skeleton,{height:14,width:60}):D});return(0,t.jsx)(i,{title:"Requests",titleElement:A,rollupElement:L,data:{builderQuery:F?.value,sonarQueryResults:S,data:P??[],disableLegend:!0,isLoading:I,isRelativeTime:c(s,u),lineType:"linear"}})}let S=[{value:"all",label:"All Tokens"},{value:"inputTokens",label:"Input Tokens"},{value:"outputTokens",label:"Output Tokens"},{value:"cachedInputTokens",label:"Cache Read Tokens"},{value:"cacheCreationInputTokens",label:"Cache Write Tokens"}];function I(){return(0,t.jsx)(p.MenuButton,{"aria-label":"Select token type",size:"tiny",className:"!h-6",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(x.ChevronDown,{size:12,color:"gray-900"})})}function F(e){let{projectName:a,projectSlug:n}=e,{start:s,end:u}=(0,o.useRangeFromQueryState)(),[m,p]=(0,f.useState)("all"),[x]=(0,v.useAIGatewayFilters)(),b=(0,v.buildFilterString)(x),{data:T}=(0,j.useDashboardProject)({projectSlug:n}),C=T?.id,w=(()=>{let e=[];if(b&&e.push(b),"no-project"===a)e.push("(projectId eq null or projectId eq '')");else if(a){let t=a.replace(/'/g,"''");e.push(`projectName eq '${t}'`)}return e.length>0?e.join(" and "):void 0})(),{data:N,isLoading:M,builderQuery:F}=(0,l.useSonarQuery)({event:"aiGatewayRequest",rollups:{inputTokens:{measure:"inputTokens",aggregation:"sum"},outputTokens:{measure:"outputTokens",aggregation:"sum"},cachedInputTokens:{measure:"cachedInputTokens",aggregation:"sum"},cacheCreationInputTokens:{measure:"cacheCreationInputTokens",aggregation:"sum"},reasoningTokens:{measure:"reasoningTokens",aggregation:"sum"}},summaryOnly:!1,filter:w,...!a&&C&&{contextFilter:{projectId:C}}},{noEnvironmentFilter:!0}),P=(0,f.useMemo)(()=>"all"===m?{inputTokens:"Input Tokens",outputTokens:"Output Tokens",reasoningTokens:"Output Tokens",cachedInputTokens:"Cache Read Tokens",cacheCreationInputTokens:"Cache Write Tokens"}:"outputTokens"===m?{outputTokens:"Output Tokens",reasoningTokens:"Output Tokens"}:{[m]:({inputTokens:"Input Tokens",cachedInputTokens:"Cache Read Tokens",cacheCreationInputTokens:"Cache Write Tokens"})[m]},[m]),q=(0,r.useTimeseriesData)(N,{rollupCategories:P})??[],D=(0,f.useMemo)(()=>{if(!N?.summary?.[0])return 0;let e=N.summary[0];return"all"===m?(Number(e.inputTokens)||0)+(Number(e.outputTokens)||0)+(Number(e.cachedInputTokens)||0)+(Number(e.cacheCreationInputTokens)||0)+(Number(e.reasoningTokens)||0):"outputTokens"===m?(Number(e.outputTokens)||0)+(Number(e.reasoningTokens)||0):Number(e[m])||0},[N,m]),R=(0,k.formatNumberCompact)(D),A=S.find(e=>e.value===m)?.label??"All Tokens",L=(0,t.jsx)("div",{className:"-mx-3 -mt-3 pl-1 pt-3 hide-from-share-dom-copy",children:(0,t.jsxs)("div",{className:"flex flex-row items-center gap-1 px-[11.5px]",children:[(0,t.jsx)("span",{className:"text-gray-900",children:A}),(0,t.jsxs)(g.MenuContainer,{position:"bottom-start",children:[(0,t.jsx)(I,{}),(0,t.jsx)(d.Menu,{width:160,children:S.map(e=>(0,t.jsx)(h.MenuItem,{onClick:()=>p(e.value),children:e.label},e.value))})]})]})}),$=(0,t.jsx)("div",{className:"pl-1 text-[14px] text-gray-1000 leading-none font-medium tabular-nums",children:M?(0,t.jsx)(y.Skeleton,{height:14,width:60}):R});return(0,t.jsx)(i,{title:"Tokens",titleElement:L,rollupElement:$,data:{builderQuery:F?.value,sonarQueryResults:N,data:q,disableLegend:!0,lineType:"linear",isLoading:M,isRelativeTime:c(s,u),getColor:e=>{switch(e){case"Input Tokens":return"var(--ds-red-700)";case"Output Tokens":return"var(--ds-amber-700)";case"Cache Read Tokens":return"var(--ds-green-700)";case"Cache Write Tokens":return"var(--ds-purple-700)";default:return"var(--ds-blue-700)"}}}})}let P=[{value:"aiModel",label:"by Model",menuLabel:"by Model"},{value:"aiProvider",label:"by Provider",menuLabel:"by Provider"},{value:"total",label:"Total",menuLabel:"Total"}];function q(){return(0,t.jsx)(p.MenuButton,{"aria-label":"Select grouping",size:"tiny",className:"!h-6",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(x.ChevronDown,{size:12,color:"gray-900"})})}function D(e){let{projectName:a,projectSlug:n}=e,{start:s,end:u}=(0,o.useRangeFromQueryState)(),[m,p]=(0,f.useState)("aiModel"),[x]=(0,v.useAIGatewayFilters)(),b=(0,v.buildFilterString)(x),{data:T}=(0,j.useDashboardProject)({projectSlug:n}),C=T?.id,k=(()=>{let e=[];if(b&&e.push(b),"no-project"===a)e.push("(projectId eq null or projectId eq '')");else if(a){let t=a.replace(/'/g,"''");e.push(`projectName eq '${t}'`)}return e.length>0?e.join(" and "):void 0})(),{data:w,isLoading:N,builderQuery:M}=(0,l.useSonarQuery)({event:"aiGatewayRequest",rollups:{value:{measure:"timeToFirstTokenMs",aggregation:"avg"}},groupBy:"total"===m?["costCurrency"]:[m,"costCurrency"],limitRanking:"top_by_summary",limit:"total"===m?1:5,tailRollup:"total"===m?"truncate":"others",summaryOnly:!1,filter:k,...!a&&C&&{contextFilter:{projectId:C}}},{noEnvironmentFilter:!0}),S=(0,r.useTimeseriesData)(w,"total"===m?{singleCategoryName:"Total"}:{category:m}),I=(0,f.useMemo)(()=>{if(!w?.summary?.length)return null;let e=w.summary.map(e=>e.value).filter(e=>null!==e&&!Number.isNaN(e));return 0===e.length?null:e.reduce((e,t)=>e+t,0)/e.length},[w]),F=null!==I?`${(I/1e3).toFixed(2)}s`:"0.00s",D=P.find(e=>e.value===m)?.label??"by Model",R=(0,t.jsx)("div",{className:"-mx-3 -mt-3 pl-1 pt-3 hide-from-share-dom-copy",children:(0,t.jsxs)("div",{className:"flex flex-row items-center gap-1 px-[11.5px]",children:[(0,t.jsxs)("span",{className:"text-gray-900",children:["Average TTFT ","total"===m?"":D]}),(0,t.jsxs)(g.MenuContainer,{position:"bottom-start",children:[(0,t.jsx)(q,{}),(0,t.jsx)(d.Menu,{width:120,children:P.map(e=>(0,t.jsx)(h.MenuItem,{onClick:()=>p(e.value),children:e.menuLabel},e.value))})]})]})}),A=(0,t.jsx)("div",{className:"pl-1 text-[14px] text-gray-1000 leading-none font-medium tabular-nums",children:N?(0,t.jsx)(y.Skeleton,{height:14,width:60}):F});return(0,t.jsx)(i,{title:"Average TTFT",titleElement:R,rollupElement:A,data:{builderQuery:M?.value,sonarQueryResults:w,data:S??[],formatValue:e=>`${(e/1e3).toFixed(2)}s`,disableLegend:!0,isLoading:N,isRelativeTime:c(s,u),lineType:"linear"}})}e.s(["ActivityGrid",0,function(e){let{projectSlug:r}=e,{state:l}=(0,a.useSearchParamsState)({projectName:{defaultValue:void 0}}),{projectName:o}=l;return(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 @lg-page:grid-cols-2",children:[(0,t.jsx)(C,{projectName:o,projectSlug:r}),(0,t.jsx)(D,{projectName:o,projectSlug:r}),(0,t.jsx)(M,{projectName:o,projectSlug:r}),(0,t.jsx)(F,{projectName:o,projectSlug:r})]})}],5921511)},6491604,e=>{"use strict";var t=e.i(4205214),a=e.i(850302),r=e.i(8660982),l=e.i(5758851),o=e.i(8923565),n=e.i(5338940),s=e.i(8151845),i=e.i(1233856),u=e.i(1230902),c=e.i(7467654),m=e.i(2936702),d=e.i(3646124),p=e.i(665316);function g(e){let{cell:a}=e,r=a.row.original.aiModelCreator||a.value.split("/")[0];return(0,t.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden py-2",children:[(0,t.jsx)(p.ModelLogo,{name:r,size:"small"}),(0,t.jsx)("span",{className:"overflow-hidden text-ellipsis text-nowrap text-gray-900",children:a.value})]})}function h(e){let{cell:a}=e,r=(0,c.getOrganizationDisplayName)(a.value);return(0,t.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden py-2",children:[(0,t.jsx)(p.ModelLogo,{name:a.value,size:"small"}),(0,t.jsx)("span",{className:"overflow-hidden text-ellipsis text-nowrap text-gray-900",children:r})]})}var y=e.i(7797615),x=e.i(6255129),v=e.i(2504781),f=e.i(3993360);function j(e){return Number.isFinite(e)?`$${e.toFixed(3)}`:"-"}function b(e){var a;let{cell:r}=e,l=r.value,o=new Date(l.endsWith("Z")?l:`${l}Z`);return Number.isNaN(o.getTime())?(0,t.jsx)("div",{className:"py-2 text-gray-900 whitespace-nowrap",children:"-"}):(0,t.jsx)("div",{className:"py-2 text-gray-900 whitespace-nowrap",children:(a=o,(0,u.format)(a,"MMM dd HH:mm:ss").toUpperCase())})}function T(e){let{data:a,customPagination:l,defaultPageSize:o,onSearchChange:n,exportBaseUrl:s,onSortChange:i,externalPageIndex:u}=e,p=void 0===a,[T,k]=(0,r.useState)(!1),w=(0,r.useMemo)(()=>p?Array(10).fill(null):Array.isArray(a)?a:[],[p,a]),N=(0,r.useMemo)(()=>[{Header:"Time",accessor:"timestamp",Cell:b,disableGlobalFilter:!0,columnClassName:"w-[160px] min-w-[120px] max-w-[180px]"},{Header:"Model",accessor:"aiModel",columnClassName:"pr-5",sortDescFirst:!1,Cell:g,disableGlobalFilter:!1},{Header:"Provider",accessor:"aiProvider",Cell:h,disableGlobalFilter:!1},{Header:"Cost",accessor:"cost",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:j},{Header:"Input",accessor:"inputTokens",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"Cache Read",accessor:"cachedInputTokens",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"Cache Write",accessor:"cacheCreationInputTokens",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"Reasoning",accessor:"reasoningTokens",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"Output",accessor:"outputTokens",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"Duration",accessor:"aiRequestDurationMs",columnAlignment:"right",Cell:d.NumericCell,cellFormatter:C}],[]),M=(0,r.useCallback)((e,t,a)=>{let r=(a||"").toLowerCase().trim();return r?e.filter(e=>{let t=String(e.original.aiModel??"").toLowerCase(),a=(0,c.getOrganizationDisplayName)(String(e.original.aiProvider??"")).toLowerCase();return t.includes(r)||a.includes(r)}):e},[]),S=(0,r.useCallback)(async()=>{try{k(!0),await new Promise(e=>setTimeout(e,0));let e=[];if(s){let t=0;for(;;){let a=`${s}&limit=1000&offset=${t}`,r=await fetch(a,{cache:"no-store"});if(!r.ok)break;let l=await r.json(),o=Array.isArray(l.data)?l.data:[];if(e=e.concat(o),(l.pageInfo?.returned??o.length)<1e3||e.length>=1e6)break;t+=1e3}}else e=Array.isArray(a)?a:[];let t=e.map(e=>[String(e.timestamp??""),String(e.aiModel??""),String(e.aiProvider??""),Number.isFinite(e.cost)?String(e.cost):"",Number.isFinite(e.inputTokens)?String(e.inputTokens):"",Number.isFinite(e.cachedInputTokens)?String(e.cachedInputTokens):"",Number.isFinite(e.cacheCreationInputTokens)?String(e.cacheCreationInputTokens):"",Number.isFinite(e.reasoningTokens)?String(e.reasoningTokens):"",Number.isFinite(e.outputTokens)?String(e.outputTokens):"",Number.isFinite(e.aiRequestDurationMs)?String(e.aiRequestDurationMs):""]),r=["Time,Model/creator,Provider,Cost,Input,Cache Read,Cache Write,Reasoning,Output,Duration (ms)",...t.map(e=>e.map((e,t)=>{let a,r;return t<=2?(a=/[",\n\r]/.test(e),r=e.replace(/"/g,'""'),a?`"${r}"`:r):e}).join(","))].join("\r\n"),l=new Blob([`\uFEFF${r}`],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(l),n=document.createElement("a");n.href=o,n.download="gateway-inference-requests.csv",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o)}finally{k(!1)}},[a,s]);return(0,t.jsx)(m.SonarTable,{columns:N,data:w,isLoading:p,defaultPageSize:o,defaultSort:[{id:"timestamp",desc:!0}],plugins:[x.useGlobalFilter,x.useSortBy,x.usePagination],globalFilter:M,onGlobalFilterChange:n,syncSearchUrlUpdate:!0,debounceSearchMs:200,customPagination:l,externalPageIndex:u,manualSortBy:!0,onSortChange:i,renderCustomActions:()=>(0,t.jsx)(v.Button,{prefix:(0,t.jsx)(f.Download,{}),type:"secondary",loading:T,disabled:p||T||!a||0===a.length,onClick:S,children:T?"Exportingâ€¦":"Export CSV"})})}function C(e){if(!Number.isFinite(e))return"-";let t=e/1e3;if(t<60){let e=t.toFixed(2).replace(/\.?0+$/,"");return`${e}s`}if(t<3600){let e=Math.floor(t/60),a=Math.floor(t%60);return 0===a?`${e}m`:`${e}m${a}s`}let a=Math.floor(t/3600),r=Math.floor(t%3600/60);return 0===r?`${a}h`:`${a}h${r}m`}var k=e.i(5481907),w=e.i(9179929),N=e.i(3677363),M=e.i(7517587),S=e.i(409142),I=e.i(5468328),F=e.i(6362863),P=e.i(5169576),q=e.i(6493690),D=e.i(57106),R=e.i(8633387);let A={projects:{groupBy:["projectId","projectName"],accessor:"projectName",headerName:"Project"},apiKeys:{groupBy:["keyId","keyName"],accessor:"keyName",headerName:"API Key"}};function L(e){return Number.isFinite(e)?`$${e.toFixed(2)}`:"-"}function $(e){let a=e.row.original;return a.isOIDC?(0,t.jsxs)("div",{className:"h-[38px] flex items-center gap-1.5 text-ellipsis text-nowrap text-gray-900 ml-1",children:[(0,t.jsx)(q.LogoVercelCircle,{size:16}),(0,t.jsx)("span",{className:"truncate",children:"Vercel OIDC Token"}),(0,t.jsx)(I.Tooltip,{text:(0,t.jsxs)("span",{children:[(0,t.jsx)(D.Link,{href:"https://vercel.com/docs/ai-gateway/authentication-and-byok/authentication#setting-up-oidc-authentication",className:"text-blue-900",children:"Vercel OIDC tokens"})," ","authenticate requests without a managed API key."]}),children:(0,t.jsx)(D.Link,{href:"https://vercel.com/docs/ai-gateway/authentication-and-byok/authentication#setting-up-oidc-authentication",className:"text-gray-700","aria-label":"Learn about Vercel OIDC tokens",children:(0,t.jsx)(P.Information,{size:12})})})]}):a.isNoProject?(0,t.jsxs)("div",{className:"h-[38px] flex items-center gap-1.5 text-ellipsis text-nowrap text-gray-900 ml-1",children:[(0,t.jsx)("span",{className:"truncate text-gray-700",children:"No Project"}),(0,t.jsx)(I.Tooltip,{text:"Requests made without an associated project, typically direct API calls.",children:(0,t.jsx)("span",{className:"text-gray-700","aria-label":"Learn about requests without projects",children:(0,t.jsx)(P.Information,{size:12})})})]}):(0,t.jsx)(d.ProjectCell,{...e})}function O(e){let{projectSlug:a}=e,[l]=(0,N.useAIGatewayFilters)(),o=(0,N.buildFilterString)(l),{data:n}=(0,R.useDashboardProject)({projectSlug:a}),s=n?.id,{tab:i}=(0,M.useQueryParamTabState)({defaultValue:"projects",options:["projects","apiKeys"],preserveSearch:!0}),{state:u,set:c}=(0,S.useSearchParamsState)({keyId:{defaultValue:void 0},projectName:{defaultValue:void 0}}),{keyId:p,projectName:h}=u,f="oidc"===p,j="no-project"===h,b=!!(s&&"projects"===i),T=!!(p||h)||b,C=(0,r.useMemo)(()=>{let e=[];if(o&&e.push(o),j)e.push("(projectId eq null or projectId eq '')");else if(h){let t=h.replace(/'/g,"''");e.push(`projectName eq '${t}'`)}else if(f)e.push("(keyId eq null or keyId eq '')"),e.push("(projectId ne null and projectId ne '')");else if(p){let t=p.replace(/'/g,"''");e.push(`keyId eq '${t}'`)}else"projects"===i&&e.push("(projectId ne null and projectId ne '')");return e.length>0?e.join(" and "):void 0},[o,i,p,h,f,j]),{data:I,isLoading:P}=(0,k.useSonarQuery)({event:"aiGatewayRequest",rollups:{requests:{measure:"count",aggregation:"sum"},cost:{measure:"cost",aggregation:"sum"},inputTokens:{measure:"inputTokens",aggregation:"sum"},outputTokens:{measure:"outputTokens",aggregation:"sum"},tokensPerSecond:{measure:"tokensPerSecond",aggregation:"avg"},p75DurationMs:{measure:"aiRequestDurationMs",aggregation:"p75"},p75TimeToFirstTokenMs:{measure:"timeToFirstTokenMs",aggregation:"p75"}},groupBy:T?["aiModel"]:A[i].groupBy,limit:100,tailRollup:"truncate",summaryOnly:!1,lowGranularity:!0,filter:"apiKeys"!==i||T?"projects"!==i||T?C:[o,"(projectId ne null and projectId ne '')"].filter(Boolean).join(" and ")||void 0:[o,"(keyId ne null and keyId ne '')"].filter(Boolean).join(" and ")||void 0,...s&&{contextFilter:{projectId:s}}},{noEnvironmentFilter:!0}),q=(0,r.useMemo)(()=>{if("apiKeys"===i&&!T)return[o,"(keyId eq null or keyId eq '')","(projectId ne null and projectId ne '')"].filter(Boolean).join(" and ")||void 0},[i,T,o]),D=(0,r.useMemo)(()=>{if("projects"===i&&!T)return[o,"(projectId eq null or projectId eq '')"].filter(Boolean).join(" and ")||void 0},[i,T,o]),{data:O,isLoading:B}=(0,k.useSonarQuery)({event:"aiGatewayRequest",rollups:{requests:{measure:"count",aggregation:"sum"},cost:{measure:"cost",aggregation:"sum"},inputTokens:{measure:"inputTokens",aggregation:"sum"},outputTokens:{measure:"outputTokens",aggregation:"sum"},tokensPerSecond:{measure:"tokensPerSecond",aggregation:"avg"},p75DurationMs:{measure:"aiRequestDurationMs",aggregation:"p75"},p75TimeToFirstTokenMs:{measure:"timeToFirstTokenMs",aggregation:"p75"}},groupBy:[],limit:1,tailRollup:"truncate",summaryOnly:!0,lowGranularity:!0,filter:q,...s&&{contextFilter:{projectId:s}}},{noEnvironmentFilter:!0}),{data:G,isLoading:V}=(0,k.useSonarQuery)({event:"aiGatewayRequest",rollups:{requests:{measure:"count",aggregation:"sum"},cost:{measure:"cost",aggregation:"sum"},inputTokens:{measure:"inputTokens",aggregation:"sum"},outputTokens:{measure:"outputTokens",aggregation:"sum"},tokensPerSecond:{measure:"tokensPerSecond",aggregation:"avg"},p75DurationMs:{measure:"aiRequestDurationMs",aggregation:"p75"},p75TimeToFirstTokenMs:{measure:"timeToFirstTokenMs",aggregation:"p75"}},groupBy:[],limit:1,tailRollup:"truncate",summaryOnly:!0,lowGranularity:!0,filter:D,...s&&{contextFilter:{projectId:s}}},{noEnvironmentFilter:!0}),E=P||"apiKeys"===i&&!T&&B||"projects"===i&&!T&&V,H=(0,w.useTableData)(I,{meta:{timeseries:{by:T?["aiModel"]:[A[i].accessor]}}},[i,T]),z=(0,r.useMemo)(()=>{if("apiKeys"===i&&!T&&O?.summary?.[0]){let e=O.summary[0],t={keyId:"oidc",keyName:"Vercel OIDC Token",isOIDC:!0,requests:e.requests??0,cost:e.cost??0,inputTokens:e.inputTokens??0,outputTokens:e.outputTokens??0,tokensPerSecond:e.tokensPerSecond??0,p75DurationMs:e.p75DurationMs??0,p75TimeToFirstTokenMs:e.p75TimeToFirstTokenMs??0};if(t.requests>0)return[t,...H??[]]}if("projects"===i&&!T&&G?.summary?.[0]){let e=G.summary[0],t={projectName:"No Project",isNoProject:!0,requests:e.requests??0,cost:e.cost??0,inputTokens:e.inputTokens??0,outputTokens:e.outputTokens??0,tokensPerSecond:e.tokensPerSecond??0,p75DurationMs:e.p75DurationMs??0,p75TimeToFirstTokenMs:e.p75TimeToFirstTokenMs??0};if(t.requests>0)return[t,...H??[]]}return H},[i,T,H,O,G]),U=(0,r.useMemo)(()=>T?[{Header:"AI Model",accessor:"aiModel",columnClassName:"pr-0",sortDescFirst:!1,Cell:g},{Header:"Requests",accessor:"requests",columnClassName:"w-28 max-w-36 min-w-28",columnAlignment:"right",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"Avg Tokens/s",accessor:"tokensPerSecond",columnClassName:"w-28 max-w-36 min-w-28",columnAlignment:"right",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"P75 Duration",accessor:"p75DurationMs",columnClassName:"w-36 max-w-36 min-w-36",Cell:d.BarTimeseriesCell,cellFormatter:y.formatDuration},{Header:"P75 TTFT",accessor:"p75TimeToFirstTokenMs",columnClassName:"w-28 max-w-36 min-w-28",Cell:d.BarTimeseriesCell,cellFormatter:y.formatDuration},{Header:"Cost",accessor:"cost",columnAlignment:"right",columnClassName:"w-20 max-w-20 min-w-20",Cell:d.NumericCell,cellFormatter:L}]:[{Header:A[i].headerName,accessor:A[i].accessor,columnClassName:"pr-0",sortDescFirst:!1,Cell:$,disableGlobalFilter:!1},{Header:"Requests",accessor:"requests",columnClassName:"w-28 max-w-36 min-w-28",columnAlignment:"right",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"Avg Tokens/s",accessor:"tokensPerSecond",columnClassName:"w-28 max-w-36 min-w-28",columnAlignment:"right",Cell:d.NumericCell,cellFormatter:y.formatNumberCompact},{Header:"P75 Duration",accessor:"p75DurationMs",columnClassName:"w-36 max-w-36 min-w-36",Cell:d.BarTimeseriesCell,cellFormatter:y.formatDuration},{Header:"P75 TTFT",accessor:"p75TimeToFirstTokenMs",columnClassName:"w-28 max-w-36 min-w-28",Cell:d.BarTimeseriesCell,cellFormatter:y.formatDuration},{Header:"Cost",accessor:"cost",columnAlignment:"right",columnClassName:"w-20 max-w-20 min-w-20",Cell:d.NumericCell,cellFormatter:L}],[i,T]),Q=(0,r.useMemo)(()=>(e,t,a)=>{let r=(a||"").toLowerCase().trim();return r?e.filter(e=>{let t=e.original;return t.isOIDC?"vercel oidc token".includes(r)||"oidc".includes(r):t.isNoProject?"no project".includes(r)||"no-project".includes(r):String(t[A[i].accessor]??"").toLowerCase().includes(r)}):e},[i]),K=(0,r.useCallback)(e=>{T||("projects"===i?e.isNoProject?c({projectName:"no-project"}):c({projectName:e.projectName}):c({keyId:e.keyId}))},[T,i,c]),W=(0,r.useMemo)(()=>()=>{if(b)return(0,t.jsx)(M.TableTabs,{defaultValue:i,options:[{label:"Models",value:"projects"},{label:"API Keys",value:"apiKeys"}],preserveSearch:!0});if(T){let e="apiKeys"===i||f?"Back to API Keys":"Back to Projects";return(0,t.jsx)(v.Button,{size:"medium",type:"secondary",shape:"square","aria-label":e,onClick:()=>c({keyId:void 0,projectName:void 0}),children:(0,t.jsx)(F.ArrowLeft,{color:"gray-900"})})}return(0,t.jsx)(M.TableTabs,{defaultValue:i,options:[{label:"Projects",value:"projects"},{label:"API Keys",value:"apiKeys"}],preserveSearch:!0})},[i,T,f,b,c]);return(0,t.jsx)("div",{children:(0,t.jsx)(m.SonarTable,{columns:U,data:z??[],isLoading:E,defaultPageSize:10,defaultSort:[{id:"cost",desc:!0}],plugins:[x.useGlobalFilter,x.useSortBy,x.usePagination],globalFilter:Q,syncSearchUrlUpdate:!0,debounceSearchMs:200,renderLeftActions:W,onRowClick:T?void 0:K,getHoveredValue:e=>T?e?.aiModel:"projects"===i?e?.isNoProject?"No Project":e?.projectName:e?.isOIDC?"Vercel OIDC Token":e?.keyName})})}function B(e){let t=e.getUTCFullYear(),a=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),l=String(e.getUTCHours()).padStart(2,"0"),o=String(e.getUTCMinutes()).padStart(2,"0"),n=String(e.getUTCSeconds()).padStart(2,"0");return`${t}-${a}-${r} ${l}:${o}:${n}`}e.s(["InferenceRequestsData",0,function(e){let{projectSlug:u}=e,{team:c}=(0,n.useTeam)(),{start:m,end:d,isRelativeTime:p}=(0,s.useRangeFromQueryState)(),{data:g}=(0,R.useDashboardProject)({projectSlug:u}),[h]=(0,N.useAIGatewayFilters)(),{state:y,set:x}=(0,S.useSearchParamsState)({view:{defaultValue:"summary",onChangeRemoveKeys:["page","sortBy","sortDesc"]},page:{defaultValue:1,formatToUrl:e=>e.toString(),parseFromUrl:e=>Number.parseInt(e,10)||1},sortBy:{defaultValue:""},sortDesc:{defaultValue:!1,formatToUrl:e=>e?"1":"0",parseFromUrl:e=>"1"===e}}),v="requests"===y.view?"requests":"summary",f=p?(0,i.startOfDuration)(m,{minutes:1}):m,j=p?(0,i.endOfDuration)(d,{minutes:1}):d,[b,C]=(0,r.useState)(10),[k,w]=(0,r.useState)(0),[M,I]=(0,r.useState)(void 0),F=(0,r.useRef)(null),[P,q]=(0,r.useState)("timestamp"),[D,A]=(0,r.useState)(!0),[L,$]=(0,r.useState)(!0),G=(0,r.useRef)(Date.now()),V=(0,r.useRef)(null);(0,r.useEffect)(()=>()=>{F.current&&clearTimeout(F.current)},[]);let E=(0,r.useMemo)(()=>{if(!c||u&&!g)return null;let e=B(f),t=B(j),a=new URLSearchParams({ownerId:c.id,startTime:e,endTime:t});return g?.id&&a.set("projectId",g.id),M&&M.trim().length>0&&a.set("q",M.trim()),h.environment&&"all"!==h.environment&&a.set("environment",h.environment),h.keyType&&"all"!==h.keyType&&a.set("keyType",h.keyType),h.authType&&"all"!==h.authType&&a.set("authType",h.authType),`/api/ai/gateway-inference-requests?${a.toString()}`},[c,u,g,f,j,M,h]),H=(0,r.useMemo)(()=>{if(!E)return null;let e=Math.max(100,Math.min(500,5*b)),t=Math.floor(k*b/e)*e,a=D?"DESC":"ASC";return`${E}&limit=${e}&offset=${t}&sortBy=${encodeURIComponent(P)}&sortDir=${a}`},[E,k,b,P,D]),{data:z,isValidating:U,error:Q,mutate:K}=(0,a.default)(H,async e=>{let t=new AbortController,a=await fetch(e,{cache:"no-store",signal:t.signal});if(!a.ok){let e=Error(`Failed to fetch inference requests: ${a.status} ${a.statusText}`);e.status=a.status;try{e.info=await a.json()}catch{}throw e}let r=await a.json();return r&&Array.isArray(r.data)?r:{data:[]}},{revalidateIfStale:!1,refreshInterval:0,revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0,dedupingInterval:6e4,errorRetryCount:1,errorRetryInterval:1e4});(0,r.useEffect)(()=>{G.current=Date.now(),V.current&&(clearTimeout(V.current),V.current=null);let e=setTimeout(()=>{$(!0)},0),t=setTimeout(()=>{$(!1)},2e3);return()=>{clearTimeout(e),clearTimeout(t),V.current&&clearTimeout(V.current)}},[H]),(0,r.useEffect)(()=>{if(!U&&z){let e=Date.now()-G.current;if(z.data&&z.data.length>0){let e=setTimeout(()=>{$(!1)},0);return V.current&&(clearTimeout(V.current),V.current=null),()=>clearTimeout(e)}if(e<500)V.current=setTimeout(()=>{$(!1)},500-e);else{let e=setTimeout(()=>{$(!1)},0);return()=>clearTimeout(e)}}return()=>{V.current&&(clearTimeout(V.current),V.current=null)}},[U,z]);let W=(0,r.useMemo)(()=>{if(L||U)return;let e=z?.data??[],t=Math.max(100,Math.min(500,5*b)),a=k*b,r=Math.floor(a/t)*t,l=a-r;return e.slice(l,l+b)},[z?.data,U,L,k,b]),_=(0,r.useMemo)(()=>{let e=z?.pageInfo?.total;if("number"==typeof e&&Number.isFinite(e))return k+1<Math.max(1,Math.ceil(e/b));let t=z?.pageInfo?.returned??0,a=Math.max(100,Math.min(500,5*b)),r=k*b,l=Math.floor(r/a)*a;return t>r-l+b||t===a},[z?.pageInfo?.total,z?.pageInfo?.returned,k,b]),Y=(0,r.useCallback)(()=>{_&&w(e=>e+1)},[_]),Z=(0,r.useCallback)(()=>{w(e=>Math.max(0,e-1))},[]),J=(0,r.useCallback)(e=>{C(e),w(0)},[]),X=(0,r.useMemo)(()=>{let e=z?.pageInfo?.total;return"number"==typeof e&&Number.isFinite(e)?Math.max(1,Math.ceil(e/b)):k+(_?2:1)},[z?.pageInfo?.total,b,k,_]),ee=(0,r.useMemo)(()=>({onNextPage:Y,onPrevPage:Z,onSetPageSize:J,pageCount:X}),[Y,Z,J,X]),et=(0,r.useMemo)(()=>{if(!E)return;let e=D?"DESC":"ASC";return`${E}&sortBy=${encodeURIComponent(P)}&sortDir=${e}`},[E,P,D]);if(Q&&!z){let e=401===Q.status||403===Q.status?"You do not have permission to view inference requests":"Failed to load inference requests";return(0,t.jsx)("div",{className:"rounded-md border border-red-200 bg-red-50 p-4",children:(0,t.jsx)(l.ErrorCard,{title:e,error:Q,reset:()=>void K()})})}return(0,t.jsxs)("div",{className:"min-h-[650px]",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-medium",children:"Requests"}),(0,t.jsx)("div",{className:"text-nowrap",children:(0,t.jsxs)(o.Switch,{name:"view-mode",children:[(0,t.jsx)(o.Switch.Control,{checked:"summary"===v,label:"Summary",onChange:()=>x({view:"summary"}),value:"summary"}),(0,t.jsx)(o.Switch.Control,{checked:"requests"===v,label:"Log",onChange:()=>x({view:"requests"}),value:"requests"})]})})]}),(0,t.jsx)("div",{className:"mt-4",children:"summary"===v?(0,t.jsx)(O,{projectSlug:u}):(0,t.jsx)(T,{data:W,customPagination:ee,defaultPageSize:b,exportBaseUrl:et,externalPageIndex:k,onSortChange:e=>{e?(q(e.id),A(e.desc)):(q("timestamp"),A(!0)),w(0)},onSearchChange:e=>{F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{I(e?.trim()?e:void 0),w(0)},200)}})})]})}],6491604)},2307571,e=>{"use strict";var t=e.i(4205214);e.i(5335102);var a=e.i(6764151),r=e.i(2831393),l=e.i(2504781),o=e.i(8522580),n=e.i(8660982),s=e.i(3089600);e.s(["AddPaymentMethodModal",0,function(){let{hasVerifiedPaymentMethod:e,loading:i,mutate:u}=(0,r.useAiCreditsBalance)(),[c,m]=(0,n.useState)(!1);return(0,s.default)("modal",e=>{"add-credit-card"===e&&m(!0)}),i||e?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Note,{fill:!0,action:(0,t.jsx)(l.Button,{size:"small",onClick:()=>{m(!0)},children:"Add a Card"}),children:"Verify your identity by adding a credit card and unlock $5 in free credits."}),(0,t.jsx)(a.CreditCardModal,{isActive:c,paying:!1,onAbort:()=>{m(!1)},onContinue:()=>{u(),m(!1)}})]})}])},6004113,e=>{"use strict";var t=e.i(4205214),a=e.i(1568642),r=e.i(95767),l=e.i(9963234),o=e.i(57106);e.s(["OverviewHeader",0,function(){return(0,t.jsx)("div",{className:"w-full max-w-[var(--geist-page-width)] mx-auto mb-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center sm:gap-9",children:[(0,t.jsxs)("div",{className:"mb-2 space-y-1",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"AI Gateway Overview"}),(0,t.jsxs)("p",{className:"text-sm text-gray-900",children:["Seamlessly integrate AI models into your Vercel project."," ",(0,t.jsx)(o.Link,{className:"text-blue-900",external:!0,href:"/docs/ai-gateway",children:"Learn more"})]})]}),(0,t.jsxs)("nav",{className:"flex flex-row gap-2.5 shrink-0",children:[(0,t.jsx)(a.ViewBalanceAndPurchaseCreditsModal,{}),(0,t.jsx)(l.AiGatewayFlexCreditsPopover,{}),(0,t.jsx)(r.OptionsMenu,{})]})]})})}])}]);

//# debugId=8bde1c10-6ee4-daf6-4f3d-2992c2b157ce
//# sourceMappingURL=15f344481d9f649f.js.map