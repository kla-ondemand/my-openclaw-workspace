;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="8caff5a0-1506-e2c3-d3c8-2726065b6ef6")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4758698,4558711,e=>{"use strict";var t=e.i(4205214),a=e.i(8660982),r=e.i(57106),i=e.i(6621419),l=e.i(7719608);function n(e){let{teamSlug:a,chartKey:i,title:l,...n}=e,o=s(a,i);return(0,t.jsx)(r.ButtonLink,{"aria-label":`View details for ${l}`,...n,href:o})}function s(e,t){let[r]=(0,i.useUsageQueryState)();return(0,a.useMemo)(()=>{let a=(0,l.getSearchParamsFromState)(r);return`/${e}/~/usage/${t}${a.size>0?`?${a.toString()}`:""}`},[e,t,r])}e.s(["ChartLinkButton",0,n,"useChartLink",0,s],4758698);var o=e.i(3306538),c=e.i(6990755),u=e.i(6143247),d=e.i(4286681);function f(e){let{title:a,id:r}=e;return(0,t.jsxs)("h3",{className:"text-heading-16",children:[(0,t.jsx)("span",{className:d.default.headingScrollTarget,id:r}),a]})}var h=e.i(4038339),p=e.i(472163),m=e.i(4070420);function x(e){let r=(0,m.linkFromKeys)(e);return(0,t.jsx)(a.Suspense,{fallback:r?.includes("observability")?(0,t.jsx)(h.OpenObservability,{href:r,size:e.large?"medium":"small",type:"full"}):null,children:(0,t.jsx)(p.AsyncButton,{...e})})}var g=e.i(9722978);e.s(["UsageCard",0,function(e){let{children:a,className:r="",classNameHeader:i="",header:l,footer:n,style:s}=e;return(0,t.jsxs)("div",{className:(0,g.default)("flex flex-col items-stretch justify-start flex-initial",d.default.card),style:s,children:[l?(0,t.jsx)("div",{className:(0,g.default)("flex flex-col items-stretch justify-start flex-initial p-6",d.default.cardHeaderContainer,i),children:l}):null,(0,t.jsx)("div",{className:(0,g.default)("flex flex-col items-stretch justify-start flex-initial p-6",r),children:a}),n]})},"UsageCardHeader",0,function(e){let{title:a,chartKey:l,sectionKey:s,description:d,additionalDescription:h,learnMoreHref:p,accessory:g,teamSlug:y,badge:v}=e,j=`${s}-${l}`,[b]=(0,i.useUsageQueryState)(),w=!!(0,m.linkFromKeys)({sectionKey:s,chartKey:l,teamSlug:y,queryState:b});return(0,t.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,t.jsxs)("div",{className:(0,u.cn)("flex gap-5",w?"flex-col @md-page:flex-row":"flex-row"),children:[(0,t.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)(f,{id:j,title:a}),v?(0,t.jsx)(o.Badge,{variant:"amber-subtle",children:v}):null]}),d?(0,t.jsxs)("p",{className:"text-copy-14",children:[d," ",p?(0,t.jsx)(r.Link,{external:!0,href:p,target:"_blank",variant:"highlight",children:"Learn More"}):null]}):null,h]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(x,{chartKey:l,queryState:b,sectionKey:s,teamSlug:y}),(0,t.jsx)(n,{chartKey:j,shape:"square",size:"small",svgOnly:!0,prefetch:!1,teamSlug:y,title:a,type:"secondary",children:(0,t.jsx)(c.ArrowUpDiagonalScale,{})})]})]}),g?(0,t.jsx)("div",{className:"grid grid-flow-col items-center",children:g}):null]})}],4558711)},9995129,2913410,e=>{"use strict";var t=e.i(5723590),a=e.i(8660982),r=e.i(7917902),i=e.i(6621419),l=e.i(1683927),n=e.i(3585271);let s=n.defaultPresets["last-30-days"].start;async function o(e){let{queryState:{range:t,to:a,from:r,projectId:i},getBillingCycles:l}=e;if(t){let e=n.defaultPresets[t];if(e)return{projectId:i,from:e.start,to:e.end??n.endOfCurrentHour};if(["current-billing-cycle","previous-billing-cycle"].includes(t)){let e=await l(),a=e?.["current-billing-cycle"===t?"current":"previous"];return a?{from:new Date(a.start),to:new Date(a.end),projectId:i,billingCycles:e,isCurrentBillingCycle:"current-billing-cycle"===t}:{projectId:i,from:s,to:n.endOfCurrentHour,billingCycles:e}}}if(!t&&r&&a)return{from:r,to:a,projectId:i};let o=await l();return o?.current?{from:new Date(o.current.start),to:new Date(o.current.end),projectId:i,billingCycles:o,isCurrentBillingCycle:!0}:{projectId:i,from:s,to:n.endOfCurrentHour,billingCycles:o,isCurrentBillingCycle:!0}}function c(e,n){let[s,c]=(0,a.useState)(e),{account:u,isLoading:d}=(0,r.useAccount)(),f=!!u?.billing?.period,[h]=(0,i.useUsageQueryState)(),{data:p,isLoading:m}=(0,l.useBillingCycles)(void 0,e?{revalidateOnMount:!e.billingCycles,fallbackData:e.billingCycles}:void 0);return(0,a.useEffect)(()=>{if(d||f&&m&&s&&!s.billingCycles)return;let e=n??h.projectId;o({queryState:{...h,projectId:e},getBillingCycles:()=>Promise.resolve(f?p??s?.billingCycles:void 0)}).then(e=>{(0,t.default)(e,s)||c(e)})},[h,p,m,s?.billingCycles,f,d,n]),s}e.s(["useUsageFilters",0,c],9995129);var u=e.i(850302),d=e.i(5677444);let f=new Map,h=new Set;function p(e){return h.add(e),()=>{h.delete(e)}}function m(e,t){return e.teamSlug===t.teamSlug&&(0,u.unstable_serialize)({to:e.filters.to,from:e.filters.from,projectId:e.filters.projectId})===(0,u.unstable_serialize)({to:t.filters.to,from:t.filters.from,projectId:t.filters.projectId})}function x(e){let t={};for(let[a,r]of f)m(r.key,e)&&(t[a]=r);return t}e.s(["getChartDataCache",0,function(e,t){let a=f.get(e);if(a&&m(a.key,t))return a},"setChartDataCache",0,function(e,t){for(let a of(f.set(e,t),h))a()},"useChartCache",0,function(e,t){let[r,i]=(0,a.useState)(x(e)[t]);return(0,a.useEffect)(()=>p(()=>{i(x(e)[t])}),[t,e]),r},"useChartDataCache",0,function(e,t){let r=(0,d.useParams)(),i=c(e,t),l=r?.teamSlug??"",[n,s]=(0,a.useState)(x({filters:i,teamSlug:l}));return(0,a.useEffect)(()=>p(()=>{s(x({filters:i,teamSlug:l}))}),[i,l]),{isInitialFilters:(0,a.useMemo)(()=>m({filters:e,teamSlug:l},{filters:i,teamSlug:l}),[e,i,l]),cacheData:n,filters:i}}],2913410)},2908202,e=>{e.v({hideMeterInfoMobile:"index-module__u8DDsa__hideMeterInfoMobile",hideMeterInfoTablet:"index-module__u8DDsa__hideMeterInfoTablet",valuesContainer:"index-module__u8DDsa__valuesContainer"})},8515934,e=>{e.v({"auto-visibility":"styles-module__lFBDKW__auto-visibility",bar:"styles-module__lFBDKW__bar","bar-overlay":"styles-module__lFBDKW__bar-overlay","empty-chart":"styles-module__lFBDKW__empty-chart","empty-description":"styles-module__lFBDKW__empty-description",figure:"styles-module__lFBDKW__figure"})},1075510,e=>{e.v({locked:"index-module__Y4EwDa__locked",tooltip:"index-module__Y4EwDa__tooltip"})},1530400,e=>{e.v({detailViewButton:"usage-tooltip-module__ZmBylG__detailViewButton",dimensionsContainer:"usage-tooltip-module__ZmBylG__dimensionsContainer",link:"usage-tooltip-module__ZmBylG__link",tooltipDate:"usage-tooltip-module__ZmBylG__tooltipDate",tooltipDateWarning:"usage-tooltip-module__ZmBylG__tooltipDateWarning"})},5605106,e=>{e.v({container:"chart-legend-module___0dxEa__container",hasMore:"chart-legend-module___0dxEa__hasMore",legendRow:"chart-legend-module___0dxEa__legendRow",viewAll:"chart-legend-module___0dxEa__viewAll"})},4588576,e=>{e.v({"animated-container":"styles-module__-hP3BW__animated-container",disabled:"styles-module__-hP3BW__disabled",open:"styles-module__-hP3BW__open",row:"styles-module__-hP3BW__row",rowHeader:"styles-module__-hP3BW__rowHeader",skeleton:"styles-module__-hP3BW__skeleton","src-images-container":"styles-module__-hP3BW__src-images-container"})},5574083,e=>{e.v({expanded:"paths-module__z5rLEG__expanded",filtersDescription:"paths-module__z5rLEG__filtersDescription",noData:"paths-module__z5rLEG__noData",odd:"paths-module__z5rLEG__odd",path:"paths-module__z5rLEG__path",pathsContainer:"paths-module__z5rLEG__pathsContainer",pathsRow:"paths-module__z5rLEG__pathsRow",rowContainer:"paths-module__z5rLEG__rowContainer",rowsContainer:"paths-module__z5rLEG__rowsContainer",switchControl:"paths-module__z5rLEG__switchControl",textMatch:"paths-module__z5rLEG__textMatch",value:"paths-module__z5rLEG__value",viewAll:"paths-module__z5rLEG__viewAll"})},9939117,360858,e=>{"use strict";var t=e.i(4205214),a=e.i(5255926),r=e.i(8835183),i=e.i(8522580),l=e.i(8660982),n=e.i(199192),s=e.i(9722978),o=e.i(9307292),c=e.i(57106),u=e.i(6774523),d=e.i(5677444),f=e.i(1947138),h=e.i(4004502),p=e.i(8515934);function m(e){let{title:a,description:r,children:i,className:l=""}=e;return(0,t.jsx)("div",{className:(0,s.clsx)(p.default["empty-chart"],l),"data-testid":(0,h.tid)("usage","metric","empty-state"),children:i||(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-16 font-medium",children:a||"No Data"}),(0,t.jsx)("p",{className:`text-copy-16 ${p.default["empty-description"]}`,children:r||"There's no data available for your selection."})]})})}e.s(["Empty",0,m],360858);var x=e.i(7087273),g=e.i(8923565),y=e.i(5574083);function v(e){let{filters:a=[],selectedFilter:r,onFilterChange:i,subFilters:n=[],selectedSubFilter:o,onSubFilterChange:c,filtersClassName:u,children:d}=e,f=a.find(e=>e.value===r),h=f?{text:f.description,icon:f.icon}:void 0;return a.length?(0,t.jsxs)("div",{className:(0,s.default)("flex flex-col items-stretch justify-start gap-4 flex-initial pb-6",u),children:[(0,t.jsx)("div",{style:{margin:-4},children:(0,t.jsx)(x.Scroller,{overflow:"x",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-1",style:{padding:4},children:[(0,t.jsx)(g.Switch,{children:a.map(e=>(0,t.jsx)(g.Switch.Control,{checked:e.value===r,label:e.label,onChange:()=>(0,l.startTransition)(()=>i?.(e.value)),value:e.value},e.value))}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[d,n.length?(0,t.jsx)(g.Switch,{children:n.map(e=>(0,t.jsx)(g.Switch.Control,{checked:e.value===o,className:y.default.switchControl,label:e.label,onChange:()=>(0,l.startTransition)(()=>c?.(e.value)),value:e.value},e.value))}):null]})]})})}),h?(0,t.jsxs)("div",{className:(0,s.default)("flex flex-row items-center justify-start gap-1.5 flex-initial px-1",y.default.filtersDescription),children:[h.icon,(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:h.text})]}):null]}):null}let j=(0,l.memo)(function(e){let{row:a,search:r,formatter:i,getRowHref:n}=e,o=b(a),d=(0,l.useMemo)(()=>{if(!r||"."===r)return[o];let e=RegExp(`(${r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return o.split(e)},[o,r]),f=(0,l.useMemo)(()=>n?n(a):void 0,[n,a]),h=(0,t.jsxs)("div",{className:(0,s.clsx)("flex flex-row items-center justify-start gap-2 flex-initial px-2",y.default.pathsRow,{[String(y.default.rowContainer)]:!f,[String(y.default.odd)]:(a.index??0)%2}),style:{"--row-percent":a.percentage},children:[(0,t.jsx)("p",{className:`text-copy-14 truncate whitespace-nowrap ${y.default.path}`,title:o,children:d.map((e,a)=>(0,t.jsx)("span",{className:a%2?y.default.textMatch:void 0,children:e},(0,u.getUnsafeKey)(a,e)))}),(0,t.jsx)("p",{className:`text-copy-14 text-right ${y.default.value}`,style:{minWidth:120},children:i?i(a.value,"display"):a.value})]});return f?(0,t.jsx)(c.Link,{className:y.default.rowContainer,href:f,prefetch:!1,target:"_blank",children:h}):h});function b(e){return e.host?`${e.host}${!e.host||e.path.startsWith("/")?"":"/"}${e.path}`:e.path}function w(e){let{search:a,setSearch:i}=e,[n,s,{currentValue:o}]=(0,f.useDebounceState)(a,100);return(0,l.useEffect)(()=>{(0,l.startTransition)(()=>i(n))},[i,n]),(0,t.jsx)(r.SearchInput,{onChange:e=>s(e.target.value),placeholder:"Filter Top Paths",value:o})}e.s(["PathsChart",0,function(e){let{data:r,formatter:i,getRowHref:u,showSkeleton:d,expanded:f,viewAllHref:h,footerNote:p,noDataMessage:x,...g}=e,[_,k]=(0,l.useState)(""),{rows:S=[],hasMore:N}=(0,l.useMemo)(()=>{if(!f)return{rows:r?.slice(0,6).map((e,t)=>({...e,index:t,parts:[b(e)]})),hasMore:r?.length&&r.length>6};let e=_.toLowerCase(),t=_&&"."!==_?r?.filter(t=>b(t).toLowerCase().includes(e)):r;return{rows:t?.map((e,t)=>({...e,index:t})),hasMore:!1}},[f,r,_]),C=r?.length&&_&&x?(0,t.jsx)(m,{className:y.default.noData,description:x(_),title:"No Results Found"}):(0,t.jsx)(m,{className:y.default.noData});return(0,t.jsxs)("div",{"data-expanded":f?"":void 0,className:(0,s.clsx)("flex flex-col items-stretch justify-start flex-initial",y.default.pathsContainer),children:[(0,t.jsx)(v,{...g,children:f?(0,t.jsx)(w,{search:_,setSearch:k}):null}),d?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial px-1.5",children:Array(f?50:6).fill(null).map((e,r)=>(0,t.jsx)(a.Skeleton,{boxHeight:40,height:28,vcenter:!0,width:"100%"},r))}):(0,t.jsxs)("div",{"data-has-more":N?"":void 0,className:(0,s.clsx)("flex flex-col items-stretch justify-start flex-initial",y.default.rowsContainer,{[String(y.default.expanded)]:f}),children:[f?(0,t.jsx)(o.Virtuoso,{data:S,itemContent:(e,a)=>(0,t.jsx)(j,{formatter:i,getRowHref:u,row:a,search:_}),overscan:100,useWindowScroll:!0}):S.map(e=>(0,t.jsx)(j,{formatter:i,getRowHref:u,row:e,search:_},b(e))),S.length?null:C]}),f&&p&&!d&&S.length?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial pt-4",children:"string"==typeof p?(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:p}):p}):null,N&&h&&!d?(0,t.jsx)(c.ButtonLink,{className:y.default.viewAll,href:h,type:"secondary",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,t.jsx)("p",{className:"text-label-12",children:"View All"}),(0,t.jsx)(n.ChevronRightSmall,{})]})}):null]})},"PathsMigratedToObservability",0,function(){let e=(0,d.useParams)();return(0,t.jsxs)(i.Note,{type:"secondary",children:["Top paths have moved to"," ",(0,t.jsx)(c.Link,{href:`/${e?.teamSlug}/~/observability/edge-requests`,children:"Observability"})," ","inside each project."]})}],9939117)},6990379,6527262,e=>{"use strict";var t=e.i(8660982),a=e.i(5677444),r=e.i(850302),i=e.i(4758698),l=e.i(4205214),n=e.i(5338940),s=e.i(57106),o=e.i(1683927),c=e.i(1649649),u=e.i(2523660),d=e.i(3070041),f=e.i(9722978),h=e.i(40818),p=e.i(9307292);e.i(2243470);var m=e.i(696150),x=e.i(1230902),g=e.i(1752298),y=e.i(2560270),v=e.i(7807066),j=e.i(5255926),b=e.i(3306538),w=e.i(8530316),_=e.i(4588576);function k(e){let{imageOptimizations:a,selectedGroup:r,query:i,isLoading:n,className:s}=e,[o,c]=(0,t.useState)(r),[k,S]=(0,t.useState)(r);(0,t.useEffect)(()=>{c(r)},[r]);let[N,C]=(0,t.useState)({}),[D,O]=[i.startDatetime,i.endDatetime].map(Number);(0,t.useEffect)(()=>{C({})},[i.projectId,D,O,i.skip]);let{groupCounts:T,groups:M,offsets:P}=(0,t.useMemo)(()=>{let e={offsets:[],groups:[],groupCounts:[]};if(!a)return e;for(let{count:t,timestamp:r}of a){let a=e.groups.indexOf(r);-1===a&&(a=e.groups.push(r)-1,e.offsets[a]=e.groupCounts.reduce((e,t)=>e+t,0)),e.groupCounts[a]=(e.groupCounts[a]||0)+t}return e},[a]),[I,E]=(0,t.useState)(!1),[A,{height:L}]=(0,g.default)(),F=(0,d.useSpring)({height:L||54,config:{mass:.15,tension:400,friction:30}}),B=(0,t.useRef)(null);null!==o&&B.current?.scrollToIndex({groupIndex:o,index:0,behavior:"smooth"});let R=(0,t.useMemo)(()=>{let e=[];for(let t=Math.max((k??1)-1,0),a=0,r=0;t<M.length&&null!==k;a+=T[t++],r++){let i=M[t].split(" ")[0].split("T")[0];if(r<3||a<=100)i in N||e.push(i);else break}return e},[T,N,M,k]),$=(0,w.useUsageImageOptimizations)({...i,buckets:R});(0,t.useEffect)(()=>{if($.data){if("error"in $.data||0===$.data.data.length)return;let e={};for(let{timestamp:t,sourceImages:a}of $.data.data)e[t.split(" ")[0].split("T")[0]]=a||[];C(t=>({...t,...e}))}},[$.data]);let z=n||$.data&&"error"in $.data||!a?.length;(0,t.useEffect)(()=>{null===o||z||E(!0)},[o,z]);let U=(0,t.useCallback)(e=>{e!==o&&c(null),S(e)},[o]);return(0,l.jsx)(u.animated.div,{className:(0,f.clsx)(s,_.default["animated-container"],{[_.default.open]:I}),style:F,children:(0,l.jsxs)("details",{className:(0,f.clsx)(_.default["src-images-container"],{[_.default.open]:I,[_.default.disabled]:z}),onClick:e=>{e.preventDefault(),!z&&(I||E(!0))},open:I,ref:A,children:[(0,l.jsx)("summary",{onClick:e=>{e.preventDefault(),z||(c(null),E(!1))},children:(0,l.jsxs)("div",{children:[I?(0,l.jsx)(y.ChevronDown,{color:"gray-700",size:20}):(0,l.jsx)(v.ChevronRight,{color:"gray-700",size:20}),(0,l.jsx)("span",{children:"View Source Images"})]})}),(0,l.jsx)("div",{children:(0,l.jsx)(p.GroupedVirtuoso,{groupContent:function(e){let t=M[e],a=m.DateTime.fromISO(t.endsWith("Z")?t:`${t.split(" ").join("T")}.000Z`).toJSDate();return(0,l.jsxs)("div",{className:_.default.rowHeader,children:[`${(0,x.format)(a,"MMM d, yyyy")}`,(0,l.jsxs)(b.Badge,{size:"sm",variant:"gray-subtle",children:[T[e].toLocaleString()," Images Optimized"]})]})},groupCounts:T,itemContent:function(e,t){let a=M[t].split(" ")[0].split("T")[0],r=P[t],i=N[a]?.[e-r];return i?(0,l.jsx)("div",{className:_.default.row,children:i}):$.isLoading?(0,l.jsx)("div",{className:_.default.row,children:(0,l.jsx)(j.Skeleton,{width:"100%"})}):(0,l.jsx)("div",{className:_.default.row,children:"Unknown"})},rangeChanged:(0,t.useMemo)(()=>(0,h.debounce)(e=>{let{startIndex:t}=e,a=P.length;for(;a--&&!(t>P[a]););U(a+1)},100),[P,U]),ref:B,style:{height:400}})})]})})}var S=e.i(4286681),N=e.i(6565161),C=e.i(4743539),D=e.i(8735244),O=e.i(1853611),T=e.i(7780974),M=e.i(9071035);let P={bandwidth:"sum(bandwidth_total)",execution_time:"sum(serverless_function_execution)",invocations:"sum(requests)",requests:"sum(requests)"};function I(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t?`/${t}/~/monitoring`:"/dashboard/monitoring";if(!e)return r;let{targetPath:i,host:l,range:n,pathKey:s}=e,o=P[e.sortKey],c="request_path"===s?"request_path":"source_path",u=a?`match(${c}, '${i}')`:`${c} = '${i}'`;void 0!==l&&(u=`${u} AND host = '${l}'`),void 0!==e.pathType&&(u=`${u} AND path_type = '${e.pathType}'`),void 0!==e.status&&(u=`${u} AND status = '${e.status}'`);let d="",f="";if(n){let e=n.startDate.getTime(),t=Math.min(n.endDate.getTime(),Date.now())-n.startDate.getTime(),a=(0,M.getDefaultGranularity)(t);d=`&startTime=${e}&deltaTime=${t}`,f=`&g=${a}`}return`${r}?visualize=${encodeURIComponent(o)}&where=${encodeURIComponent(u)}${d}${f}`}function E(e,t,a,r,i){return[{teamSlug:e,batchKey:a,filters:{to:t.to,from:t.from,projectId:t.projectId},isPage:r,options:i},"usage-metrics-action"]}var A=e.i(2913410),L=e.i(682502),F=e.i(6939507),B=e.i(5433449);let R=[{value:"bandwidth",label:"Bandwidth",description:"Total incoming and outgoing bandwidth in GB from any unique path",icon:(0,l.jsx)(L.ArrowCrossed,{})},{value:"execution_time",label:"Execution",description:"Execution in GB-Hrs from serverless functions",icon:(0,l.jsx)(F.Lambda,{})},{value:"invocations",label:"Invocations",description:"Number of requests to serverless, ISR, and Edge functions",icon:(0,l.jsx)(F.Lambda,{})},{value:"requests",label:"Requests",description:"Number of requests to any unique path",icon:(0,l.jsx)(B.FileText,{})}],$=[{label:"Request",value:"request_path"},{label:"Source",value:"target_path"}],z={bandwidth:"size",execution_time:"computingTime",invocations:"count",requests:"count"},U=["bandwidth","requests","invocations","execution_time"];function G(e){let{filters:n,chartKey:o,batchKey:c,isPage:u,getData:d,initialData:f,cacheOnly:h}=e,p=(0,a.useParams)(),[m,x]=(0,t.useState)("bandwidth"),[g,y]=(0,t.useState)("request_path"),[v,j]=(0,t.useState)(!1),b=p?.teamSlug??"";(0,t.useEffect)(()=>{j(!0)},[]);let w="bandwidth"===m&&"request_path"===g,_=E(b,n,c,u,{usageType:m,pathType:g}),{data:k,isValidating:S}=(0,r.default)(h?null:_,async e=>{let[t]=e,a=await d(t);return await a.promise},{refreshInterval:0,revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:f.error?.code==="timeout",fallback:f.error?.code==="timeout"?{}:{[(0,r.unstable_serialize)(E(b,f.filters,c,u,{usageType:"bandwidth",pathType:"request_path"}))]:{[o]:f}}}),M=k?.[o]?.error,P=k?.[o]?.data?.data??[],L=!!P.length,F=(0,A.useChartCache)({filters:n,teamSlug:b},o),B=F?.data,G=!!(w&&!S&&!M&&k);(0,t.useEffect)(()=>{G&&b&&(0,A.setChartDataCache)(o,{key:{..._[0]},data:u?void 0:P,isValidating:!1})},[G,o,u,(0,r.unstable_serialize)(_[0]),p?.teamSlug]),(0,t.useEffect)(()=>{if(!L)return;let e=async e=>{let t=E(b,n,c,u,{usageType:m,pathType:g,...e});if(!C.cache.get((0,r.unstable_serialize)(t)))return(0,N.preload)(t,async e=>{let[t]=e,a=await d(t);return await a.promise})};for(let t of(e({pathType:"target_path"===g?"request_path":"target_path"}),U))if(t!==m){e({usageType:t});break}},[m,g,L]);let W=(0,t.useCallback)(e=>I({sortKey:m,targetPath:e.path,host:e.host,pathKey:"target_path"===g?"source_path":g,range:{startDate:n.from,endDate:n.to}},p?.teamSlug),[p?.teamSlug,g,m,n.from,n.to]),H=(0,i.useChartLink)(p?.teamSlug??"",o),K=(0,t.useCallback)(e=>{let t=I({...function(e){try{if(!e.includes("."))return{targetPath:e};let t=new URL(e.startsWith("http")?e:`https://${e}`);return{host:t.host,targetPath:t.pathname}}catch{return{targetPath:e}}}(e),sortKey:m,pathKey:"target_path"===g?"source_path":g,range:{startDate:n.from,endDate:n.to}},p?.teamSlug,!0);return(0,l.jsxs)(l.Fragment,{children:["Your search did not match any paths in your Top 1,000 paths. You can look at all your paths with"," ",(0,l.jsx)(s.Link,{href:t,target:"_blank",variant:"highlight",children:"Monitoring"}),"."]})},[p?.teamSlug,g,m,n.from,n.to]);if(!h||B)return{error:M,type:"paths",formatter:z[m],data:h?B:P,filters:R,selectedFilter:m,onFilterChange:e=>{h||(x(e),O.analytics.track(T.VercelActivityAction.UsageTopPathsFilterChange,{plan:p?.plan,planIteration:p?.planIteration,usageType:e,pathType:g},{send_to:{data_warehouse_legacy:!0}}))},subFilters:$,selectedSubFilter:g,onSubFilterChange:e=>{h||(y(e),O.analytics.track(T.VercelActivityAction.UsageTopPathsFilterChange,{plan:p?.plan,planIteration:p?.planIteration,usageType:m,pathType:e},{send_to:{data_warehouse_legacy:!0}}))},getRowHref:W,showSkeleton:S||!v,viewAllHref:H,footerNote:h?(0,l.jsx)("div",{className:"flex flex-row items-stretch justify-center flex-initial",children:(0,l.jsx)(D.Spinner,{})}):"Showing the top 1,000 paths within the selected time range",noDataMessage:K}}function W(e){let{props:a,filters:r}=e,[i,n]=(0,t.useState)(null);if(!a||"bar"!==a.type)return;let s=a.data?.map(e=>({timestamp:new Date(e.date).toISOString(),count:e.sum,projectId:"",projectName:""}));return{...a,onBarSelected:e=>{let{bar:t}=e;n(t.index)},footer:(0,l.jsx)(k,{className:S.default.imageOptimizationsTable,imageOptimizations:s,isLoading:!1,query:{startDatetime:r.from,endDatetime:r.to,projectId:r.projectId},selectedGroup:i})}}function H(e){let{props:a,filters:r,chartKey:i}=e,l="edge-functions-cpu-time"===i?"edge-function":"middleware",[n,s]=(0,t.useState)(!1),{data:c}=(0,o.useUsageGroupByProjectMetrics)({type:"edge_group_by_project",edgeInvocationType:l,start:r.from,end:r.to,skip:!n||!l});return a?.type==="line"?{...a,groupByProjectData:c?.data.workerExecutionAvg,setGroupByProject:s}:void 0}function K(e){let{props:t,filters:a}=e,r=a.projectId?"When filtered by project local artifact usage is not attributed.":void 0;return t?{...t,legendNote:r}:void 0}function q(e){let{props:a}=e,{isPlus:r,plan:i}=(0,c.useIsWebAnalyticsBilling)(),{team:o}=(0,n.useTeam)(),u=(0,t.useMemo)(()=>{if("pro"!==i)return;let e=o?.slug?`/${o.slug}/~/settings/billing#web-analytics`:"/account/billing#web-analytics";return r?(0,l.jsxs)("p",{className:"text-copy-14",children:["You have Web Analytics Plus enabled for your team."," ",(0,l.jsx)(s.Link,{href:"/docs/analytics/limits-and-pricing",variant:"highlight",children:"Manage in Billing"}),"."]}):(0,l.jsxs)("p",{className:"text-copy-14",children:["Enable the"," ",(0,l.jsx)(s.Link,{href:e,variant:"highlight",children:"Web Analytics Plus Add-on"})," ","to unlock 500k included events per month."]})},[r,i,o?.slug]);return a?{...a,additionalDescription:u}:void 0}var V=e.i(9129382);function Y(e){let{chartKey:l,batchKey:n,filters:s,initialData:o,getData:c,noRevalidate:u,cacheOnly:d,isPage:f}=e,h=(0,a.useParams)(),{hook:p,noSWR:m}=(0,t.useMemo)(()=>"image-optimization-source-image-optimizations"===l?{hook:W}:"networking-top-paths"===l?{hook:G,noSWR:!0}:"observability-web-analytics"===l?{hook:q}:"edge-functions-cpu-time"===l||"edge-middleware-cpu-time"===l?{hook:H}:l.startsWith("artifacts-")?{hook:K}:{hook:e=>{let{props:t}=e;return t}},[l]),x=h?.teamSlug??"",g=E(x,s,n,f),{data:y,isValidating:v}=(0,r.default)(m||d?null:g,async e=>{let[t]=e;if(u)return{};let a=await c(t);return await a.promise},{refreshInterval:0,revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:o.error?.code==="timeout",revalidateIfStale:!1,fallback:o.error?.code==="timeout"?{}:{[(0,r.unstable_serialize)(E(x,o.filters,n,f))]:{[l]:o}}}),{data:j,meterData:b,error:w}=y?.[l]??o,_=p({filters:s,props:j,chartKey:l,batchKey:n,getData:c,cacheOnly:d,initialData:o,isPage:f}),k=m?_?.error:w,S=(0,i.useChartLink)(x,l),N=(0,t.useMemo)(()=>_?{..._,viewAllHref:S,formatter:V.formatters[_.formatter],selectedProjectId:s.projectId}:void 0,[s.projectId,_,S]),C=h?.teamSlug?(0,A.getChartDataCache)(l,{...g[0]})?.data:void 0;return(0,t.useEffect)(()=>{!u&&!f&&!d&&h?.teamSlug&&(0,A.setChartDataCache)(l,{key:{...g[0]},data:N,meterData:b,isValidating:v,error:k})},[u,l,N,d,f,g,v,b,k,h?.teamSlug]),{meterData:b,error:k,props:d&&!u?C:N,isValidating:v,footer:_?.footer??null}}e.s(["useChartData",0,Y],6990379);var X=e.i(2689376),Z=e.i(7917902),Q=e.i(9318197),J=e.i(5468328),ee=e.i(2466450),et=e.i(8826496),ea=e.i(2908202);function er(e){let{used:t,increment:a,limit:r,hideOnMobile:i=!0,className:n,formatter:o,value:c,buttonCopy:u,buttonHref:d,pricePerIncrement:h,currency:p,nextTier:m,hidePrices:x}=e,{isActive:g}=(0,et.useUpgradeContext)(),y=r??0,v=g&&m?m:y;return(0,l.jsx)("div",{className:(0,f.clsx)("flex flex-row items-stretch justify-start flex-initial",{[ea.default.hideMeterInfoMobile]:i},n),children:(0,l.jsx)(J.Tooltip,{className:(0,f.clsx)(ea.default.hideMeterInfoMobile,"tooltip-container"),position:"bottom",text:(0,l.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,l.jsx)("p",{className:"text-copy-14 text-gray-900",children:(0,l.jsx)(el,{currency:p,formatter:o,hidePrices:x,increment:a,limit:y,pricePerIncrement:h,value:c})}),(0,l.jsx)(Q.Spacer,{y:.5}),(0,l.jsx)(s.ButtonLink,{href:d??"/docs/limits",type:"secondary",children:u??"View Docs"})]}),wrap:!1,children:(0,l.jsx)(X.Gauge,{colors:{primary:"var(--ds-blue-700)"},size:"tiny",value:t/v*100})})})}function ei(e){let{value:t,formatter:a,limit:r,nextTier:i,hideOnTablet:n=!0,hideLimit:s=!1}=e,{isActive:o}=(0,et.useUpgradeContext)(),c=i&&o;return(0,l.jsxs)("p",{className:`text-copy-14 text-gray-900 ${(0,f.clsx)("meter-values-container",ea.default.valuesContainer,{[ea.default.hideMeterInfoTablet]:n})}`,children:[a(t,"display"),s?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:" / "}),(0,l.jsxs)("span",{className:"relative",children:[(0,l.jsx)("span",{className:"relative transition-colors",style:{color:c?"var(--ds-gray-700)":void 0},children:r?a(r,"display"):"-"}),(0,l.jsx)("span",{className:"absolute inset-x-0 top-[calc(50%-1px)] block h-[2px] bg-gray-500 transition-transform duration-500",style:{transformOrigin:"left",transform:c?"scaleX(1)":"scaleX(0)"}})]}),i?(0,l.jsxs)("span",{"aria-hidden":!c,className:"ml-2 inline-flex items-center gap-1.5 text-blue-900 transition-all duration-500",style:{transform:c?"translateX(0)":"translateX(8px)",opacity:+!!c},children:[a(i,"display"),(0,l.jsx)(b.Badge,{size:"sm",variant:"blue-subtle",children:"Pro"})]}):null]})]})}function el(e){let{limit:t,value:a,formatter:r,increment:i,pricePerIncrement:n,currency:s,hidePrices:o}=e,c=null!==i&&null!==n&&!o;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(l.Fragment,{children:["You have used"," ",t?Math.floor(a/t*100).toLocaleString():"-","% of the ",t?r(t,"long"):"-"," included in your plan."]}),c?(0,l.jsxs)(l.Fragment,{children:[" ","Once this limit has been reached, you will be charged"," ",(0,ee.formatCurrency)(n,s)," per additional"," ",r(i,"long"),"."]}):null]})}var en=e.i(9995129),es=e.i(4558711),eo=e.i(4496450);function ec(e){let{children:t,card:a,sectionKey:r,accessory:i,teamSlug:n,additionalDescription:s,planIteration:o,plan:c,footer:u}=e,d=a.isNew&&o&&(0,eo.isLegacyPlanIteration)(o)&&"hobby"!==c,f=["description"in a?a.description:void 0,d?"This usage metric will soon be part of your plan.":void 0].filter(Boolean).join(" ");return(0,l.jsx)(es.UsageCard,{footer:u,header:(0,l.jsx)(es.UsageCardHeader,{accessory:i,additionalDescription:s,badge:d?"Coming Soon":void 0,chartKey:a.key,description:f,learnMoreHref:a.learnMoreHref,sectionKey:r,teamSlug:n,title:a.title}),children:t},a.key)}var eu=e.i(8264458);function ed(){return(ed=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function ef(e){var a=e.className,r=e.innerRef,i=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["className","innerRef"]);return t.default.createElement("rect",ed({ref:r,className:(0,eu.default)("visx-bar",a)},i))}var eh=e.i(1377254),ep=e.i(2304153);function em(){return(em=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function ex(e){var a=e.top,r=e.left,i=e.transform,l=e.className,n=e.children,s=e.innerRef,o=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["top","left","transform","className","children","innerRef"]);return t.default.createElement("g",em({ref:s,className:(0,eu.default)("visx-group",l),transform:i||"translate("+(void 0===r?0:r)+", "+(void 0===a?0:a)+")"},o),n)}function eg(e){return null==e?void 0:e[0]}function ey(e){return null==e?void 0:e[1]}ex.propTypes={top:ep.default.number,left:ep.default.number,transform:ep.default.string,className:ep.default.string,children:ep.default.node,innerRef:ep.default.oneOfType([ep.default.string,ep.default.func,ep.default.object])};var ev=e.i(6469467),ej=e.i(7448903),eb=e.i(2004754),ew=e.i(1219720),e_=e.i(9824722),ek={ascending:ev.stackOrderAscending,descending:ej.stackOrderDescending,insideout:eb.stackOrderInsideOut,none:ew.stackOrderNone,reverse:e_.stackOrderReverse};Object.keys(ek);var eS=e.i(1089043),eN=e.i(1360520),eC=e.i(3729955),eD=e.i(9422769),eO=e.i(5141407),eT={expand:eS.stackOffsetExpand,diverging:eN.stackOffsetDiverging,none:eC.stackOffsetNone,silhouette:eD.stackOffsetSilhouette,wiggle:eO.stackOffsetWiggle};function eM(){return(eM=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function eP(e){var a,r=e.data,i=e.className,l=e.top,n=e.left,s=e.x,o=e.y0,c=void 0===o?eg:o,u=e.y1,d=void 0===u?ey:u,f=e.xScale,h=e.yScale,p=e.color,m=e.keys,x=e.value,g=e.order,y=e.offset,v=e.children,j=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["data","className","top","left","x","y0","y1","xScale","yScale","color","keys","value","order","offset","children"]),b=(0,eh.stack)();m&&b.keys(m),x&&(a=b.value,a(x)),g&&b.order(g&&ek[g]||ek.none),y&&b.offset(y&&eT[y]||eT.none);var w=b(r),_=function(e){if("bandwidth"in e)return e.bandwidth();var t=e.range(),a=e.domain();return Math.abs(t[t.length-1]-t[0])/a.length}(f),k=w.map(function(e,t){var a=e.key;return{index:t,key:a,bars:e.map(function(t,r){var i=(h(c(t))||0)-(h(d(t))||0),l=h(d(t)),n="bandwidth"in f?f(s(t.data)):Math.max((f(s(t.data))||0)-_/2);return{bar:t,key:a,index:r,height:i,width:_,x:n||0,y:l||0,color:p(e.key,r)}})}});return v?t.default.createElement(t.default.Fragment,null,v(k)):t.default.createElement(ex,{className:(0,eu.default)("visx-bar-stack",i),top:l,left:n},k.map(function(e){return e.bars.map(function(a){return t.default.createElement(ef,eM({key:"bar-stack-"+e.index+"-"+a.index,x:a.x,y:a.y,height:a.height,width:a.width,fill:a.color},j))})}))}function eI(){return(eI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function eE(e){var a=e.from,r=void 0===a?{x:0,y:0}:a,i=e.to,l=void 0===i?{x:1,y:1}:i,n=e.fill,s=e.className,o=e.innerRef,c=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["from","to","fill","className","innerRef"]);return t.default.createElement("line",eI({ref:o,className:(0,eu.default)("visx-line",s),x1:r.x,y1:r.y,x2:l.x,y2:l.y,fill:void 0===n?"transparent":n},c))}Object.keys(eT);var eA=e.i(6854195);function eL(){return(eL=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function eF(e){var a,r,i,l,n,s,o,c,u=e.children,d=e.data,f=e.x,h=e.y,p=e.fill,m=e.className,x=e.curve,g=e.innerRef,y=e.defined,v=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["children","data","x","y","fill","className","curve","innerRef","defined"]),j=(l=(i={x:f,y:h,defined:void 0===y?function(){return!0}:y,curve:x}).x,n=i.y,s=i.defined,o=i.curve,c=(0,eA.line)(),l&&(a=c.x,a(l)),n&&(r=c.y,r(n)),s&&c.defined(s),o&&c.curve(o),c);return u?t.default.createElement(t.default.Fragment,null,u({path:j})):t.default.createElement("path",eL({ref:g,className:(0,eu.default)("visx-linepath",m),d:j(void 0===d?[]:d)||"",fill:void 0===p?"transparent":p},v))}var eB=e.i(9310550),eR=e.i(8587628),e$=e.i(8861835),ez=e.i(4573068),eU=e.i(8545185),eG=e.i(5158601),eW=e.i(8125826),eH=e.i(4405391),eK=e.i(6493958),eq=e.i(360858),eV=e.i(8515934);function eY(){return(eY=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var eX=e.i(2504781),eZ=e.i(1075510);let eQ=e=>{let{left:t,containerWidth:a,children:r}=e,i="-50%",n="0",s="0";if(void 0!==t){let{innerWidth:e}=window,r=t+(e<741?-150:0)+(e-a)/2,l=e-r-300;r<0&&(i=-r/3-50+"%",n=`calc(${r/3+50}% - 8px)`,s="unset"),l<0&&(i=l/3-50+"%",n="unset",s=`calc(${l/3+50}% - 8px)`)}let o=(0,d.useSpring)({left:t,bottom:0,translateX:i,config:{mass:.05,tension:400,friction:30}});return(0,l.jsx)(u.animated.div,{className:eZ.default.tooltip,style:{...o,"--arrow-left":n,"--arrow-right":s},children:r})};var eJ=e.i(1530400);let e0=(0,t.memo)(function(e){let{isOpen:t,width:a,left:r,data:i,hide:n,date:s,openDetailModal:o,dataAvailableSince:c}=e;return t&&i?(0,l.jsx)(eQ,{containerWidth:a,left:r,children:(0,l.jsxs)("div",{className:(0,f.default)("flex flex-col items-center justify-start flex-initial",eJ.default.dimensionsContainer),children:[(0,l.jsx)("div",{className:eJ.default.tooltipDate,children:s}),c&&new Date(i.data.date)<new Date(c)?(0,l.jsxs)("div",{className:eJ.default.tooltipDateWarning,children:["Started collecting on"," ",(0,x.format)(new Date(c),"MMM d, y HH:mm")]}):null,o&&i.data.resources?(0,l.jsx)(eX.Button,{className:eJ.default.detailViewButton,onClick:()=>{n(),o()},size:"small",type:"secondary",children:"Detail View"}):null]})}):null});function e1(e){var a,r,i,l,n,s;let{from:o,to:c,granularity:u,showPercentage:d=!1}=e,{tooltipOpen:f,tooltipLeft:h,tooltipData:p,hideTooltip:m,showTooltip:x}=(r=(a=(0,t.useState)(eY({tooltipOpen:!1},void 0)))[0],i=a[1],l=(0,t.useCallback)(function(e){var t=e.tooltipOpen,a=e.tooltipLeft,r=e.tooltipTop,l=e.tooltipData;return i(function(e){return eY({},e,{tooltipOpen:t,tooltipLeft:a,tooltipTop:r,tooltipData:l})})},[]),n=(0,t.useCallback)(function(e){return l({tooltipOpen:!0,tooltipLeft:e.tooltipLeft,tooltipTop:e.tooltipTop,tooltipData:e.tooltipData})},[l]),s=(0,t.useCallback)(function(){return l({tooltipOpen:!1,tooltipLeft:void 0,tooltipTop:void 0,tooltipData:void 0})},[l]),{tooltipOpen:r.tooltipOpen,tooltipLeft:r.tooltipLeft,tooltipTop:r.tooltipTop,tooltipData:r.tooltipData,updateTooltip:l,showTooltip:n,hideTooltip:s}),g=!!(p?.data.resources&&p.data.resources.length>0),y=(0,t.useRef)(null),v=(0,t.useCallback)(()=>{y.current=window.setTimeout(()=>{m()},200)},[m]),j=(0,t.useCallback)(()=>{y.current&&(clearTimeout(y.current),y.current=null)},[]),b=(0,t.useMemo)(()=>{if(!p?.data)return;let{data:e,value:t}=p.data;return Object.fromEntries(Object.entries(e).map(e=>{let[a,r]=e,i=r||0;return d&&(i={total:i,percent:(0,V.formatPercentage)(i,t)}),[a,i]}))},[p,d]);return{tooltipData:p,tooltipDimension:b,showTooltip:x,hideTooltip:v,cancelHideTooltip:j,usageTooltipProps:{isOpen:f,left:h,data:p,hide:v,shouldShowBreakdown:g,date:p&&(0,V.formatFullDateWithRange)(p.data.date,u,o,c)}}}var e2=e.i(6621419);function e5(e){let{defaultGroupingType:a,expanded:r=!1}=e,[{view:i},l]=(0,e2.useUsageQueryState)(),[n,s]=(0,t.useState)(i||a);return((0,t.useEffect)(()=>{r&&!i&&l({view:a})},[r]),r)?{groupingType:i||a,setGroupingType:e=>l({view:e})}:{groupingType:n,setGroupingType:e=>{s(e)}}}var e4=e.i(8295952),e9=e.i(3489437),e6=e.i(2480776),e3=e.i(157972);function e8(e){let{data:a=[],width:r,range:i,keys:l,colors:n,granularity:s}=e,o=a.map(e=>{let{date:t}=e;return t}),{valueScale:c,tickXValues:u,tickYValues:d}=(0,t.useMemo)(()=>{let e=Math.round(o.length/(r<480?3:r<720||"hour"===s?4:8));return{valueScale:(0,e9.scaleLinear)({domain:[0,i],range:[200,0],clamp:!0}),tickXValues:o.length<=3?o:o.filter((t,a)=>a%e==e>>1),tickYValues:0===i?[0]:[0,i/5,2*i/5,3*i/5,4*i/5,i]}},[o,s,i,r]);return{valueScale:c,colorScale:(0,t.useMemo)(()=>(0,e6.scaleOrdinal)({domain:l,range:n}),[n,l]),tickYValues:d,tickXValues:u}}var e7=e.i(8522580),te=e.i(8923565),tt=e.i(4004502),ta=e.i(9031150),tr=e.i(7218483),ti=e.i(5605106);let tl=(0,t.memo)(function(e){let{groupingType:t,groupingTypeOptions:a,setGroupingType:r,disableGroupBy:i,lastUpdate:n,noteText:s,selectedProjectId:o}=e,c=(0,tr.useAgo)(n,{justNowLabel:"just now"});return(0,l.jsxs)("div",{className:"flex flex-col @lg-page:flex-row items-stretch @md-page:items-center justify-between gap-4 flex-initial",children:[(0,l.jsxs)("div",{className:(0,f.default)("flex flex-col @md-page:flex-row items-stretch @md-page:items-center justify-start flex-initial",ti.default.groupingFilterWrapper),children:[(0,l.jsx)(te.Switch,{children:a.map(e=>(0,l.jsx)(J.Tooltip,{desktopOnly:!0,style:{flexGrow:1},text:`Group by ${e}`,children:(0,l.jsx)(te.Switch.Control,{checked:e===t,disabled:i||"Projects"===e&&!!o,label:e,onChange:(0,ta.withAwaitPaint)(()=>r(e)),value:e,width:110})},e))}),s?(0,l.jsx)(e7.Note,{className:ti.default.note,label:!1,size:"small",children:s}):null]}),(0,l.jsx)("div",{className:(0,f.default)("flex flex-col items-stretch justify-start",ti.default.updatedTimestamp),style:{flex:"0 0 auto"},children:(0,l.jsxs)("p",{className:"text-label-14 text-gray-600","data-testid":(0,tt.tid)("usage","metric","updated-text"),children:["Updated ",c||"just now"]})})]})});var tn=e.i(199192),ts=e.i(8626589),to=e.i(3675495),tc=e.i(1288475),tu=e.i(6685186),td=e.i(3322724),tf=e.i(9482244),th=e.i(4038339),tp=e.i(1712262);let tm=[{Icon:ts.Hash,accessor:"total"},{Icon:to.Percentage,accessor:"percent"}],tx=(e,t,a)=>{if(null===e||null===t)return 0;let r=e||0;return Math.max(0,r+(t-r)*a)},tg=(0,t.memo)(function(e){let{keys:a,truncatedKeys:r,chartData:i,colorScale:n,dimension:o,formatter:c,lastUpdate:u,expanded:d=!1,isHovered:h=!1,groupingType:p,linkStyle:m,viewAllHref:x="",emptyValueTitle:g}=e,[y,v]=(0,t.useState)(tm[0].accessor),[j,b]=(0,t.useState)(!1),w=(0,td.useIsMobile)(),_=(0,tr.useAgo)(u,{justNowLabel:"just now"}),{showPercentage:k,columns:S,data:N}=(0,t.useMemo)(()=>{let[e={}]=Object.values(o),t=1!==a.length&&"object"==typeof e&&"percent"in e&&null!==e.percent,n=[{Header:"Name",accessor:"name"},{Header:"Total",accessor:"total",align:"right"}];t&&n.push({Header:"Percent",accessor:"percent",align:"right"}),w&&n.length>2&&n.splice(n.findIndex(e=>"name"!==e.accessor&&e.accessor!==y),1);let c={},u={};for(let{resources:e=[],regions:t=[],logDrains:a=[]}of i)for(let{title:r,subtitle:i,link:l}of[...e,...t,...a])r&&(i||l)&&(c[r]=i,u[r]=l);return{showPercentage:t,columns:n,data:a.map(e=>{let t=o[e]??0,a=0,i=null;"number"!=typeof t?{total:a,percent:i}=t:a=t;let n=c[e],d=u[e],f=e||(g??"Unknown");return{key:e,groupedInOther:!!r&&!r.includes(e),link:d,name:(0,l.jsxs)(l.Fragment,{children:[d&&"external"===m?(0,l.jsx)(s.Link,{external:!0,href:d,children:f}):f,n?(0,l.jsxs)(l.Fragment,{children:[" ",(0,l.jsx)("span",{className:"text-copy-14 text-gray-900",children:n})]}):null]}),total:a,percent:Number.parseFloat(i??"0")}})}},[o,a,w,y,i,p,r,m,g]),C=function(e,a){let[r,i]=(0,t.useState)(e),l=(0,t.useRef)(e),n=(0,tf.usePrefersReducedMotion)();return(0,t.useEffect)(()=>{l.current=e},[a]),(0,t.useEffect)(()=>{let t=performance.now(),a=l.current,r=a.length===e.length;n&&(r=!1);let s=0,o=function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),n=Math.sin(Math.min((l-t)/100,1)*Math.PI*.5);if(!r||1===n){i(e),Object.assign(a,e);return}s=requestAnimationFrame(o);let c=Array(e.length);for(let t=e.length;t--;){let r=e[t],i=a[t];c[t]={key:r.key,groupedInOther:r.groupedInOther,name:r.name,link:r.link,total:tx(i.total,r.total,n),percent:tx(i.percent,r.percent,n)}}i(c)};return o(),()=>{cancelAnimationFrame(s),i(e=>(Object.assign(a,e),e))}},[e,n]),r}(N,p),D=d?30:6,O=!j&&C.length>D,T=(0,t.useMemo)(()=>{let e=new URL(x,location.origin);return e.searchParams.set("view",p),e.toString()},[x,p]),M=(0,t.useMemo)(()=>O?d?(0,l.jsx)(eX.Button,{className:ti.default.viewAll,onClick:()=>void(0,tu.awaitPaint)().then(()=>b(!0)),type:"secondary",children:(0,l.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,l.jsx)("p",{className:"text-label-12",children:"View All"}),(0,l.jsx)(tn.ChevronRightSmall,{})]})}):(0,l.jsx)(s.ButtonLink,{className:ti.default.viewAll,href:T,type:"secondary",children:(0,l.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,l.jsx)("p",{className:"text-label-12",children:"View All"}),(0,l.jsx)(tn.ChevronRightSmall,{})]})}):null,[O,T,d]),P=(0,t.useMemo)(()=>"none"===m||"external"===m?null:"o11y"===m?function(e){let{link:t}=e;return t?(0,l.jsx)(th.OpenObservability,{href:t}):null}:function(e){let{link:t}=e;return t?(0,l.jsx)(tp.OpenButton,{href:t}):null},[m]);return(0,l.jsxs)("div",{className:(0,f.clsx)("flex flex-col items-stretch justify-start gap-2 flex-initial pt-4",ti.default.container,O&&ti.default.hasMore),children:[(0,l.jsx)("div",{className:"geist-show-on-mobile",children:(0,l.jsxs)("div",{className:"flex flex-row items-center justify-between flex-initial mt-2 mb-1",children:[k?(0,l.jsx)(te.Switch,{children:tm.map(e=>(0,l.jsx)(te.Switch.Control,{checked:e.accessor===y,label:(0,l.jsx)(e.Icon,{size:16}),onChange:()=>v(e.accessor),value:e.accessor},e.accessor))}):(0,l.jsx)("div",{}),(0,l.jsxs)("p",{className:"text-label-14 text-gray-600","data-testid":(0,tt.tid)("usage","metric","updated-text"),children:["Updated ",_||"just now"]})]})}),(0,l.jsx)("div",{className:(0,f.clsx)("grid",P?"grid-cols-[44px_1fr_auto_auto]":"grid-cols-[1fr_auto_auto]"),children:C.map((e,t)=>!j&&t>=D?null:(0,l.jsxs)("div",{className:"col-span-full grid grid-cols-subgrid items-center odd:bg-background-200",children:[P?(0,l.jsx)("span",{className:"p-2",children:P(e)}):null,S.map((t,a)=>{let r,i=a===S.length-1;if(0===a){let a=e[t.accessor];return(0,l.jsxs)("span",{className:"flex flex-row items-center gap-3 p-2 font-medium text-gray-1000",children:[(0,l.jsx)(tc.Status,{style:{color:n(e.groupedInOther?"other":e.key)}}),a]},t.accessor)}let s=e[t.accessor];return r="total"===t.accessor?c(s,w?"display":"long"):`${s.toFixed(1)}%`,(0,l.jsx)("span",{className:(0,f.clsx)("p-2 tabular-nums text-gray-900",i?"pr-2":"pr-10","right"===t.align?"text-right":"","left"===t.align?"text-left":"",h&&"text-gray-1000"),children:r},t.accessor)})]},e.key))}),M]})});var ty=e.i(6774523);function tv(e){let{metricCount:t}=e;return(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 @md-page:gap-4 @lg-page:gap-4 flex-initial",children:[(0,l.jsxs)("div",{className:"flex flex-col @md-page:flex-row items-center justify-between gap-2 @md-page:gap-[72px] flex-initial pb-2 @md-page:pb-0",children:[(0,l.jsx)(j.Skeleton,{height:40,width:180}),(0,l.jsx)(j.Skeleton,{height:22,width:125})]}),(0,l.jsx)(j.Skeleton,{height:240,width:"100%"}),(0,l.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial pt-2",children:Array(t).fill(null).map((e,t)=>(0,l.jsxs)("div",{className:"flex flex-row items-stretch justify-between flex-initial p-2",children:[(0,l.jsx)(j.Skeleton,{height:20,width:152-t%2*32}),(0,l.jsxs)("div",{className:"flex flex-row items-stretch justify-end",style:{flex:"0 0 50%"},children:[(0,l.jsx)("div",{className:"flex flex-col items-end justify-start geist-hide-on-mobile",style:{flex:"0 0 50%"},children:(0,l.jsx)(j.Skeleton,{height:20,width:64+t%2*20})}),(0,l.jsx)("div",{className:"flex flex-col items-end justify-start",style:{flex:"0 0 50%"},children:(0,l.jsx)(j.Skeleton,{height:20,width:64+t%2*20})})]})]},(0,ty.getUnsafeKey)(t)))})]})})}function tj(){return(0,l.jsx)(j.Skeleton,{height:234,style:{marginTop:5},width:"100%"})}var tb=e.i(3513482);let tw=(e,t)=>{if(t?.kind==="custom"){let{singular:e,plural:a}=t;return(0,eK.createCountFormatterWithUnit)({singular:e,plural:a})}return e},t_=(0,t.memo)(function(e){let{children:a}=e,[r,i]=(0,t.useState)(!1),[n,s]=(0,t.useState)(360),o=(0,t.useRef)(null);return((0,t.useEffect)(()=>{let e=o.current;if(!e)return;let t=new IntersectionObserver(t=>{let[a=null]=t;if(!a)return;let r=!1;i(e=>(r=e&&!a.isIntersecting,a.isIntersecting)),r&&s(e.clientHeight)},{rootMargin:"800px 0px"});return t.observe(e),()=>t.disconnect()},[]),r)?(0,l.jsx)("div",{ref:o,style:{minHeight:360,transition:"opacity 0.1s"},children:a}):(0,l.jsx)("div",{ref:o,style:{contentVisibility:"hidden",containIntrinsicHeight:n,height:n,minHeight:360,opacity:0}})}),tk=(0,t.memo)(function(e){let{from:a,to:r,metricNames:i,data:n=[],metricColors:s,formatter:o,unit:c,granularity:u,reverseStack:d,lastUpdate:f,dataAvailableSince:h,selectedProjectId:p,disableGroupBy:m=!1,legendNote:x,groupingTypeEmptyValueTitles:y,groupingTypeOptions:v=["Ratio","Projects"],defaultGroupingType:j="Ratio",groupingTypeLinkStyles:b,onBarSelected:w,dimension:_,expanded:k=!1,viewAllHref:S=""}=e,N=tw(o,c),[C,{width:D}]=(0,g.default)(),{chartData:O,keys:T,truncatedKeys:M,range:P,dimension:I,groupingType:E,setGroupingType:A,isGroupingEnabled:L}=function(e){let{data:a=[],metricNames:r,formatter:i,defaultGroupingType:l,expanded:n=!1}=e,{groupingType:s,setGroupingType:o}=e5({defaultGroupingType:l,expanded:n}),{groupedData:c,keys:u,truncatedKeys:d}=(0,t.useMemo)(()=>{let e=(e,t)=>e||t;if("Ratio"===s||"Direction"===s||"Count"===s||"Origin"===s||"Build Machine"===s)return{groupedData:a.map(e=>{let{sum:t,date:a,resources:i,regions:l,...n}=e;return{data:Object.entries(n).reduce((e,t)=>{let[a,i]=t,l=r[Number.parseInt(a,10)];return l&&(e[l]="number"==typeof i?i:0),e},{}),sum:t,date:a,resources:i,regions:l}}),keys:r,truncatedKeys:r};let t="resources";switch(s){case"Regions":t="regions";break;case"Drains":t="logDrains";break;case"Sources":t="logSources";break;case"Event Types":t="eventType";break;case"Blob Stores":t="blobStores";break;case"Runtime":t="runtime";break;case"Type":t="cause";break;case"Network Type":t="networkTenancy";break;case"Traffic Source":t="trafficSource";break;case"Reader Projects":t="readerProjects";break;default:t="resources"}let i=new Map,l=new Set;for(let r of a)for(let{name:a,percent:n,title:s,count:o}of r[t]??[]){let t=e(a,s),c=o||(i.get(t)||0)+n/100*r.sum;i.set(t,c),c/r.sum>.05&&l.add(t)}let n=Array.from(i.entries()).sort((e,t)=>{let[,a]=e,[,r]=t;return a>r?-1:1}),o="other";if(l.size<10){for(let[e]of n)if(l.add(e),l.size>=10)break}let c=Array.from(l).sort((e,t)=>(i.get(t)??0)-(i.get(e)??0)),u=Object.fromEntries(n.map(e=>{let[t]=e;return[t,0]})),d=Object.keys(u);return c.length<d.length&&c.push(o),{groupedData:a.map(a=>{let r=a[t]?.reduce((t,r)=>{let{name:i,title:l,percent:n,count:s}=r,u=e(i,l),d=s||n/100*a.sum;return t[u]=(t[u]??0)+d,c.includes(u)||(t[o]=(t[o]??0)+d),t},{});return{data:{...u,...r},sum:a.sum,date:a.date,resources:a.resources,regions:a.regions,logDrains:a.logDrains,logSources:a.logSources,eventType:a.eventType,blobStores:a.blobStores,networkTenancy:a.networkTenancy,trafficSource:a.trafficSource,runtime:a.runtime,cause:a.cause,readerProjects:a.readerProjects}}),keys:d,truncatedKeys:c}},[a,s,r]),[f,h,p]=(0,t.useMemo)(()=>{let e={},t=0,a=0;for(let r of c)for(let i of(t<r.sum&&(t=r.sum),a+=r.sum,u))if(i in r.data){let t=r.data[i];if("number"==typeof t){let a=(i in e?e[i].total:0)+t;e[i]={total:a,percent:null}}}if(a>0)for(let[t,{total:r}]of Object.entries(e))e[t]={total:r,percent:(0,V.formatPercentage)(r,a)};return[(0,eH.roundUpAxisRange)(t,i),t>0,e]},[i,c,u]),m=(0,t.useMemo)(()=>c.map(e=>({date:e.date,value:e.sum,data:e.data,resources:e.resources,regions:e.regions,logDrains:e.logDrains,logSources:e.logSources,eventType:e.eventType,blobStores:e.blobStores,networkTenancy:e.networkTenancy,trafficSource:e.trafficSource,runtime:e.runtime,cause:e.cause})),[c]);return{chartData:m,keys:u,truncatedKeys:d,range:f,dimension:p,groupingType:s,setGroupingType:o,isGroupingEnabled:h&&m[0]&&("resources"in m[0]||"regions"in m[0]||"logDrains"in m[0]||"logSources"in m[0]||"eventType"in m[0]||"blobStores"in m[0]||"runtime"in m[0]||"networkTenancy"in m[0]||"trafficSource"in m[0]||"readerProjects"in m[0]||"cause"in m[0])}}({metricNames:i,data:n,formatter:N,defaultGroupingType:j,expanded:k}),F=O.length>0,{valueScale:B,dateScale:R,colorScale:$,tickYValues:z,tickXValues:U}=function(e){let{data:a=[],width:r}=e;return{dateScale:(0,t.useMemo)(()=>{let e=a.map(e=>{let{date:t}=e;return t});return(0,e4.scaleBand)({domain:e,range:[0,r-50],padding:.4375,paddingOuter:.3})},[a,r]),...e8(e)}}({data:n,width:D,range:P,keys:T,granularity:u,colors:"Projects"===E||"Regions"===E||"Drains"===E||"Sources"===E?tb.defaultMetricColors:s}),{usageTooltipProps:G,tooltipData:W,tooltipDimension:H,showTooltip:K,hideTooltip:q,cancelHideTooltip:Y}=e1({from:a,to:r,granularity:u,showPercentage:T.length>1}),X=(0,t.useMemo)(()=>{let e=v.indexOf(E);return b?.[e]??"none"},[E,v,b]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tl,{disableGroupBy:m||!L,groupingType:E,groupingTypeOptions:v,lastUpdate:f,noteText:x,selectedProjectId:p,setGroupingType:A}),(0,l.jsx)(tC,{chartRef:C,chartScales:{dateScale:R,valueScale:B},dataAvailableSince:h,formatter:N,granularity:u,isDataAvailable:F,tickXValues:U,tickYValues:z,unit:c,usageTooltip:{cancelHideTooltip:Y,hideTooltip:q,usageTooltipProps:G},width:D,children:(0,l.jsx)(eP,{color:$,data:O,keys:M,order:d?"reverse":"none",value:(e,t)=>e.data[t]??0,x:e=>{let{date:t}=e;return t},xScale:R,yScale:B,children:e=>[e[d?0:e.length-1]?.bars.map(t=>(0,l.jsx)("rect",{className:eV.default["bar-overlay"],height:B(0),onClick:w?e=>w({event:e,bar:t}):void 0,onMouseMove:()=>{if(!W||t.index!==W.index){let e=Math.round((B(t.bar[1])||0)-22),a=Math.round(t.x+50+t.width/2);K({tooltipData:{data:t.bar.data,index:t.index},tooltipTop:e,tooltipLeft:a})}},onTouchMove:a=>{Y();let{x:r}=(0,eU.localPoint)(a)||{x:0},i=~~(r/(t.width/.5625)),l=e[d?0:e.length-1].bars[i];if(l&&(!W||l.index!==W.index)){let e=Math.round((B(l.bar[1])||0)-22),t=Math.round(l.x+50+l.width/2);K({tooltipData:{data:l.bar.data,index:i},tooltipTop:e,tooltipLeft:t})}},width:t.width/.5625,x:t.x-.4375*t.width*.5/.5625,y:0},`bar-stack-${t.index}-overlay`)),...e.map(e=>e.bars.map(t=>(0,l.jsx)("rect",{className:eV.default.bar,fill:t.color,height:t.height,width:t.width,x:t.x,y:t.y},`bar-stack-${e.index}-${t.index}`)))]})}),(0,l.jsx)(tg,{chartData:O,colorScale:$,dimension:H||_||I,expanded:k,formatter:N,groupingType:E,isDataAvailable:F,isHovered:!!H,keys:T,lastUpdate:f,linkStyle:X,truncatedKeys:M,viewAllHref:S,emptyValueTitle:y?.[E]})]})}),tS=(0,t.memo)(function(e){return(0,l.jsx)(t_,{children:(0,l.jsx)(tk,{...e})})}),tN=(0,t.memo)(function(e){let a,{from:r,to:i,metricNames:n,data:s=[],groupByProjectData:o,metricColors:c,formatter:u,unit:d,granularity:f,lastUpdate:h,dataAvailableSince:p,selectedProjectId:m,disableGroupBy:x=!1,legendNote:y,groupingTypeEmptyValueTitles:v,groupingTypeOptions:j=["Average","Projects"],defaultGroupingType:b="Average",groupingTypeLinkStyles:w,setGroupByProject:_,expanded:k=!1,viewAllHref:S=""}=e,N=tw(u,d),[C,{width:D}]=(0,g.default)(),{chartData:O,keys:T,range:M,dimension:P,groupingType:I,setGroupingType:E,isGroupingEnabled:A}=function(e){let{data:a=[],groupByProjectData:r,metricNames:i,formatter:l,defaultGroupingType:n,expanded:s=!1}=e,{groupingType:o,setGroupingType:c}=e5({defaultGroupingType:n,expanded:s}),{groupedData:u,keys:d}=(0,t.useMemo)(()=>{if("Projects"===o){let e=new Map;for(let t of r||[])for(let a of t.data){let[t,r]=e.get(a.name)??[0,0];e.set(a.name,[t+a.sum,r+a.count])}let t=[...e.entries()].sort((e,t)=>{let[,a]=e,[,r]=t;return a[0]/a[1]>r[0]/r[1]?-1:1}).map(e=>{let[t]=e;return t}),i=Object.fromEntries(t.map(e=>[e,[0,0]])),l=t.map(e=>{for(let t of a){let a=t.resources?.find(t=>{let{name:a}=t;return a===e});if(a)return{...a,title:a.name,sum:0,count:0}}}).filter(e=>void 0!==e);return{groupedData:(r||[]).map(e=>({data:{...i,...Object.fromEntries(e.data.map(e=>[e.name,[e.sum,e.count]]))},resources:l,date:e.date})),keys:t}}return{groupedData:a.map(e=>{let{date:t,resources:a,regions:r,...l}=e;return{data:Object.entries(l).reduce((e,t)=>{let[a,[r,l]]=t,n=i[Number.parseInt(a,10)];return n&&(e[n]=[r,l]),e},{}),date:t,resources:a,regions:r}}),keys:i}},[a,r,o,i]),[f,h,p]=(0,t.useMemo)(()=>{let e={},t=0;for(let a of u)for(let r of d)if(r in a.data){let[i,l]=a.data[r];t<i/l&&(t=i/l);let[n,s]=e[r]??[0,0];e[r]=[i+n,l+s]}let a=Object.fromEntries(Object.entries(e).map(e=>{let[t,[a,r]]=e;return[t,a/r]}));return[(0,eH.roundUpAxisRange)(t,l),t>0,a]},[l,u,d]),m=u.map(e=>{let t=Object.entries(e.data).map(e=>{let[t,[a,r]]=e;return[t,0!==r?a/r:void 0]});return{date:e.date,value:t.reduce((e,t)=>{let[a,r]=t;return Math.max(e,r??0)},0),data:Object.fromEntries(t),resources:e.resources}});return{chartData:m,keys:d,range:f,dimension:p,groupingType:o,setGroupingType:c,isGroupingEnabled:h&&m[0]&&("resources"in m[0]||"regions"in m[0]||"logDrains"in m[0]||"logSources"in m[0]||"eventType"in m[0]||"blobStores"in m[0]||"runtime"in m[0]||"cause"in m[0]||"readerProjects"in m[0])}}({metricNames:n,data:s,groupByProjectData:o,formatter:N,defaultGroupingType:b,expanded:k}),L="Projects"===I&&!o,F=O.length>0,{valueScale:B,dateScale:R,colorScale:$,tickYValues:z,tickXValues:U}=function(e){let{data:a=[],width:r}=e;return{dateScale:(0,t.useMemo)(()=>{let e=a.map(e=>{let{date:t}=e;return t});return(0,e3.scalePoint)({domain:e,range:[0,r-36],padding:.3})},[a,r]),...e8(e)}}({data:s,width:D,range:M,keys:T,granularity:f,colors:"Projects"===I||"Regions"===I?tb.defaultMetricColors:c}),{usageTooltipProps:G,tooltipData:W,tooltipDimension:H,showTooltip:K,hideTooltip:q,cancelHideTooltip:V}=e1({from:r,to:i,granularity:f}),Y=(0,t.useCallback)(e=>{_?.("Projects"===e),E(e)},[_,E]),X=(0,t.useMemo)(()=>{var e;let t,a,r;return t=(e=R).domain(),a=e(t[0])??0,r=e.step(),e=>Math.max(0,Math.min(Math.round((e-a)/r),t.length-1))},[R]),Z=(0,t.useCallback)(e=>{let t;V();let{x:a,y:r}=(0,eU.localPoint)(e)||{x:0,y:0},i=X(a),l=O[i],n=Object.values(l.data).filter(e=>"number"==typeof e).sort((e,t)=>e-t);if(!n.length)return;let s=B.invert(r),o=(t=n.length-1,(0,eW.bisector)(e=>e).left(n,s,0,t));if(W&&i===W.index&&o===W.yIndex)return;let c=(B(n[o])||0)-22,u=(R(l.date)||0)+50;K({tooltipData:{data:l,index:i,yIndex:o},tooltipLeft:u,tooltipTop:c})},[V,O,R,X,K,W,B]);void 0!==G.left&&(a=X(G.left-50));let Q=(0,t.useMemo)(()=>{let e=j.indexOf(I);return w?.[e]??"none"},[I,j,w]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tl,{disableGroupBy:x||!L&&!A,groupingType:I,groupingTypeOptions:j,lastUpdate:h,noteText:y,selectedProjectId:m,setGroupingType:Y}),(0,l.jsxs)(tC,{chartRef:C,chartScales:{dateScale:R,valueScale:B},dataAvailableSince:p,formatter:N,granularity:f,isDataAvailable:F,loading:L,tickXValues:U,tickYValues:z,unit:d,usageTooltip:{cancelHideTooltip:V,hideTooltip:q,usageTooltipProps:G},width:D,children:[void 0!==G.left&&(0,l.jsx)(eE,{from:{x:G.left-50,y:0},pointerEvents:"none",stroke:"var(--accents-2)",strokeWidth:1,to:{x:G.left-50,y:200}}),T.map(e=>{let r=$(e),i=O.map(t=>({date:t.date,value:t.data[e]})),n="number"==typeof a?i[a]?.value:void 0,s=void 0!==n?B(n):void 0;return(0,l.jsxs)(t.default.Fragment,{children:[(0,l.jsx)(eF,{curve:eG.curveLinear,data:i.filter(e=>void 0!==e.value),stroke:r,strokeWidth:2,x:e=>{let{date:t}=e;return R(t)??0},y:e=>{let{value:t}=e;return B(t)}}),void 0!==G.left&&void 0!==s&&(0,l.jsx)("circle",{cx:G.left-50,cy:s,fill:r,pointerEvents:"none",r:4,stroke:"white",strokeWidth:2})]},e)}),(0,l.jsx)(ef,{fill:"transparent",height:200,onMouseMove:Z,onTouchMove:Z,rx:0,width:D,x:0,y:0})]}),(0,l.jsx)(tg,{chartData:O,colorScale:$,dimension:H||P,expanded:k,formatter:N,groupingType:I,isDataAvailable:F,isHovered:!!H,keys:T,lastUpdate:h,linkStyle:Q,loading:L,viewAllHref:S,emptyValueTitle:v?.[I]})]})}),tC=(0,t.memo)(function(e){let{chartRef:a,chartScales:{dateScale:r,valueScale:i},children:n,dataAvailableSince:s,formatter:o,granularity:c,isDataAvailable:u,loading:d,tickXValues:f,tickYValues:h,unit:p,usageTooltip:{cancelHideTooltip:m,hideTooltip:x,usageTooltipProps:g},width:y}=e,v=(0,t.useRef)(null),[j,b]=(0,t.useState)(400);if((0,t.useEffect)(()=>{let e=v.current;if(!e)return;let t=()=>{b(e.clientWidth)};requestAnimationFrame(()=>t());let a=new ResizeObserver(t);return a.observe(e),()=>{a.disconnect()}}),d)return(0,l.jsx)(tj,{});let w=6e4*new Date().getTimezoneOffset();return u?(0,l.jsxs)("figure",{className:eV.default.figure,onMouseEnter:m,onMouseLeave:x,ref:a,style:{visibility:y?"visible":"hidden"},children:[(0,l.jsxs)("div",{className:eV.default["auto-visibility"],children:[(0,l.jsx)("svg",{height:227,width:50,children:(0,l.jsx)(ez.AxisLeft,{hideAxisLine:!0,hideTicks:!0,left:8,scale:i,tickFormat:e=>p?.kind==="duration"&&p?.name==="millisecond"?(0,eH.msDetailedTimeFormatterForYAxis)(e):o(e),tickLabelProps:()=>({fill:"var(--accents-5)",fontSize:14,textAnchor:"start"}),tickValues:h,top:5})}),(0,l.jsxs)("svg",{height:227,ref:v,width:"calc(100% - 50px)",children:[(0,l.jsx)(e$.AxisBottom,{hideAxisLine:!0,hideTicks:!0,scale:r,tickFormat:e=>(0,V.formatDate)(e+("hour"===c?0:w),c),tickLabelProps:()=>({fill:"var(--accents-5)",fontSize:14,textAnchor:"middle"}),tickValues:f,top:200}),(0,l.jsx)(eR.GridRows,{scale:i,stroke:"var(--accents-2)",tickValues:h,width:j}),(0,l.jsx)(eB.Group,{children:n})]})]}),(0,l.jsx)(e0,{...g,dataAvailableSince:s,width:y})]}):(0,l.jsx)(eq.Empty,{})}),tD=(0,t.memo)(function(e){return(0,l.jsx)(t_,{children:(0,l.jsx)(tN,{...e})})});var tO=e.i(9939117);function tT(e){let{skeleton:t,card:a,sectionKey:r,teamSlug:i,isPage:n}=e;return(0,l.jsx)(ec,{accessory:t.hasMeter?(0,l.jsx)(j.Skeleton,{height:20,width:120}):null,card:a,sectionKey:r,teamSlug:i,children:(0,l.jsx)(tM,{isPage:n,skeleton:t})})}function tM(e){let{skeleton:t,isPage:a}=e;switch(t.type){case"bar":case"line":return(0,l.jsx)(tv,{metricCount:t.metricCount});case"paths":return(0,l.jsx)(tO.PathsChart,{expanded:a,filters:t.filters,filtersClassName:a?S.default.stickyPathsFilters:void 0,selectedFilter:t.filters?.[0]?.value,selectedSubFilter:t.subFilters?.[0]?.value,showSkeleton:!0,subFilters:t.subFilters});default:return null}}var tP=e.i(9584456);function tI(e){let{type:t}=e;return(0,l.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial tailwind-preflight",children:(0,l.jsxs)("div",{className:(0,f.clsx)("flex flex-col items-center justify-center gap-5 flex-initial rounded-md border border-gray-400 bg-background-100",{"h-[392px]":"bar"===t||"line"===t,"h-[340px]":"paths"===t}),children:[(0,l.jsx)("div",{className:"flex flex-col items-center justify-center flex-initial size-10 rounded-full bg-red-100",children:(0,l.jsx)(tP.StopFill,{color:"red-900"})}),(0,l.jsxs)("div",{className:"flex flex-col items-center justify-start gap-1 flex-initial",children:[(0,l.jsx)("p",{className:"text-label-14 font-medium",children:"Something went wrong"}),(0,l.jsx)("p",{className:"text-copy-14 text-gray-900",children:"We couldnt load the data for your selection"})]})]})})}let tE=(0,t.memo)(function(e){let{teamSlug:t,skeleton:a,plan:r,card:i,sectionKey:n,isPage:s,planIteration:o,isReseller:c,scopedProject:u,...d}=e,f=(0,en.useUsageFilters)(d.initialData.filters,u?.id),{account:h}=(0,Z.useAccount)(),{props:p,meterData:m,isValidating:x,error:g,footer:y}=Y({...d,filters:f,isPage:s});if(g&&!x)return s?(0,l.jsx)(tI,{type:a.type}):(0,l.jsx)(ec,{card:i,sectionKey:n,teamSlug:t,children:(0,l.jsx)(tI,{type:a.type})});if(!p||x)return s?(0,l.jsx)(tM,{skeleton:a}):(0,l.jsx)(tT,{card:i,sectionKey:n,skeleton:a,teamSlug:t});if(s)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tA,{...p,isPage:!0}),y]});let v=m?.limit||"hobby"===r,j=m?{...m,currency:h?.billing?.currency,formatter:p.formatter,used:m.value,hideOnTablet:!1,hidePrices:c}:void 0;return(0,l.jsx)(ec,{accessory:j&&!j.hideChartMeter?(0,l.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:[v?(0,l.jsx)(er,{...j}):(0,l.jsx)(X.Gauge,{className:"geist-hide-on-mobile",size:"tiny",value:0}),(0,l.jsx)(ei,{...j,hideLimit:!v})]}):null,additionalDescription:p.additionalDescription,card:i,footer:y,plan:r,planIteration:o,sectionKey:n,teamSlug:t,children:(0,l.jsx)(tA,{...p})})}),tA=(0,t.memo)(function(e){let{isPage:t,...a}=e;switch(a.type){case"bar":return(0,l.jsx)(tS,{...a,expanded:t});case"line":return(0,l.jsx)(tD,{...a,expanded:t});case"paths":return(0,l.jsx)(tO.PathsChart,{...a,expanded:t,filtersClassName:t?S.default.stickyPathsFilters:void 0});default:return null}});e.s(["UsageChart",0,tA,"UsageChartWrapper",0,tE],6527262)},6517252,e=>{"use strict";var t=e.i(4205214),a=e.i(9995129),r=e.i(6990379),i=e.i(6527262);function l(e){let{children:a,chartKey:l,batchKey:n,filters:s,noRevalidate:o}=e,{props:c,footer:u}=(0,r.useChartData)({filters:s,isPage:!1,cacheOnly:!0,chartKey:l,batchKey:n,initialData:{filters:s,error:{code:"not_found",message:"Not found"}},noRevalidate:o,getData:async()=>({promise:Promise.resolve({})})});return(0,t.jsxs)(t.Fragment,{children:[c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.UsageChart,{...c,isPage:!0}),u]}):null,(0,t.jsx)("div",{style:c?{display:"none"}:void 0,children:a})]})}e.s(["ClientChartWrapper",0,function(e){let{children:r,scopedProject:i,...n}=e,s=(0,a.useUsageFilters)(void 0,i?.id);return s?(0,t.jsx)(l,{...n,filters:s,children:r}):r}])}]);

//# debugId=8caff5a0-1506-e2c3-d3c8-2726065b6ef6
//# sourceMappingURL=e5544e14beea28bc.js.map