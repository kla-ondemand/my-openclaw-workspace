;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="8b6a0128-3f0d-9839-9481-c38707e9df49")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,421794,e=>{"use strict";let t={gen:{name:"Generic Attack",description:"Provide broad protection from various undefined or novel attack vectors."},java:{name:"Java Attack",description:"Mitigate risks of exploitation targeting Java-based applications or components."},lfi:{name:"Local File Inclusion Attack",description:"Prevent unauthorized access to local files through web applications."},ma:{name:"Multipart Attack",description:"Block attempts to bypass security controls using multipart/form-data encoding."},php:{name:"PHP Attack",description:"Safeguard against vulnerability exploits in PHP-based applications."},rce:{name:"Remote Execution Attack",description:"Prevent unauthorized execution of remote scripts or commands."},rfi:{name:"Remote File Inclusion Attack",description:"Prohibit unauthorized upload or execution of remote files."},sd:{name:"Scanner Detection",description:"Detect and prevent reconnaissance activities from network scanning tools."},sf:{name:"Session Fixation Attack",description:"Prevent unauthorized takeover of user sessions by enforcing unique session IDs."},sqli:{name:"SQL Injection Attack",description:"Prohibit unauthorized use of SQL commands to manipulate databases."},xss:{name:"XSS Attack",description:"Prevent injection of malicious scripts into trusted webpages."}};function a(e){return e.endsWith("update")?"modified":e.endsWith("insert")?"created":e.endsWith("remove")?"deleted":e.endsWith("priority")?"reordered":"firewallEnabled"===e?"changed":""}function r(e,t){return"bot_filter"===t?e.bot_filter??e.bot_protection:"bot_protection"===t?e.bot_protection??e.bot_filter:e[t]}e.s(["botProtectionFromConfig",0,function(e){let t=e?.managedRules;return t?.bot_filter??t?.bot_protection},"botProtectionFromRulesets",0,function(e){return e.bot_filter??e.bot_protection},"createActionConfig",0,function(e,t,i){let n=i?"You":e.username,{id:l,action:o}=e;if("crs.update"===e.action)return{id:l||"",principal:n,rule:l?t.owasp.ruleGroups?.[l].name??l:"",actionTaken:a(o)};if("ip.insert"===e.action||"ip.remove"===e.action)return{id:l||"",principal:n,rule:(e.action,"IP Blocking Rule"),actionTaken:a(o)};if("rules.insert"===e.action||"rules.update"===e.action)return{id:l||"",principal:n,rule:e.value.name,actionTaken:a(o)};if("rules.remove"===e.action)return{id:l||"",principal:n,rule:"a Custom Rule",actionTaken:a(o)};if("rules.priority"===e.action)return{id:l||"",principal:n,rule:"Rule",actionTaken:a(o)};if("managedRules.update"===e.action)return{id:l||"",principal:n,rule:(()=>{if(!l)return"";let e=r(t,l);return e?e.name:l})(),actionTaken:e.value.active?"enabled":"disabled"};if("managedRuleGroup.update"===e.action){let a=r(t,l||""),i=a?.name||l||"",o=Object.entries(e.value).map(e=>{let[t]=e;return a?.ruleGroups?.[t]?.name||t}).join(", ");return{id:l||"",principal:n,rule:i,actionTaken:`modified ${o}`}}return"botId.toggle"===e.action?{id:l||"",principal:n,rule:"BotID Deep Analysis",actionTaken:e.value?"enabled":"disabled"}:{principal:n,id:l||"",rule:"Firewall",actionTaken:a(o)}},"crsRuleToConfig",0,function(e){return t[e]},"getRulesetFromRulesets",0,r,"isBotProtectionData",0,function(e){return"managed_bot_filter"===e||"managed_bot_protection"===e},"isBotProtectionManagedRuleset",0,function(e){return"bot_filter"===e||"bot_protection"===e}])},594750,e=>{"use strict";var t=e.i(8660982),a=e.i(455575),r=e.i(850302),i=e.i(5298575),n=e.i(7209339),l=e.i(193728),o=e.i(569917),u=e.i(5677444),s=e.i(8042625),c=e.i(277234),d=e.i(4244280),f=e.i(5338940),m=e.i(421794);function p(e){if(!e)return;let t=e.draft??e.active;if(!t)return t;let a=new Map,r=Object.keys(t.crs).map(e=>{let{name:r,description:i}=(0,m.crsRuleToConfig)(e),n={id:e,action:t.crs[e].action,active:t.crs[e].active,name:r,description:i};return a.set(n.id,{...n,type:"owas"}),n}).sort((e,t)=>e.name.localeCompare(t.name)),i=t.rules.map(e=>{let t={id:e.id,description:e.description,name:e.name,action:e.action?.mitigate?.action==="rate_limit"?e.action.mitigate.rateLimit?.action||"log":e.action?.mitigate?.action||"log",active:e.active,value:e,isRateLimit:e.action?.mitigate?.action==="rate_limit"};return a.set(t.id,{...t,type:"custom_rule"}),t});t.ips.forEach(e=>{a.set(e.id,{...e,type:"ip_block"})});let n=t.changes.sort((e,t)=>t.createdAt.localeCompare(e.createdAt));return{currentConfig:t,crsRules:r,rules:i,changes:n,ruleMap:a}}async function g(e){let[t]=e;return(await (0,c.fetchAPI)(t,{method:"GET",throwOnHTTPError:!0,returnStatus:!0})).body}async function v(e,t){let{arg:a}=t,r=(0,n.cloneDeep)(a);return r.value&&"object"==typeof r.value&&("valid"in r.value&&delete r.value.valid,"validationErrors"in r.value&&delete r.value.validationErrors),(await (0,c.fetchAPI)(e,{method:"PATCH",throwOnHTTPError:!0,returnStatus:!0,body:JSON.stringify(r)})).body}async function y(e,t){let[a,r]=e,{arg:i="draft"}=t;return await (0,c.fetchAPI)(`${a}${i}${r}`,{method:"POST",throwOnHTTPError:!0,returnStatus:!0,body:JSON.stringify({})})}async function h(e){return await (0,c.fetchAPI)(e,{method:"DELETE",throwOnHTTPError:!0,returnStatus:!0})}e.s(["formatPatchRule",0,function(e,t,a){if(Object.hasOwn(e,"value")){let a=(0,n.cloneDeep)(e);return a=(0,o.omit)(a,"value.id"),"action"===t.type?a.isRateLimit?(0,l.set)(a,"value.action.mitigate.rateLimit.action",t.value):(0,l.set)(a,"value.action.mitigate.action",t.value):(0,l.set)(a,"value.active",t.value),{id:e.id,action:"rules.update",value:a.value}}if(a){let r,i;return r="active"===t.type?t.value:e.active,i="action"===t.type?t.value:"disable"===e.action?"log":e.action,{id:a,action:"managedRuleGroup.update",value:{[e.id]:{active:r,action:i}}}}throw Error("formatPatchRule called without rulesetId for managed rule")},"useFirewallConfig",0,function(e){let{projectId:n,ruleId:l}=e,{team:o}=(0,f.useTeam)(),c=(0,u.useRouter)(),m=(0,s.encode)({teamId:o?.id,projectId:n}),{data:b,mutate:w,isLoading:_}=(0,r.default)(o&&n?[`${d.API_FIREWALL}/firewall/config${m}`,m]:null,async e=>g(e)),R=(0,a.useToasts)(),k=(0,t.useMemo)(()=>p(b?{...b,draft:null}:void 0),[b]),P=(0,t.useMemo)(()=>p(b),[b]),{trigger:A,isMutating:I}=(0,i.default)(`${d.API_FIREWALL}/firewall/config/draft${m}`,v),{trigger:S,isMutating:T}=(0,i.default)([`${d.API_FIREWALL}/firewall/config/`,`/activate${m}`],y),{trigger:D}=(0,i.default)(`${d.API_FIREWALL}/firewall/config${m}`,v),{trigger:B,isMutating:L}=(0,i.default)(`${d.API_FIREWALL}/firewall/config/draft${m}`,h),O=(0,t.useCallback)(async e=>{try{let t=await v(`${d.API_FIREWALL}/firewall/config/draft${m}`,{arg:e});w({...b||{active:null,versions:[t]},draft:t},{revalidate:!1}).then(()=>null,()=>null)}catch(e){throw R.error(e.message||"Failed to update Firewall. Please try again."),e}},[m,R,b,w]),F=(0,t.useCallback)(async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=arguments.length>2?arguments[2]:void 0;try{await D(e),t&&(await w(),c.refresh(),a?.())}catch(e){throw R.error(e.message||"Failed to update Firewall. Please try again."),e}},[w,R,b,D,c.refresh]),M=(0,t.useCallback)(async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=arguments.length>2?arguments[2]:void 0;try{let r=await A(e);await w({...b||{active:null,versions:[r]},draft:r},{revalidate:!1}),t&&(a?.(),w().then(()=>null,()=>null))}catch(e){throw R.error(e.message||"Failed to update Firewall. Please try again."),e}},[w,A,R,b]),C=(0,t.useCallback)(async()=>{try{await B(),await w()}catch(e){throw R.error(e.message||"Failed to discard Firewall changes. Please try again."),e}},[w,B,R]),E=(0,t.useCallback)(async(e,t)=>{try{await S(t);let a=e?.toastSuccessMessage??"Your Firewall changes have been applied successfully";R.success(a),c.refresh(),await w().catch(()=>null)}catch(t){throw R.error(e?.toastErrorMessage||t.message||"Failed to publish Firewall changes. Please try again."),t}},[S,w,R,c]),$=(0,t.useCallback)(()=>{w().then(()=>null,()=>null)},[w]),j=(0,t.useMemo)(()=>{if(!l||!P)return;let e=P.rules.find(e=>e.id===l);if(e)return e.value},[l,P]),x=(0,t.useMemo)(()=>!P||!P.rules.some(e=>e.isRateLimit),[P]);return{activeConfig:k,config:P,showRateLimitModal:x,selectedRule:j,forceConfig:F,updateConfig:M,reorderItem:O,discardChanges:C,publishChanges:E,isPublishing:T,isDiscarding:L,isUpdatingConfig:I,isLoadingConfig:_&&!b,refresh:$}}],594750)},4708200,3863657,e=>{"use strict";var t=e.i(8295952),a=e.i(3489437),r=e.i(9629316),i=e.i(8125826),n=e.i(4085287),l=e.i(388027),o=e.i(2480776),u=e.i(5727994),u=u;let s="__hidden",c="__others";function d(e){return e?.date}function f(e){return e.value}e.s(["findNearestDataPointByDate",0,function(e,t){let a=e.getTime(),r=(0,i.bisector)((e,t)=>e.date.getTime()-t).center(t,a);return t[r]},"flatten",0,function(e){return Array.from(e.values()).reduce((e,t)=>e.concat(t),[])},"getScales",0,function(e,i,s,m,p,g,v,y,h){let b=(0,l.max)(e,f)??0,w=(0,r.scaleTime)({domain:(0,n.extent)(e,d),range:[0,m]}),_=(0,a.scaleLinear)({domain:[0,b],range:h||[p,0]}),R=(0,a.scaleLinear)({domain:[0,b*(y??1)],range:h||[p,0]}),k=(0,l.max)(i,e=>{var t;return t=e,s.reduce((e,a)=>"number"==typeof t[a]?e+t[a]:e,0)})??0,P=(0,a.scaleLinear)({domain:[0,k],range:[p,0]}),A=(0,a.scaleLinear)({domain:[0,k*(y??1)],range:[p,0]}),I=(0,t.scaleBand)({domain:e.map(e=>d(e)??new Date).sort((e,t)=>e.getTime()-t.getTime()),paddingInner:.3,range:[0,m]}),S={};return v&&(S[c]=v),{lineXScale:w,lineYScale:_,lineYAxisScale:R,barStackYScale:P,barDateScale:I,barYAxisScale:A,colorScale:function(e){let t=(0,o.scaleOrdinal)({domain:e.domain.filter(t=>!(t in e.special)),range:e.range,unknown:e.unknown||u.implicit});function a(a){return e.special[a]??t(a)}return Object.assign(a,t),a}({domain:s,range:g,special:S})}},"getX",0,d,"getY",0,f,"groupByTime",0,function(e,t){let a=new Map(e.map(e=>{let{time:a,date:r}=e;return[a,{time:a,date:r,...Object.fromEntries(t.map(e=>[e,0]))}]}));return e.forEach(e=>{let{time:t,key:r,value:i}=e,n=a.get(t);n&&(n[r]=i)}),[...a.values()].sort((e,t)=>e.date.getTime()-t.date.getTime())},"hideDataKey",0,s,"othersDataKey",0,c,"singletons",0,function(e){return e.filter((t,a)=>{let r=e[a-1]||{value:null},i=e[a+1]||{value:null};return null!==t.value&&null===r.value&&null===i.value})}],4708200);var m=e.i(9534247);function p(e,t){let a=e.filter(e=>"projectId"!==e);if(0===a.length)return"All Data";let r=a.map(e=>t[e]);return r.includes("Others")?c:r.every(e=>!e)?s:r.join("$$")}e.s(["SEPARATOR",0,"$$","getSeriesKey",0,p,"toSeriesMap",0,function(e,t){let a=t.filter(e=>"projectId"!==e),r=new Map,i=!0;for(let t of e.data||[]){"edgeNetworkRegion"in t&&(t.edgeNetworkRegion=(0,m.friendlyRegionFormatter)(t.edgeNetworkRegion)),"projectId"in t&&"projectName"in t&&""!==t.projectName&&(t.projectId=t.projectName);let e=p(a,t);e!==s&&(i=!1),r.has(e)||r.set(e,[]);let{timestamp:n,value:l,...o}=t,u=n.toISOString();r.get(e)?.push({...o,date:n,time:u,key:e,value:l})}if(i)return new Map;let n=new Map;return e.summary.map(e=>[p(a,e),e.value]).sort((e,t)=>{let[a,r]=e,[i,n]=t;return n-r}).map(e=>{let[t,a]=e;return t}).forEach(e=>{n.set(e,r.get(e)||[])}),n}],3863657)},5963711,7212454,e=>{"use strict";var t=e.i(4708200),a=e.i(3863657),r=e.i(6493958),i=e.i(3538015);function n(e){return e?e.rules.filter(e=>"value"in e&&e.value.action?.mitigate?.action==="rate_limit"&&!!e.value.action.mitigate.rateLimit&&!!e.value.active).length:0}function l(e){return"rate-limit"===e?"rate_limit":e}e.s(["countRateLimitRules",0,n],7212454);let o={all:{base:"text-gray-900",active:"var(--ds-blue-100-value)",chart:"var(--ds-gray-900)"},allow:{base:"text-blue-700",active:"var(--ds-blue-100-value)",chart:"var(--ds-blue-700)"},deny:{base:"text-red-700",active:"var(--ds-red-100-value)",chart:"var(--ds-red-700)"},challenge:{base:"text-amber-700",active:"var(--ds-amber-100-value)",chart:"var(--ds-amber-700)"},log:{base:"text-purple-700",active:"var(--ds-purple-100-value)",chart:"var(--ds-purple-700)"},rate_limit:{base:"text-teal-700",active:"var(--ds-teal-100-value)",chart:"var(--ds-teal-700)"}};e.s(["ACTION_COLORS",0,o,"denormalizeFirewallAction",0,function(e){return"rate_limit"===e?"rate-limit":e},"formatFirewallActionForDisplay",0,function(e){return void 0===e?"":l(e).replace("_"," ")},"formatShortPrecision",0,function(e){return(0,r.countFormatter)(e,"short-precision").replace(/\s/g,"")},"formatTableHeader",0,function(e,t){let a=e.find(e=>e.value===t);return a?a.label:t},"getActionFromKey",0,function(e){var t;let r=e.includes(a.SEPARATOR)?e.split(a.SEPARATOR).at(-1):e;if(!r)return null;let i=l(r);return(t=i,Object.prototype.hasOwnProperty.call(o,t))?i:null},"getSonarSeriesData",0,function(e,r,i,n){let o=new Map,u=e=>{let i=[];for(let a of r){let r=e[a];if(null==r||("wafAction"===a?r=l(r||"allow"):"wafRuleId"===a&&(r||="default_web_traffic"),!r&&n.groupBy===a))return t.hideDataKey;i.push(r)}return i.join(a.SEPARATOR)},s=!0,c=new Set;for(let a of e){let e=u(a);e!==t.hideDataKey&&(s=!1),o.has(e)||e===t.hideDataKey||o.set(e,[]);let r=a.timestamp;c.add(r.toISOString()),o.get(e)?.push({...a,date:r,key:e})}if(r.every(e=>["wafRuleId","wafAction"].includes(e))){let e=Array.from(c.values()).map(e=>new Date(e));for(let t of i){let r=[t.value,t.action].join(a.SEPARATOR);o.has(r)||"all_rules"===t.value||o.set(r,e.map(e=>({date:e,timestamp:e,key:r,value:0})))}}return s?new Map:o},"isCustomRuleId",0,function(e){return"string"==typeof e&&(e.startsWith("rule_")||"deployment_defined_rules"===e)},"isOthersAggregate",0,function(e){return RegExp(`(Others(${a.SEPARATOR})?)+`).test(e)},"isPlanLimitReached",0,function(e){let{teamPlan:t,config:a,bypassRules:r,type:l}=e;if(!t)return!0;let o=i.firewallPlanLimits[t][l];return"ipBypass"===l?"hobby"===t||!!r&&r.length>=o:null!==a&&(void 0===a||("ipBlocks"===l?a.currentConfig.ips.length>=o:"rateLimit"===l?n(a)>=o:a.rules.length>=o))},"isValidEdgeRateLimitKey",0,function(e){switch(e){case"ip":case"ja4":return!0;default:return e.startsWith("header:")}},"normalizeFirewallAction",0,l,"wafRuleId",0,function(e){return"default_web_traffic"===e?"":"managed_bot_filter"===e?"managed_bot_protection":e}],5963711)},2178078,e=>{"use strict";var t=e.i(1017452),a=e.i(8585693),r=e.i(1767063),i=e.i(1418890),n=e.i(2583821);e.s(["default",0,function(e,l,o,u){if(!(0,i.default)(e))return e;l=(0,a.default)(l,e);for(var s=-1,c=l.length,d=c-1,f=e;null!=f&&++s<c;){var m=(0,n.default)(l[s]),p=o;if("__proto__"===m||"constructor"===m||"prototype"===m)break;if(s!=d){var g=f[m];void 0===(p=u?u(g,m,f):void 0)&&(p=(0,i.default)(g)?g:(0,r.default)(l[s+1])?[]:{})}(0,t.default)(f,m,p),f=f[m]}return e}])},7209339,e=>{"use strict";var t=e.i(5201866);e.s(["cloneDeep",0,function(e){return(0,t.default)(e,5)}],7209339)},193728,e=>{"use strict";var t=e.i(2178078);e.s(["set",0,function(e,a,r){return null==e?e:(0,t.default)(e,a,r)}],193728)},388027,e=>{"use strict";var t=e.i(6950223);e.s(["max",()=>t.default])},8594561,9541744,7823055,1575714,e=>{"use strict";var t=e.i(4893216),a=e.i(3607787),r=e.i(4742629),i=e.i(383598),n=e.i(6603859),l=e.i(4411560),o=e.i(6191442),u=e.i(2854),u=u,s=e.i(8587618),c=e.i(7500952),d=e.i(8074820),f=(0,d.default)(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});f.every=function(e){return isFinite(e=Math.floor(e))&&e>0?e>1?(0,d.default)(function(t){t.setTime(Math.floor(t/e)*e)},function(t,a){t.setTime(+t+a*e)},function(t,a){return(a-t)/e}):f:null},f.range;var m=e.i(5422208),p=e.i(6638429),g=e.i(8698404),v=e.i(4816246),y=e.i(1146510),h=e.i(2951555),b=e.i(7002069),w=e.i(987865),_=e.i(9960377),R=e.i(6874652),k=e.i(8342947),P=e.i(7957080);function A(e,t,a,r,i,n){let l=[[m.default,1,c.durationSecond],[m.default,5,5*c.durationSecond],[m.default,15,15*c.durationSecond],[m.default,30,30*c.durationSecond],[n,1,c.durationMinute],[n,5,5*c.durationMinute],[n,15,15*c.durationMinute],[n,30,30*c.durationMinute],[i,1,c.durationHour],[i,3,3*c.durationHour],[i,6,6*c.durationHour],[i,12,12*c.durationHour],[r,1,c.durationDay],[r,2,2*c.durationDay],[a,1,c.durationWeek],[t,1,c.durationMonth],[t,3,3*c.durationMonth],[e,1,c.durationYear]];function o(t,a,r){let i=Math.abs(a-t)/r,n=(0,u.default)(e=>{let[,,t]=e;return t}).right(l,i);if(n===l.length)return e.every((0,s.tickStep)(t/c.durationYear,a/c.durationYear,r));if(0===n)return f.every(Math.max((0,s.tickStep)(t,a,r),1));let[o,d]=l[i/l[n-1][2]<l[n][2]/i?n-1:n];return o.every(d)}return[function(e,t,a){let r=t<e;r&&([e,t]=[t,e]);let i=a&&"function"==typeof a.range?a:o(e,t,a),n=i?i.range(e,+t+1):[];return r?n.reverse():n},o]}let[I,S]=A(e.i(2766852).default,P.default,k.utcSunday,R.default,_.default,w.default),[T,D]=A(b.default,h.default,y.sunday,v.default,g.default,p.default);e.s(["timeTickInterval",0,D,"timeTicks",0,T,"utcTickInterval",0,S,"utcTicks",0,I],9541744);var B=e.i(9827209),L=e.i(7824140),O=e.i(2448719);function F(e,t){e=e.slice();var a,r=0,i=e.length-1,n=e[r],l=e[i];return l<n&&(a=r,r=i,i=a,a=n,n=l,l=a),e[r]=t.floor(n),e[i]=t.ceil(l),e}function M(e){return new Date(e)}function C(e){return e instanceof Date?+e:+new Date(+e)}function E(e,t,a,r,i,n,l,o,u,s){var c=(0,L.default)(),d=c.invert,f=c.domain,m=s(".%L"),p=s(":%S"),g=s("%I:%M"),v=s("%I %p"),y=s("%a %d"),h=s("%b %d"),b=s("%B"),w=s("%Y");function _(e){return(u(e)<e?m:o(e)<e?p:l(e)<e?g:n(e)<e?v:r(e)<e?i(e)<e?y:h:a(e)<e?b:w)(e)}return c.invert=function(e){return new Date(d(e))},c.domain=function(e){return arguments.length?f(Array.from(e,C)):f().map(M)},c.ticks=function(t){var a=f();return e(a[0],a[a.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?_:s(t)},c.nice=function(e){var a=f();return e&&"function"==typeof e.range||(e=t(a[0],a[a.length-1],null==e?10:e)),e?f(F(a,e)):c},c.copy=function(){return(0,L.copy)(c,E(e,t,a,r,i,n,l,o,u,s))},c}function $(){return O.initRange.apply(E(T,D,t.timeYear,a.timeMonth,r.timeWeek,i.timeDay,n.timeHour,l.timeMinute,o.timeSecond,B.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}e.s(["default",0,F],7823055),e.s(["calendar",0,E,"default",0,$],1575714);var j=(0,e.i(8777499).default)("domain","range","reverse","clamp","interpolate","nice","round");e.s(["default",0,function(e){return j($(),e)}],8594561)},9629316,4085287,e=>{"use strict";var t=e.i(8594561);e.s(["scaleTime",()=>t.default],9629316),e.s(["extent",0,function(e,t){let a,r;if(void 0===t)for(let t of e)null!=t&&(void 0===a?t>=t&&(a=r=t):(a>t&&(a=t),r<t&&(r=t)));else{let i=-1;for(let n of e)null!=(n=t(n,++i,e))&&(void 0===a?n>=n&&(a=r=n):(a>n&&(a=n),r<n&&(r=n)))}return[a,r]}],4085287)},3538015,e=>{"use strict";var t=e.i(421794);let a=JSON.stringify({name:"",description:"",active:!0,conditionGroup:[{conditions:[{type:"path",op:"eq",value:""}]}],action:{mitigate:{action:"rate_limit",rateLimit:{action:"rate_limit",algo:"fixed_window",window:"60",limit:"100",keys:["ip"]}}}}),r={sys_dos_mitigation:{label:"DDoS Mitigation",groupBy:"System",rank:11},ip_blocking:{label:"IP Blocking",groupBy:"System",rank:12}},i={owasp_anomaly_detection:{label:"OWASP Anomaly Detection",groupBy:"System",rank:3,keys:["gen","java","ma","sd"]},owasp_xss_detection:{label:"OWASP XSS Detection",groupBy:"System",rank:4,keys:["xss"]},owasp_sqli_detection:{label:"OWASP SQL Injection Detection",groupBy:"System",rank:5,keys:["sqli"]},owasp_rfi_detection:{label:"OWASP RFI Detection",groupBy:"System",rank:6,keys:["rfi"]},owasp_lfi_detection:{label:"OWASP LFI Detection",groupBy:"System",rank:7,keys:["lfi"]},owasp_rce_detection:{label:"OWASP RCE Detection",groupBy:"System",rank:8,keys:["rce"]},owasp_php_detection:{label:"OWASP PHP Injection Detection",groupBy:"System",rank:9,keys:["php"]},owasp_session_fixation_detection:{label:"OWASP Session Fixation Detection",groupBy:"System",rank:10,keys:["sf"]}},n={default_web_traffic:{label:"Allowed Requests",groupBy:"System",rank:1},challenge_mode:{label:"Attack Mode",groupBy:"System",rank:2},...i,...r},l={hobby:{customRules:3,ipBlocks:10,ipBypass:0,rateLimit:1},pro:{customRules:40,ipBlocks:100,ipBypass:25,rateLimit:40},enterprise:{customRules:1e3,ipBlocks:1e3,ipBypass:100,rateLimit:1e3}},o={pro:{customRules:{title:"Need more custom rules?",description:"Upgrade to Enterprise Plan"},ipBlocks:{title:"Need to block more IPs?",description:"Upgrade to Enterprise Plan"},ipBypass:{title:"Need to allow more IPs?",description:"Upgrade to Enterprise Plan"},rateLimit:{title:"Need more rate limit rules?",description:"Upgrade to Enterprise Plan"}},hobby:{customRules:{title:"Need more custom rules?",description:`Upgrade to pro to add up to ${l.pro.customRules} custom rules`},ipBlocks:{title:"Need to block more IPs?",description:`Upgrade to pro to block up to ${l.pro.ipBlocks} IPs`},ipBypass:{title:"Need to setup an IP bypass?",description:`Upgrade to pro to allow up to ${l.pro.ipBypass} IPs`},rateLimit:{title:"Need more rate limit rules?",description:`Upgrade to pro to add up to ${l.pro.rateLimit} rate limit rules`}}},u=[{label:n.default_web_traffic.label,value:"default_web_traffic",action:"allow"},{label:n.challenge_mode.label,value:"challenge_mode",action:"challenge"},...Object.entries(r).map(e=>{let[t,a]=e;return{label:a.label,value:t,action:"deny"}})],s=Object.entries(n).reduce((e,t)=>{let[a,r]=t;return Object.assign(e,{[a]:r.rank})},{});e.s(["allowedFirewallActions",0,function(e,t){let a=[{value:"log",label:"Log",subtext:"Log traffic and do nothing more"},{value:"deny",label:t?"Deny (403)":"Deny",subtext:"Block traffic from accessing your site"},{value:"challenge",label:"Challenge",subtext:"Verify traffic at a security checkpoint before allowing access to your site"}];return t||a.push({value:"bypass",label:"Bypass",subtext:"Bypass existing rules and allow traffic access to your site"}),e&&a.push({value:"rate_limit",label:t?"Too Many Requests (429)":"Rate Limit",subtext:"Enforce frequency limitations on traffic"}),t||a.push({value:"redirect",label:"Redirect",subtext:"Redirect traffic to a different page"}),a},"defaultFilter",0,[{label:"User Agent",value:"clientUserAgent"},{label:"Country",value:"clientIpCountry"},{label:"IP Address",value:"clientIp"},{label:"Request Path",value:"requestPath"},{label:"Vercel Region",value:"edgeNetworkRegion"},{label:"Route",value:"sourcePath"},{label:"JA4 Digest",value:"clientJa4Digest"},{label:"Host",value:"requestHostname"}],"defaultShowSystemRules",0,u,"firewallPlanLimits",0,l,"getRuleName",0,function(e,a,r){if(r&&e.startsWith("managed_")){let a=e.slice(8),i=(0,t.getRulesetFromRulesets)(r,a);if(i)return i.name;for(let[,e]of Object.entries(r))if(e.ruleGroups?.[a])return e.ruleGroups[a].name||a}let i=[];a&&(i.push(...a.rules),i.push(...a.crsRules),i.push(...a.currentConfig.ips.map(e=>({id:e.id,name:`IP Block ${"*"===e.hostname?"":e.hostname} ${e.ip}`}))));let l=i.find(t=>t.id===e);if(l)return l.name;let o=n[e];return o?o.label:"deployment_rules"===e?"Deployment Rules":"deployment_defined_rules"===e?"Deployment Defined Rules":e},"isLimitedSystemRule",0,function(e){return e in r},"owaspToCrsConfig",0,function(e){return Object.entries(i).reduce((t,a)=>{let[r,i]=a,n=e.filter(e=>i.keys.includes(e.id)&&e.active);if(n.length>0){let e=Array.from(n.reduce((e,t)=>(e.add(t.action),e),new Set));t.push({label:i.label,value:r,action:e.join(" / ")})}return t},[])},"planLimitText",0,o,"rateLimitTemplate",0,a,"ruleToMappings",0,n,"stableSort",0,function(e,t){let[a]=e.split("$"),[r]=t.split("$"),i=s[a],n=s[r];return i&&n?i-n:i?-i:n||e.localeCompare(t)},"systemFilter",0,[{label:"IP Address",value:"clientIp"},{label:"Country",value:"clientIpCountry"},{label:"JA4 Digest",value:"clientJa4Digest"},{label:"Host",value:"requestHostname"}]])},3774835,e=>{"use strict";var t=e.i(277234),a=e.i(850302);e.s(["useManagedRulesets",0,function(e){let{projectIdOrName:r,teamIdOrSlug:i}=e;return(0,a.default)(["/v1/security/firewall/managed-rules",new URLSearchParams({projectId:r,teamId:i}).toString()],async e=>{let[a,r]=e;return(0,t.default)(`${a}?${r}`)})}])},4689018,1496379,e=>{"use strict";var t=e.i(8660982),a=e.i(1246255),r=e.i(7432042),i=e.i(1233856),n=e.i(5963711),l=e.i(7749365),o=e.i(1283928),u=e.i(588428),s=e.i(409142),c=e.i(3538015);let d=[{value:"group_by_category",label:"Group by Category"},{value:"group_by_action",label:"Group by Action"}],f=[{label:"User Agent",value:"clientUserAgent"},{label:"Country",value:"clientIpCountry"},{label:"IP Address",value:"clientIp"},{label:"Request Path",value:"requestPath"},{label:"Route",value:"route"},{label:"JA4 Digest",value:"clientJa4Digest"},{label:"Host",value:"requestHostname"}],m=[{value:"botCheckResult",label:"Check Result"},...f],p=[{icon:l.Clock,label:"Live",value:"live"},{label:"Past Hour",value:"1h"},{label:"Past Day",value:"1d"},{label:"Past 3 Days",value:"3d"}];function g(){let{hideIpAddresses:e=!1,firewallOverviewRefresh:a=!1,defaultToolbarFilter:r="all_rules"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hideIpAddresses:!1,firewallOverviewRefresh:!1,defaultToolbarFilter:"all_rules"},{isReady:i,value:n}=(0,u.useIPBlockingTeamFlag)(),{set:l,state:p}=(0,s.useSearchParamsState)({action:{defaultValue:"all"},filter:{defaultValue:r},groupBy:{defaultValue:a?d[1].value:d[0].value,parseFromUrl:e=>(0,o.tryNormalizeDimension)(e)||e},range:{defaultValue:"1h",formatToUrl(e){if("string"==typeof e)return e;let t=Math.floor(e.from.getTime()/1e3),a=Math.floor(e.to.getTime()/1e3);return`${t}-${a}`},parseFromUrl(e){if(/^\d+-\d+$/.test(e)){let[t,a]=e.split("-"),r=1e3*Number.parseInt(t,10),i=1e3*Number.parseInt(a,10);return{from:new Date(r),to:new Date(i)}}return e}}}),g=(0,t.useMemo)(()=>p.range,[p.range]),v=(0,t.useMemo)(()=>{if("BotID"===p.filter){let e=p.groupBy===d[0].value?m[0].value:p.groupBy;return{action:p.action,filter:p.filter,groupBy:e,range:g}}return"botCheckResult"===p.groupBy&&"BotID"!==p.filter?{action:p.action,filter:p.filter,groupBy:f[0].value,range:g}:{action:p.action,filter:p.filter,groupBy:p.groupBy,range:g}},[p.action,p.filter,p.groupBy,g]),y=(0,t.useCallback)(t=>{let a=e||!n||!i;if("filter"===t.type){if("all_rules"===v.filter&&"all_rules"!==t.value){let e=(0,c.isLimitedSystemRule)(t.value)?c.systemFilter:c.defaultFilter;a&&(e=e.filter(e=>"clientIp"!==e.value)),l({filter:t.value,groupBy:"BotID"===t.value?m[0].value:e[0].value});return}if("all_rules"!==v.filter&&"all_rules"===t.value)return void l({filter:t.value,groupBy:d[0].value});if(!(0,c.isLimitedSystemRule)(v.filter)&&(0,c.isLimitedSystemRule)(t.value)){let e=a?c.systemFilter.filter(e=>"clientIp"!==e.value):c.systemFilter;l({filter:t.value,groupBy:e[0].value});return}l({filter:t.value})}else l({[t.type]:t.value})},[l,v,e,n,i]),h=(0,t.useMemo)(()=>{let t=e||!n||!i;if("all_rules"===v.filter)return d;if("BotID"===v.filter)return m;let a=(0,c.isLimitedSystemRule)(v.filter)?c.systemFilter:c.defaultFilter;return t?a.filter(e=>"clientIp"!==e.value):a},[v.filter,e,n,i]);return[v,y,h]}e.s(["getEnabledTimeRangeOptions",0,function(e){return p.filter(t=>{var a;let i;return"live"===t.value||(a=(0,r.default)(t.value),a<=(i=e?.billing?.plan==="enterprise"?(0,r.default)("7d"):(0,r.default)("24h"))+i/12)})},"useToolbarState",0,g],1496379);let v=[{threshold:(0,r.default)("4h"),granularity:{minutes:30}},{threshold:(0,r.default)("2h"),granularity:{minutes:15}},{threshold:(0,r.default)("1h"),granularity:{minutes:5}},{threshold:(0,r.default)("10m"),granularity:{minutes:1}}];function y(e){if("string"!=typeof e){let t,a,r=(t=Math.abs(e.from.getTime()-e.to.getTime()),a=v.find(e=>t>e.threshold),a?.granularity??{seconds:10});return{granularity:r,range:{end:(0,i.endOfDuration)(e.to,r),start:(0,i.startOfDuration)(e.from,r)}}}let t="live"===e?{seconds:10}:{minutes:"1h"===e?1:15},n=new Date,l="live"===e?(0,r.default)("10m"):(0,r.default)(e);return{granularity:t,range:{end:(0,i.endOfDuration)((0,a.subMinutes)(n,1),t),start:(0,i.startOfDuration)(new Date(n.getTime()-l),t)}}}function h(e,t){if("BotID"===e)return"";let a=[];switch(t){case"allow":a.push("wafAction eq 'allow'");break;case"challenge":a.push("wafAction in ('challenge', 'challenge-failed', 'challenge-solved')");break;case"all":break;default:a.push(`wafAction eq '${(0,n.denormalizeFirewallAction)(t)}'`)}let r=(0,n.wafRuleId)(e);return"all_rules"!==e&&a.push(`wafRuleId eq '${r}'`),a.join(" and ")}function b(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return"BotID"!==e&&r.push("wafAction"),"all_rules"===e?r.unshift("wafRuleId"):"BotID"===e?r.unshift("botCheckResult"):a||r.unshift(t),"clientIp"===t&&r.push("asnId","asnName","clientIpCountry"),r.map(t=>"sourcePath"===t?"default_web_traffic"===e?"route":"requestPath":t)}e.s(["useFirewallTimeRange",0,function(){let[e]=g();return y(e.range)},"useQuerySelect",0,function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{granularity:r,range:i}=(0,t.useMemo)(()=>y(e.range),[e.range]),{filter:n,action:l,groupBy:o}=e;return(0,t.useMemo)(()=>{let e="default_web_traffic"===n;return"BotID"===n?{event:"botIdCheck",reason:"firewall_tab",rollups:{value:{measure:"count",aggregation:"sum"}},granularity:r,groupBy:b(n,o,a),filter:h(n,l),limit:10,tailRollup:"others",summaryOnly:!1,startTime:i.start,endTime:i.end}:"bot-management"===n?{event:"incomingRequest",reason:"firewall_tab",rollups:{value:{measure:"count",aggregation:"sum"}},granularity:r,groupBy:["botName"],filter:"matchesPattern(botName, '\\S')",limit:10,tailRollup:"others",summaryOnly:!1,startTime:i.start,endTime:i.end}:e?{event:"incomingRequest",reason:"firewall_tab",rollups:{value:{measure:"count",aggregation:"sum"}},granularity:r,groupBy:b(n,o,a),filter:h(n,l),limit:10,tailRollup:"others",summaryOnly:!1,startTime:i.start,endTime:i.end}:{event:"firewallAction",reason:"firewall_tab",rollups:{value:{measure:"count",aggregation:"sum"}},granularity:r,groupBy:b(n,o,a),filter:h(n,l),limit:10,tailRollup:"others",summaryOnly:!1,startTime:i.start,endTime:i.end}},[r,i,n,l,o,a])}],4689018)}]);

//# debugId=8b6a0128-3f0d-9839-9481-c38707e9df49
//# sourceMappingURL=38ee34857450ae7b.js.map